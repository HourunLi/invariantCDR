nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=0), device_id='0', domains='cell_electronic', dropout=0.3, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-03 19:21:35.956857: step 947/75760 (epoch 1/80), loss = 1.389092 (241.703 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060085	 ndcg_5: 0.0510	 ndcg_10: 0.0699	 hit@1:0.020882	 hit@5:0.0818	 hit@10: 0.1406
target: 	 mrr: 0.068906	 ndcg_5: 0.0601	 ndcg_10: 0.0784	 hit@1:0.024475	 hit@5:0.0957	 hit@10: 0.1519
source best!
...............................................................
source: 	 mrr: 0.057605	 ndcg_5: 0.0483	 ndcg_10: 0.0658	 hit@1:0.018032	 hit@5:0.0797	 hit@10: 0.1341
target best!
......................................................................................................................................................target: 	 mrr: 0.068851	 ndcg_5: 0.0594	 ndcg_10: 0.0793	 hit@1:0.024513	 hit@5:0.0949	 hit@10: 0.1564
epoch 1: train_loss = 1.389092, source_hit@10 = 0.1341, source_ndcg@10 = 0.0658, target_hit@10 = 0.1564, target_ndcg@10 = 0.0793

2024-08-03 19:25:42.031039: step 1894/75760 (epoch 2/80), loss = 1.303885 (242.181 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067837	 ndcg_5: 0.0594	 ndcg_10: 0.0762	 hit@1:0.026180	 hit@5:0.0909	 hit@10: 0.1427
target: 	 mrr: 0.070829	 ndcg_5: 0.0625	 ndcg_10: 0.0807	 hit@1:0.026252	 hit@5:0.0990	 hit@10: 0.1554
source best!
...............................................................
source: 	 mrr: 0.072085	 ndcg_5: 0.0642	 ndcg_10: 0.0807	 hit@1:0.030528	 hit@5:0.0976	 hit@10: 0.1488
target best!
......................................................................................................................................................target: 	 mrr: 0.072908	 ndcg_5: 0.0639	 ndcg_10: 0.0830	 hit@1:0.028234	 hit@5:0.0996	 hit@10: 0.1590
epoch 2: train_loss = 1.303885, source_hit@10 = 0.1488, source_ndcg@10 = 0.0807, target_hit@10 = 0.1590, target_ndcg@10 = 0.0830
new best model saved.

2024-08-03 19:29:48.322392: step 2841/75760 (epoch 3/80), loss = 1.271153 (242.245 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.058960	 ndcg_5: 0.0525	 ndcg_10: 0.0680	 hit@1:0.019480	 hit@5:0.0860	 hit@10: 0.1342
target: 	 mrr: 0.079495	 ndcg_5: 0.0723	 ndcg_10: 0.0896	 hit@1:0.033028	 hit@5:0.1110	 hit@10: 0.1646
target best!
......................................................................................................................................................target: 	 mrr: 0.081846	 ndcg_5: 0.0743	 ndcg_10: 0.0922	 hit@1:0.036006	 hit@5:0.1127	 hit@10: 0.1683
epoch 3: train_loss = 1.271153, source_hit@10 = 0.1342, source_ndcg@10 = 0.0680, target_hit@10 = 0.1683, target_ndcg@10 = 0.0922

2024-08-03 19:33:54.436501: step 3788/75760 (epoch 4/80), loss = 1.251517 (242.799 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051457	 ndcg_5: 0.0437	 ndcg_10: 0.0588	 hit@1:0.015739	 hit@5:0.0718	 hit@10: 0.1187
target: 	 mrr: 0.076999	 ndcg_5: 0.0688	 ndcg_10: 0.0869	 hit@1:0.029805	 hit@5:0.1064	 hit@10: 0.1623
epoch 4: train_loss = 1.251517, source_hit@10 = 0.1187, source_ndcg@10 = 0.0588, target_hit@10 = 0.1623, target_ndcg@10 = 0.0869

2024-08-03 19:37:59.814930: step 4735/75760 (epoch 5/80), loss = 1.229778 (243.324 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065867	 ndcg_5: 0.0571	 ndcg_10: 0.0733	 hit@1:0.025245	 hit@5:0.0884	 hit@10: 0.1384
target: 	 mrr: 0.078298	 ndcg_5: 0.0703	 ndcg_10: 0.0866	 hit@1:0.035200	 hit@5:0.1042	 hit@10: 0.1549
epoch 5: train_loss = 1.229778, source_hit@10 = 0.1384, source_ndcg@10 = 0.0733, target_hit@10 = 0.1549, target_ndcg@10 = 0.0866

2024-08-03 19:42:04.906183: step 5682/75760 (epoch 6/80), loss = 1.218563 (243.084 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066609	 ndcg_5: 0.0571	 ndcg_10: 0.0739	 hit@1:0.026492	 hit@5:0.0882	 hit@10: 0.1406
target: 	 mrr: 0.038029	 ndcg_5: 0.0234	 ndcg_10: 0.0371	 hit@1:0.010198	 hit@5:0.0379	 hit@10: 0.0807
epoch 6: train_loss = 1.218563, source_hit@10 = 0.1406, source_ndcg@10 = 0.0739, target_hit@10 = 0.0807, target_ndcg@10 = 0.0371

2024-08-03 19:46:10.376918: step 6629/75760 (epoch 7/80), loss = 1.203255 (243.468 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057629	 ndcg_5: 0.0500	 ndcg_10: 0.0646	 hit@1:0.019947	 hit@5:0.0795	 hit@10: 0.1248
target: 	 mrr: 0.070828	 ndcg_5: 0.0618	 ndcg_10: 0.0783	 hit@1:0.027633	 hit@5:0.0954	 hit@10: 0.1470
epoch 7: train_loss = 1.203255, source_hit@10 = 0.1248, source_ndcg@10 = 0.0646, target_hit@10 = 0.1470, target_ndcg@10 = 0.0783

2024-08-03 19:50:15.375005: step 7576/75760 (epoch 8/80), loss = 1.193699 (242.986 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060096	 ndcg_5: 0.0517	 ndcg_10: 0.0673	 hit@1:0.020259	 hit@5:0.0827	 hit@10: 0.1312
target: 	 mrr: 0.051938	 ndcg_5: 0.0406	 ndcg_10: 0.0576	 hit@1:0.014475	 hit@5:0.0672	 hit@10: 0.1201
epoch 8: train_loss = 1.193699, source_hit@10 = 0.1312, source_ndcg@10 = 0.0673, target_hit@10 = 0.1201, target_ndcg@10 = 0.0576

2024-08-03 19:54:21.165410: step 8523/75760 (epoch 9/80), loss = 1.187219 (243.786 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051108	 ndcg_5: 0.0409	 ndcg_10: 0.0569	 hit@1:0.015739	 hit@5:0.0665	 hit@10: 0.1166
target: 	 mrr: 0.070966	 ndcg_5: 0.0620	 ndcg_10: 0.0824	 hit@1:0.022896	 hit@5:0.1015	 hit@10: 0.1650
epoch 9: train_loss = 1.187219, source_hit@10 = 0.1166, source_ndcg@10 = 0.0569, target_hit@10 = 0.1650, target_ndcg@10 = 0.0824

2024-08-03 19:58:26.780552: step 9470/75760 (epoch 10/80), loss = 1.180260 (243.585 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068259	 ndcg_5: 0.0602	 ndcg_10: 0.0755	 hit@1:0.027895	 hit@5:0.0927	 hit@10: 0.1406
target: 	 mrr: 0.077123	 ndcg_5: 0.0685	 ndcg_10: 0.0862	 hit@1:0.030726	 hit@5:0.1054	 hit@10: 0.1603
source best!
...............................................................
source: 	 mrr: 0.067532	 ndcg_5: 0.0581	 ndcg_10: 0.0753	 hit@1:0.025625	 hit@5:0.0906	 hit@10: 0.1441
epoch 10: train_loss = 1.180260, source_hit@10 = 0.1441, source_ndcg@10 = 0.0753, target_hit@10 = 0.1603, target_ndcg@10 = 0.0862

2024-08-03 20:02:33.099104: step 10417/75760 (epoch 11/80), loss = 1.175244 (243.734 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073187	 ndcg_5: 0.0646	 ndcg_10: 0.0821	 hit@1:0.028830	 hit@5:0.0999	 hit@10: 0.1543
target: 	 mrr: 0.066809	 ndcg_5: 0.0570	 ndcg_10: 0.0749	 hit@1:0.023817	 hit@5:0.0903	 hit@10: 0.1460
source best!
...............................................................
source: 	 mrr: 0.075259	 ndcg_5: 0.0653	 ndcg_10: 0.0835	 hit@1:0.030370	 hit@5:0.0995	 hit@10: 0.1560
epoch 11: train_loss = 1.175244, source_hit@10 = 0.1560, source_ndcg@10 = 0.0835, target_hit@10 = 0.1460, target_ndcg@10 = 0.0749

2024-08-03 20:06:39.203234: step 11364/75760 (epoch 12/80), loss = 1.169528 (243.551 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064886	 ndcg_5: 0.0571	 ndcg_10: 0.0730	 hit@1:0.023531	 hit@5:0.0907	 hit@10: 0.1403
target: 	 mrr: 0.077288	 ndcg_5: 0.0673	 ndcg_10: 0.0867	 hit@1:0.029410	 hit@5:0.1041	 hit@10: 0.1643
epoch 12: train_loss = 1.169528, source_hit@10 = 0.1403, source_ndcg@10 = 0.0730, target_hit@10 = 0.1643, target_ndcg@10 = 0.0867

2024-08-03 20:10:46.657139: step 12311/75760 (epoch 13/80), loss = 1.168055 (245.453 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050049	 ndcg_5: 0.0388	 ndcg_10: 0.0552	 hit@1:0.016363	 hit@5:0.0620	 hit@10: 0.1131
target: 	 mrr: 0.066178	 ndcg_5: 0.0564	 ndcg_10: 0.0743	 hit@1:0.023028	 hit@5:0.0904	 hit@10: 0.1461
epoch 13: train_loss = 1.168055, source_hit@10 = 0.1131, source_ndcg@10 = 0.0552, target_hit@10 = 0.1461, target_ndcg@10 = 0.0743

2024-08-03 20:14:52.691067: step 13258/75760 (epoch 14/80), loss = 1.164143 (244.029 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.048497	 ndcg_5: 0.0377	 ndcg_10: 0.0561	 hit@1:0.014025	 hit@5:0.0622	 hit@10: 0.1194
target: 	 mrr: 0.072894	 ndcg_5: 0.0635	 ndcg_10: 0.0809	 hit@1:0.027831	 hit@5:0.0990	 hit@10: 0.1533
epoch 14: train_loss = 1.164143, source_hit@10 = 0.1194, source_ndcg@10 = 0.0561, target_hit@10 = 0.1533, target_ndcg@10 = 0.0809

2024-08-03 20:18:58.444394: step 14205/75760 (epoch 15/80), loss = 1.162841 (243.742 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060562	 ndcg_5: 0.0509	 ndcg_10: 0.0659	 hit@1:0.021817	 hit@5:0.0789	 hit@10: 0.1258
target: 	 mrr: 0.044290	 ndcg_5: 0.0303	 ndcg_10: 0.0447	 hit@1:0.011843	 hit@5:0.0494	 hit@10: 0.0945
epoch 15: train_loss = 1.162841, source_hit@10 = 0.1258, source_ndcg@10 = 0.0659, target_hit@10 = 0.0945, target_ndcg@10 = 0.0447

2024-08-03 20:23:04.349874: step 15152/75760 (epoch 16/80), loss = 1.159126 (243.897 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.040429	 ndcg_5: 0.0305	 ndcg_10: 0.0409	 hit@1:0.012467	 hit@5:0.0486	 hit@10: 0.0812
target: 	 mrr: 0.078097	 ndcg_5: 0.0691	 ndcg_10: 0.0880	 hit@1:0.029410	 hit@5:0.1082	 hit@10: 0.1670
epoch 16: train_loss = 1.159126, source_hit@10 = 0.0812, source_ndcg@10 = 0.0409, target_hit@10 = 0.1670, target_ndcg@10 = 0.0880

2024-08-03 20:27:10.378831: step 16099/75760 (epoch 17/80), loss = 1.156491 (243.937 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051894	 ndcg_5: 0.0408	 ndcg_10: 0.0558	 hit@1:0.017609	 hit@5:0.0655	 hit@10: 0.1120
target: 	 mrr: 0.082869	 ndcg_5: 0.0747	 ndcg_10: 0.0926	 hit@1:0.033226	 hit@5:0.1148	 hit@10: 0.1703
target best!
......................................................................................................................................................target: 	 mrr: 0.084832	 ndcg_5: 0.0765	 ndcg_10: 0.0952	 hit@1:0.035408	 hit@5:0.1167	 hit@10: 0.1748
epoch 17: train_loss = 1.156491, source_hit@10 = 0.1120, source_ndcg@10 = 0.0558, target_hit@10 = 0.1748, target_ndcg@10 = 0.0952

2024-08-03 20:31:17.569860: step 17046/75760 (epoch 18/80), loss = 1.155923 (243.807 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069051	 ndcg_5: 0.0594	 ndcg_10: 0.0772	 hit@1:0.026960	 hit@5:0.0918	 hit@10: 0.1476
target: 	 mrr: 0.086470	 ndcg_5: 0.0790	 ndcg_10: 0.0969	 hit@1:0.037371	 hit@5:0.1190	 hit@10: 0.1748
target best!
......................................................................................................................................................target: 	 mrr: 0.088705	 ndcg_5: 0.0807	 ndcg_10: 0.0988	 hit@1:0.039992	 hit@5:0.1194	 hit@10: 0.1757
epoch 18: train_loss = 1.155923, source_hit@10 = 0.1476, source_ndcg@10 = 0.0772, target_hit@10 = 0.1757, target_ndcg@10 = 0.0988

2024-08-03 20:35:24.731676: step 17993/75760 (epoch 19/80), loss = 1.155156 (243.823 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.040774	 ndcg_5: 0.0314	 ndcg_10: 0.0411	 hit@1:0.013402	 hit@5:0.0483	 hit@10: 0.0784
target: 	 mrr: 0.028017	 ndcg_5: 0.0175	 ndcg_10: 0.0249	 hit@1:0.007303	 hit@5:0.0283	 hit@10: 0.0513
epoch 19: train_loss = 1.155156, source_hit@10 = 0.0784, source_ndcg@10 = 0.0411, target_hit@10 = 0.0513, target_ndcg@10 = 0.0249

2024-08-03 20:39:30.526391: step 18940/75760 (epoch 20/80), loss = 1.153445 (243.782 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052673	 ndcg_5: 0.0437	 ndcg_10: 0.0597	 hit@1:0.018700	 hit@5:0.0695	 hit@10: 0.1189
target: 	 mrr: 0.052006	 ndcg_5: 0.0420	 ndcg_10: 0.0541	 hit@1:0.018028	 hit@5:0.0660	 hit@10: 0.1034
epoch 20: train_loss = 1.153445, source_hit@10 = 0.1189, source_ndcg@10 = 0.0597, target_hit@10 = 0.1034, target_ndcg@10 = 0.0541

2024-08-03 20:43:36.305385: step 19887/75760 (epoch 21/80), loss = 1.153004 (243.760 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050531	 ndcg_5: 0.0408	 ndcg_10: 0.0560	 hit@1:0.017609	 hit@5:0.0642	 hit@10: 0.1120
target: 	 mrr: 0.063196	 ndcg_5: 0.0590	 ndcg_10: 0.0703	 hit@1:0.029015	 hit@5:0.0883	 hit@10: 0.1234
epoch 21: train_loss = 1.153004, source_hit@10 = 0.1120, source_ndcg@10 = 0.0560, target_hit@10 = 0.1234, target_ndcg@10 = 0.0703

2024-08-03 20:47:42.249696: step 20834/75760 (epoch 22/80), loss = 1.153306 (243.926 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051086	 ndcg_5: 0.0424	 ndcg_10: 0.0574	 hit@1:0.017609	 hit@5:0.0676	 hit@10: 0.1145
target: 	 mrr: 0.062634	 ndcg_5: 0.0562	 ndcg_10: 0.0689	 hit@1:0.026449	 hit@5:0.0851	 hit@10: 0.1245
epoch 22: train_loss = 1.153306, source_hit@10 = 0.1145, source_ndcg@10 = 0.0574, target_hit@10 = 0.1245, target_ndcg@10 = 0.0689

2024-08-03 20:51:48.247962: step 21781/75760 (epoch 23/80), loss = 1.149620 (243.967 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070646	 ndcg_5: 0.0626	 ndcg_10: 0.0817	 hit@1:0.024934	 hit@5:0.1004	 hit@10: 0.1593
target: 	 mrr: 0.058392	 ndcg_5: 0.0480	 ndcg_10: 0.0623	 hit@1:0.024212	 hit@5:0.0709	 hit@10: 0.1156
epoch 23: train_loss = 1.149620, source_hit@10 = 0.1593, source_ndcg@10 = 0.0817, target_hit@10 = 0.1156, target_ndcg@10 = 0.0623

2024-08-03 20:55:53.489851: step 22728/75760 (epoch 24/80), loss = 1.150727 (243.152 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069712	 ndcg_5: 0.0607	 ndcg_10: 0.0772	 hit@1:0.027583	 hit@5:0.0940	 hit@10: 0.1454
target: 	 mrr: 0.080917	 ndcg_5: 0.0729	 ndcg_10: 0.0891	 hit@1:0.036384	 hit@5:0.1080	 hit@10: 0.1583
epoch 24: train_loss = 1.150727, source_hit@10 = 0.1454, source_ndcg@10 = 0.0772, target_hit@10 = 0.1583, target_ndcg@10 = 0.0891

2024-08-03 20:59:59.156419: step 23675/75760 (epoch 25/80), loss = 1.149631 (243.657 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069904	 ndcg_5: 0.0607	 ndcg_10: 0.0777	 hit@1:0.027739	 hit@5:0.0937	 hit@10: 0.1463
target: 	 mrr: 0.057241	 ndcg_5: 0.0500	 ndcg_10: 0.0646	 hit@1:0.020791	 hit@5:0.0786	 hit@10: 0.1240
epoch 25: train_loss = 1.149631, source_hit@10 = 0.1463, source_ndcg@10 = 0.0777, target_hit@10 = 0.1240, target_ndcg@10 = 0.0646

2024-08-03 21:04:04.922835: step 24622/75760 (epoch 26/80), loss = 1.147588 (243.762 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052747	 ndcg_5: 0.0411	 ndcg_10: 0.0578	 hit@1:0.018233	 hit@5:0.0639	 hit@10: 0.1167
target: 	 mrr: 0.078377	 ndcg_5: 0.0697	 ndcg_10: 0.0862	 hit@1:0.034608	 hit@5:0.1036	 hit@10: 0.1547
epoch 26: train_loss = 1.147588, source_hit@10 = 0.1167, source_ndcg@10 = 0.0578, target_hit@10 = 0.1547, target_ndcg@10 = 0.0862

2024-08-03 21:08:10.385766: step 25569/75760 (epoch 27/80), loss = 1.144967 (243.408 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.058795	 ndcg_5: 0.0475	 ndcg_10: 0.0668	 hit@1:0.019635	 hit@5:0.0756	 hit@10: 0.1360
target: 	 mrr: 0.080616	 ndcg_5: 0.0721	 ndcg_10: 0.0902	 hit@1:0.034871	 hit@5:0.1088	 hit@10: 0.1652
epoch 27: train_loss = 1.144967, source_hit@10 = 0.1360, source_ndcg@10 = 0.0668, target_hit@10 = 0.1652, target_ndcg@10 = 0.0902

2024-08-03 21:12:15.934521: step 26516/75760 (epoch 28/80), loss = 1.144528 (243.537 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.044966	 ndcg_5: 0.0336	 ndcg_10: 0.0509	 hit@1:0.011376	 hit@5:0.0578	 hit@10: 0.1117
target: 	 mrr: 0.091241	 ndcg_5: 0.0845	 ndcg_10: 0.1019	 hit@1:0.041121	 hit@5:0.1269	 hit@10: 0.1806
target best!
......................................................................................................................................................target: 	 mrr: 0.091116	 ndcg_5: 0.0835	 ndcg_10: 0.1017	 hit@1:0.041586	 hit@5:0.1244	 hit@10: 0.1808
epoch 28: train_loss = 1.144528, source_hit@10 = 0.1117, source_ndcg@10 = 0.0509, target_hit@10 = 0.1808, target_ndcg@10 = 0.1017

2024-08-03 21:16:22.786183: step 27463/75760 (epoch 29/80), loss = 1.143631 (243.513 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063880	 ndcg_5: 0.0544	 ndcg_10: 0.0722	 hit@1:0.021973	 hit@5:0.0873	 hit@10: 0.1424
target: 	 mrr: 0.058790	 ndcg_5: 0.0490	 ndcg_10: 0.0633	 hit@1:0.022370	 hit@5:0.0763	 hit@10: 0.1208
epoch 29: train_loss = 1.143631, source_hit@10 = 0.1424, source_ndcg@10 = 0.0722, target_hit@10 = 0.1208, target_ndcg@10 = 0.0633

2024-08-03 21:20:28.766291: step 28410/75760 (epoch 30/80), loss = 1.141649 (243.957 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059269	 ndcg_5: 0.0504	 ndcg_10: 0.0666	 hit@1:0.022129	 hit@5:0.0779	 hit@10: 0.1281
target: 	 mrr: 0.076406	 ndcg_5: 0.0678	 ndcg_10: 0.0861	 hit@1:0.031515	 hit@5:0.1036	 hit@10: 0.1605
epoch 30: train_loss = 1.141649, source_hit@10 = 0.1281, source_ndcg@10 = 0.0666, target_hit@10 = 0.1605, target_ndcg@10 = 0.0861

2024-08-03 21:24:34.522793: step 29357/75760 (epoch 31/80), loss = 1.141134 (243.736 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.045133	 ndcg_5: 0.0347	 ndcg_10: 0.0492	 hit@1:0.013090	 hit@5:0.0567	 hit@10: 0.1024
target: 	 mrr: 0.062797	 ndcg_5: 0.0554	 ndcg_10: 0.0690	 hit@1:0.025791	 hit@5:0.0851	 hit@10: 0.1274
epoch 31: train_loss = 1.141134, source_hit@10 = 0.1024, source_ndcg@10 = 0.0492, target_hit@10 = 0.1274, target_ndcg@10 = 0.0690

2024-08-03 21:28:40.310515: step 30304/75760 (epoch 32/80), loss = 1.137337 (243.782 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072703	 ndcg_5: 0.0646	 ndcg_10: 0.0821	 hit@1:0.029297	 hit@5:0.1005	 hit@10: 0.1547
target: 	 mrr: 0.072962	 ndcg_5: 0.0648	 ndcg_10: 0.0823	 hit@1:0.028818	 hit@5:0.1013	 hit@10: 0.1556
epoch 32: train_loss = 1.137337, source_hit@10 = 0.1547, source_ndcg@10 = 0.0821, target_hit@10 = 0.1556, target_ndcg@10 = 0.0823

2024-08-03 21:32:45.541359: step 31251/75760 (epoch 33/80), loss = 1.138234 (243.208 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068507	 ndcg_5: 0.0584	 ndcg_10: 0.0769	 hit@1:0.025713	 hit@5:0.0909	 hit@10: 0.1490
target: 	 mrr: 0.090919	 ndcg_5: 0.0821	 ndcg_10: 0.1005	 hit@1:0.041911	 hit@5:0.1205	 hit@10: 0.1776
epoch 33: train_loss = 1.138234, source_hit@10 = 0.1490, source_ndcg@10 = 0.0769, target_hit@10 = 0.1776, target_ndcg@10 = 0.1005

2024-08-03 21:36:51.261176: step 32198/75760 (epoch 34/80), loss = 1.136522 (243.702 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.047459	 ndcg_5: 0.0389	 ndcg_10: 0.0508	 hit@1:0.017454	 hit@5:0.0605	 hit@10: 0.0977
target: 	 mrr: 0.090492	 ndcg_5: 0.0811	 ndcg_10: 0.1006	 hit@1:0.040463	 hit@5:0.1203	 hit@10: 0.1809
epoch 34: train_loss = 1.136522, source_hit@10 = 0.0977, source_ndcg@10 = 0.0508, target_hit@10 = 0.1809, target_ndcg@10 = 0.1006

2024-08-03 21:40:57.087877: step 33145/75760 (epoch 35/80), loss = 1.135072 (243.811 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057889	 ndcg_5: 0.0487	 ndcg_10: 0.0639	 hit@1:0.018856	 hit@5:0.0790	 hit@10: 0.1259
target: 	 mrr: 0.080548	 ndcg_5: 0.0734	 ndcg_10: 0.0899	 hit@1:0.033621	 hit@5:0.1128	 hit@10: 0.1639
epoch 35: train_loss = 1.135072, source_hit@10 = 0.1259, source_ndcg@10 = 0.0639, target_hit@10 = 0.1639, target_ndcg@10 = 0.0899

2024-08-03 21:45:02.586171: step 34092/75760 (epoch 36/80), loss = 1.136348 (243.372 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074015	 ndcg_5: 0.0643	 ndcg_10: 0.0816	 hit@1:0.032102	 hit@5:0.0944	 hit@10: 0.1484
target: 	 mrr: 0.067094	 ndcg_5: 0.0565	 ndcg_10: 0.0735	 hit@1:0.025857	 hit@5:0.0868	 hit@10: 0.1395
source best!
...............................................................
source: 	 mrr: 0.076742	 ndcg_5: 0.0676	 ndcg_10: 0.0854	 hit@1:0.032901	 hit@5:0.1009	 hit@10: 0.1563
epoch 36: train_loss = 1.136348, source_hit@10 = 0.1563, source_ndcg@10 = 0.0854, target_hit@10 = 0.1395, target_ndcg@10 = 0.0735

2024-08-03 21:49:09.150933: step 35039/75760 (epoch 37/80), loss = 1.134666 (243.995 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.083195	 ndcg_5: 0.0765	 ndcg_10: 0.0923	 hit@1:0.037868	 hit@5:0.1144	 hit@10: 0.1636
target: 	 mrr: 0.056915	 ndcg_5: 0.0482	 ndcg_10: 0.0634	 hit@1:0.020067	 hit@5:0.0768	 hit@10: 0.1242
source best!
...............................................................
source: 	 mrr: 0.083714	 ndcg_5: 0.0759	 ndcg_10: 0.0929	 hit@1:0.037330	 hit@5:0.1134	 hit@10: 0.1666
epoch 37: train_loss = 1.134666, source_hit@10 = 0.1666, source_ndcg@10 = 0.0929, target_hit@10 = 0.1242, target_ndcg@10 = 0.0634

2024-08-03 21:53:15.336549: step 35986/75760 (epoch 38/80), loss = 1.133803 (243.626 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065696	 ndcg_5: 0.0576	 ndcg_10: 0.0746	 hit@1:0.022440	 hit@5:0.0930	 hit@10: 0.1457
target: 	 mrr: 0.067673	 ndcg_5: 0.0577	 ndcg_10: 0.0751	 hit@1:0.026318	 hit@5:0.0893	 hit@10: 0.1436
epoch 38: train_loss = 1.133803, source_hit@10 = 0.1457, source_ndcg@10 = 0.0746, target_hit@10 = 0.1436, target_ndcg@10 = 0.0751

2024-08-03 21:57:20.357232: step 36933/75760 (epoch 39/80), loss = 1.127977 (243.009 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.047184	 ndcg_5: 0.0372	 ndcg_10: 0.0514	 hit@1:0.016207	 hit@5:0.0580	 hit@10: 0.1022
target: 	 mrr: 0.087733	 ndcg_5: 0.0795	 ndcg_10: 0.0982	 hit@1:0.037700	 hit@5:0.1200	 hit@10: 0.1782
epoch 39: train_loss = 1.127977, source_hit@10 = 0.1022, source_ndcg@10 = 0.0514, target_hit@10 = 0.1782, target_ndcg@10 = 0.0982

2024-08-03 22:01:25.915266: step 37880/75760 (epoch 40/80), loss = 1.128765 (243.547 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076236	 ndcg_5: 0.0671	 ndcg_10: 0.0864	 hit@1:0.031167	 hit@5:0.1027	 hit@10: 0.1630
target: 	 mrr: 0.094742	 ndcg_5: 0.0869	 ndcg_10: 0.1053	 hit@1:0.045595	 hit@5:0.1272	 hit@10: 0.1842
target best!
......................................................................................................................................................target: 	 mrr: 0.095892	 ndcg_5: 0.0885	 ndcg_10: 0.1063	 hit@1:0.045506	 hit@5:0.1301	 hit@10: 0.1853
epoch 40: train_loss = 1.128765, source_hit@10 = 0.1630, source_ndcg@10 = 0.0864, target_hit@10 = 0.1853, target_ndcg@10 = 0.1063
shift to transfer learning mode

2024-08-03 22:05:33.627464: step 38827/75760 (epoch 41/80), loss = 1.127970 (244.363 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064698	 ndcg_5: 0.0561	 ndcg_10: 0.0730	 hit@1:0.023531	 hit@5:0.0891	 hit@10: 0.1415
target: 	 mrr: 0.092788	 ndcg_5: 0.0853	 ndcg_10: 0.1043	 hit@1:0.041319	 hit@5:0.1271	 hit@10: 0.1858
epoch 41: train_loss = 1.127970, source_hit@10 = 0.1415, source_ndcg@10 = 0.0730, target_hit@10 = 0.1858, target_ndcg@10 = 0.1043

2024-08-03 22:09:41.187810: step 39774/75760 (epoch 42/80), loss = 1.125769 (245.549 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072792	 ndcg_5: 0.0641	 ndcg_10: 0.0825	 hit@1:0.027115	 hit@5:0.1007	 hit@10: 0.1580
target: 	 mrr: 0.083760	 ndcg_5: 0.0749	 ndcg_10: 0.0932	 hit@1:0.036647	 hit@5:0.1120	 hit@10: 0.1690
epoch 42: train_loss = 1.125769, source_hit@10 = 0.1580, source_ndcg@10 = 0.0825, target_hit@10 = 0.1690, target_ndcg@10 = 0.0932

2024-08-03 22:13:49.079687: step 40721/75760 (epoch 43/80), loss = 1.124145 (245.882 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077227	 ndcg_5: 0.0678	 ndcg_10: 0.0864	 hit@1:0.033505	 hit@5:0.1024	 hit@10: 0.1605
target: 	 mrr: 0.094020	 ndcg_5: 0.0857	 ndcg_10: 0.1053	 hit@1:0.044279	 hit@5:0.1264	 hit@10: 0.1874
epoch 43: train_loss = 1.124145, source_hit@10 = 0.1605, source_ndcg@10 = 0.0864, target_hit@10 = 0.1874, target_ndcg@10 = 0.1053

2024-08-03 22:17:56.232883: step 41668/75760 (epoch 44/80), loss = 1.122596 (245.139 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072827	 ndcg_5: 0.0643	 ndcg_10: 0.0818	 hit@1:0.028830	 hit@5:0.0997	 hit@10: 0.1546
target: 	 mrr: 0.097415	 ndcg_5: 0.0887	 ndcg_10: 0.1086	 hit@1:0.047240	 hit@5:0.1282	 hit@10: 0.1900
target best!
......................................................................................................................................................target: 	 mrr: 0.098682	 ndcg_5: 0.0905	 ndcg_10: 0.1095	 hit@1:0.048628	 hit@5:0.1312	 hit@10: 0.1902
epoch 44: train_loss = 1.122596, source_hit@10 = 0.1546, source_ndcg@10 = 0.0818, target_hit@10 = 0.1902, target_ndcg@10 = 0.1095

2024-08-03 22:22:05.398364: step 42615/75760 (epoch 45/80), loss = 1.120875 (245.819 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.075322	 ndcg_5: 0.0663	 ndcg_10: 0.0855	 hit@1:0.030856	 hit@5:0.1010	 hit@10: 0.1607
target: 	 mrr: 0.062820	 ndcg_5: 0.0551	 ndcg_10: 0.0704	 hit@1:0.025660	 hit@5:0.0845	 hit@10: 0.1322
epoch 45: train_loss = 1.120875, source_hit@10 = 0.1607, source_ndcg@10 = 0.0855, target_hit@10 = 0.1322, target_ndcg@10 = 0.0704

2024-08-03 22:26:12.770381: step 43562/75760 (epoch 46/80), loss = 1.115338 (245.355 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077039	 ndcg_5: 0.0692	 ndcg_10: 0.0873	 hit@1:0.031167	 hit@5:0.1064	 hit@10: 0.1627
target: 	 mrr: 0.071431	 ndcg_5: 0.0634	 ndcg_10: 0.0842	 hit@1:0.024212	 hit@5:0.1049	 hit@10: 0.1692
epoch 46: train_loss = 1.115338, source_hit@10 = 0.1627, source_ndcg@10 = 0.0873, target_hit@10 = 0.1692, target_ndcg@10 = 0.0842

2024-08-03 22:30:20.167019: step 44509/75760 (epoch 47/80), loss = 1.112391 (245.391 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.037337	 ndcg_5: 0.0284	 ndcg_10: 0.0389	 hit@1:0.012467	 hit@5:0.0439	 hit@10: 0.0765
target: 	 mrr: 0.093285	 ndcg_5: 0.0851	 ndcg_10: 0.1051	 hit@1:0.042174	 hit@5:0.1265	 hit@10: 0.1886
epoch 47: train_loss = 1.112391, source_hit@10 = 0.0765, source_ndcg@10 = 0.0389, target_hit@10 = 0.1886, target_ndcg@10 = 0.1051

2024-08-03 22:34:27.611991: step 45456/75760 (epoch 48/80), loss = 1.101951 (245.411 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074922	 ndcg_5: 0.0656	 ndcg_10: 0.0851	 hit@1:0.028986	 hit@5:0.1019	 hit@10: 0.1625
target: 	 mrr: 0.091105	 ndcg_5: 0.0828	 ndcg_10: 0.1011	 hit@1:0.042963	 hit@5:0.1214	 hit@10: 0.1784
epoch 48: train_loss = 1.101951, source_hit@10 = 0.1625, source_ndcg@10 = 0.0851, target_hit@10 = 0.1784, target_ndcg@10 = 0.1011

2024-08-03 22:38:34.922309: step 46403/75760 (epoch 49/80), loss = 1.092913 (245.267 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052537	 ndcg_5: 0.0431	 ndcg_10: 0.0580	 hit@1:0.018233	 hit@5:0.0678	 hit@10: 0.1141
target: 	 mrr: 0.081993	 ndcg_5: 0.0730	 ndcg_10: 0.0920	 hit@1:0.033423	 hit@5:0.1117	 hit@10: 0.1706
epoch 49: train_loss = 1.092913, source_hit@10 = 0.1141, source_ndcg@10 = 0.0580, target_hit@10 = 0.1706, target_ndcg@10 = 0.0920

2024-08-03 22:42:42.506496: step 47350/75760 (epoch 50/80), loss = 1.086102 (245.558 sec/epoch), lr: 0.001589
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.083069	 ndcg_5: 0.0751	 ndcg_10: 0.0935	 hit@1:0.035219	 hit@5:0.1141	 hit@10: 0.1710
target: 	 mrr: 0.094929	 ndcg_5: 0.0873	 ndcg_10: 0.1071	 hit@1:0.044082	 hit@5:0.1301	 hit@10: 0.1919
epoch 50: train_loss = 1.086102, source_hit@10 = 0.1710, source_ndcg@10 = 0.0935, target_hit@10 = 0.1919, target_ndcg@10 = 0.1071

2024-08-03 22:46:50.872986: step 48297/75760 (epoch 51/80), loss = 1.082536 (246.354 sec/epoch), lr: 0.001589
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068762	 ndcg_5: 0.0594	 ndcg_10: 0.0777	 hit@1:0.025401	 hit@5:0.0926	 hit@10: 0.1494
target: 	 mrr: 0.085642	 ndcg_5: 0.0753	 ndcg_10: 0.0956	 hit@1:0.038489	 hit@5:0.1117	 hit@10: 0.1751
epoch 51: train_loss = 1.082536, source_hit@10 = 0.1494, source_ndcg@10 = 0.0777, target_hit@10 = 0.1751, target_ndcg@10 = 0.0956
early termination of training
