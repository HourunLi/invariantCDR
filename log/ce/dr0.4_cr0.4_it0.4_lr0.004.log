nohup: ignoring input
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:54: UserWarning: An issue occurred while importing 'pyg-lib'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'pyg-lib'. "
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:110: UserWarning: An issue occurred while importing 'torch-sparse'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'torch-sparse'. "
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=0), device_id='0', domains='cell_electronic', dropout=0.4, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:68: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /opt/conda/conda-bld/pytorch_1711403590347/work/torch/csrc/utils/tensor_new.cpp:618.)
  return torch.sparse.FloatTensor(indices, values, shape)
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-03 19:41:00.190846: step 947/75760 (epoch 1/80), loss = 1.355165 (691.690 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062014	 ndcg_5: 0.0525	 ndcg_10: 0.0686	 hit@1:0.024934	 hit@5:0.0795	 hit@10: 0.1295
target: 	 mrr: 0.061732	 ndcg_5: 0.0519	 ndcg_10: 0.0707	 hit@1:0.022436	 hit@5:0.0826	 hit@10: 0.1408
source best!
...............................................................
source: 	 mrr: 0.067890	 ndcg_5: 0.0598	 ndcg_10: 0.0742	 hit@1:0.028472	 hit@5:0.0905	 hit@10: 0.1352
target best!
......................................................................................................................................................target: 	 mrr: 0.060454	 ndcg_5: 0.0503	 ndcg_10: 0.0703	 hit@1:0.020328	 hit@5:0.0814	 hit@10: 0.1432
epoch 1: train_loss = 1.355165, source_hit@10 = 0.1352, source_ndcg@10 = 0.0742, target_hit@10 = 0.1432, target_ndcg@10 = 0.0703

2024-08-03 19:52:40.566936: step 1894/75760 (epoch 2/80), loss = 1.266073 (689.892 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052924	 ndcg_5: 0.0461	 ndcg_10: 0.0595	 hit@1:0.017454	 hit@5:0.0737	 hit@10: 0.1155
target: 	 mrr: 0.053206	 ndcg_5: 0.0426	 ndcg_10: 0.0609	 hit@1:0.015856	 hit@5:0.0701	 hit@10: 0.1270
epoch 2: train_loss = 1.266073, source_hit@10 = 0.1155, source_ndcg@10 = 0.0595, target_hit@10 = 0.1270, target_ndcg@10 = 0.0609

2024-08-03 20:04:16.672265: step 2841/75760 (epoch 3/80), loss = 1.255798 (690.167 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053886	 ndcg_5: 0.0453	 ndcg_10: 0.0615	 hit@1:0.017454	 hit@5:0.0729	 hit@10: 0.1231
target: 	 mrr: 0.063049	 ndcg_5: 0.0528	 ndcg_10: 0.0717	 hit@1:0.022173	 hit@5:0.0843	 hit@10: 0.1430
target best!
......................................................................................................................................................target: 	 mrr: 0.065323	 ndcg_5: 0.0560	 ndcg_10: 0.0746	 hit@1:0.022853	 hit@5:0.0900	 hit@10: 0.1479
epoch 3: train_loss = 1.255798, source_hit@10 = 0.1231, source_ndcg@10 = 0.0615, target_hit@10 = 0.1479, target_ndcg@10 = 0.0746

2024-08-03 20:16:13.900332: step 3788/75760 (epoch 4/80), loss = 1.254423 (708.349 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057657	 ndcg_5: 0.0458	 ndcg_10: 0.0632	 hit@1:0.021661	 hit@5:0.0706	 hit@10: 0.1247
target: 	 mrr: 0.067478	 ndcg_5: 0.0577	 ndcg_10: 0.0757	 hit@1:0.024278	 hit@5:0.0911	 hit@10: 0.1470
target best!
......................................................................................................................................................target: 	 mrr: 0.068380	 ndcg_5: 0.0589	 ndcg_10: 0.0768	 hit@1:0.024713	 hit@5:0.0934	 hit@10: 0.1494
epoch 4: train_loss = 1.254423, source_hit@10 = 0.1247, source_ndcg@10 = 0.0632, target_hit@10 = 0.1494, target_ndcg@10 = 0.0768
new best model saved.

2024-08-03 20:27:43.585032: step 4735/75760 (epoch 5/80), loss = 1.247668 (680.642 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057172	 ndcg_5: 0.0489	 ndcg_10: 0.0635	 hit@1:0.020726	 hit@5:0.0776	 hit@10: 0.1231
target: 	 mrr: 0.056515	 ndcg_5: 0.0487	 ndcg_10: 0.0648	 hit@1:0.018422	 hit@5:0.0796	 hit@10: 0.1293
epoch 5: train_loss = 1.247668, source_hit@10 = 0.1231, source_ndcg@10 = 0.0635, target_hit@10 = 0.1293, target_ndcg@10 = 0.0648

2024-08-03 20:39:07.707087: step 5682/75760 (epoch 6/80), loss = 1.240127 (679.082 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.018619	 ndcg_5: 0.0123	 ndcg_10: 0.0162	 hit@1:0.005143	 hit@5:0.0198	 hit@10: 0.0318
target: 	 mrr: 0.066715	 ndcg_5: 0.0580	 ndcg_10: 0.0760	 hit@1:0.023949	 hit@5:0.0929	 hit@10: 0.1492
epoch 6: train_loss = 1.240127, source_hit@10 = 0.0318, source_ndcg@10 = 0.0162, target_hit@10 = 0.1492, target_ndcg@10 = 0.0760

2024-08-03 20:50:37.077938: step 6629/75760 (epoch 7/80), loss = 1.235503 (684.372 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.027508	 ndcg_5: 0.0204	 ndcg_10: 0.0292	 hit@1:0.008571	 hit@5:0.0326	 hit@10: 0.0595
target: 	 mrr: 0.067481	 ndcg_5: 0.0588	 ndcg_10: 0.0756	 hit@1:0.024673	 hit@5:0.0933	 hit@10: 0.1458
target best!
......................................................................................................................................................target: 	 mrr: 0.067360	 ndcg_5: 0.0584	 ndcg_10: 0.0754	 hit@1:0.024646	 hit@5:0.0923	 hit@10: 0.1452
epoch 7: train_loss = 1.235503, source_hit@10 = 0.0595, source_ndcg@10 = 0.0292, target_hit@10 = 0.1452, target_ndcg@10 = 0.0754

2024-08-03 21:02:07.470787: step 7576/75760 (epoch 8/80), loss = 1.229531 (680.998 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054131	 ndcg_5: 0.0456	 ndcg_10: 0.0602	 hit@1:0.018700	 hit@5:0.0717	 hit@10: 0.1169
target: 	 mrr: 0.049420	 ndcg_5: 0.0378	 ndcg_10: 0.0559	 hit@1:0.013488	 hit@5:0.0637	 hit@10: 0.1199
epoch 8: train_loss = 1.229531, source_hit@10 = 0.1169, source_ndcg@10 = 0.0602, target_hit@10 = 0.1199, target_ndcg@10 = 0.0559

2024-08-03 21:13:35.490582: step 8523/75760 (epoch 9/80), loss = 1.226730 (682.870 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.042942	 ndcg_5: 0.0341	 ndcg_10: 0.0460	 hit@1:0.011999	 hit@5:0.0561	 hit@10: 0.0930
target: 	 mrr: 0.061866	 ndcg_5: 0.0506	 ndcg_10: 0.0718	 hit@1:0.017962	 hit@5:0.0847	 hit@10: 0.1507
epoch 9: train_loss = 1.226730, source_hit@10 = 0.0930, source_ndcg@10 = 0.0460, target_hit@10 = 0.1507, target_ndcg@10 = 0.0718

2024-08-03 21:25:05.773783: step 9470/75760 (epoch 10/80), loss = 1.219324 (685.066 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.022480	 ndcg_5: 0.0152	 ndcg_10: 0.0212	 hit@1:0.005922	 hit@5:0.0249	 hit@10: 0.0438
target: 	 mrr: 0.079757	 ndcg_5: 0.0710	 ndcg_10: 0.0880	 hit@1:0.034213	 hit@5:0.1067	 hit@10: 0.1597
target best!
......................................................................................................................................................target: 	 mrr: 0.080457	 ndcg_5: 0.0720	 ndcg_10: 0.0897	 hit@1:0.034345	 hit@5:0.1096	 hit@10: 0.1648
epoch 10: train_loss = 1.219324, source_hit@10 = 0.0438, source_ndcg@10 = 0.0212, target_hit@10 = 0.1648, target_ndcg@10 = 0.0897

2024-08-03 21:36:47.523569: step 10417/75760 (epoch 11/80), loss = 1.208152 (692.573 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.037710	 ndcg_5: 0.0305	 ndcg_10: 0.0391	 hit@1:0.011220	 hit@5:0.0492	 hit@10: 0.0760
target: 	 mrr: 0.077990	 ndcg_5: 0.0689	 ndcg_10: 0.0868	 hit@1:0.032568	 hit@5:0.1043	 hit@10: 0.1601
epoch 11: train_loss = 1.208152, source_hit@10 = 0.0760, source_ndcg@10 = 0.0391, target_hit@10 = 0.1601, target_ndcg@10 = 0.0868

2024-08-03 21:48:17.679841: step 11364/75760 (epoch 12/80), loss = 1.193900 (684.808 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.055336	 ndcg_5: 0.0467	 ndcg_10: 0.0610	 hit@1:0.018700	 hit@5:0.0742	 hit@10: 0.1191
target: 	 mrr: 0.066142	 ndcg_5: 0.0560	 ndcg_10: 0.0748	 hit@1:0.022830	 hit@5:0.0903	 hit@10: 0.1487
epoch 12: train_loss = 1.193900, source_hit@10 = 0.1191, source_ndcg@10 = 0.0610, target_hit@10 = 0.1487, target_ndcg@10 = 0.0748

2024-08-03 22:01:12.978535: step 12311/75760 (epoch 13/80), loss = 1.190459 (770.128 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065650	 ndcg_5: 0.0562	 ndcg_10: 0.0729	 hit@1:0.023843	 hit@5:0.0882	 hit@10: 0.1399
target: 	 mrr: 0.069222	 ndcg_5: 0.0601	 ndcg_10: 0.0768	 hit@1:0.026318	 hit@5:0.0930	 hit@10: 0.1444
source best!
...............................................................
source: 	 mrr: 0.070605	 ndcg_5: 0.0626	 ndcg_10: 0.0797	 hit@1:0.026732	 hit@5:0.0993	 hit@10: 0.1526
epoch 13: train_loss = 1.190459, source_hit@10 = 0.1526, source_ndcg@10 = 0.0797, target_hit@10 = 0.1444, target_ndcg@10 = 0.0768

2024-08-03 22:12:42.662780: step 13258/75760 (epoch 14/80), loss = 1.189071 (683.410 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062997	 ndcg_5: 0.0557	 ndcg_10: 0.0716	 hit@1:0.024466	 hit@5:0.0866	 hit@10: 0.1359
target: 	 mrr: 0.023060	 ndcg_5: 0.0160	 ndcg_10: 0.0210	 hit@1:0.008093	 hit@5:0.0236	 hit@10: 0.0391
epoch 14: train_loss = 1.189071, source_hit@10 = 0.1359, source_ndcg@10 = 0.0716, target_hit@10 = 0.0391, target_ndcg@10 = 0.0210

2024-08-03 22:24:18.035739: step 14205/75760 (epoch 15/80), loss = 1.184779 (690.183 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.055886	 ndcg_5: 0.0449	 ndcg_10: 0.0617	 hit@1:0.017765	 hit@5:0.0718	 hit@10: 0.1242
target: 	 mrr: 0.079428	 ndcg_5: 0.0713	 ndcg_10: 0.0894	 hit@1:0.032700	 hit@5:0.1102	 hit@10: 0.1666
epoch 15: train_loss = 1.184779, source_hit@10 = 0.1242, source_ndcg@10 = 0.0617, target_hit@10 = 0.1666, target_ndcg@10 = 0.0894

2024-08-03 22:35:53.247194: step 15152/75760 (epoch 16/80), loss = 1.182825 (689.952 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059139	 ndcg_5: 0.0532	 ndcg_10: 0.0658	 hit@1:0.022596	 hit@5:0.0832	 hit@10: 0.1222
target: 	 mrr: 0.064151	 ndcg_5: 0.0559	 ndcg_10: 0.0744	 hit@1:0.021449	 hit@5:0.0914	 hit@10: 0.1487
epoch 16: train_loss = 1.182825, source_hit@10 = 0.1222, source_ndcg@10 = 0.0658, target_hit@10 = 0.1487, target_ndcg@10 = 0.0744

2024-08-03 22:47:22.870495: step 16099/75760 (epoch 17/80), loss = 1.178656 (684.596 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056786	 ndcg_5: 0.0495	 ndcg_10: 0.0643	 hit@1:0.019168	 hit@5:0.0795	 hit@10: 0.1258
target: 	 mrr: 0.050726	 ndcg_5: 0.0425	 ndcg_10: 0.0554	 hit@1:0.018554	 hit@5:0.0671	 hit@10: 0.1071
epoch 17: train_loss = 1.178656, source_hit@10 = 0.1258, source_ndcg@10 = 0.0643, target_hit@10 = 0.1071, target_ndcg@10 = 0.0554

2024-08-03 22:58:54.269130: step 17046/75760 (epoch 18/80), loss = 1.177596 (686.066 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064003	 ndcg_5: 0.0550	 ndcg_10: 0.0721	 hit@1:0.023220	 hit@5:0.0865	 hit@10: 0.1395
target: 	 mrr: 0.077008	 ndcg_5: 0.0685	 ndcg_10: 0.0872	 hit@1:0.030726	 hit@5:0.1055	 hit@10: 0.1639
epoch 18: train_loss = 1.177596, source_hit@10 = 0.1395, source_ndcg@10 = 0.0721, target_hit@10 = 0.1639, target_ndcg@10 = 0.0872

2024-08-03 23:10:23.926939: step 17993/75760 (epoch 19/80), loss = 1.176390 (684.452 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.047747	 ndcg_5: 0.0380	 ndcg_10: 0.0520	 hit@1:0.015584	 hit@5:0.0605	 hit@10: 0.1041
target: 	 mrr: 0.058830	 ndcg_5: 0.0474	 ndcg_10: 0.0650	 hit@1:0.019409	 hit@5:0.0762	 hit@10: 0.1314
epoch 19: train_loss = 1.176390, source_hit@10 = 0.1041, source_ndcg@10 = 0.0520, target_hit@10 = 0.1314, target_ndcg@10 = 0.0650

2024-08-03 23:21:53.271253: step 18940/75760 (epoch 20/80), loss = 1.172763 (683.789 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051528	 ndcg_5: 0.0415	 ndcg_10: 0.0565	 hit@1:0.016363	 hit@5:0.0664	 hit@10: 0.1134
target: 	 mrr: 0.063043	 ndcg_5: 0.0525	 ndcg_10: 0.0679	 hit@1:0.025528	 hit@5:0.0788	 hit@10: 0.1270
epoch 20: train_loss = 1.172763, source_hit@10 = 0.1134, source_ndcg@10 = 0.0565, target_hit@10 = 0.1270, target_ndcg@10 = 0.0679

2024-08-03 23:33:22.140774: step 19887/75760 (epoch 21/80), loss = 1.172644 (683.223 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.020179	 ndcg_5: 0.0112	 ndcg_10: 0.0179	 hit@1:0.004675	 hit@5:0.0182	 hit@10: 0.0390
target: 	 mrr: 0.044412	 ndcg_5: 0.0338	 ndcg_10: 0.0451	 hit@1:0.015659	 hit@5:0.0518	 hit@10: 0.0868
epoch 21: train_loss = 1.172644, source_hit@10 = 0.0390, source_ndcg@10 = 0.0179, target_hit@10 = 0.0868, target_ndcg@10 = 0.0451

2024-08-03 23:44:50.862260: step 20834/75760 (epoch 22/80), loss = 1.169306 (683.549 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054833	 ndcg_5: 0.0447	 ndcg_10: 0.0611	 hit@1:0.016986	 hit@5:0.0739	 hit@10: 0.1251
target: 	 mrr: 0.072954	 ndcg_5: 0.0628	 ndcg_10: 0.0829	 hit@1:0.027897	 hit@5:0.0977	 hit@10: 0.1605
epoch 22: train_loss = 1.169306, source_hit@10 = 0.1251, source_ndcg@10 = 0.0611, target_hit@10 = 0.1605, target_ndcg@10 = 0.0829

2024-08-04 00:04:02.036866: step 21781/75760 (epoch 23/80), loss = 1.169648 (1145.969 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066054	 ndcg_5: 0.0565	 ndcg_10: 0.0730	 hit@1:0.023999	 hit@5:0.0880	 hit@10: 0.1395
target: 	 mrr: 0.062065	 ndcg_5: 0.0532	 ndcg_10: 0.0711	 hit@1:0.021251	 hit@5:0.0862	 hit@10: 0.1415
source best!
...............................................................
source: 	 mrr: 0.069498	 ndcg_5: 0.0604	 ndcg_10: 0.0778	 hit@1:0.026416	 hit@5:0.0949	 hit@10: 0.1485
epoch 23: train_loss = 1.169648, source_hit@10 = 0.1485, source_ndcg@10 = 0.0778, target_hit@10 = 0.1415, target_ndcg@10 = 0.0711

2024-08-04 00:27:08.423046: step 22728/75760 (epoch 24/80), loss = 1.167552 (1363.074 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.040698	 ndcg_5: 0.0303	 ndcg_10: 0.0416	 hit@1:0.012779	 hit@5:0.0483	 hit@10: 0.0835
target: 	 mrr: 0.075446	 ndcg_5: 0.0661	 ndcg_10: 0.0852	 hit@1:0.030660	 hit@5:0.1013	 hit@10: 0.1606
epoch 24: train_loss = 1.167552, source_hit@10 = 0.0835, source_ndcg@10 = 0.0416, target_hit@10 = 0.1606, target_ndcg@10 = 0.0852

2024-08-04 00:50:44.229535: step 23675/75760 (epoch 25/80), loss = 1.165115 (1409.673 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066175	 ndcg_5: 0.0556	 ndcg_10: 0.0741	 hit@1:0.024622	 hit@5:0.0863	 hit@10: 0.1441
target: 	 mrr: 0.074618	 ndcg_5: 0.0653	 ndcg_10: 0.0832	 hit@1:0.030002	 hit@5:0.1005	 hit@10: 0.1561
source best!
...............................................................
source: 	 mrr: 0.069478	 ndcg_5: 0.0595	 ndcg_10: 0.0773	 hit@1:0.027207	 hit@5:0.0917	 hit@10: 0.1476
epoch 25: train_loss = 1.165115, source_hit@10 = 0.1476, source_ndcg@10 = 0.0773, target_hit@10 = 0.1561, target_ndcg@10 = 0.0832

2024-08-04 01:14:12.406740: step 24622/75760 (epoch 26/80), loss = 1.165146 (1381.713 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.033678	 ndcg_5: 0.0245	 ndcg_10: 0.0329	 hit@1:0.010597	 hit@5:0.0377	 hit@10: 0.0642
target: 	 mrr: 0.056483	 ndcg_5: 0.0477	 ndcg_10: 0.0609	 hit@1:0.022765	 hit@5:0.0726	 hit@10: 0.1133
epoch 26: train_loss = 1.165146, source_hit@10 = 0.0642, source_ndcg@10 = 0.0329, target_hit@10 = 0.1133, target_ndcg@10 = 0.0609

2024-08-04 01:37:17.357734: step 25569/75760 (epoch 27/80), loss = 1.159605 (1378.954 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.035355	 ndcg_5: 0.0269	 ndcg_10: 0.0367	 hit@1:0.012779	 hit@5:0.0415	 hit@10: 0.0722
target: 	 mrr: 0.074353	 ndcg_5: 0.0648	 ndcg_10: 0.0849	 hit@1:0.027699	 hit@5:0.1020	 hit@10: 0.1645
epoch 27: train_loss = 1.159605, source_hit@10 = 0.0722, source_ndcg@10 = 0.0367, target_hit@10 = 0.1645, target_ndcg@10 = 0.0849

2024-08-04 02:01:13.702813: step 26516/75760 (epoch 28/80), loss = 1.159515 (1416.358 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.043766	 ndcg_5: 0.0325	 ndcg_10: 0.0474	 hit@1:0.014493	 hit@5:0.0514	 hit@10: 0.0982
target: 	 mrr: 0.082599	 ndcg_5: 0.0730	 ndcg_10: 0.0918	 hit@1:0.035989	 hit@5:0.1099	 hit@10: 0.1683
target best!
......................................................................................................................................................target: 	 mrr: 0.085385	 ndcg_5: 0.0760	 ndcg_10: 0.0944	 hit@1:0.038464	 hit@5:0.1125	 hit@10: 0.1701
epoch 28: train_loss = 1.159515, source_hit@10 = 0.0982, source_ndcg@10 = 0.0474, target_hit@10 = 0.1701, target_ndcg@10 = 0.0944

2024-08-04 02:25:07.786720: step 27463/75760 (epoch 29/80), loss = 1.160572 (1406.150 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073908	 ndcg_5: 0.0657	 ndcg_10: 0.0825	 hit@1:0.029921	 hit@5:0.1010	 hit@10: 0.1533
target: 	 mrr: 0.061373	 ndcg_5: 0.0545	 ndcg_10: 0.0689	 hit@1:0.022501	 hit@5:0.0861	 hit@10: 0.1309
source best!
...............................................................
source: 	 mrr: 0.077213	 ndcg_5: 0.0697	 ndcg_10: 0.0869	 hit@1:0.030845	 hit@5:0.1079	 hit@10: 0.1617
epoch 29: train_loss = 1.160572, source_hit@10 = 0.1617, source_ndcg@10 = 0.0869, target_hit@10 = 0.1309, target_ndcg@10 = 0.0689

2024-08-04 02:48:28.277928: step 28410/75760 (epoch 30/80), loss = 1.159049 (1376.169 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.030284	 ndcg_5: 0.0226	 ndcg_10: 0.0335	 hit@1:0.007792	 hit@5:0.0382	 hit@10: 0.0723
target: 	 mrr: 0.062461	 ndcg_5: 0.0535	 ndcg_10: 0.0717	 hit@1:0.020001	 hit@5:0.0878	 hit@10: 0.1446
epoch 30: train_loss = 1.159049, source_hit@10 = 0.0723, source_ndcg@10 = 0.0335, target_hit@10 = 0.1446, target_ndcg@10 = 0.0717

2024-08-04 03:12:21.719671: step 29357/75760 (epoch 31/80), loss = 1.157860 (1415.887 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.048608	 ndcg_5: 0.0393	 ndcg_10: 0.0530	 hit@1:0.017921	 hit@5:0.0597	 hit@10: 0.1024
target: 	 mrr: 0.086633	 ndcg_5: 0.0779	 ndcg_10: 0.0963	 hit@1:0.039016	 hit@5:0.1157	 hit@10: 0.1730
target best!
......................................................................................................................................................target: 	 mrr: 0.086181	 ndcg_5: 0.0775	 ndcg_10: 0.0967	 hit@1:0.037268	 hit@5:0.1169	 hit@10: 0.1766
epoch 31: train_loss = 1.157860, source_hit@10 = 0.1024, source_ndcg@10 = 0.0530, target_hit@10 = 0.1766, target_ndcg@10 = 0.0967

2024-08-04 03:36:00.880388: step 30304/75760 (epoch 32/80), loss = 1.155656 (1384.722 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.047239	 ndcg_5: 0.0385	 ndcg_10: 0.0537	 hit@1:0.014025	 hit@5:0.0640	 hit@10: 0.1116
target: 	 mrr: 0.072451	 ndcg_5: 0.0639	 ndcg_10: 0.0815	 hit@1:0.027962	 hit@5:0.1002	 hit@10: 0.1551
epoch 32: train_loss = 1.155656, source_hit@10 = 0.1116, source_ndcg@10 = 0.0537, target_hit@10 = 0.1551, target_ndcg@10 = 0.0815

2024-08-04 04:00:22.848406: step 31251/75760 (epoch 33/80), loss = 1.153894 (1444.340 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.035108	 ndcg_5: 0.0260	 ndcg_10: 0.0357	 hit@1:0.012623	 hit@5:0.0397	 hit@10: 0.0704
target: 	 mrr: 0.087461	 ndcg_5: 0.0778	 ndcg_10: 0.0984	 hit@1:0.039410	 hit@5:0.1165	 hit@10: 0.1807
target best!
......................................................................................................................................................target: 	 mrr: 0.088890	 ndcg_5: 0.0797	 ndcg_10: 0.1004	 hit@1:0.038663	 hit@5:0.1196	 hit@10: 0.1840
epoch 33: train_loss = 1.153894, source_hit@10 = 0.0704, source_ndcg@10 = 0.0357, target_hit@10 = 0.1840, target_ndcg@10 = 0.1004

2024-08-04 04:24:32.308375: step 32198/75760 (epoch 34/80), loss = 1.152049 (1416.660 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.055964	 ndcg_5: 0.0458	 ndcg_10: 0.0632	 hit@1:0.019168	 hit@5:0.0729	 hit@10: 0.1267
target: 	 mrr: 0.080488	 ndcg_5: 0.0708	 ndcg_10: 0.0906	 hit@1:0.033818	 hit@5:0.1080	 hit@10: 0.1696
epoch 34: train_loss = 1.152049, source_hit@10 = 0.1267, source_ndcg@10 = 0.0632, target_hit@10 = 0.1696, target_ndcg@10 = 0.0906

2024-08-04 04:48:24.008474: step 33145/75760 (epoch 35/80), loss = 1.151999 (1412.639 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067226	 ndcg_5: 0.0581	 ndcg_10: 0.0739	 hit@1:0.027427	 hit@5:0.0880	 hit@10: 0.1376
target: 	 mrr: 0.085975	 ndcg_5: 0.0762	 ndcg_10: 0.0947	 hit@1:0.039345	 hit@5:0.1117	 hit@10: 0.1690
epoch 35: train_loss = 1.151999, source_hit@10 = 0.1376, source_ndcg@10 = 0.0739, target_hit@10 = 0.1690, target_ndcg@10 = 0.0947

2024-08-04 05:12:52.876146: step 34092/75760 (epoch 36/80), loss = 1.153904 (1451.152 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072191	 ndcg_5: 0.0629	 ndcg_10: 0.0808	 hit@1:0.029453	 hit@5:0.0963	 hit@10: 0.1521
target: 	 mrr: 0.088663	 ndcg_5: 0.0806	 ndcg_10: 0.0992	 hit@1:0.040134	 hit@5:0.1202	 hit@10: 0.1781
target best!
......................................................................................................................................................target: 	 mrr: 0.089407	 ndcg_5: 0.0805	 ndcg_10: 0.1002	 hit@1:0.040058	 hit@5:0.1192	 hit@10: 0.1807
epoch 36: train_loss = 1.153904, source_hit@10 = 0.1521, source_ndcg@10 = 0.0808, target_hit@10 = 0.1807, target_ndcg@10 = 0.1002

2024-08-04 05:37:35.785779: step 35039/75760 (epoch 37/80), loss = 1.151706 (1450.058 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.041543	 ndcg_5: 0.0335	 ndcg_10: 0.0439	 hit@1:0.016207	 hit@5:0.0506	 hit@10: 0.0831
target: 	 mrr: 0.088240	 ndcg_5: 0.0788	 ndcg_10: 0.0984	 hit@1:0.039871	 hit@5:0.1163	 hit@10: 0.1770
epoch 37: train_loss = 1.151706, source_hit@10 = 0.0831, source_ndcg@10 = 0.0439, target_hit@10 = 0.1770, target_ndcg@10 = 0.0984

2024-08-04 06:02:04.733062: step 35986/75760 (epoch 38/80), loss = 1.150784 (1447.814 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053133	 ndcg_5: 0.0453	 ndcg_10: 0.0598	 hit@1:0.017921	 hit@5:0.0739	 hit@10: 0.1191
target: 	 mrr: 0.086534	 ndcg_5: 0.0778	 ndcg_10: 0.0963	 hit@1:0.038555	 hit@5:0.1163	 hit@10: 0.1740
epoch 38: train_loss = 1.150784, source_hit@10 = 0.1191, source_ndcg@10 = 0.0598, target_hit@10 = 0.1740, target_ndcg@10 = 0.0963

2024-08-04 06:26:07.211236: step 36933/75760 (epoch 39/80), loss = 1.147236 (1424.816 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.044714	 ndcg_5: 0.0361	 ndcg_10: 0.0486	 hit@1:0.016986	 hit@5:0.0544	 hit@10: 0.0933
target: 	 mrr: 0.064988	 ndcg_5: 0.0554	 ndcg_10: 0.0716	 hit@1:0.023094	 hit@5:0.0872	 hit@10: 0.1378
epoch 39: train_loss = 1.147236, source_hit@10 = 0.0933, source_ndcg@10 = 0.0486, target_hit@10 = 0.1378, target_ndcg@10 = 0.0716

2024-08-04 06:50:05.570880: step 37880/75760 (epoch 40/80), loss = 1.146050 (1426.330 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.048757	 ndcg_5: 0.0380	 ndcg_10: 0.0536	 hit@1:0.016830	 hit@5:0.0591	 hit@10: 0.1078
target: 	 mrr: 0.085469	 ndcg_5: 0.0770	 ndcg_10: 0.0950	 hit@1:0.038753	 hit@5:0.1147	 hit@10: 0.1705
epoch 40: train_loss = 1.146050, source_hit@10 = 0.1078, source_ndcg@10 = 0.0536, target_hit@10 = 0.1705, target_ndcg@10 = 0.0950
shift to transfer learning mode

2024-08-04 07:13:50.385573: step 38827/75760 (epoch 41/80), loss = 1.146603 (1404.209 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054423	 ndcg_5: 0.0429	 ndcg_10: 0.0594	 hit@1:0.017298	 hit@5:0.0678	 hit@10: 0.1195
target: 	 mrr: 0.082184	 ndcg_5: 0.0734	 ndcg_10: 0.0933	 hit@1:0.033489	 hit@5:0.1130	 hit@10: 0.1753
epoch 41: train_loss = 1.146603, source_hit@10 = 0.1195, source_ndcg@10 = 0.0594, target_hit@10 = 0.1753, target_ndcg@10 = 0.0933

2024-08-04 07:38:26.305013: step 39774/75760 (epoch 42/80), loss = 1.145896 (1455.904 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056426	 ndcg_5: 0.0457	 ndcg_10: 0.0607	 hit@1:0.022129	 hit@5:0.0683	 hit@10: 0.1147
target: 	 mrr: 0.090155	 ndcg_5: 0.0828	 ndcg_10: 0.1017	 hit@1:0.040595	 hit@5:0.1242	 hit@10: 0.1830
target best!
......................................................................................................................................................target: 	 mrr: 0.091221	 ndcg_5: 0.0830	 ndcg_10: 0.1022	 hit@1:0.042782	 hit@5:0.1228	 hit@10: 0.1827
epoch 42: train_loss = 1.145896, source_hit@10 = 0.1147, source_ndcg@10 = 0.0607, target_hit@10 = 0.1827, target_ndcg@10 = 0.1022

2024-08-04 08:03:17.780790: step 40721/75760 (epoch 43/80), loss = 1.144392 (1457.011 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077570	 ndcg_5: 0.0690	 ndcg_10: 0.0863	 hit@1:0.032102	 hit@5:0.1047	 hit@10: 0.1588
target: 	 mrr: 0.085821	 ndcg_5: 0.0778	 ndcg_10: 0.0966	 hit@1:0.036121	 hit@5:0.1180	 hit@10: 0.1761
source best!
...............................................................
source: 	 mrr: 0.081752	 ndcg_5: 0.0724	 ndcg_10: 0.0924	 hit@1:0.034799	 hit@5:0.1091	 hit@10: 0.1715
epoch 43: train_loss = 1.144392, source_hit@10 = 0.1715, source_ndcg@10 = 0.0924, target_hit@10 = 0.1761, target_ndcg@10 = 0.0966

2024-08-04 08:28:19.588767: step 41668/75760 (epoch 44/80), loss = 1.143835 (1476.295 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.042744	 ndcg_5: 0.0325	 ndcg_10: 0.0441	 hit@1:0.014960	 hit@5:0.0503	 hit@10: 0.0866
target: 	 mrr: 0.079138	 ndcg_5: 0.0696	 ndcg_10: 0.0895	 hit@1:0.031186	 hit@5:0.1075	 hit@10: 0.1693
epoch 44: train_loss = 1.143835, source_hit@10 = 0.0866, source_ndcg@10 = 0.0441, target_hit@10 = 0.1693, target_ndcg@10 = 0.0895

2024-08-04 08:52:40.512204: step 42615/75760 (epoch 45/80), loss = 1.142507 (1441.451 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063503	 ndcg_5: 0.0545	 ndcg_10: 0.0717	 hit@1:0.022752	 hit@5:0.0870	 hit@10: 0.1404
target: 	 mrr: 0.083040	 ndcg_5: 0.0736	 ndcg_10: 0.0932	 hit@1:0.036252	 hit@5:0.1107	 hit@10: 0.1718
epoch 45: train_loss = 1.142507, source_hit@10 = 0.1404, source_ndcg@10 = 0.0717, target_hit@10 = 0.1718, target_ndcg@10 = 0.0932

2024-08-04 09:20:05.486558: step 43562/75760 (epoch 46/80), loss = 1.139960 (1625.726 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053110	 ndcg_5: 0.0428	 ndcg_10: 0.0580	 hit@1:0.019168	 hit@5:0.0672	 hit@10: 0.1145
target: 	 mrr: 0.094219	 ndcg_5: 0.0861	 ndcg_10: 0.1054	 hit@1:0.045595	 hit@5:0.1258	 hit@10: 0.1856
target best!
......................................................................................................................................................target: 	 mrr: 0.094150	 ndcg_5: 0.0864	 ndcg_10: 0.1049	 hit@1:0.043513	 hit@5:0.1272	 hit@10: 0.1845
epoch 46: train_loss = 1.139960, source_hit@10 = 0.1145, source_ndcg@10 = 0.0580, target_hit@10 = 0.1845, target_ndcg@10 = 0.1049

2024-08-04 09:45:21.165752: step 44509/75760 (epoch 47/80), loss = 1.139966 (1496.007 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.036412	 ndcg_5: 0.0293	 ndcg_10: 0.0395	 hit@1:0.011532	 hit@5:0.0478	 hit@10: 0.0793
target: 	 mrr: 0.089841	 ndcg_5: 0.0810	 ndcg_10: 0.1016	 hit@1:0.039739	 hit@5:0.1213	 hit@10: 0.1854
epoch 47: train_loss = 1.139966, source_hit@10 = 0.0793, source_ndcg@10 = 0.0395, target_hit@10 = 0.1854, target_ndcg@10 = 0.1016

2024-08-04 10:06:55.999469: step 45456/75760 (epoch 48/80), loss = 1.136694 (1274.183 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063444	 ndcg_5: 0.0543	 ndcg_10: 0.0703	 hit@1:0.023999	 hit@5:0.0849	 hit@10: 0.1350
target: 	 mrr: 0.086288	 ndcg_5: 0.0777	 ndcg_10: 0.0965	 hit@1:0.036384	 hit@5:0.1174	 hit@10: 0.1756
epoch 48: train_loss = 1.136694, source_hit@10 = 0.1350, source_ndcg@10 = 0.0703, target_hit@10 = 0.1756, target_ndcg@10 = 0.0965

2024-08-04 10:18:41.359822: step 46403/75760 (epoch 49/80), loss = 1.134627 (700.026 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.048912	 ndcg_5: 0.0396	 ndcg_10: 0.0533	 hit@1:0.020103	 hit@5:0.0600	 hit@10: 0.1024
target: 	 mrr: 0.074067	 ndcg_5: 0.0642	 ndcg_10: 0.0829	 hit@1:0.029081	 hit@5:0.0993	 hit@10: 0.1576
epoch 49: train_loss = 1.134627, source_hit@10 = 0.1024, source_ndcg@10 = 0.0533, target_hit@10 = 0.1576, target_ndcg@10 = 0.0829

2024-08-04 10:30:22.646949: step 47350/75760 (epoch 50/80), loss = 1.131775 (695.994 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074780	 ndcg_5: 0.0664	 ndcg_10: 0.0840	 hit@1:0.030856	 hit@5:0.1021	 hit@10: 0.1568
target: 	 mrr: 0.076380	 ndcg_5: 0.0676	 ndcg_10: 0.0870	 hit@1:0.028883	 hit@5:0.1064	 hit@10: 0.1664
epoch 50: train_loss = 1.131775, source_hit@10 = 0.1568, source_ndcg@10 = 0.0840, target_hit@10 = 0.1664, target_ndcg@10 = 0.0870

2024-08-04 10:42:02.091534: step 48297/75760 (epoch 51/80), loss = 1.131214 (693.941 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054424	 ndcg_5: 0.0459	 ndcg_10: 0.0603	 hit@1:0.019168	 hit@5:0.0734	 hit@10: 0.1184
target: 	 mrr: 0.086898	 ndcg_5: 0.0794	 ndcg_10: 0.0978	 hit@1:0.037173	 hit@5:0.1211	 hit@10: 0.1783
epoch 51: train_loss = 1.131214, source_hit@10 = 0.1184, source_ndcg@10 = 0.0603, target_hit@10 = 0.1783, target_ndcg@10 = 0.0978
early termination of training
