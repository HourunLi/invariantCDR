nohup: ignoring input
using gpu:3 to train the model
using gpu:3 to train the model
cuda:3
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=3), device_id='3', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1.2, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home/disk2/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-03 16:34:11.350750: step 947/75760 (epoch 1/80), loss = 1.358377 (558.670 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061688	 ndcg_5: 0.0524	 ndcg_10: 0.0696	 hit@1:0.020726	 hit@5:0.0848	 hit@10: 0.1384
target: 	 mrr: 0.066604	 ndcg_5: 0.0569	 ndcg_10: 0.0769	 hit@1:0.023159	 hit@5:0.0904	 hit@10: 0.1527
source best!
...............................................................
source: 	 mrr: 0.062167	 ndcg_5: 0.0529	 ndcg_10: 0.0708	 hit@1:0.019298	 hit@5:0.0878	 hit@10: 0.1436
target best!
......................................................................................................................................................target: 	 mrr: 0.066972	 ndcg_5: 0.0575	 ndcg_10: 0.0774	 hit@1:0.023650	 hit@5:0.0915	 hit@10: 0.1535
epoch 1: train_loss = 1.358377, source_hit@10 = 0.1436, source_ndcg@10 = 0.0708, target_hit@10 = 0.1535, target_ndcg@10 = 0.0774

2024-08-03 16:43:36.454016: step 1894/75760 (epoch 2/80), loss = 1.270703 (557.444 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062485	 ndcg_5: 0.0528	 ndcg_10: 0.0714	 hit@1:0.021350	 hit@5:0.0849	 hit@10: 0.1426
target: 	 mrr: 0.074828	 ndcg_5: 0.0672	 ndcg_10: 0.0859	 hit@1:0.028226	 hit@5:0.1055	 hit@10: 0.1637
source best!
...............................................................
source: 	 mrr: 0.066634	 ndcg_5: 0.0573	 ndcg_10: 0.0744	 hit@1:0.024518	 hit@5:0.0911	 hit@10: 0.1436
target best!
......................................................................................................................................................target: 	 mrr: 0.077110	 ndcg_5: 0.0687	 ndcg_10: 0.0870	 hit@1:0.032153	 hit@5:0.1054	 hit@10: 0.1626
epoch 2: train_loss = 1.270703, source_hit@10 = 0.1436, source_ndcg@10 = 0.0744, target_hit@10 = 0.1626, target_ndcg@10 = 0.0870
new best model saved.

2024-08-03 16:53:02.604136: step 2841/75760 (epoch 3/80), loss = 1.258397 (557.805 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.024211	 ndcg_5: 0.0174	 ndcg_10: 0.0228	 hit@1:0.007792	 hit@5:0.0266	 hit@10: 0.0438
target: 	 mrr: 0.055392	 ndcg_5: 0.0448	 ndcg_10: 0.0633	 hit@1:0.014409	 hit@5:0.0765	 hit@10: 0.1341
epoch 3: train_loss = 1.258397, source_hit@10 = 0.0438, source_ndcg@10 = 0.0228, target_hit@10 = 0.1341, target_ndcg@10 = 0.0633

2024-08-03 17:02:21.685153: step 3788/75760 (epoch 4/80), loss = 1.253885 (555.141 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067649	 ndcg_5: 0.0602	 ndcg_10: 0.0751	 hit@1:0.026180	 hit@5:0.0935	 hit@10: 0.1398
target: 	 mrr: 0.063600	 ndcg_5: 0.0525	 ndcg_10: 0.0722	 hit@1:0.021778	 hit@5:0.0838	 hit@10: 0.1451
source best!
...............................................................
source: 	 mrr: 0.071078	 ndcg_5: 0.0625	 ndcg_10: 0.0788	 hit@1:0.030054	 hit@5:0.0941	 hit@10: 0.1447
epoch 4: train_loss = 1.253885, source_hit@10 = 0.1447, source_ndcg@10 = 0.0788, target_hit@10 = 0.1451, target_ndcg@10 = 0.0722

2024-08-03 17:11:43.548200: step 4735/75760 (epoch 5/80), loss = 1.250483 (556.882 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050763	 ndcg_5: 0.0404	 ndcg_10: 0.0560	 hit@1:0.017298	 hit@5:0.0645	 hit@10: 0.1127
target: 	 mrr: 0.072887	 ndcg_5: 0.0643	 ndcg_10: 0.0822	 hit@1:0.028752	 hit@5:0.0999	 hit@10: 0.1555
epoch 5: train_loss = 1.250483, source_hit@10 = 0.1127, source_ndcg@10 = 0.0560, target_hit@10 = 0.1555, target_ndcg@10 = 0.0822

2024-08-03 17:21:04.225143: step 5682/75760 (epoch 6/80), loss = 1.246188 (556.932 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.036803	 ndcg_5: 0.0276	 ndcg_10: 0.0381	 hit@1:0.011064	 hit@5:0.0446	 hit@10: 0.0775
target: 	 mrr: 0.060253	 ndcg_5: 0.0489	 ndcg_10: 0.0684	 hit@1:0.018356	 hit@5:0.0804	 hit@10: 0.1410
epoch 6: train_loss = 1.246188, source_hit@10 = 0.0775, source_ndcg@10 = 0.0381, target_hit@10 = 0.1410, target_ndcg@10 = 0.0684

2024-08-03 17:30:26.129436: step 6629/75760 (epoch 7/80), loss = 1.244794 (558.001 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050688	 ndcg_5: 0.0411	 ndcg_10: 0.0550	 hit@1:0.017921	 hit@5:0.0640	 hit@10: 0.1072
target: 	 mrr: 0.061060	 ndcg_5: 0.0494	 ndcg_10: 0.0676	 hit@1:0.021449	 hit@5:0.0778	 hit@10: 0.1349
epoch 7: train_loss = 1.244794, source_hit@10 = 0.1072, source_ndcg@10 = 0.0550, target_hit@10 = 0.1349, target_ndcg@10 = 0.0676

2024-08-03 17:39:47.106144: step 7576/75760 (epoch 8/80), loss = 1.240411 (557.096 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.045321	 ndcg_5: 0.0330	 ndcg_10: 0.0489	 hit@1:0.011532	 hit@5:0.0552	 hit@10: 0.1047
target: 	 mrr: 0.052844	 ndcg_5: 0.0455	 ndcg_10: 0.0611	 hit@1:0.017567	 hit@5:0.0740	 hit@10: 0.1227
epoch 8: train_loss = 1.240411, source_hit@10 = 0.1047, source_ndcg@10 = 0.0489, target_hit@10 = 0.1227, target_ndcg@10 = 0.0611

2024-08-03 17:49:08.629028: step 8523/75760 (epoch 9/80), loss = 1.235692 (557.683 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054569	 ndcg_5: 0.0454	 ndcg_10: 0.0608	 hit@1:0.018544	 hit@5:0.0739	 hit@10: 0.1219
target: 	 mrr: 0.044798	 ndcg_5: 0.0326	 ndcg_10: 0.0468	 hit@1:0.014343	 hit@5:0.0508	 hit@10: 0.0958
epoch 9: train_loss = 1.235692, source_hit@10 = 0.1219, source_ndcg@10 = 0.0608, target_hit@10 = 0.0958, target_ndcg@10 = 0.0468

2024-08-03 17:58:29.927434: step 9470/75760 (epoch 10/80), loss = 1.231420 (557.271 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.043791	 ndcg_5: 0.0321	 ndcg_10: 0.0462	 hit@1:0.013090	 hit@5:0.0513	 hit@10: 0.0954
target: 	 mrr: 0.074600	 ndcg_5: 0.0665	 ndcg_10: 0.0839	 hit@1:0.027633	 hit@5:0.1056	 hit@10: 0.1594
epoch 10: train_loss = 1.231420, source_hit@10 = 0.0954, source_ndcg@10 = 0.0462, target_hit@10 = 0.1594, target_ndcg@10 = 0.0839

2024-08-03 18:07:52.094931: step 10417/75760 (epoch 11/80), loss = 1.224951 (558.138 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070873	 ndcg_5: 0.0648	 ndcg_10: 0.0782	 hit@1:0.026648	 hit@5:0.1021	 hit@10: 0.1440
target: 	 mrr: 0.032971	 ndcg_5: 0.0258	 ndcg_10: 0.0348	 hit@1:0.010001	 hit@5:0.0413	 hit@10: 0.0693
source best!
...............................................................
source: 	 mrr: 0.075399	 ndcg_5: 0.0688	 ndcg_10: 0.0852	 hit@1:0.028156	 hit@5:0.1082	 hit@10: 0.1598
epoch 11: train_loss = 1.224951, source_hit@10 = 0.1598, source_ndcg@10 = 0.0852, target_hit@10 = 0.0693, target_ndcg@10 = 0.0348

2024-08-03 18:17:14.652485: step 11364/75760 (epoch 12/80), loss = 1.213544 (557.617 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.038835	 ndcg_5: 0.0283	 ndcg_10: 0.0427	 hit@1:0.010285	 hit@5:0.0464	 hit@10: 0.0919
target: 	 mrr: 0.084130	 ndcg_5: 0.0755	 ndcg_10: 0.0947	 hit@1:0.035463	 hit@5:0.1140	 hit@10: 0.1737
target best!
......................................................................................................................................................target: 	 mrr: 0.085817	 ndcg_5: 0.0773	 ndcg_10: 0.0953	 hit@1:0.037268	 hit@5:0.1152	 hit@10: 0.1712
epoch 12: train_loss = 1.213544, source_hit@10 = 0.0919, source_ndcg@10 = 0.0427, target_hit@10 = 0.1712, target_ndcg@10 = 0.0953

2024-08-03 18:26:37.931265: step 12311/75760 (epoch 13/80), loss = 1.209571 (556.647 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063407	 ndcg_5: 0.0548	 ndcg_10: 0.0722	 hit@1:0.020259	 hit@5:0.0893	 hit@10: 0.1431
target: 	 mrr: 0.062814	 ndcg_5: 0.0535	 ndcg_10: 0.0701	 hit@1:0.021449	 hit@5:0.0859	 hit@10: 0.1376
epoch 13: train_loss = 1.209571, source_hit@10 = 0.1431, source_ndcg@10 = 0.0722, target_hit@10 = 0.1376, target_ndcg@10 = 0.0701

2024-08-03 18:35:59.505978: step 13258/75760 (epoch 14/80), loss = 1.205629 (557.580 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066257	 ndcg_5: 0.0580	 ndcg_10: 0.0733	 hit@1:0.028206	 hit@5:0.0876	 hit@10: 0.1354
target: 	 mrr: 0.058814	 ndcg_5: 0.0526	 ndcg_10: 0.0668	 hit@1:0.021646	 hit@5:0.0832	 hit@10: 0.1270
epoch 14: train_loss = 1.205629, source_hit@10 = 0.1354, source_ndcg@10 = 0.0733, target_hit@10 = 0.1270, target_ndcg@10 = 0.0668

2024-08-03 18:45:19.086772: step 14205/75760 (epoch 15/80), loss = 1.199516 (555.786 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065594	 ndcg_5: 0.0576	 ndcg_10: 0.0716	 hit@1:0.028518	 hit@5:0.0873	 hit@10: 0.1309
target: 	 mrr: 0.069262	 ndcg_5: 0.0593	 ndcg_10: 0.0777	 hit@1:0.024607	 hit@5:0.0940	 hit@10: 0.1513
epoch 15: train_loss = 1.199516, source_hit@10 = 0.1309, source_ndcg@10 = 0.0716, target_hit@10 = 0.1513, target_ndcg@10 = 0.0777

2024-08-03 18:54:39.730154: step 15152/75760 (epoch 16/80), loss = 1.195737 (556.770 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059249	 ndcg_5: 0.0504	 ndcg_10: 0.0659	 hit@1:0.019947	 hit@5:0.0792	 hit@10: 0.1275
target: 	 mrr: 0.057535	 ndcg_5: 0.0455	 ndcg_10: 0.0619	 hit@1:0.019212	 hit@5:0.0722	 hit@10: 0.1234
epoch 16: train_loss = 1.195737, source_hit@10 = 0.1275, source_ndcg@10 = 0.0659, target_hit@10 = 0.1234, target_ndcg@10 = 0.0619

2024-08-03 19:04:00.433034: step 16099/75760 (epoch 17/80), loss = 1.189173 (556.875 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060207	 ndcg_5: 0.0518	 ndcg_10: 0.0669	 hit@1:0.023375	 hit@5:0.0804	 hit@10: 0.1278
target: 	 mrr: 0.053389	 ndcg_5: 0.0409	 ndcg_10: 0.0563	 hit@1:0.017962	 hit@5:0.0644	 hit@10: 0.1124
epoch 17: train_loss = 1.189173, source_hit@10 = 0.1278, source_ndcg@10 = 0.0669, target_hit@10 = 0.1124, target_ndcg@10 = 0.0563

2024-08-03 19:13:21.208427: step 17046/75760 (epoch 18/80), loss = 1.182959 (556.871 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052873	 ndcg_5: 0.0443	 ndcg_10: 0.0608	 hit@1:0.017609	 hit@5:0.0714	 hit@10: 0.1223
target: 	 mrr: 0.072250	 ndcg_5: 0.0623	 ndcg_10: 0.0812	 hit@1:0.027699	 hit@5:0.0972	 hit@10: 0.1558
epoch 18: train_loss = 1.182959, source_hit@10 = 0.1223, source_ndcg@10 = 0.0608, target_hit@10 = 0.1558, target_ndcg@10 = 0.0812

2024-08-03 19:22:42.772308: step 17993/75760 (epoch 19/80), loss = 1.179848 (557.662 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060476	 ndcg_5: 0.0517	 ndcg_10: 0.0668	 hit@1:0.023375	 hit@5:0.0798	 hit@10: 0.1269
target: 	 mrr: 0.057922	 ndcg_5: 0.0487	 ndcg_10: 0.0648	 hit@1:0.021120	 hit@5:0.0765	 hit@10: 0.1269
epoch 19: train_loss = 1.179848, source_hit@10 = 0.1269, source_ndcg@10 = 0.0668, target_hit@10 = 0.1269, target_ndcg@10 = 0.0648

2024-08-03 19:32:03.770551: step 18940/75760 (epoch 20/80), loss = 1.175913 (556.860 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051409	 ndcg_5: 0.0428	 ndcg_10: 0.0594	 hit@1:0.016363	 hit@5:0.0712	 hit@10: 0.1230
target: 	 mrr: 0.077575	 ndcg_5: 0.0697	 ndcg_10: 0.0854	 hit@1:0.032502	 hit@5:0.1063	 hit@10: 0.1551
epoch 20: train_loss = 1.175913, source_hit@10 = 0.1230, source_ndcg@10 = 0.0594, target_hit@10 = 0.1551, target_ndcg@10 = 0.0854

2024-08-03 19:41:24.394998: step 19887/75760 (epoch 21/80), loss = 1.171232 (556.774 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.044661	 ndcg_5: 0.0358	 ndcg_10: 0.0461	 hit@1:0.017921	 hit@5:0.0527	 hit@10: 0.0849
target: 	 mrr: 0.020709	 ndcg_5: 0.0117	 ndcg_10: 0.0154	 hit@1:0.005790	 hit@5:0.0178	 hit@10: 0.0295
epoch 21: train_loss = 1.171232, source_hit@10 = 0.0849, source_ndcg@10 = 0.0461, target_hit@10 = 0.0295, target_ndcg@10 = 0.0154

2024-08-03 19:50:45.463584: step 20834/75760 (epoch 22/80), loss = 1.167342 (557.386 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065700	 ndcg_5: 0.0567	 ndcg_10: 0.0728	 hit@1:0.026960	 hit@5:0.0863	 hit@10: 0.1368
target: 	 mrr: 0.051385	 ndcg_5: 0.0440	 ndcg_10: 0.0604	 hit@1:0.012896	 hit@5:0.0767	 hit@10: 0.1273
epoch 22: train_loss = 1.167342, source_hit@10 = 0.1368, source_ndcg@10 = 0.0728, target_hit@10 = 0.1273, target_ndcg@10 = 0.0604

2024-08-03 20:00:06.629770: step 21781/75760 (epoch 23/80), loss = 1.166003 (557.332 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.058813	 ndcg_5: 0.0528	 ndcg_10: 0.0672	 hit@1:0.020103	 hit@5:0.0859	 hit@10: 0.1304
target: 	 mrr: 0.048717	 ndcg_5: 0.0389	 ndcg_10: 0.0532	 hit@1:0.014146	 hit@5:0.0646	 hit@10: 0.1095
epoch 23: train_loss = 1.166003, source_hit@10 = 0.1304, source_ndcg@10 = 0.0672, target_hit@10 = 0.1095, target_ndcg@10 = 0.0532

2024-08-03 20:09:28.863988: step 22728/75760 (epoch 24/80), loss = 1.162857 (558.100 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063343	 ndcg_5: 0.0564	 ndcg_10: 0.0707	 hit@1:0.025557	 hit@5:0.0874	 hit@10: 0.1320
target: 	 mrr: 0.075992	 ndcg_5: 0.0678	 ndcg_10: 0.0897	 hit@1:0.026910	 hit@5:0.1084	 hit@10: 0.1762
epoch 24: train_loss = 1.162857, source_hit@10 = 0.1320, source_ndcg@10 = 0.0707, target_hit@10 = 0.1762, target_ndcg@10 = 0.0897

2024-08-03 20:18:50.294766: step 23675/75760 (epoch 25/80), loss = 1.160312 (557.439 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060515	 ndcg_5: 0.0512	 ndcg_10: 0.0685	 hit@1:0.018856	 hit@5:0.0824	 hit@10: 0.1364
target: 	 mrr: 0.045112	 ndcg_5: 0.0381	 ndcg_10: 0.0506	 hit@1:0.015067	 hit@5:0.0614	 hit@10: 0.1003
epoch 25: train_loss = 1.160312, source_hit@10 = 0.1364, source_ndcg@10 = 0.0685, target_hit@10 = 0.1003, target_ndcg@10 = 0.0506

2024-08-03 20:28:11.066706: step 24622/75760 (epoch 26/80), loss = 1.160050 (556.935 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069150	 ndcg_5: 0.0619	 ndcg_10: 0.0763	 hit@1:0.027271	 hit@5:0.0957	 hit@10: 0.1403
target: 	 mrr: 0.060812	 ndcg_5: 0.0508	 ndcg_10: 0.0666	 hit@1:0.022896	 hit@5:0.0783	 hit@10: 0.1275
epoch 26: train_loss = 1.160050, source_hit@10 = 0.1403, source_ndcg@10 = 0.0763, target_hit@10 = 0.1275, target_ndcg@10 = 0.0666

2024-08-03 20:37:31.342486: step 25569/75760 (epoch 27/80), loss = 1.155816 (556.491 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.045001	 ndcg_5: 0.0350	 ndcg_10: 0.0493	 hit@1:0.014337	 hit@5:0.0559	 hit@10: 0.1010
target: 	 mrr: 0.068568	 ndcg_5: 0.0583	 ndcg_10: 0.0765	 hit@1:0.024870	 hit@5:0.0916	 hit@10: 0.1484
epoch 27: train_loss = 1.155816, source_hit@10 = 0.1010, source_ndcg@10 = 0.0493, target_hit@10 = 0.1484, target_ndcg@10 = 0.0765

2024-08-03 20:46:53.218517: step 26516/75760 (epoch 28/80), loss = 1.153468 (557.779 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.045163	 ndcg_5: 0.0348	 ndcg_10: 0.0497	 hit@1:0.015116	 hit@5:0.0559	 hit@10: 0.1021
target: 	 mrr: 0.050484	 ndcg_5: 0.0385	 ndcg_10: 0.0528	 hit@1:0.017238	 hit@5:0.0602	 hit@10: 0.1049
epoch 28: train_loss = 1.153468, source_hit@10 = 0.1021, source_ndcg@10 = 0.0497, target_hit@10 = 0.1049, target_ndcg@10 = 0.0528

2024-08-03 20:56:14.514704: step 27463/75760 (epoch 29/80), loss = 1.151976 (557.447 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068687	 ndcg_5: 0.0607	 ndcg_10: 0.0763	 hit@1:0.027895	 hit@5:0.0932	 hit@10: 0.1415
target: 	 mrr: 0.059477	 ndcg_5: 0.0479	 ndcg_10: 0.0642	 hit@1:0.023291	 hit@5:0.0727	 hit@10: 0.1237
epoch 29: train_loss = 1.151976, source_hit@10 = 0.1415, source_ndcg@10 = 0.0763, target_hit@10 = 0.1237, target_ndcg@10 = 0.0642

2024-08-03 21:05:37.667764: step 28410/75760 (epoch 30/80), loss = 1.151234 (559.111 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067550	 ndcg_5: 0.0599	 ndcg_10: 0.0745	 hit@1:0.026336	 hit@5:0.0935	 hit@10: 0.1390
target: 	 mrr: 0.074681	 ndcg_5: 0.0680	 ndcg_10: 0.0850	 hit@1:0.030199	 hit@5:0.1055	 hit@10: 0.1584
epoch 30: train_loss = 1.151234, source_hit@10 = 0.1390, source_ndcg@10 = 0.0745, target_hit@10 = 0.1584, target_ndcg@10 = 0.0850

2024-08-03 21:14:59.630460: step 29357/75760 (epoch 31/80), loss = 1.149057 (558.117 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054999	 ndcg_5: 0.0451	 ndcg_10: 0.0611	 hit@1:0.018077	 hit@5:0.0729	 hit@10: 0.1233
target: 	 mrr: 0.076318	 ndcg_5: 0.0697	 ndcg_10: 0.0859	 hit@1:0.031778	 hit@5:0.1075	 hit@10: 0.1576
epoch 31: train_loss = 1.149057, source_hit@10 = 0.1233, source_ndcg@10 = 0.0611, target_hit@10 = 0.1576, target_ndcg@10 = 0.0859

2024-08-03 21:24:21.394127: step 30304/75760 (epoch 32/80), loss = 1.146127 (557.843 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061034	 ndcg_5: 0.0527	 ndcg_10: 0.0690	 hit@1:0.021350	 hit@5:0.0831	 hit@10: 0.1336
target: 	 mrr: 0.061253	 ndcg_5: 0.0527	 ndcg_10: 0.0694	 hit@1:0.020857	 hit@5:0.0859	 hit@10: 0.1377
epoch 32: train_loss = 1.146127, source_hit@10 = 0.1336, source_ndcg@10 = 0.0690, target_hit@10 = 0.1377, target_ndcg@10 = 0.0694

2024-08-03 21:33:43.228293: step 31251/75760 (epoch 33/80), loss = 1.143662 (557.765 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060661	 ndcg_5: 0.0524	 ndcg_10: 0.0687	 hit@1:0.023999	 hit@5:0.0806	 hit@10: 0.1314
target: 	 mrr: 0.087326	 ndcg_5: 0.0797	 ndcg_10: 0.0987	 hit@1:0.037173	 hit@5:0.1215	 hit@10: 0.1803
target best!
......................................................................................................................................................target: 	 mrr: 0.089310	 ndcg_5: 0.0813	 ndcg_10: 0.0998	 hit@1:0.040191	 hit@5:0.1217	 hit@10: 0.1792
epoch 33: train_loss = 1.143662, source_hit@10 = 0.1314, source_ndcg@10 = 0.0687, target_hit@10 = 0.1792, target_ndcg@10 = 0.0998

2024-08-03 21:43:06.984431: step 32198/75760 (epoch 34/80), loss = 1.141561 (557.078 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057506	 ndcg_5: 0.0497	 ndcg_10: 0.0649	 hit@1:0.019168	 hit@5:0.0801	 hit@10: 0.1276
target: 	 mrr: 0.080949	 ndcg_5: 0.0737	 ndcg_10: 0.0917	 hit@1:0.032897	 hit@5:0.1142	 hit@10: 0.1698
epoch 34: train_loss = 1.141561, source_hit@10 = 0.1276, source_ndcg@10 = 0.0649, target_hit@10 = 0.1698, target_ndcg@10 = 0.0917

2024-08-03 21:52:27.516114: step 33145/75760 (epoch 35/80), loss = 1.135599 (556.383 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056871	 ndcg_5: 0.0470	 ndcg_10: 0.0635	 hit@1:0.018077	 hit@5:0.0748	 hit@10: 0.1264
target: 	 mrr: 0.086304	 ndcg_5: 0.0790	 ndcg_10: 0.0974	 hit@1:0.037239	 hit@5:0.1196	 hit@10: 0.1769
epoch 35: train_loss = 1.135599, source_hit@10 = 0.1264, source_ndcg@10 = 0.0635, target_hit@10 = 0.1769, target_ndcg@10 = 0.0974

2024-08-03 22:01:47.390533: step 34092/75760 (epoch 36/80), loss = 1.135680 (556.077 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061870	 ndcg_5: 0.0539	 ndcg_10: 0.0702	 hit@1:0.020882	 hit@5:0.0871	 hit@10: 0.1381
target: 	 mrr: 0.075641	 ndcg_5: 0.0677	 ndcg_10: 0.0834	 hit@1:0.030923	 hit@5:0.1036	 hit@10: 0.1520
epoch 36: train_loss = 1.135680, source_hit@10 = 0.1381, source_ndcg@10 = 0.0702, target_hit@10 = 0.1520, target_ndcg@10 = 0.0834

2024-08-03 22:11:07.886789: step 35039/75760 (epoch 37/80), loss = 1.130438 (556.658 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062156	 ndcg_5: 0.0538	 ndcg_10: 0.0706	 hit@1:0.021194	 hit@5:0.0863	 hit@10: 0.1387
target: 	 mrr: 0.086175	 ndcg_5: 0.0776	 ndcg_10: 0.0971	 hit@1:0.037108	 hit@5:0.1173	 hit@10: 0.1780
epoch 37: train_loss = 1.130438, source_hit@10 = 0.1387, source_ndcg@10 = 0.0706, target_hit@10 = 0.1780, target_ndcg@10 = 0.0971

2024-08-03 22:20:29.636634: step 35986/75760 (epoch 38/80), loss = 1.129439 (557.902 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064774	 ndcg_5: 0.0570	 ndcg_10: 0.0726	 hit@1:0.025713	 hit@5:0.0874	 hit@10: 0.1356
target: 	 mrr: 0.082278	 ndcg_5: 0.0739	 ndcg_10: 0.0943	 hit@1:0.032305	 hit@5:0.1148	 hit@10: 0.1786
epoch 38: train_loss = 1.129439, source_hit@10 = 0.1356, source_ndcg@10 = 0.0726, target_hit@10 = 0.1786, target_ndcg@10 = 0.0943

2024-08-03 22:29:51.130941: step 36933/75760 (epoch 39/80), loss = 1.123245 (557.456 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.080343	 ndcg_5: 0.0720	 ndcg_10: 0.0898	 hit@1:0.034907	 hit@5:0.1078	 hit@10: 0.1628
target: 	 mrr: 0.072880	 ndcg_5: 0.0644	 ndcg_10: 0.0824	 hit@1:0.030594	 hit@5:0.0985	 hit@10: 0.1545
source best!
...............................................................
source: 	 mrr: 0.084668	 ndcg_5: 0.0765	 ndcg_10: 0.0942	 hit@1:0.039070	 hit@5:0.1133	 hit@10: 0.1680
epoch 39: train_loss = 1.123245, source_hit@10 = 0.1680, source_ndcg@10 = 0.0942, target_hit@10 = 0.1545, target_ndcg@10 = 0.0824

2024-08-03 22:39:13.220938: step 37880/75760 (epoch 40/80), loss = 1.120630 (556.928 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076411	 ndcg_5: 0.0679	 ndcg_10: 0.0856	 hit@1:0.031635	 hit@5:0.1033	 hit@10: 0.1583
target: 	 mrr: 0.088836	 ndcg_5: 0.0805	 ndcg_10: 0.0977	 hit@1:0.041187	 hit@5:0.1186	 hit@10: 0.1723
target best!
......................................................................................................................................................target: 	 mrr: 0.089037	 ndcg_5: 0.0809	 ndcg_10: 0.0985	 hit@1:0.040258	 hit@5:0.1202	 hit@10: 0.1748
epoch 40: train_loss = 1.120630, source_hit@10 = 0.1583, source_ndcg@10 = 0.0856, target_hit@10 = 0.1748, target_ndcg@10 = 0.0985
shift to transfer learning mode

2024-08-03 22:48:40.344200: step 38827/75760 (epoch 41/80), loss = 1.119030 (560.627 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056448	 ndcg_5: 0.0474	 ndcg_10: 0.0635	 hit@1:0.021194	 hit@5:0.0751	 hit@10: 0.1253
target: 	 mrr: 0.083445	 ndcg_5: 0.0752	 ndcg_10: 0.0931	 hit@1:0.037897	 hit@5:0.1115	 hit@10: 0.1673
epoch 41: train_loss = 1.119030, source_hit@10 = 0.1253, source_ndcg@10 = 0.0635, target_hit@10 = 0.1673, target_ndcg@10 = 0.0931

2024-08-03 22:58:05.214348: step 39774/75760 (epoch 42/80), loss = 1.115231 (560.918 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.080148	 ndcg_5: 0.0708	 ndcg_10: 0.0906	 hit@1:0.034440	 hit@5:0.1063	 hit@10: 0.1678
target: 	 mrr: 0.073013	 ndcg_5: 0.0653	 ndcg_10: 0.0792	 hit@1:0.035463	 hit@5:0.0940	 hit@10: 0.1373
epoch 42: train_loss = 1.115231, source_hit@10 = 0.1678, source_ndcg@10 = 0.0906, target_hit@10 = 0.1373, target_ndcg@10 = 0.0792

2024-08-03 23:07:29.727232: step 40721/75760 (epoch 43/80), loss = 1.112572 (560.601 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066399	 ndcg_5: 0.0577	 ndcg_10: 0.0733	 hit@1:0.027739	 hit@5:0.0882	 hit@10: 0.1365
target: 	 mrr: 0.091641	 ndcg_5: 0.0842	 ndcg_10: 0.1029	 hit@1:0.041845	 hit@5:0.1263	 hit@10: 0.1843
target best!
......................................................................................................................................................target: 	 mrr: 0.092787	 ndcg_5: 0.0851	 ndcg_10: 0.1046	 hit@1:0.042251	 hit@5:0.1270	 hit@10: 0.1875
epoch 43: train_loss = 1.112572, source_hit@10 = 0.1365, source_ndcg@10 = 0.0733, target_hit@10 = 0.1875, target_ndcg@10 = 0.1046

2024-08-03 23:16:57.458679: step 41668/75760 (epoch 44/80), loss = 1.111056 (560.926 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062915	 ndcg_5: 0.0552	 ndcg_10: 0.0696	 hit@1:0.023843	 hit@5:0.0866	 hit@10: 0.1311
target: 	 mrr: 0.088318	 ndcg_5: 0.0796	 ndcg_10: 0.0979	 hit@1:0.041450	 hit@5:0.1167	 hit@10: 0.1736
epoch 44: train_loss = 1.111056, source_hit@10 = 0.1311, source_ndcg@10 = 0.0696, target_hit@10 = 0.1736, target_ndcg@10 = 0.0979

2024-08-03 23:26:20.224955: step 42615/75760 (epoch 45/80), loss = 1.107033 (558.971 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078025	 ndcg_5: 0.0698	 ndcg_10: 0.0882	 hit@1:0.031791	 hit@5:0.1066	 hit@10: 0.1636
target: 	 mrr: 0.084117	 ndcg_5: 0.0759	 ndcg_10: 0.0950	 hit@1:0.035594	 hit@5:0.1154	 hit@10: 0.1746
epoch 45: train_loss = 1.107033, source_hit@10 = 0.1636, source_ndcg@10 = 0.0882, target_hit@10 = 0.1746, target_ndcg@10 = 0.0950

2024-08-03 23:35:42.415376: step 43562/75760 (epoch 46/80), loss = 1.104522 (558.301 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064998	 ndcg_5: 0.0579	 ndcg_10: 0.0736	 hit@1:0.025713	 hit@5:0.0910	 hit@10: 0.1396
target: 	 mrr: 0.088873	 ndcg_5: 0.0817	 ndcg_10: 0.0989	 hit@1:0.041319	 hit@5:0.1205	 hit@10: 0.1742
epoch 46: train_loss = 1.104522, source_hit@10 = 0.1396, source_ndcg@10 = 0.0736, target_hit@10 = 0.1742, target_ndcg@10 = 0.0989

2024-08-03 23:45:06.038307: step 44509/75760 (epoch 47/80), loss = 1.101616 (559.728 sec/epoch), lr: 0.001589
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069214	 ndcg_5: 0.0618	 ndcg_10: 0.0787	 hit@1:0.026648	 hit@5:0.0955	 hit@10: 0.1477
target: 	 mrr: 0.061233	 ndcg_5: 0.0503	 ndcg_10: 0.0662	 hit@1:0.023423	 hit@5:0.0778	 hit@10: 0.1275
epoch 47: train_loss = 1.101616, source_hit@10 = 0.1477, source_ndcg@10 = 0.0787, target_hit@10 = 0.1275, target_ndcg@10 = 0.0662

2024-08-03 23:54:29.860228: step 45456/75760 (epoch 48/80), loss = 1.098558 (560.009 sec/epoch), lr: 0.001509
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053424	 ndcg_5: 0.0448	 ndcg_10: 0.0598	 hit@1:0.019324	 hit@5:0.0704	 hit@10: 0.1169
target: 	 mrr: 0.086894	 ndcg_5: 0.0779	 ndcg_10: 0.0973	 hit@1:0.039279	 hit@5:0.1155	 hit@10: 0.1759
epoch 48: train_loss = 1.098558, source_hit@10 = 0.1169, source_ndcg@10 = 0.0598, target_hit@10 = 0.1759, target_ndcg@10 = 0.0973

2024-08-04 00:03:54.350257: step 46403/75760 (epoch 49/80), loss = 1.094412 (560.493 sec/epoch), lr: 0.001509
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066034	 ndcg_5: 0.0574	 ndcg_10: 0.0725	 hit@1:0.028830	 hit@5:0.0857	 hit@10: 0.1329
target: 	 mrr: 0.087750	 ndcg_5: 0.0802	 ndcg_10: 0.0979	 hit@1:0.041187	 hit@5:0.1187	 hit@10: 0.1736
epoch 49: train_loss = 1.094412, source_hit@10 = 0.1329, source_ndcg@10 = 0.0725, target_hit@10 = 0.1736, target_ndcg@10 = 0.0979

2024-08-04 00:13:18.254361: step 47350/75760 (epoch 50/80), loss = 1.093920 (560.071 sec/epoch), lr: 0.001509
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062642	 ndcg_5: 0.0527	 ndcg_10: 0.0705	 hit@1:0.023843	 hit@5:0.0818	 hit@10: 0.1371
target: 	 mrr: 0.088854	 ndcg_5: 0.0808	 ndcg_10: 0.0987	 hit@1:0.042371	 hit@5:0.1181	 hit@10: 0.1737
epoch 50: train_loss = 1.093920, source_hit@10 = 0.1371, source_ndcg@10 = 0.0705, target_hit@10 = 0.1737, target_ndcg@10 = 0.0987

2024-08-04 00:22:42.842348: step 48297/75760 (epoch 51/80), loss = 1.091077 (560.407 sec/epoch), lr: 0.001434
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.058742	 ndcg_5: 0.0514	 ndcg_10: 0.0667	 hit@1:0.021661	 hit@5:0.0821	 hit@10: 0.1304
target: 	 mrr: 0.089355	 ndcg_5: 0.0821	 ndcg_10: 0.1006	 hit@1:0.039739	 hit@5:0.1226	 hit@10: 0.1802
epoch 51: train_loss = 1.091077, source_hit@10 = 0.1304, source_ndcg@10 = 0.0667, target_hit@10 = 0.1802, target_ndcg@10 = 0.1006
early termination of training
