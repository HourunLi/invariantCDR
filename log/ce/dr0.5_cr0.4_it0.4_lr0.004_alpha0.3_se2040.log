nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.3, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=0), device_id='0', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=2040, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-05 11:10:10.120882: step 947/75760 (epoch 1/80), loss = 1.361188 (241.797 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052676	 ndcg_5: 0.0443	 ndcg_10: 0.0607	 hit@1:0.015739	 hit@5:0.0725	 hit@10: 0.1237
target: 	 mrr: 0.073459	 ndcg_5: 0.0655	 ndcg_10: 0.0826	 hit@1:0.029739	 hit@5:0.1004	 hit@10: 0.1533
source best!
...............................................................
source: 	 mrr: 0.054388	 ndcg_5: 0.0477	 ndcg_10: 0.0623	 hit@1:0.017083	 hit@5:0.0788	 hit@10: 0.1245
target best!
......................................................................................................................................................target: 	 mrr: 0.071831	 ndcg_5: 0.0652	 ndcg_10: 0.0812	 hit@1:0.027569	 hit@5:0.1032	 hit@10: 0.1532
epoch 1: train_loss = 1.361188, source_hit@10 = 0.1245, source_ndcg@10 = 0.0623, target_hit@10 = 0.1532, target_ndcg@10 = 0.0812

2024-08-05 11:14:16.817053: step 1894/75760 (epoch 2/80), loss = 1.259089 (242.812 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066120	 ndcg_5: 0.0571	 ndcg_10: 0.0756	 hit@1:0.024622	 hit@5:0.0905	 hit@10: 0.1476
target: 	 mrr: 0.071721	 ndcg_5: 0.0624	 ndcg_10: 0.0785	 hit@1:0.031647	 hit@5:0.0936	 hit@10: 0.1437
source best!
...............................................................
source: 	 mrr: 0.065895	 ndcg_5: 0.0566	 ndcg_10: 0.0745	 hit@1:0.024043	 hit@5:0.0903	 hit@10: 0.1457
epoch 2: train_loss = 1.259089, source_hit@10 = 0.1457, source_ndcg@10 = 0.0745, target_hit@10 = 0.1437, target_ndcg@10 = 0.0785
new best model saved.

2024-08-05 11:18:21.834219: step 2841/75760 (epoch 3/80), loss = 1.244639 (242.191 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.037929	 ndcg_5: 0.0278	 ndcg_10: 0.0410	 hit@1:0.009194	 hit@5:0.0464	 hit@10: 0.0877
target: 	 mrr: 0.042850	 ndcg_5: 0.0325	 ndcg_10: 0.0441	 hit@1:0.012896	 hit@5:0.0527	 hit@10: 0.0891
epoch 3: train_loss = 1.244639, source_hit@10 = 0.0877, source_ndcg@10 = 0.0410, target_hit@10 = 0.0891, target_ndcg@10 = 0.0441

2024-08-05 11:22:26.399525: step 3788/75760 (epoch 4/80), loss = 1.235136 (242.540 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067607	 ndcg_5: 0.0580	 ndcg_10: 0.0758	 hit@1:0.026025	 hit@5:0.0901	 hit@10: 0.1451
target: 	 mrr: 0.062422	 ndcg_5: 0.0528	 ndcg_10: 0.0719	 hit@1:0.020725	 hit@5:0.0859	 hit@10: 0.1451
source best!
...............................................................
source: 	 mrr: 0.070814	 ndcg_5: 0.0613	 ndcg_10: 0.0790	 hit@1:0.028630	 hit@5:0.0938	 hit@10: 0.1492
epoch 4: train_loss = 1.235136, source_hit@10 = 0.1492, source_ndcg@10 = 0.0790, target_hit@10 = 0.1451, target_ndcg@10 = 0.0719

2024-08-05 11:26:31.676525: step 4735/75760 (epoch 5/80), loss = 1.222577 (242.738 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069567	 ndcg_5: 0.0614	 ndcg_10: 0.0770	 hit@1:0.028050	 hit@5:0.0943	 hit@10: 0.1426
target: 	 mrr: 0.054330	 ndcg_5: 0.0437	 ndcg_10: 0.0585	 hit@1:0.018817	 hit@5:0.0689	 hit@10: 0.1149
source best!
...............................................................
source: 	 mrr: 0.070687	 ndcg_5: 0.0632	 ndcg_10: 0.0802	 hit@1:0.027048	 hit@5:0.0993	 hit@10: 0.1520
epoch 5: train_loss = 1.222577, source_hit@10 = 0.1520, source_ndcg@10 = 0.0802, target_hit@10 = 0.1149, target_ndcg@10 = 0.0585

2024-08-05 11:30:37.347591: step 5682/75760 (epoch 6/80), loss = 1.212345 (243.096 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066523	 ndcg_5: 0.0597	 ndcg_10: 0.0750	 hit@1:0.023220	 hit@5:0.0963	 hit@10: 0.1435
target: 	 mrr: 0.058789	 ndcg_5: 0.0493	 ndcg_10: 0.0685	 hit@1:0.017633	 hit@5:0.0820	 hit@10: 0.1416
epoch 6: train_loss = 1.212345, source_hit@10 = 0.1435, source_ndcg@10 = 0.0750, target_hit@10 = 0.1416, target_ndcg@10 = 0.0685

2024-08-05 11:34:42.396544: step 6629/75760 (epoch 7/80), loss = 1.205577 (242.999 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.020051	 ndcg_5: 0.0157	 ndcg_10: 0.0184	 hit@1:0.007013	 hit@5:0.0240	 hit@10: 0.0324
target: 	 mrr: 0.067741	 ndcg_5: 0.0565	 ndcg_10: 0.0767	 hit@1:0.024870	 hit@5:0.0886	 hit@10: 0.1516
epoch 7: train_loss = 1.205577, source_hit@10 = 0.0324, source_ndcg@10 = 0.0184, target_hit@10 = 0.1516, target_ndcg@10 = 0.0767

2024-08-05 11:38:47.176205: step 7576/75760 (epoch 8/80), loss = 1.200917 (242.766 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.046254	 ndcg_5: 0.0366	 ndcg_10: 0.0511	 hit@1:0.014649	 hit@5:0.0589	 hit@10: 0.1043
target: 	 mrr: 0.079244	 ndcg_5: 0.0697	 ndcg_10: 0.0890	 hit@1:0.033884	 hit@5:0.1051	 hit@10: 0.1649
target best!
......................................................................................................................................................target: 	 mrr: 0.083201	 ndcg_5: 0.0754	 ndcg_10: 0.0930	 hit@1:0.036538	 hit@5:0.1135	 hit@10: 0.1684
epoch 8: train_loss = 1.200917, source_hit@10 = 0.1043, source_ndcg@10 = 0.0511, target_hit@10 = 0.1684, target_ndcg@10 = 0.0930

2024-08-05 11:42:53.826031: step 8523/75760 (epoch 9/80), loss = 1.200379 (243.252 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054380	 ndcg_5: 0.0455	 ndcg_10: 0.0607	 hit@1:0.018077	 hit@5:0.0722	 hit@10: 0.1197
target: 	 mrr: 0.061459	 ndcg_5: 0.0510	 ndcg_10: 0.0701	 hit@1:0.019607	 hit@5:0.0826	 hit@10: 0.1421
epoch 9: train_loss = 1.200379, source_hit@10 = 0.1197, source_ndcg@10 = 0.0607, target_hit@10 = 0.1421, target_ndcg@10 = 0.0701

2024-08-05 11:46:58.928136: step 9470/75760 (epoch 10/80), loss = 1.198400 (242.981 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.037104	 ndcg_5: 0.0309	 ndcg_10: 0.0400	 hit@1:0.012934	 hit@5:0.0492	 hit@10: 0.0778
target: 	 mrr: 0.075704	 ndcg_5: 0.0671	 ndcg_10: 0.0846	 hit@1:0.029870	 hit@5:0.1045	 hit@10: 0.1588
epoch 10: train_loss = 1.198400, source_hit@10 = 0.0778, source_ndcg@10 = 0.0400, target_hit@10 = 0.1588, target_ndcg@10 = 0.0846

2024-08-05 11:51:04.164827: step 10417/75760 (epoch 11/80), loss = 1.197748 (243.184 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060451	 ndcg_5: 0.0497	 ndcg_10: 0.0680	 hit@1:0.022752	 hit@5:0.0770	 hit@10: 0.1342
target: 	 mrr: 0.077698	 ndcg_5: 0.0687	 ndcg_10: 0.0878	 hit@1:0.029805	 hit@5:0.1072	 hit@10: 0.1667
epoch 11: train_loss = 1.197748, source_hit@10 = 0.1342, source_ndcg@10 = 0.0680, target_hit@10 = 0.1667, target_ndcg@10 = 0.0878

2024-08-05 11:55:08.208884: step 11364/75760 (epoch 12/80), loss = 1.198724 (242.034 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.028614	 ndcg_5: 0.0230	 ndcg_10: 0.0297	 hit@1:0.010441	 hit@5:0.0349	 hit@10: 0.0555
target: 	 mrr: 0.053423	 ndcg_5: 0.0426	 ndcg_10: 0.0591	 hit@1:0.015462	 hit@5:0.0711	 hit@10: 0.1225
epoch 12: train_loss = 1.198724, source_hit@10 = 0.0555, source_ndcg@10 = 0.0297, target_hit@10 = 0.1225, target_ndcg@10 = 0.0591

2024-08-05 11:59:14.612570: step 12311/75760 (epoch 13/80), loss = 1.190995 (244.341 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068915	 ndcg_5: 0.0609	 ndcg_10: 0.0769	 hit@1:0.027895	 hit@5:0.0935	 hit@10: 0.1434
target: 	 mrr: 0.060638	 ndcg_5: 0.0504	 ndcg_10: 0.0682	 hit@1:0.019080	 hit@5:0.0822	 hit@10: 0.1378
epoch 13: train_loss = 1.190995, source_hit@10 = 0.1434, source_ndcg@10 = 0.0769, target_hit@10 = 0.1378, target_ndcg@10 = 0.0682

2024-08-05 12:03:19.758995: step 13258/75760 (epoch 14/80), loss = 1.191471 (243.133 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066096	 ndcg_5: 0.0581	 ndcg_10: 0.0724	 hit@1:0.024622	 hit@5:0.0918	 hit@10: 0.1365
target: 	 mrr: 0.073474	 ndcg_5: 0.0654	 ndcg_10: 0.0835	 hit@1:0.027239	 hit@5:0.1031	 hit@10: 0.1595
epoch 14: train_loss = 1.191471, source_hit@10 = 0.1365, source_ndcg@10 = 0.0724, target_hit@10 = 0.1595, target_ndcg@10 = 0.0835

2024-08-05 12:07:25.369158: step 14205/75760 (epoch 15/80), loss = 1.187240 (243.603 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.026784	 ndcg_5: 0.0219	 ndcg_10: 0.0271	 hit@1:0.009350	 hit@5:0.0340	 hit@10: 0.0500
target: 	 mrr: 0.043424	 ndcg_5: 0.0316	 ndcg_10: 0.0460	 hit@1:0.012172	 hit@5:0.0517	 hit@10: 0.0967
epoch 15: train_loss = 1.187240, source_hit@10 = 0.0500, source_ndcg@10 = 0.0271, target_hit@10 = 0.0967, target_ndcg@10 = 0.0460

2024-08-05 12:11:30.640593: step 15152/75760 (epoch 16/80), loss = 1.186000 (243.260 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051172	 ndcg_5: 0.0410	 ndcg_10: 0.0550	 hit@1:0.016519	 hit@5:0.0655	 hit@10: 0.1089
target: 	 mrr: 0.060560	 ndcg_5: 0.0504	 ndcg_10: 0.0688	 hit@1:0.019541	 hit@5:0.0817	 hit@10: 0.1388
epoch 16: train_loss = 1.186000, source_hit@10 = 0.1089, source_ndcg@10 = 0.0550, target_hit@10 = 0.1388, target_ndcg@10 = 0.0688

2024-08-05 12:15:35.767667: step 16099/75760 (epoch 17/80), loss = 1.183550 (243.083 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057948	 ndcg_5: 0.0490	 ndcg_10: 0.0651	 hit@1:0.020415	 hit@5:0.0782	 hit@10: 0.1278
target: 	 mrr: 0.077285	 ndcg_5: 0.0674	 ndcg_10: 0.0866	 hit@1:0.031318	 hit@5:0.1032	 hit@10: 0.1626
epoch 17: train_loss = 1.183550, source_hit@10 = 0.1278, source_ndcg@10 = 0.0651, target_hit@10 = 0.1626, target_ndcg@10 = 0.0866

2024-08-05 12:19:40.908219: step 17046/75760 (epoch 18/80), loss = 1.179426 (243.131 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063439	 ndcg_5: 0.0557	 ndcg_10: 0.0701	 hit@1:0.025245	 hit@5:0.0852	 hit@10: 0.1300
target: 	 mrr: 0.081670	 ndcg_5: 0.0731	 ndcg_10: 0.0912	 hit@1:0.033621	 hit@5:0.1122	 hit@10: 0.1682
target best!
......................................................................................................................................................target: 	 mrr: 0.082649	 ndcg_5: 0.0741	 ndcg_10: 0.0915	 hit@1:0.035076	 hit@5:0.1125	 hit@10: 0.1664
epoch 18: train_loss = 1.179426, source_hit@10 = 0.1300, source_ndcg@10 = 0.0701, target_hit@10 = 0.1664, target_ndcg@10 = 0.0915

2024-08-05 12:23:47.523910: step 17993/75760 (epoch 19/80), loss = 1.177029 (243.146 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.026466	 ndcg_5: 0.0190	 ndcg_10: 0.0267	 hit@1:0.008415	 hit@5:0.0295	 hit@10: 0.0536
target: 	 mrr: 0.073425	 ndcg_5: 0.0630	 ndcg_10: 0.0837	 hit@1:0.026449	 hit@5:0.0996	 hit@10: 0.1642
epoch 19: train_loss = 1.177029, source_hit@10 = 0.0536, source_ndcg@10 = 0.0267, target_hit@10 = 0.1642, target_ndcg@10 = 0.0837

2024-08-05 12:27:53.489908: step 18940/75760 (epoch 20/80), loss = 1.172361 (243.942 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.011268	 ndcg_5: 0.0075	 ndcg_10: 0.0093	 hit@1:0.003117	 hit@5:0.0118	 hit@10: 0.0176
target: 	 mrr: 0.066491	 ndcg_5: 0.0556	 ndcg_10: 0.0761	 hit@1:0.022304	 hit@5:0.0907	 hit@10: 0.1543
epoch 20: train_loss = 1.172361, source_hit@10 = 0.0176, source_ndcg@10 = 0.0093, target_hit@10 = 0.1543, target_ndcg@10 = 0.0761

2024-08-05 12:31:58.758256: step 19887/75760 (epoch 21/80), loss = 1.164485 (243.250 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.015301	 ndcg_5: 0.0120	 ndcg_10: 0.0146	 hit@1:0.006545	 hit@5:0.0170	 hit@10: 0.0249
target: 	 mrr: 0.083222	 ndcg_5: 0.0732	 ndcg_10: 0.0924	 hit@1:0.034410	 hit@5:0.1109	 hit@10: 0.1707
target best!
......................................................................................................................................................target: 	 mrr: 0.085748	 ndcg_5: 0.0753	 ndcg_10: 0.0952	 hit@1:0.037401	 hit@5:0.1119	 hit@10: 0.1737
epoch 21: train_loss = 1.164485, source_hit@10 = 0.0249, source_ndcg@10 = 0.0146, target_hit@10 = 0.1737, target_ndcg@10 = 0.0952

2024-08-05 12:36:05.426405: step 20834/75760 (epoch 22/80), loss = 1.162248 (243.264 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057446	 ndcg_5: 0.0476	 ndcg_10: 0.0628	 hit@1:0.022285	 hit@5:0.0726	 hit@10: 0.1194
target: 	 mrr: 0.071246	 ndcg_5: 0.0611	 ndcg_10: 0.0790	 hit@1:0.027831	 hit@5:0.0942	 hit@10: 0.1499
epoch 22: train_loss = 1.162248, source_hit@10 = 0.1194, source_ndcg@10 = 0.0628, target_hit@10 = 0.1499, target_ndcg@10 = 0.0790

2024-08-05 12:40:10.690618: step 21781/75760 (epoch 23/80), loss = 1.158288 (243.219 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.019567	 ndcg_5: 0.0144	 ndcg_10: 0.0184	 hit@1:0.006078	 hit@5:0.0226	 hit@10: 0.0349
target: 	 mrr: 0.079485	 ndcg_5: 0.0697	 ndcg_10: 0.0881	 hit@1:0.033884	 hit@5:0.1055	 hit@10: 0.1626
epoch 23: train_loss = 1.158288, source_hit@10 = 0.0349, source_ndcg@10 = 0.0184, target_hit@10 = 0.1626, target_ndcg@10 = 0.0881

2024-08-05 12:44:16.461274: step 22728/75760 (epoch 24/80), loss = 1.153085 (243.765 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.012336	 ndcg_5: 0.0094	 ndcg_10: 0.0110	 hit@1:0.003896	 hit@5:0.0145	 hit@10: 0.0195
target: 	 mrr: 0.068925	 ndcg_5: 0.0586	 ndcg_10: 0.0755	 hit@1:0.027633	 hit@5:0.0899	 hit@10: 0.1426
epoch 24: train_loss = 1.153085, source_hit@10 = 0.0195, source_ndcg@10 = 0.0110, target_hit@10 = 0.1426, target_ndcg@10 = 0.0755

2024-08-05 12:48:22.331840: step 23675/75760 (epoch 25/80), loss = 1.150442 (243.869 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.039576	 ndcg_5: 0.0308	 ndcg_10: 0.0416	 hit@1:0.011532	 hit@5:0.0500	 hit@10: 0.0840
target: 	 mrr: 0.080328	 ndcg_5: 0.0712	 ndcg_10: 0.0893	 hit@1:0.034410	 hit@5:0.1068	 hit@10: 0.1632
epoch 25: train_loss = 1.150442, source_hit@10 = 0.0840, source_ndcg@10 = 0.0416, target_hit@10 = 0.1632, target_ndcg@10 = 0.0893

2024-08-05 12:52:27.720025: step 24622/75760 (epoch 26/80), loss = 1.148554 (243.376 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066679	 ndcg_5: 0.0599	 ndcg_10: 0.0745	 hit@1:0.025090	 hit@5:0.0940	 hit@10: 0.1390
target: 	 mrr: 0.086007	 ndcg_5: 0.0771	 ndcg_10: 0.0949	 hit@1:0.037766	 hit@5:0.1140	 hit@10: 0.1696
target best!
......................................................................................................................................................target: 	 mrr: 0.089105	 ndcg_5: 0.0800	 ndcg_10: 0.0979	 hit@1:0.042184	 hit@5:0.1167	 hit@10: 0.1727
epoch 26: train_loss = 1.148554, source_hit@10 = 0.1390, source_ndcg@10 = 0.0745, target_hit@10 = 0.1727, target_ndcg@10 = 0.0979

2024-08-05 12:56:33.975648: step 25569/75760 (epoch 27/80), loss = 1.148566 (242.872 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.035376	 ndcg_5: 0.0272	 ndcg_10: 0.0375	 hit@1:0.012155	 hit@5:0.0429	 hit@10: 0.0750
target: 	 mrr: 0.069492	 ndcg_5: 0.0594	 ndcg_10: 0.0763	 hit@1:0.027041	 hit@5:0.0913	 hit@10: 0.1440
epoch 27: train_loss = 1.148566, source_hit@10 = 0.0750, source_ndcg@10 = 0.0375, target_hit@10 = 0.1440, target_ndcg@10 = 0.0763

2024-08-05 13:00:39.274223: step 26516/75760 (epoch 28/80), loss = 1.144086 (243.281 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057065	 ndcg_5: 0.0501	 ndcg_10: 0.0648	 hit@1:0.019947	 hit@5:0.0804	 hit@10: 0.1264
target: 	 mrr: 0.079284	 ndcg_5: 0.0695	 ndcg_10: 0.0889	 hit@1:0.034081	 hit@5:0.1052	 hit@10: 0.1657
epoch 28: train_loss = 1.144086, source_hit@10 = 0.1264, source_ndcg@10 = 0.0648, target_hit@10 = 0.1657, target_ndcg@10 = 0.0889

2024-08-05 13:04:45.021792: step 27463/75760 (epoch 29/80), loss = 1.146113 (243.741 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.049927	 ndcg_5: 0.0423	 ndcg_10: 0.0564	 hit@1:0.017142	 hit@5:0.0679	 hit@10: 0.1117
target: 	 mrr: 0.073107	 ndcg_5: 0.0617	 ndcg_10: 0.0798	 hit@1:0.029673	 hit@5:0.0938	 hit@10: 0.1501
epoch 29: train_loss = 1.146113, source_hit@10 = 0.1117, source_ndcg@10 = 0.0564, target_hit@10 = 0.1501, target_ndcg@10 = 0.0798

2024-08-05 13:08:50.379265: step 28410/75760 (epoch 30/80), loss = 1.142588 (243.341 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069982	 ndcg_5: 0.0630	 ndcg_10: 0.0765	 hit@1:0.029453	 hit@5:0.0957	 hit@10: 0.1381
target: 	 mrr: 0.076774	 ndcg_5: 0.0674	 ndcg_10: 0.0845	 hit@1:0.030791	 hit@5:0.1029	 hit@10: 0.1561
source best!
...............................................................
source: 	 mrr: 0.071173	 ndcg_5: 0.0634	 ndcg_10: 0.0786	 hit@1:0.027997	 hit@5:0.0965	 hit@10: 0.1436
epoch 30: train_loss = 1.142588, source_hit@10 = 0.1436, source_ndcg@10 = 0.0786, target_hit@10 = 0.1561, target_ndcg@10 = 0.0845

2024-08-05 13:12:55.932139: step 29357/75760 (epoch 31/80), loss = 1.141532 (242.985 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060173	 ndcg_5: 0.0516	 ndcg_10: 0.0665	 hit@1:0.023064	 hit@5:0.0799	 hit@10: 0.1262
target: 	 mrr: 0.078301	 ndcg_5: 0.0681	 ndcg_10: 0.0854	 hit@1:0.032700	 hit@5:0.1028	 hit@10: 0.1572
epoch 31: train_loss = 1.141532, source_hit@10 = 0.1262, source_ndcg@10 = 0.0665, target_hit@10 = 0.1572, target_ndcg@10 = 0.0854

2024-08-05 13:17:01.938268: step 30304/75760 (epoch 32/80), loss = 1.138937 (243.959 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.021612	 ndcg_5: 0.0156	 ndcg_10: 0.0201	 hit@1:0.007636	 hit@5:0.0237	 hit@10: 0.0377
target: 	 mrr: 0.086395	 ndcg_5: 0.0763	 ndcg_10: 0.0958	 hit@1:0.037502	 hit@5:0.1136	 hit@10: 0.1739
target best!
......................................................................................................................................................target: 	 mrr: 0.088095	 ndcg_5: 0.0793	 ndcg_10: 0.0990	 hit@1:0.038331	 hit@5:0.1193	 hit@10: 0.1806
epoch 32: train_loss = 1.138937, source_hit@10 = 0.0377, source_ndcg@10 = 0.0201, target_hit@10 = 0.1806, target_ndcg@10 = 0.0990

2024-08-05 13:21:08.776512: step 31251/75760 (epoch 33/80), loss = 1.135540 (243.521 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064247	 ndcg_5: 0.0568	 ndcg_10: 0.0712	 hit@1:0.026180	 hit@5:0.0873	 hit@10: 0.1325
target: 	 mrr: 0.077352	 ndcg_5: 0.0666	 ndcg_10: 0.0855	 hit@1:0.031976	 hit@5:0.1012	 hit@10: 0.1600
epoch 33: train_loss = 1.135540, source_hit@10 = 0.1325, source_ndcg@10 = 0.0712, target_hit@10 = 0.1600, target_ndcg@10 = 0.0855

2024-08-05 13:25:14.299474: step 32198/75760 (epoch 34/80), loss = 1.134274 (243.522 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.027860	 ndcg_5: 0.0217	 ndcg_10: 0.0278	 hit@1:0.009038	 hit@5:0.0340	 hit@10: 0.0530
target: 	 mrr: 0.078932	 ndcg_5: 0.0688	 ndcg_10: 0.0881	 hit@1:0.032173	 hit@5:0.1050	 hit@10: 0.1650
epoch 34: train_loss = 1.134274, source_hit@10 = 0.0530, source_ndcg@10 = 0.0278, target_hit@10 = 0.1650, target_ndcg@10 = 0.0881

2024-08-05 13:29:20.446374: step 33145/75760 (epoch 35/80), loss = 1.132189 (244.140 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.028601	 ndcg_5: 0.0223	 ndcg_10: 0.0292	 hit@1:0.009038	 hit@5:0.0355	 hit@10: 0.0570
target: 	 mrr: 0.084107	 ndcg_5: 0.0746	 ndcg_10: 0.0937	 hit@1:0.036121	 hit@5:0.1126	 hit@10: 0.1719
epoch 35: train_loss = 1.132189, source_hit@10 = 0.0570, source_ndcg@10 = 0.0292, target_hit@10 = 0.1719, target_ndcg@10 = 0.0937

2024-08-05 13:33:25.940749: step 34092/75760 (epoch 36/80), loss = 1.130458 (243.496 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068211	 ndcg_5: 0.0604	 ndcg_10: 0.0745	 hit@1:0.027895	 hit@5:0.0918	 hit@10: 0.1362
target: 	 mrr: 0.083735	 ndcg_5: 0.0736	 ndcg_10: 0.0915	 hit@1:0.036581	 hit@5:0.1088	 hit@10: 0.1648
epoch 36: train_loss = 1.130458, source_hit@10 = 0.1362, source_ndcg@10 = 0.0745, target_hit@10 = 0.1648, target_ndcg@10 = 0.0915

2024-08-05 13:37:31.391640: step 35039/75760 (epoch 37/80), loss = 1.130959 (243.444 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067852	 ndcg_5: 0.0599	 ndcg_10: 0.0760	 hit@1:0.025557	 hit@5:0.0933	 hit@10: 0.1429
target: 	 mrr: 0.066646	 ndcg_5: 0.0556	 ndcg_10: 0.0725	 hit@1:0.026646	 hit@5:0.0843	 hit@10: 0.1367
epoch 37: train_loss = 1.130959, source_hit@10 = 0.1429, source_ndcg@10 = 0.0760, target_hit@10 = 0.1367, target_ndcg@10 = 0.0725

2024-08-05 13:41:36.343624: step 35986/75760 (epoch 38/80), loss = 1.130210 (242.889 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061020	 ndcg_5: 0.0538	 ndcg_10: 0.0704	 hit@1:0.021661	 hit@5:0.0862	 hit@10: 0.1378
target: 	 mrr: 0.067214	 ndcg_5: 0.0572	 ndcg_10: 0.0743	 hit@1:0.023357	 hit@5:0.0913	 hit@10: 0.1445
epoch 38: train_loss = 1.130210, source_hit@10 = 0.1378, source_ndcg@10 = 0.0704, target_hit@10 = 0.1445, target_ndcg@10 = 0.0743

2024-08-05 13:45:42.001262: step 36933/75760 (epoch 39/80), loss = 1.125639 (243.593 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061299	 ndcg_5: 0.0537	 ndcg_10: 0.0678	 hit@1:0.023375	 hit@5:0.0832	 hit@10: 0.1267
target: 	 mrr: 0.075016	 ndcg_5: 0.0633	 ndcg_10: 0.0821	 hit@1:0.031384	 hit@5:0.0951	 hit@10: 0.1537
epoch 39: train_loss = 1.125639, source_hit@10 = 0.1267, source_ndcg@10 = 0.0678, target_hit@10 = 0.1537, target_ndcg@10 = 0.0821

2024-08-05 13:49:47.932309: step 37880/75760 (epoch 40/80), loss = 1.124583 (243.903 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053715	 ndcg_5: 0.0444	 ndcg_10: 0.0608	 hit@1:0.018077	 hit@5:0.0711	 hit@10: 0.1217
target: 	 mrr: 0.075123	 ndcg_5: 0.0650	 ndcg_10: 0.0846	 hit@1:0.031252	 hit@5:0.0982	 hit@10: 0.1593
epoch 40: train_loss = 1.124583, source_hit@10 = 0.1217, source_ndcg@10 = 0.0608, target_hit@10 = 0.1593, target_ndcg@10 = 0.0846
shift to transfer learning mode

2024-08-05 13:53:55.035417: step 38827/75760 (epoch 41/80), loss = 1.123139 (245.096 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.028459	 ndcg_5: 0.0220	 ndcg_10: 0.0296	 hit@1:0.010285	 hit@5:0.0341	 hit@10: 0.0578
target: 	 mrr: 0.081307	 ndcg_5: 0.0706	 ndcg_10: 0.0902	 hit@1:0.033818	 hit@5:0.1072	 hit@10: 0.1680
epoch 41: train_loss = 1.123139, source_hit@10 = 0.0578, source_ndcg@10 = 0.0296, target_hit@10 = 0.1680, target_ndcg@10 = 0.0902

2024-08-05 13:58:02.645581: step 39774/75760 (epoch 42/80), loss = 1.119325 (245.592 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056372	 ndcg_5: 0.0483	 ndcg_10: 0.0639	 hit@1:0.019791	 hit@5:0.0768	 hit@10: 0.1256
target: 	 mrr: 0.082834	 ndcg_5: 0.0727	 ndcg_10: 0.0920	 hit@1:0.036713	 hit@5:0.1078	 hit@10: 0.1679
epoch 42: train_loss = 1.119325, source_hit@10 = 0.1256, source_ndcg@10 = 0.0639, target_hit@10 = 0.1679, target_ndcg@10 = 0.0920

2024-08-05 14:02:10.084157: step 40721/75760 (epoch 43/80), loss = 1.117220 (245.426 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063304	 ndcg_5: 0.0550	 ndcg_10: 0.0706	 hit@1:0.021350	 hit@5:0.0871	 hit@10: 0.1356
target: 	 mrr: 0.074063	 ndcg_5: 0.0636	 ndcg_10: 0.0844	 hit@1:0.025857	 hit@5:0.1018	 hit@10: 0.1665
epoch 43: train_loss = 1.117220, source_hit@10 = 0.1356, source_ndcg@10 = 0.0706, target_hit@10 = 0.1665, target_ndcg@10 = 0.0844

2024-08-05 14:06:17.291697: step 41668/75760 (epoch 44/80), loss = 1.117360 (245.201 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.036471	 ndcg_5: 0.0284	 ndcg_10: 0.0391	 hit@1:0.011376	 hit@5:0.0453	 hit@10: 0.0787
target: 	 mrr: 0.082578	 ndcg_5: 0.0721	 ndcg_10: 0.0936	 hit@1:0.034081	 hit@5:0.1103	 hit@10: 0.1771
epoch 44: train_loss = 1.117360, source_hit@10 = 0.0787, source_ndcg@10 = 0.0391, target_hit@10 = 0.1771, target_ndcg@10 = 0.0936

2024-08-05 14:10:24.572900: step 42615/75760 (epoch 45/80), loss = 1.114223 (245.279 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.016628	 ndcg_5: 0.0127	 ndcg_10: 0.0165	 hit@1:0.005454	 hit@5:0.0199	 hit@10: 0.0319
target: 	 mrr: 0.082845	 ndcg_5: 0.0743	 ndcg_10: 0.0930	 hit@1:0.033686	 hit@5:0.1142	 hit@10: 0.1724
epoch 45: train_loss = 1.114223, source_hit@10 = 0.0319, source_ndcg@10 = 0.0165, target_hit@10 = 0.1724, target_ndcg@10 = 0.0930

2024-08-05 14:14:31.479181: step 43562/75760 (epoch 46/80), loss = 1.112332 (244.891 sec/epoch), lr: 0.001589
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.031217	 ndcg_5: 0.0244	 ndcg_10: 0.0340	 hit@1:0.010285	 hit@5:0.0386	 hit@10: 0.0684
target: 	 mrr: 0.084601	 ndcg_5: 0.0751	 ndcg_10: 0.0955	 hit@1:0.034081	 hit@5:0.1151	 hit@10: 0.1785
epoch 46: train_loss = 1.112332, source_hit@10 = 0.0684, source_ndcg@10 = 0.0340, target_hit@10 = 0.1785, target_ndcg@10 = 0.0955

2024-08-05 14:18:38.281125: step 44509/75760 (epoch 47/80), loss = 1.111465 (244.765 sec/epoch), lr: 0.001589
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051402	 ndcg_5: 0.0435	 ndcg_10: 0.0565	 hit@1:0.019480	 hit@5:0.0684	 hit@10: 0.1089
target: 	 mrr: 0.089902	 ndcg_5: 0.0806	 ndcg_10: 0.1001	 hit@1:0.039871	 hit@5:0.1204	 hit@10: 0.1807
target best!
......................................................................................................................................................target: 	 mrr: 0.090673	 ndcg_5: 0.0818	 ndcg_10: 0.1019	 hit@1:0.039394	 hit@5:0.1231	 hit@10: 0.1857
epoch 47: train_loss = 1.111465, source_hit@10 = 0.1089, source_ndcg@10 = 0.0565, target_hit@10 = 0.1857, target_ndcg@10 = 0.1019

2024-08-05 14:22:46.867537: step 45456/75760 (epoch 48/80), loss = 1.112123 (245.260 sec/epoch), lr: 0.001589
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054325	 ndcg_5: 0.0467	 ndcg_10: 0.0593	 hit@1:0.023064	 hit@5:0.0697	 hit@10: 0.1089
target: 	 mrr: 0.085180	 ndcg_5: 0.0757	 ndcg_10: 0.0942	 hit@1:0.036845	 hit@5:0.1138	 hit@10: 0.1714
epoch 48: train_loss = 1.112123, source_hit@10 = 0.1089, source_ndcg@10 = 0.0593, target_hit@10 = 0.1714, target_ndcg@10 = 0.0942

2024-08-05 14:26:54.277718: step 46403/75760 (epoch 49/80), loss = 1.107795 (245.405 sec/epoch), lr: 0.001509
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.030329	 ndcg_5: 0.0244	 ndcg_10: 0.0327	 hit@1:0.009194	 hit@5:0.0400	 hit@10: 0.0659
target: 	 mrr: 0.089581	 ndcg_5: 0.0805	 ndcg_10: 0.1006	 hit@1:0.039410	 hit@5:0.1210	 hit@10: 0.1834
epoch 49: train_loss = 1.107795, source_hit@10 = 0.0659, source_ndcg@10 = 0.0327, target_hit@10 = 0.1834, target_ndcg@10 = 0.1006

2024-08-05 14:31:01.129966: step 47350/75760 (epoch 50/80), loss = 1.105592 (244.847 sec/epoch), lr: 0.001434
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.023376	 ndcg_5: 0.0189	 ndcg_10: 0.0224	 hit@1:0.008727	 hit@5:0.0288	 hit@10: 0.0397
target: 	 mrr: 0.077588	 ndcg_5: 0.0679	 ndcg_10: 0.0864	 hit@1:0.029936	 hit@5:0.1051	 hit@10: 0.1627
epoch 50: train_loss = 1.105592, source_hit@10 = 0.0397, source_ndcg@10 = 0.0224, target_hit@10 = 0.1627, target_ndcg@10 = 0.0864

2024-08-05 14:35:08.737931: step 48297/75760 (epoch 51/80), loss = 1.104051 (245.591 sec/epoch), lr: 0.001362
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060463	 ndcg_5: 0.0530	 ndcg_10: 0.0690	 hit@1:0.021194	 hit@5:0.0851	 hit@10: 0.1353
target: 	 mrr: 0.085377	 ndcg_5: 0.0764	 ndcg_10: 0.0976	 hit@1:0.033226	 hit@5:0.1197	 hit@10: 0.1858
epoch 51: train_loss = 1.104051, source_hit@10 = 0.1353, source_ndcg@10 = 0.0690, target_hit@10 = 0.1858, target_ndcg@10 = 0.0976
early termination of training
