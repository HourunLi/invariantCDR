nohup: ignoring input
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:54: UserWarning: An issue occurred while importing 'pyg-lib'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'pyg-lib'. "
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:110: UserWarning: An issue occurred while importing 'torch-sparse'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'torch-sparse'. "
using gpu:2 to train the model
using gpu:2 to train the model
cuda:2
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=2), device_id='2', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.003, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:68: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /opt/conda/conda-bld/pytorch_1711403590347/work/torch/csrc/utils/tensor_new.cpp:618.)
  return torch.sparse.FloatTensor(indices, values, shape)
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-03 19:42:10.492232: step 947/75760 (epoch 1/80), loss = 1.371421 (690.157 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.032218	 ndcg_5: 0.0231	 ndcg_10: 0.0330	 hit@1:0.010753	 hit@5:0.0357	 hit@10: 0.0665
target: 	 mrr: 0.064025	 ndcg_5: 0.0527	 ndcg_10: 0.0713	 hit@1:0.024146	 hit@5:0.0814	 hit@10: 0.1394
source best!
...............................................................
source: 	 mrr: 0.031687	 ndcg_5: 0.0229	 ndcg_10: 0.0322	 hit@1:0.010123	 hit@5:0.0362	 hit@10: 0.0653
target best!
......................................................................................................................................................target: 	 mrr: 0.065883	 ndcg_5: 0.0546	 ndcg_10: 0.0732	 hit@1:0.025908	 hit@5:0.0831	 hit@10: 0.1413
epoch 1: train_loss = 1.371421, source_hit@10 = 0.0653, source_ndcg@10 = 0.0322, target_hit@10 = 0.1413, target_ndcg@10 = 0.0732

2024-08-03 19:53:50.089294: step 1894/75760 (epoch 2/80), loss = 1.249656 (689.468 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064716	 ndcg_5: 0.0551	 ndcg_10: 0.0725	 hit@1:0.024310	 hit@5:0.0852	 hit@10: 0.1398
target: 	 mrr: 0.081768	 ndcg_5: 0.0749	 ndcg_10: 0.0927	 hit@1:0.033555	 hit@5:0.1155	 hit@10: 0.1705
source best!
...............................................................
source: 	 mrr: 0.067507	 ndcg_5: 0.0588	 ndcg_10: 0.0770	 hit@1:0.026258	 hit@5:0.0922	 hit@10: 0.1490
target best!
......................................................................................................................................................target: 	 mrr: 0.084565	 ndcg_5: 0.0770	 ndcg_10: 0.0949	 hit@1:0.036936	 hit@5:0.1162	 hit@10: 0.1719
epoch 2: train_loss = 1.249656, source_hit@10 = 0.1490, source_ndcg@10 = 0.0770, target_hit@10 = 0.1719, target_ndcg@10 = 0.0949
new best model saved.

2024-08-03 20:05:29.785054: step 2841/75760 (epoch 3/80), loss = 1.234248 (688.862 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062056	 ndcg_5: 0.0539	 ndcg_10: 0.0686	 hit@1:0.026492	 hit@5:0.0810	 hit@10: 0.1272
target: 	 mrr: 0.080091	 ndcg_5: 0.0711	 ndcg_10: 0.0894	 hit@1:0.033621	 hit@5:0.1071	 hit@10: 0.1639
epoch 3: train_loss = 1.234248, source_hit@10 = 0.1272, source_ndcg@10 = 0.0686, target_hit@10 = 0.1639, target_ndcg@10 = 0.0894

2024-08-03 20:17:24.708663: step 3788/75760 (epoch 4/80), loss = 1.224154 (709.414 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072603	 ndcg_5: 0.0648	 ndcg_10: 0.0810	 hit@1:0.028362	 hit@5:0.1010	 hit@10: 0.1508
target: 	 mrr: 0.084261	 ndcg_5: 0.0759	 ndcg_10: 0.0945	 hit@1:0.036187	 hit@5:0.1145	 hit@10: 0.1725
source best!
...............................................................
source: 	 mrr: 0.073393	 ndcg_5: 0.0642	 ndcg_10: 0.0816	 hit@1:0.029421	 hit@5:0.0985	 hit@10: 0.1528
target best!
......................................................................................................................................................target: 	 mrr: 0.085430	 ndcg_5: 0.0759	 ndcg_10: 0.0951	 hit@1:0.038863	 hit@5:0.1127	 hit@10: 0.1723
epoch 4: train_loss = 1.224154, source_hit@10 = 0.1528, source_ndcg@10 = 0.0816, target_hit@10 = 0.1723, target_ndcg@10 = 0.0951
new best model saved.

2024-08-03 20:28:56.253978: step 4735/75760 (epoch 5/80), loss = 1.212469 (681.349 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068668	 ndcg_5: 0.0608	 ndcg_10: 0.0768	 hit@1:0.027271	 hit@5:0.0952	 hit@10: 0.1445
target: 	 mrr: 0.071213	 ndcg_5: 0.0620	 ndcg_10: 0.0788	 hit@1:0.029278	 hit@5:0.0949	 hit@10: 0.1474
epoch 5: train_loss = 1.212469, source_hit@10 = 0.1445, source_ndcg@10 = 0.0768, target_hit@10 = 0.1474, target_ndcg@10 = 0.0788

2024-08-03 20:40:24.068190: step 5682/75760 (epoch 6/80), loss = 1.202279 (682.496 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074707	 ndcg_5: 0.0668	 ndcg_10: 0.0822	 hit@1:0.032258	 hit@5:0.1004	 hit@10: 0.1485
target: 	 mrr: 0.082738	 ndcg_5: 0.0737	 ndcg_10: 0.0932	 hit@1:0.034937	 hit@5:0.1113	 hit@10: 0.1717
source best!
...............................................................
source: 	 mrr: 0.078550	 ndcg_5: 0.0696	 ndcg_10: 0.0873	 hit@1:0.034483	 hit@5:0.1036	 hit@10: 0.1587
epoch 6: train_loss = 1.202279, source_hit@10 = 0.1587, source_ndcg@10 = 0.0873, target_hit@10 = 0.1717, target_ndcg@10 = 0.0932
new best model saved.

2024-08-03 20:54:57.129776: step 6629/75760 (epoch 7/80), loss = 1.197235 (866.548 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.058936	 ndcg_5: 0.0493	 ndcg_10: 0.0639	 hit@1:0.021661	 hit@5:0.0756	 hit@10: 0.1209
target: 	 mrr: 0.074845	 ndcg_5: 0.0652	 ndcg_10: 0.0849	 hit@1:0.028555	 hit@5:0.1022	 hit@10: 0.1633
epoch 7: train_loss = 1.197235, source_hit@10 = 0.1209, source_ndcg@10 = 0.0639, target_hit@10 = 0.1633, target_ndcg@10 = 0.0849

2024-08-03 21:06:24.436365: step 7576/75760 (epoch 8/80), loss = 1.188973 (681.934 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057693	 ndcg_5: 0.0505	 ndcg_10: 0.0653	 hit@1:0.019635	 hit@5:0.0809	 hit@10: 0.1264
target: 	 mrr: 0.056908	 ndcg_5: 0.0473	 ndcg_10: 0.0632	 hit@1:0.020133	 hit@5:0.0750	 hit@10: 0.1246
epoch 8: train_loss = 1.188973, source_hit@10 = 0.1264, source_ndcg@10 = 0.0653, target_hit@10 = 0.1246, target_ndcg@10 = 0.0632

2024-08-03 21:25:52.768235: step 8523/75760 (epoch 9/80), loss = 1.184387 (1163.000 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065378	 ndcg_5: 0.0573	 ndcg_10: 0.0734	 hit@1:0.024466	 hit@5:0.0909	 hit@10: 0.1409
target: 	 mrr: 0.083291	 ndcg_5: 0.0743	 ndcg_10: 0.0938	 hit@1:0.034805	 hit@5:0.1124	 hit@10: 0.1732
epoch 9: train_loss = 1.184387, source_hit@10 = 0.1409, source_ndcg@10 = 0.0734, target_hit@10 = 0.1732, target_ndcg@10 = 0.0938

2024-08-03 21:48:21.519067: step 9470/75760 (epoch 10/80), loss = 1.177039 (1317.284 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073397	 ndcg_5: 0.0658	 ndcg_10: 0.0829	 hit@1:0.031635	 hit@5:0.1008	 hit@10: 0.1540
target: 	 mrr: 0.070245	 ndcg_5: 0.0600	 ndcg_10: 0.0784	 hit@1:0.027699	 hit@5:0.0922	 hit@10: 0.1496
epoch 10: train_loss = 1.177039, source_hit@10 = 0.1540, source_ndcg@10 = 0.0829, target_hit@10 = 0.1496, target_ndcg@10 = 0.0784

2024-08-03 22:08:49.768446: step 10417/75760 (epoch 11/80), loss = 1.170475 (1195.396 sec/epoch), lr: 0.003000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.045867	 ndcg_5: 0.0370	 ndcg_10: 0.0502	 hit@1:0.013558	 hit@5:0.0597	 hit@10: 0.1011
target: 	 mrr: 0.078098	 ndcg_5: 0.0691	 ndcg_10: 0.0889	 hit@1:0.030923	 hit@5:0.1072	 hit@10: 0.1688
epoch 11: train_loss = 1.170475, source_hit@10 = 0.1011, source_ndcg@10 = 0.0502, target_hit@10 = 0.1688, target_ndcg@10 = 0.0889

2024-08-03 22:26:41.757789: step 11364/75760 (epoch 12/80), loss = 1.157731 (1061.539 sec/epoch), lr: 0.002850
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.032488	 ndcg_5: 0.0248	 ndcg_10: 0.0320	 hit@1:0.009506	 hit@5:0.0404	 hit@10: 0.0626
target: 	 mrr: 0.071340	 ndcg_5: 0.0602	 ndcg_10: 0.0777	 hit@1:0.030397	 hit@5:0.0900	 hit@10: 0.1444
epoch 12: train_loss = 1.157731, source_hit@10 = 0.0626, source_ndcg@10 = 0.0320, target_hit@10 = 0.1444, target_ndcg@10 = 0.0777

2024-08-03 22:48:48.789724: step 12311/75760 (epoch 13/80), loss = 1.147595 (1318.442 sec/epoch), lr: 0.002707
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069349	 ndcg_5: 0.0595	 ndcg_10: 0.0784	 hit@1:0.024778	 hit@5:0.0946	 hit@10: 0.1540
target: 	 mrr: 0.089453	 ndcg_5: 0.0813	 ndcg_10: 0.1004	 hit@1:0.039608	 hit@5:0.1215	 hit@10: 0.1809
target best!
......................................................................................................................................................target: 	 mrr: 0.090534	 ndcg_5: 0.0831	 ndcg_10: 0.1018	 hit@1:0.039992	 hit@5:0.1248	 hit@10: 0.1831
epoch 13: train_loss = 1.147595, source_hit@10 = 0.1540, source_ndcg@10 = 0.0784, target_hit@10 = 0.1831, target_ndcg@10 = 0.1018

2024-08-03 23:11:41.736685: step 13258/75760 (epoch 14/80), loss = 1.141999 (1320.106 sec/epoch), lr: 0.002707
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067727	 ndcg_5: 0.0594	 ndcg_10: 0.0762	 hit@1:0.025713	 hit@5:0.0930	 hit@10: 0.1449
target: 	 mrr: 0.082936	 ndcg_5: 0.0743	 ndcg_10: 0.0929	 hit@1:0.035265	 hit@5:0.1124	 hit@10: 0.1700
epoch 14: train_loss = 1.141999, source_hit@10 = 0.1449, source_ndcg@10 = 0.0762, target_hit@10 = 0.1700, target_ndcg@10 = 0.0929

2024-08-03 23:30:46.022933: step 14205/75760 (epoch 15/80), loss = 1.135908 (1109.802 sec/epoch), lr: 0.002572
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050350	 ndcg_5: 0.0399	 ndcg_10: 0.0554	 hit@1:0.015428	 hit@5:0.0642	 hit@10: 0.1127
target: 	 mrr: 0.081259	 ndcg_5: 0.0728	 ndcg_10: 0.0899	 hit@1:0.035134	 hit@5:0.1090	 hit@10: 0.1624
epoch 15: train_loss = 1.135908, source_hit@10 = 0.1127, source_ndcg@10 = 0.0554, target_hit@10 = 0.1624, target_ndcg@10 = 0.0899

2024-08-03 23:50:42.577746: step 15152/75760 (epoch 16/80), loss = 1.131536 (1186.970 sec/epoch), lr: 0.002444
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.044556	 ndcg_5: 0.0350	 ndcg_10: 0.0493	 hit@1:0.013558	 hit@5:0.0570	 hit@10: 0.1019
target: 	 mrr: 0.089690	 ndcg_5: 0.0808	 ndcg_10: 0.0995	 hit@1:0.039937	 hit@5:0.1197	 hit@10: 0.1779
target best!
......................................................................................................................................................target: 	 mrr: 0.090580	 ndcg_5: 0.0823	 ndcg_10: 0.1001	 hit@1:0.041454	 hit@5:0.1222	 hit@10: 0.1776
epoch 16: train_loss = 1.131536, source_hit@10 = 0.1019, source_ndcg@10 = 0.0493, target_hit@10 = 0.1776, target_ndcg@10 = 0.1001

2024-08-04 00:13:51.538848: step 16099/75760 (epoch 17/80), loss = 1.128196 (1344.389 sec/epoch), lr: 0.002444
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074869	 ndcg_5: 0.0666	 ndcg_10: 0.0848	 hit@1:0.029765	 hit@5:0.1038	 hit@10: 0.1602
target: 	 mrr: 0.066571	 ndcg_5: 0.0570	 ndcg_10: 0.0739	 hit@1:0.024146	 hit@5:0.0898	 hit@10: 0.1428
source best!
...............................................................
source: 	 mrr: 0.080171	 ndcg_5: 0.0710	 ndcg_10: 0.0900	 hit@1:0.034799	 hit@5:0.1065	 hit@10: 0.1658
epoch 17: train_loss = 1.128196, source_hit@10 = 0.1658, source_ndcg@10 = 0.0900, target_hit@10 = 0.1428, target_ndcg@10 = 0.0739

2024-08-04 00:36:38.517191: step 17046/75760 (epoch 18/80), loss = 1.128637 (1349.554 sec/epoch), lr: 0.002444
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073075	 ndcg_5: 0.0638	 ndcg_10: 0.0811	 hit@1:0.030388	 hit@5:0.0972	 hit@10: 0.1508
target: 	 mrr: 0.086551	 ndcg_5: 0.0773	 ndcg_10: 0.0966	 hit@1:0.038621	 hit@5:0.1155	 hit@10: 0.1756
epoch 18: train_loss = 1.128637, source_hit@10 = 0.1508, source_ndcg@10 = 0.0811, target_hit@10 = 0.1756, target_ndcg@10 = 0.0966

2024-08-04 00:55:42.166125: step 17993/75760 (epoch 19/80), loss = 1.126737 (1134.602 sec/epoch), lr: 0.002444
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076561	 ndcg_5: 0.0686	 ndcg_10: 0.0868	 hit@1:0.030388	 hit@5:0.1060	 hit@10: 0.1630
target: 	 mrr: 0.075110	 ndcg_5: 0.0668	 ndcg_10: 0.0845	 hit@1:0.029410	 hit@5:0.1038	 hit@10: 0.1588
source best!
...............................................................
source: 	 mrr: 0.081589	 ndcg_5: 0.0733	 ndcg_10: 0.0913	 hit@1:0.035590	 hit@5:0.1104	 hit@10: 0.1664
epoch 19: train_loss = 1.126737, source_hit@10 = 0.1664, source_ndcg@10 = 0.0913, target_hit@10 = 0.1588, target_ndcg@10 = 0.0845

2024-08-04 01:16:06.799106: step 18940/75760 (epoch 20/80), loss = 1.122446 (1213.610 sec/epoch), lr: 0.002321
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078579	 ndcg_5: 0.0711	 ndcg_10: 0.0889	 hit@1:0.031946	 hit@5:0.1099	 hit@10: 0.1652
target: 	 mrr: 0.070926	 ndcg_5: 0.0621	 ndcg_10: 0.0791	 hit@1:0.027699	 hit@5:0.0963	 hit@10: 0.1492
source best!
...............................................................
source: 	 mrr: 0.082096	 ndcg_5: 0.0722	 ndcg_10: 0.0923	 hit@1:0.036539	 hit@5:0.1076	 hit@10: 0.1700
epoch 20: train_loss = 1.122446, source_hit@10 = 0.1700, source_ndcg@10 = 0.0923, target_hit@10 = 0.1492, target_ndcg@10 = 0.0791

2024-08-04 01:39:03.224090: step 19887/75760 (epoch 21/80), loss = 1.120247 (1336.482 sec/epoch), lr: 0.002205
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.085488	 ndcg_5: 0.0784	 ndcg_10: 0.0976	 hit@1:0.037089	 hit@5:0.1197	 hit@10: 0.1792
target: 	 mrr: 0.080030	 ndcg_5: 0.0709	 ndcg_10: 0.0890	 hit@1:0.032897	 hit@5:0.1089	 hit@10: 0.1650
source best!
...............................................................
source: 	 mrr: 0.085377	 ndcg_5: 0.0775	 ndcg_10: 0.0966	 hit@1:0.035274	 hit@5:0.1185	 hit@10: 0.1778
epoch 21: train_loss = 1.120247, source_hit@10 = 0.1778, source_ndcg@10 = 0.0966, target_hit@10 = 0.1650, target_ndcg@10 = 0.0890

2024-08-04 01:59:54.686802: step 20834/75760 (epoch 22/80), loss = 1.119389 (1209.894 sec/epoch), lr: 0.002205
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063506	 ndcg_5: 0.0541	 ndcg_10: 0.0715	 hit@1:0.021505	 hit@5:0.0870	 hit@10: 0.1410
target: 	 mrr: 0.087673	 ndcg_5: 0.0795	 ndcg_10: 0.0984	 hit@1:0.037766	 hit@5:0.1207	 hit@10: 0.1792
epoch 22: train_loss = 1.119389, source_hit@10 = 0.1410, source_ndcg@10 = 0.0715, target_hit@10 = 0.1792, target_ndcg@10 = 0.0984

2024-08-04 02:18:18.186784: step 21781/75760 (epoch 23/80), loss = 1.116412 (1093.453 sec/epoch), lr: 0.002095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.031018	 ndcg_5: 0.0246	 ndcg_10: 0.0309	 hit@1:0.009974	 hit@5:0.0394	 hit@10: 0.0588
target: 	 mrr: 0.071529	 ndcg_5: 0.0619	 ndcg_10: 0.0808	 hit@1:0.025396	 hit@5:0.0984	 hit@10: 0.1570
epoch 23: train_loss = 1.116412, source_hit@10 = 0.0588, source_ndcg@10 = 0.0309, target_hit@10 = 0.1570, target_ndcg@10 = 0.0808

2024-08-04 02:41:01.709178: step 22728/75760 (epoch 24/80), loss = 1.112788 (1346.408 sec/epoch), lr: 0.001990
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050297	 ndcg_5: 0.0420	 ndcg_10: 0.0555	 hit@1:0.017142	 hit@5:0.0672	 hit@10: 0.1094
target: 	 mrr: 0.072485	 ndcg_5: 0.0646	 ndcg_10: 0.0835	 hit@1:0.024146	 hit@5:0.1053	 hit@10: 0.1642
epoch 24: train_loss = 1.112788, source_hit@10 = 0.1094, source_ndcg@10 = 0.0555, target_hit@10 = 0.1642, target_ndcg@10 = 0.0835

2024-08-04 03:04:00.320057: step 23675/75760 (epoch 25/80), loss = 1.110635 (1361.924 sec/epoch), lr: 0.001990
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068588	 ndcg_5: 0.0600	 ndcg_10: 0.0779	 hit@1:0.026180	 hit@5:0.0947	 hit@10: 0.1501
target: 	 mrr: 0.086717	 ndcg_5: 0.0792	 ndcg_10: 0.0979	 hit@1:0.037766	 hit@5:0.1197	 hit@10: 0.1778
epoch 25: train_loss = 1.110635, source_hit@10 = 0.1501, source_ndcg@10 = 0.0779, target_hit@10 = 0.1778, target_ndcg@10 = 0.0979

2024-08-04 03:23:30.972753: step 24622/75760 (epoch 26/80), loss = 1.112268 (1146.986 sec/epoch), lr: 0.001990
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.081015	 ndcg_5: 0.0733	 ndcg_10: 0.0914	 hit@1:0.034440	 hit@5:0.1114	 hit@10: 0.1674
target: 	 mrr: 0.087049	 ndcg_5: 0.0777	 ndcg_10: 0.0964	 hit@1:0.039739	 hit@5:0.1137	 hit@10: 0.1717
epoch 26: train_loss = 1.112268, source_hit@10 = 0.1674, source_ndcg@10 = 0.0914, target_hit@10 = 0.1717, target_ndcg@10 = 0.0964

2024-08-04 03:43:47.536389: step 25569/75760 (epoch 27/80), loss = 1.108606 (1183.407 sec/epoch), lr: 0.001990
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.083138	 ndcg_5: 0.0755	 ndcg_10: 0.0925	 hit@1:0.036621	 hit@5:0.1138	 hit@10: 0.1667
target: 	 mrr: 0.087733	 ndcg_5: 0.0793	 ndcg_10: 0.0979	 hit@1:0.038292	 hit@5:0.1195	 hit@10: 0.1774
epoch 27: train_loss = 1.108606, source_hit@10 = 0.1667, source_ndcg@10 = 0.0925, target_hit@10 = 0.1774, target_ndcg@10 = 0.0979

2024-08-04 04:06:34.334431: step 26516/75760 (epoch 28/80), loss = 1.107788 (1334.367 sec/epoch), lr: 0.001990
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076317	 ndcg_5: 0.0695	 ndcg_10: 0.0872	 hit@1:0.028518	 hit@5:0.1110	 hit@10: 0.1661
target: 	 mrr: 0.072171	 ndcg_5: 0.0655	 ndcg_10: 0.0814	 hit@1:0.031120	 hit@5:0.0995	 hit@10: 0.1488
epoch 28: train_loss = 1.107788, source_hit@10 = 0.1661, source_ndcg@10 = 0.0872, target_hit@10 = 0.1488, target_ndcg@10 = 0.0814

2024-08-04 04:28:36.366482: step 27463/75760 (epoch 29/80), loss = 1.104905 (1291.082 sec/epoch), lr: 0.001891
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070361	 ndcg_5: 0.0621	 ndcg_10: 0.0800	 hit@1:0.025713	 hit@5:0.0983	 hit@10: 0.1538
target: 	 mrr: 0.080269	 ndcg_5: 0.0709	 ndcg_10: 0.0903	 hit@1:0.032568	 hit@5:0.1082	 hit@10: 0.1684
epoch 29: train_loss = 1.104905, source_hit@10 = 0.1538, source_ndcg@10 = 0.0800, target_hit@10 = 0.1684, target_ndcg@10 = 0.0903

2024-08-04 04:47:41.010467: step 28410/75760 (epoch 30/80), loss = 1.104855 (1134.758 sec/epoch), lr: 0.001891
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.043340	 ndcg_5: 0.0327	 ndcg_10: 0.0466	 hit@1:0.014337	 hit@5:0.0516	 hit@10: 0.0949
target: 	 mrr: 0.085143	 ndcg_5: 0.0771	 ndcg_10: 0.0960	 hit@1:0.035397	 hit@5:0.1185	 hit@10: 0.1772
epoch 30: train_loss = 1.104855, source_hit@10 = 0.0949, source_ndcg@10 = 0.0466, target_hit@10 = 0.1772, target_ndcg@10 = 0.0960

2024-08-04 05:08:53.621737: step 29357/75760 (epoch 31/80), loss = 1.101595 (1263.519 sec/epoch), lr: 0.001796
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.085863	 ndcg_5: 0.0775	 ndcg_10: 0.0976	 hit@1:0.038647	 hit@5:0.1159	 hit@10: 0.1783
target: 	 mrr: 0.080037	 ndcg_5: 0.0729	 ndcg_10: 0.0907	 hit@1:0.032239	 hit@5:0.1126	 hit@10: 0.1680
source best!
...............................................................
source: 	 mrr: 0.085368	 ndcg_5: 0.0765	 ndcg_10: 0.0970	 hit@1:0.035906	 hit@5:0.1156	 hit@10: 0.1795
epoch 31: train_loss = 1.101595, source_hit@10 = 0.1795, source_ndcg@10 = 0.0970, target_hit@10 = 0.1680, target_ndcg@10 = 0.0907

2024-08-04 05:31:47.517948: step 30304/75760 (epoch 32/80), loss = 1.101597 (1336.077 sec/epoch), lr: 0.001796
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069170	 ndcg_5: 0.0610	 ndcg_10: 0.0791	 hit@1:0.026336	 hit@5:0.0955	 hit@10: 0.1521
target: 	 mrr: 0.070416	 ndcg_5: 0.0626	 ndcg_10: 0.0799	 hit@1:0.027831	 hit@5:0.0968	 hit@10: 0.1509
epoch 32: train_loss = 1.101597, source_hit@10 = 0.1521, source_ndcg@10 = 0.0791, target_hit@10 = 0.1509, target_ndcg@10 = 0.0799

2024-08-04 05:51:58.570498: step 31251/75760 (epoch 33/80), loss = 1.097794 (1177.512 sec/epoch), lr: 0.001706
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.081250	 ndcg_5: 0.0730	 ndcg_10: 0.0925	 hit@1:0.034440	 hit@5:0.1113	 hit@10: 0.1720
target: 	 mrr: 0.086838	 ndcg_5: 0.0777	 ndcg_10: 0.0962	 hit@1:0.039082	 hit@5:0.1154	 hit@10: 0.1726
epoch 33: train_loss = 1.097794, source_hit@10 = 0.1720, source_ndcg@10 = 0.0925, target_hit@10 = 0.1726, target_ndcg@10 = 0.0962

2024-08-04 06:10:12.176758: step 32198/75760 (epoch 34/80), loss = 1.096646 (1083.667 sec/epoch), lr: 0.001706
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.085236	 ndcg_5: 0.0777	 ndcg_10: 0.0945	 hit@1:0.037556	 hit@5:0.1155	 hit@10: 0.1675
target: 	 mrr: 0.085644	 ndcg_5: 0.0767	 ndcg_10: 0.0973	 hit@1:0.036516	 hit@5:0.1161	 hit@10: 0.1799
epoch 34: train_loss = 1.096646, source_hit@10 = 0.1675, source_ndcg@10 = 0.0945, target_hit@10 = 0.1799, target_ndcg@10 = 0.0973

2024-08-04 06:32:48.692508: step 33145/75760 (epoch 35/80), loss = 1.095564 (1323.521 sec/epoch), lr: 0.001706
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068899	 ndcg_5: 0.0614	 ndcg_10: 0.0776	 hit@1:0.025401	 hit@5:0.0985	 hit@10: 0.1488
target: 	 mrr: 0.080829	 ndcg_5: 0.0735	 ndcg_10: 0.0910	 hit@1:0.031252	 hit@5:0.1144	 hit@10: 0.1690
epoch 35: train_loss = 1.095564, source_hit@10 = 0.1488, source_ndcg@10 = 0.0776, target_hit@10 = 0.1690, target_ndcg@10 = 0.0910

2024-08-04 06:55:29.533197: step 34092/75760 (epoch 36/80), loss = 1.093166 (1328.238 sec/epoch), lr: 0.001621
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067474	 ndcg_5: 0.0582	 ndcg_10: 0.0759	 hit@1:0.026025	 hit@5:0.0902	 hit@10: 0.1452
target: 	 mrr: 0.083488	 ndcg_5: 0.0754	 ndcg_10: 0.0935	 hit@1:0.036779	 hit@5:0.1134	 hit@10: 0.1696
epoch 36: train_loss = 1.093166, source_hit@10 = 0.1452, source_ndcg@10 = 0.0759, target_hit@10 = 0.1696, target_ndcg@10 = 0.0935

2024-08-04 07:15:07.477374: step 35039/75760 (epoch 37/80), loss = 1.091750 (1144.909 sec/epoch), lr: 0.001621
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076188	 ndcg_5: 0.0677	 ndcg_10: 0.0851	 hit@1:0.031791	 hit@5:0.1036	 hit@10: 0.1572
target: 	 mrr: 0.084443	 ndcg_5: 0.0762	 ndcg_10: 0.0950	 hit@1:0.036647	 hit@5:0.1148	 hit@10: 0.1729
epoch 37: train_loss = 1.091750, source_hit@10 = 0.1572, source_ndcg@10 = 0.0851, target_hit@10 = 0.1729, target_ndcg@10 = 0.0950

2024-08-04 07:34:57.250639: step 35986/75760 (epoch 38/80), loss = 1.091129 (1156.246 sec/epoch), lr: 0.001621
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.083934	 ndcg_5: 0.0772	 ndcg_10: 0.0954	 hit@1:0.035531	 hit@5:0.1194	 hit@10: 0.1763
target: 	 mrr: 0.083788	 ndcg_5: 0.0749	 ndcg_10: 0.0941	 hit@1:0.036779	 hit@5:0.1117	 hit@10: 0.1718
epoch 38: train_loss = 1.091129, source_hit@10 = 0.1763, source_ndcg@10 = 0.0954, target_hit@10 = 0.1718, target_ndcg@10 = 0.0941

2024-08-04 07:57:46.955904: step 36933/75760 (epoch 39/80), loss = 1.086301 (1335.594 sec/epoch), lr: 0.001621
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.075843	 ndcg_5: 0.0672	 ndcg_10: 0.0858	 hit@1:0.031791	 hit@5:0.1021	 hit@10: 0.1599
target: 	 mrr: 0.086857	 ndcg_5: 0.0790	 ndcg_10: 0.0978	 hit@1:0.037568	 hit@5:0.1195	 hit@10: 0.1783
epoch 39: train_loss = 1.086301, source_hit@10 = 0.1599, source_ndcg@10 = 0.0858, target_hit@10 = 0.1783, target_ndcg@10 = 0.0978

2024-08-04 08:19:43.778963: step 37880/75760 (epoch 40/80), loss = 1.083824 (1283.821 sec/epoch), lr: 0.001540
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064872	 ndcg_5: 0.0574	 ndcg_10: 0.0748	 hit@1:0.023220	 hit@5:0.0913	 hit@10: 0.1457
target: 	 mrr: 0.084062	 ndcg_5: 0.0739	 ndcg_10: 0.0940	 hit@1:0.037371	 hit@5:0.1092	 hit@10: 0.1718
epoch 40: train_loss = 1.083824, source_hit@10 = 0.1457, source_ndcg@10 = 0.0748, target_hit@10 = 0.1718, target_ndcg@10 = 0.0940
shift to transfer learning mode

2024-08-04 08:38:10.299931: step 38827/75760 (epoch 41/80), loss = 1.081079 (1096.303 sec/epoch), lr: 0.001463
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078437	 ndcg_5: 0.0707	 ndcg_10: 0.0880	 hit@1:0.032414	 hit@5:0.1077	 hit@10: 0.1613
target: 	 mrr: 0.070482	 ndcg_5: 0.0633	 ndcg_10: 0.0803	 hit@1:0.025594	 hit@5:0.1001	 hit@10: 0.1531
epoch 41: train_loss = 1.081079, source_hit@10 = 0.1613, source_ndcg@10 = 0.0880, target_hit@10 = 0.1531, target_ndcg@10 = 0.0803

2024-08-04 08:59:40.702651: step 39774/75760 (epoch 42/80), loss = 1.078513 (1281.729 sec/epoch), lr: 0.001390
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.086918	 ndcg_5: 0.0781	 ndcg_10: 0.0980	 hit@1:0.039427	 hit@5:0.1163	 hit@10: 0.1781
target: 	 mrr: 0.078533	 ndcg_5: 0.0691	 ndcg_10: 0.0870	 hit@1:0.034542	 hit@5:0.1028	 hit@10: 0.1584
source best!
...............................................................
source: 	 mrr: 0.089117	 ndcg_5: 0.0806	 ndcg_10: 0.1009	 hit@1:0.040652	 hit@5:0.1201	 hit@10: 0.1833
epoch 42: train_loss = 1.078513, source_hit@10 = 0.1833, source_ndcg@10 = 0.1009, target_hit@10 = 0.1584, target_ndcg@10 = 0.0870

2024-08-04 09:22:57.349100: step 40721/75760 (epoch 43/80), loss = 1.078039 (1358.064 sec/epoch), lr: 0.001390
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067096	 ndcg_5: 0.0583	 ndcg_10: 0.0748	 hit@1:0.025869	 hit@5:0.0899	 hit@10: 0.1413
target: 	 mrr: 0.081497	 ndcg_5: 0.0728	 ndcg_10: 0.0908	 hit@1:0.033226	 hit@5:0.1105	 hit@10: 0.1664
epoch 43: train_loss = 1.078039, source_hit@10 = 0.1413, source_ndcg@10 = 0.0748, target_hit@10 = 0.1664, target_ndcg@10 = 0.0908

2024-08-04 09:42:29.794233: step 41668/75760 (epoch 44/80), loss = 1.074197 (1140.898 sec/epoch), lr: 0.001320
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.087956	 ndcg_5: 0.0798	 ndcg_10: 0.0991	 hit@1:0.039115	 hit@5:0.1201	 hit@10: 0.1803
target: 	 mrr: 0.084814	 ndcg_5: 0.0756	 ndcg_10: 0.0942	 hit@1:0.037437	 hit@5:0.1125	 hit@10: 0.1703
source best!
...............................................................
source: 	 mrr: 0.092491	 ndcg_5: 0.0832	 ndcg_10: 0.1041	 hit@1:0.042708	 hit@5:0.1226	 hit@10: 0.1874
epoch 44: train_loss = 1.074197, source_hit@10 = 0.1874, source_ndcg@10 = 0.1041, target_hit@10 = 0.1703, target_ndcg@10 = 0.0942

2024-08-04 10:01:55.714482: step 42615/75760 (epoch 45/80), loss = 1.073878 (1153.423 sec/epoch), lr: 0.001320
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.090323	 ndcg_5: 0.0827	 ndcg_10: 0.1012	 hit@1:0.040985	 hit@5:0.1231	 hit@10: 0.1808
target: 	 mrr: 0.077238	 ndcg_5: 0.0675	 ndcg_10: 0.0867	 hit@1:0.030660	 hit@5:0.1033	 hit@10: 0.1634
source best!
...............................................................
source: 	 mrr: 0.090536	 ndcg_5: 0.0823	 ndcg_10: 0.1018	 hit@1:0.040019	 hit@5:0.1239	 hit@10: 0.1840
epoch 45: train_loss = 1.073878, source_hit@10 = 0.1840, source_ndcg@10 = 0.1018, target_hit@10 = 0.1634, target_ndcg@10 = 0.0867

2024-08-04 10:24:40.910109: step 43562/75760 (epoch 46/80), loss = 1.070253 (1322.506 sec/epoch), lr: 0.001254
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.080224	 ndcg_5: 0.0726	 ndcg_10: 0.0898	 hit@1:0.033661	 hit@5:0.1114	 hit@10: 0.1647
target: 	 mrr: 0.080511	 ndcg_5: 0.0721	 ndcg_10: 0.0915	 hit@1:0.030660	 hit@5:0.1124	 hit@10: 0.1724
epoch 46: train_loss = 1.070253, source_hit@10 = 0.1647, source_ndcg@10 = 0.0898, target_hit@10 = 0.1724, target_ndcg@10 = 0.0915

2024-08-04 10:46:06.005919: step 44509/75760 (epoch 47/80), loss = 1.067067 (1255.401 sec/epoch), lr: 0.001192
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.085596	 ndcg_5: 0.0774	 ndcg_10: 0.0963	 hit@1:0.037245	 hit@5:0.1173	 hit@10: 0.1763
target: 	 mrr: 0.087727	 ndcg_5: 0.0793	 ndcg_10: 0.0978	 hit@1:0.039213	 hit@5:0.1184	 hit@10: 0.1760
epoch 47: train_loss = 1.067067, source_hit@10 = 0.1763, source_ndcg@10 = 0.0963, target_hit@10 = 0.1760, target_ndcg@10 = 0.0978

2024-08-04 11:04:55.822287: step 45456/75760 (epoch 48/80), loss = 1.064821 (1098.087 sec/epoch), lr: 0.001192
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067915	 ndcg_5: 0.0607	 ndcg_10: 0.0787	 hit@1:0.026025	 hit@5:0.0958	 hit@10: 0.1513
target: 	 mrr: 0.083274	 ndcg_5: 0.0740	 ndcg_10: 0.0924	 hit@1:0.036450	 hit@5:0.1109	 hit@10: 0.1682
epoch 48: train_loss = 1.064821, source_hit@10 = 0.1513, source_ndcg@10 = 0.0787, target_hit@10 = 0.1682, target_ndcg@10 = 0.0924

2024-08-04 11:23:59.051481: step 46403/75760 (epoch 49/80), loss = 1.060816 (1114.139 sec/epoch), lr: 0.001132
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.085537	 ndcg_5: 0.0777	 ndcg_10: 0.0964	 hit@1:0.036621	 hit@5:0.1180	 hit@10: 0.1764
target: 	 mrr: 0.090661	 ndcg_5: 0.0810	 ndcg_10: 0.1009	 hit@1:0.042898	 hit@5:0.1190	 hit@10: 0.1807
target best!
......................................................................................................................................................target: 	 mrr: 0.092035	 ndcg_5: 0.0830	 ndcg_10: 0.1029	 hit@1:0.042450	 hit@5:0.1222	 hit@10: 0.1843
epoch 49: train_loss = 1.060816, source_hit@10 = 0.1764, source_ndcg@10 = 0.0964, target_hit@10 = 0.1843, target_ndcg@10 = 0.1029

2024-08-04 11:45:44.110785: step 47350/75760 (epoch 50/80), loss = 1.061156 (1252.017 sec/epoch), lr: 0.001132
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077252	 ndcg_5: 0.0704	 ndcg_10: 0.0884	 hit@1:0.031791	 hit@5:0.1092	 hit@10: 0.1650
target: 	 mrr: 0.085610	 ndcg_5: 0.0777	 ndcg_10: 0.0960	 hit@1:0.036581	 hit@5:0.1176	 hit@10: 0.1742
epoch 50: train_loss = 1.061156, source_hit@10 = 0.1650, source_ndcg@10 = 0.0884, target_hit@10 = 0.1742, target_ndcg@10 = 0.0960

2024-08-04 12:07:10.598900: step 48297/75760 (epoch 51/80), loss = 1.058412 (1255.005 sec/epoch), lr: 0.001075
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.086898	 ndcg_5: 0.0793	 ndcg_10: 0.0980	 hit@1:0.038180	 hit@5:0.1198	 hit@10: 0.1781
target: 	 mrr: 0.085437	 ndcg_5: 0.0771	 ndcg_10: 0.0959	 hit@1:0.036384	 hit@5:0.1174	 hit@10: 0.1758
epoch 51: train_loss = 1.058412, source_hit@10 = 0.1781, source_ndcg@10 = 0.0980, target_hit@10 = 0.1758, target_ndcg@10 = 0.0959
early termination of training
