nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=0), device_id='0', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.1, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home/disk2/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-03 16:31:34.531154: step 947/75760 (epoch 1/80), loss = 1.382671 (564.295 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.032578	 ndcg_5: 0.0241	 ndcg_10: 0.0336	 hit@1:0.010753	 hit@5:0.0374	 hit@10: 0.0670
target: 	 mrr: 0.072627	 ndcg_5: 0.0652	 ndcg_10: 0.0823	 hit@1:0.029344	 hit@5:0.1017	 hit@10: 0.1548
source best!
...............................................................
source: 	 mrr: 0.035189	 ndcg_5: 0.0272	 ndcg_10: 0.0350	 hit@1:0.014078	 hit@5:0.0405	 hit@10: 0.0650
target best!
......................................................................................................................................................target: 	 mrr: 0.074367	 ndcg_5: 0.0662	 ndcg_10: 0.0850	 hit@1:0.030359	 hit@5:0.1016	 hit@10: 0.1600
epoch 1: train_loss = 1.382671, source_hit@10 = 0.0650, source_ndcg@10 = 0.0350, target_hit@10 = 0.1600, target_ndcg@10 = 0.0850

2024-08-03 16:41:00.111102: step 1894/75760 (epoch 2/80), loss = 1.292399 (557.887 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.043828	 ndcg_5: 0.0358	 ndcg_10: 0.0511	 hit@1:0.011064	 hit@5:0.0608	 hit@10: 0.1082
target: 	 mrr: 0.062399	 ndcg_5: 0.0522	 ndcg_10: 0.0725	 hit@1:0.019870	 hit@5:0.0856	 hit@10: 0.1486
source best!
...............................................................
source: 	 mrr: 0.044939	 ndcg_5: 0.0377	 ndcg_10: 0.0527	 hit@1:0.010756	 hit@5:0.0656	 hit@10: 0.1120
epoch 2: train_loss = 1.292399, source_hit@10 = 0.1120, source_ndcg@10 = 0.0527, target_hit@10 = 0.1486, target_ndcg@10 = 0.0725
new best model saved.

2024-08-03 16:50:23.707779: step 2841/75760 (epoch 3/80), loss = 1.283680 (558.236 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.041691	 ndcg_5: 0.0369	 ndcg_10: 0.0485	 hit@1:0.012155	 hit@5:0.0625	 hit@10: 0.0982
target: 	 mrr: 0.068249	 ndcg_5: 0.0597	 ndcg_10: 0.0776	 hit@1:0.024673	 hit@5:0.0945	 hit@10: 0.1501
epoch 3: train_loss = 1.283680, source_hit@10 = 0.0982, source_ndcg@10 = 0.0485, target_hit@10 = 0.1501, target_ndcg@10 = 0.0776

2024-08-03 16:59:48.985028: step 3788/75760 (epoch 4/80), loss = 1.281051 (561.319 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060462	 ndcg_5: 0.0505	 ndcg_10: 0.0680	 hit@1:0.023064	 hit@5:0.0775	 hit@10: 0.1321
target: 	 mrr: 0.072958	 ndcg_5: 0.0651	 ndcg_10: 0.0829	 hit@1:0.027107	 hit@5:0.1026	 hit@10: 0.1576
source best!
...............................................................
source: 	 mrr: 0.060734	 ndcg_5: 0.0518	 ndcg_10: 0.0698	 hit@1:0.020405	 hit@5:0.0829	 hit@10: 0.1392
target best!
......................................................................................................................................................target: 	 mrr: 0.071695	 ndcg_5: 0.0633	 ndcg_10: 0.0827	 hit@1:0.024646	 hit@5:0.1016	 hit@10: 0.1617
epoch 4: train_loss = 1.281051, source_hit@10 = 0.1392, source_ndcg@10 = 0.0698, target_hit@10 = 0.1617, target_ndcg@10 = 0.0827
new best model saved.

2024-08-03 17:09:18.989871: step 4735/75760 (epoch 5/80), loss = 1.272989 (561.803 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.022650	 ndcg_5: 0.0155	 ndcg_10: 0.0217	 hit@1:0.005766	 hit@5:0.0254	 hit@10: 0.0444
target: 	 mrr: 0.051495	 ndcg_5: 0.0388	 ndcg_10: 0.0576	 hit@1:0.014804	 hit@5:0.0636	 hit@10: 0.1221
epoch 5: train_loss = 1.272989, source_hit@10 = 0.0444, source_ndcg@10 = 0.0217, target_hit@10 = 0.1221, target_ndcg@10 = 0.0576

2024-08-03 17:18:40.964585: step 5682/75760 (epoch 6/80), loss = 1.258453 (558.096 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052330	 ndcg_5: 0.0430	 ndcg_10: 0.0577	 hit@1:0.017921	 hit@5:0.0692	 hit@10: 0.1153
target: 	 mrr: 0.035966	 ndcg_5: 0.0244	 ndcg_10: 0.0389	 hit@1:0.007435	 hit@5:0.0423	 hit@10: 0.0874
epoch 6: train_loss = 1.258453, source_hit@10 = 0.1153, source_ndcg@10 = 0.0577, target_hit@10 = 0.0874, target_ndcg@10 = 0.0389

2024-08-03 17:28:05.833277: step 6629/75760 (epoch 7/80), loss = 1.256714 (560.990 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070506	 ndcg_5: 0.0627	 ndcg_10: 0.0784	 hit@1:0.029297	 hit@5:0.0965	 hit@10: 0.1448
target: 	 mrr: 0.067326	 ndcg_5: 0.0573	 ndcg_10: 0.0764	 hit@1:0.023554	 hit@5:0.0908	 hit@10: 0.1506
source best!
...............................................................
source: 	 mrr: 0.072691	 ndcg_5: 0.0650	 ndcg_10: 0.0793	 hit@1:0.030528	 hit@5:0.0990	 hit@10: 0.1433
epoch 7: train_loss = 1.256714, source_hit@10 = 0.1433, source_ndcg@10 = 0.0793, target_hit@10 = 0.1506, target_ndcg@10 = 0.0764
new best model saved.

2024-08-03 17:37:34.135662: step 7576/75760 (epoch 8/80), loss = 1.254850 (562.727 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.033364	 ndcg_5: 0.0254	 ndcg_10: 0.0339	 hit@1:0.010285	 hit@5:0.0407	 hit@10: 0.0672
target: 	 mrr: 0.069769	 ndcg_5: 0.0616	 ndcg_10: 0.0800	 hit@1:0.024344	 hit@5:0.0986	 hit@10: 0.1557
epoch 8: train_loss = 1.254850, source_hit@10 = 0.0672, source_ndcg@10 = 0.0339, target_hit@10 = 0.1557, target_ndcg@10 = 0.0800

2024-08-03 17:46:59.193531: step 8523/75760 (epoch 9/80), loss = 1.254661 (561.202 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070278	 ndcg_5: 0.0624	 ndcg_10: 0.0791	 hit@1:0.028518	 hit@5:0.0960	 hit@10: 0.1479
target: 	 mrr: 0.032766	 ndcg_5: 0.0240	 ndcg_10: 0.0302	 hit@1:0.011843	 hit@5:0.0359	 hit@10: 0.0552
epoch 9: train_loss = 1.254661, source_hit@10 = 0.1479, source_ndcg@10 = 0.0791, target_hit@10 = 0.0552, target_ndcg@10 = 0.0302

2024-08-03 17:56:21.439348: step 9470/75760 (epoch 10/80), loss = 1.251845 (558.290 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057959	 ndcg_5: 0.0481	 ndcg_10: 0.0639	 hit@1:0.021661	 hit@5:0.0751	 hit@10: 0.1245
target: 	 mrr: 0.043396	 ndcg_5: 0.0325	 ndcg_10: 0.0451	 hit@1:0.013027	 hit@5:0.0525	 hit@10: 0.0921
epoch 10: train_loss = 1.251845, source_hit@10 = 0.1245, source_ndcg@10 = 0.0639, target_hit@10 = 0.0921, target_ndcg@10 = 0.0451

2024-08-03 18:05:43.871952: step 10417/75760 (epoch 11/80), loss = 1.251522 (558.253 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.049123	 ndcg_5: 0.0406	 ndcg_10: 0.0562	 hit@1:0.013714	 hit@5:0.0687	 hit@10: 0.1173
target: 	 mrr: 0.068561	 ndcg_5: 0.0605	 ndcg_10: 0.0777	 hit@1:0.023357	 hit@5:0.0972	 hit@10: 0.1505
epoch 11: train_loss = 1.251522, source_hit@10 = 0.1173, source_ndcg@10 = 0.0562, target_hit@10 = 0.1505, target_ndcg@10 = 0.0777

2024-08-03 18:15:13.483222: step 11364/75760 (epoch 12/80), loss = 1.249194 (565.657 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.031055	 ndcg_5: 0.0220	 ndcg_10: 0.0325	 hit@1:0.008883	 hit@5:0.0355	 hit@10: 0.0684
target: 	 mrr: 0.042492	 ndcg_5: 0.0297	 ndcg_10: 0.0448	 hit@1:0.011448	 hit@5:0.0486	 hit@10: 0.0959
epoch 12: train_loss = 1.249194, source_hit@10 = 0.0684, source_ndcg@10 = 0.0325, target_hit@10 = 0.0959, target_ndcg@10 = 0.0448

2024-08-03 18:24:42.698278: step 12311/75760 (epoch 13/80), loss = 1.245391 (565.189 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062604	 ndcg_5: 0.0540	 ndcg_10: 0.0688	 hit@1:0.023531	 hit@5:0.0840	 hit@10: 0.1300
target: 	 mrr: 0.038605	 ndcg_5: 0.0243	 ndcg_10: 0.0391	 hit@1:0.009935	 hit@5:0.0399	 hit@10: 0.0864
epoch 13: train_loss = 1.245391, source_hit@10 = 0.1300, source_ndcg@10 = 0.0688, target_hit@10 = 0.0864, target_ndcg@10 = 0.0391

2024-08-03 18:34:07.214816: step 13258/75760 (epoch 14/80), loss = 1.245248 (560.493 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062417	 ndcg_5: 0.0530	 ndcg_10: 0.0686	 hit@1:0.024466	 hit@5:0.0821	 hit@10: 0.1309
target: 	 mrr: 0.052155	 ndcg_5: 0.0414	 ndcg_10: 0.0576	 hit@1:0.015330	 hit@5:0.0682	 hit@10: 0.1191
epoch 14: train_loss = 1.245248, source_hit@10 = 0.1309, source_ndcg@10 = 0.0686, target_hit@10 = 0.1191, target_ndcg@10 = 0.0576

2024-08-03 18:43:30.839847: step 14205/75760 (epoch 15/80), loss = 1.244811 (559.476 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068689	 ndcg_5: 0.0591	 ndcg_10: 0.0768	 hit@1:0.027271	 hit@5:0.0912	 hit@10: 0.1463
target: 	 mrr: 0.037644	 ndcg_5: 0.0239	 ndcg_10: 0.0382	 hit@1:0.007961	 hit@5:0.0407	 hit@10: 0.0859
epoch 15: train_loss = 1.244811, source_hit@10 = 0.1463, source_ndcg@10 = 0.0768, target_hit@10 = 0.0859, target_ndcg@10 = 0.0382

2024-08-03 18:52:56.725988: step 15152/75760 (epoch 16/80), loss = 1.240810 (561.944 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067630	 ndcg_5: 0.0591	 ndcg_10: 0.0768	 hit@1:0.025245	 hit@5:0.0938	 hit@10: 0.1490
target: 	 mrr: 0.066929	 ndcg_5: 0.0574	 ndcg_10: 0.0758	 hit@1:0.023488	 hit@5:0.0920	 hit@10: 0.1492
epoch 16: train_loss = 1.240810, source_hit@10 = 0.1490, source_ndcg@10 = 0.0768, target_hit@10 = 0.1492, target_ndcg@10 = 0.0758

2024-08-03 19:02:22.237633: step 16099/75760 (epoch 17/80), loss = 1.232797 (561.688 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.047449	 ndcg_5: 0.0405	 ndcg_10: 0.0513	 hit@1:0.016674	 hit@5:0.0642	 hit@10: 0.0980
target: 	 mrr: 0.059590	 ndcg_5: 0.0480	 ndcg_10: 0.0645	 hit@1:0.020133	 hit@5:0.0761	 hit@10: 0.1274
epoch 17: train_loss = 1.232797, source_hit@10 = 0.0980, source_ndcg@10 = 0.0513, target_hit@10 = 0.1274, target_ndcg@10 = 0.0645

2024-08-03 19:11:45.469589: step 17046/75760 (epoch 18/80), loss = 1.207309 (559.363 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053953	 ndcg_5: 0.0441	 ndcg_10: 0.0607	 hit@1:0.017142	 hit@5:0.0712	 hit@10: 0.1226
target: 	 mrr: 0.065497	 ndcg_5: 0.0542	 ndcg_10: 0.0748	 hit@1:0.021317	 hit@5:0.0878	 hit@10: 0.1521
epoch 18: train_loss = 1.207309, source_hit@10 = 0.1226, source_ndcg@10 = 0.0607, target_hit@10 = 0.1521, target_ndcg@10 = 0.0748

2024-08-03 19:21:09.111753: step 17993/75760 (epoch 19/80), loss = 1.202305 (559.674 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063027	 ndcg_5: 0.0545	 ndcg_10: 0.0724	 hit@1:0.021194	 hit@5:0.0880	 hit@10: 0.1443
target: 	 mrr: 0.062758	 ndcg_5: 0.0517	 ndcg_10: 0.0696	 hit@1:0.020133	 hit@5:0.0837	 hit@10: 0.1394
epoch 19: train_loss = 1.202305, source_hit@10 = 0.1443, source_ndcg@10 = 0.0724, target_hit@10 = 0.1394, target_ndcg@10 = 0.0696

2024-08-03 19:30:29.894964: step 18940/75760 (epoch 20/80), loss = 1.202724 (556.623 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076037	 ndcg_5: 0.0684	 ndcg_10: 0.0857	 hit@1:0.031946	 hit@5:0.1049	 hit@10: 0.1583
target: 	 mrr: 0.055163	 ndcg_5: 0.0426	 ndcg_10: 0.0611	 hit@1:0.016383	 hit@5:0.0695	 hit@10: 0.1274
source best!
...............................................................
source: 	 mrr: 0.076024	 ndcg_5: 0.0687	 ndcg_10: 0.0854	 hit@1:0.031319	 hit@5:0.1058	 hit@10: 0.1580
epoch 20: train_loss = 1.202724, source_hit@10 = 0.1580, source_ndcg@10 = 0.0854, target_hit@10 = 0.1274, target_ndcg@10 = 0.0611

2024-08-03 19:39:52.441419: step 19887/75760 (epoch 21/80), loss = 1.201131 (557.605 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068569	 ndcg_5: 0.0594	 ndcg_10: 0.0762	 hit@1:0.027115	 hit@5:0.0916	 hit@10: 0.1438
target: 	 mrr: 0.058790	 ndcg_5: 0.0482	 ndcg_10: 0.0650	 hit@1:0.018422	 hit@5:0.0785	 hit@10: 0.1309
epoch 21: train_loss = 1.201131, source_hit@10 = 0.1438, source_ndcg@10 = 0.0762, target_hit@10 = 0.1309, target_ndcg@10 = 0.0650

2024-08-03 19:49:17.714778: step 20834/75760 (epoch 22/80), loss = 1.198698 (561.406 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.038599	 ndcg_5: 0.0291	 ndcg_10: 0.0386	 hit@1:0.013714	 hit@5:0.0447	 hit@10: 0.0742
target: 	 mrr: 0.061498	 ndcg_5: 0.0488	 ndcg_10: 0.0666	 hit@1:0.021317	 hit@5:0.0766	 hit@10: 0.1322
epoch 22: train_loss = 1.198698, source_hit@10 = 0.0742, source_ndcg@10 = 0.0386, target_hit@10 = 0.1322, target_ndcg@10 = 0.0666

2024-08-03 19:58:40.660281: step 21781/75760 (epoch 23/80), loss = 1.197098 (558.937 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069688	 ndcg_5: 0.0619	 ndcg_10: 0.0773	 hit@1:0.028674	 hit@5:0.0940	 hit@10: 0.1420
target: 	 mrr: 0.068281	 ndcg_5: 0.0575	 ndcg_10: 0.0783	 hit@1:0.022896	 hit@5:0.0926	 hit@10: 0.1570
epoch 23: train_loss = 1.197098, source_hit@10 = 0.1420, source_ndcg@10 = 0.0773, target_hit@10 = 0.1570, target_ndcg@10 = 0.0783

2024-08-03 20:08:07.758803: step 22728/75760 (epoch 24/80), loss = 1.194800 (563.186 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.043941	 ndcg_5: 0.0343	 ndcg_10: 0.0466	 hit@1:0.013402	 hit@5:0.0550	 hit@10: 0.0935
target: 	 mrr: 0.056088	 ndcg_5: 0.0426	 ndcg_10: 0.0603	 hit@1:0.018751	 hit@5:0.0673	 hit@10: 0.1226
epoch 24: train_loss = 1.194800, source_hit@10 = 0.0935, source_ndcg@10 = 0.0466, target_hit@10 = 0.1226, target_ndcg@10 = 0.0603

2024-08-03 20:17:31.745496: step 23675/75760 (epoch 25/80), loss = 1.191198 (560.164 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.079147	 ndcg_5: 0.0705	 ndcg_10: 0.0886	 hit@1:0.035063	 hit@5:0.1060	 hit@10: 0.1622
target: 	 mrr: 0.057089	 ndcg_5: 0.0458	 ndcg_10: 0.0652	 hit@1:0.016909	 hit@5:0.0757	 hit@10: 0.1358
source best!
...............................................................
source: 	 mrr: 0.080645	 ndcg_5: 0.0721	 ndcg_10: 0.0893	 hit@1:0.034799	 hit@5:0.1080	 hit@10: 0.1613
epoch 25: train_loss = 1.191198, source_hit@10 = 0.1613, source_ndcg@10 = 0.0893, target_hit@10 = 0.1358, target_ndcg@10 = 0.0652

2024-08-03 20:26:56.545957: step 24622/75760 (epoch 26/80), loss = 1.190544 (559.707 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066910	 ndcg_5: 0.0583	 ndcg_10: 0.0753	 hit@1:0.024466	 hit@5:0.0918	 hit@10: 0.1448
target: 	 mrr: 0.084350	 ndcg_5: 0.0758	 ndcg_10: 0.0928	 hit@1:0.037437	 hit@5:0.1126	 hit@10: 0.1653
target best!
......................................................................................................................................................target: 	 mrr: 0.085463	 ndcg_5: 0.0774	 ndcg_10: 0.0943	 hit@1:0.039128	 hit@5:0.1153	 hit@10: 0.1679
epoch 26: train_loss = 1.190544, source_hit@10 = 0.1448, source_ndcg@10 = 0.0753, target_hit@10 = 0.1679, target_ndcg@10 = 0.0943

2024-08-03 20:36:23.110057: step 25569/75760 (epoch 27/80), loss = 1.185816 (560.123 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076619	 ndcg_5: 0.0687	 ndcg_10: 0.0837	 hit@1:0.033349	 hit@5:0.1030	 hit@10: 0.1496
target: 	 mrr: 0.070321	 ndcg_5: 0.0619	 ndcg_10: 0.0792	 hit@1:0.027699	 hit@5:0.0959	 hit@10: 0.1495
epoch 27: train_loss = 1.185816, source_hit@10 = 0.1496, source_ndcg@10 = 0.0837, target_hit@10 = 0.1495, target_ndcg@10 = 0.0792

2024-08-03 20:45:44.726925: step 26516/75760 (epoch 28/80), loss = 1.182548 (557.561 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068776	 ndcg_5: 0.0589	 ndcg_10: 0.0755	 hit@1:0.030388	 hit@5:0.0871	 hit@10: 0.1390
target: 	 mrr: 0.083342	 ndcg_5: 0.0750	 ndcg_10: 0.0937	 hit@1:0.035923	 hit@5:0.1128	 hit@10: 0.1709
epoch 28: train_loss = 1.182548, source_hit@10 = 0.1390, source_ndcg@10 = 0.0755, target_hit@10 = 0.1709, target_ndcg@10 = 0.0937

2024-08-03 20:55:12.447776: step 27463/75760 (epoch 29/80), loss = 1.182018 (563.792 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072059	 ndcg_5: 0.0625	 ndcg_10: 0.0807	 hit@1:0.030232	 hit@5:0.0949	 hit@10: 0.1513
target: 	 mrr: 0.087500	 ndcg_5: 0.0787	 ndcg_10: 0.0975	 hit@1:0.039082	 hit@5:0.1176	 hit@10: 0.1761
target best!
......................................................................................................................................................target: 	 mrr: 0.088477	 ndcg_5: 0.0791	 ndcg_10: 0.0986	 hit@1:0.040723	 hit@5:0.1171	 hit@10: 0.1778
epoch 29: train_loss = 1.182018, source_hit@10 = 0.1513, source_ndcg@10 = 0.0807, target_hit@10 = 0.1778, target_ndcg@10 = 0.0986

2024-08-03 21:04:43.180765: step 28410/75760 (epoch 30/80), loss = 1.180926 (562.406 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.079633	 ndcg_5: 0.0715	 ndcg_10: 0.0885	 hit@1:0.035842	 hit@5:0.1066	 hit@10: 0.1591
target: 	 mrr: 0.077461	 ndcg_5: 0.0689	 ndcg_10: 0.0862	 hit@1:0.032436	 hit@5:0.1043	 hit@10: 0.1582
source best!
...............................................................
source: 	 mrr: 0.080876	 ndcg_5: 0.0741	 ndcg_10: 0.0915	 hit@1:0.033059	 hit@5:0.1139	 hit@10: 0.1683
epoch 30: train_loss = 1.180926, source_hit@10 = 0.1683, source_ndcg@10 = 0.0915, target_hit@10 = 0.1582, target_ndcg@10 = 0.0862

2024-08-03 21:14:10.294901: step 29357/75760 (epoch 31/80), loss = 1.178040 (562.146 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069292	 ndcg_5: 0.0612	 ndcg_10: 0.0796	 hit@1:0.023687	 hit@5:0.0982	 hit@10: 0.1558
target: 	 mrr: 0.081210	 ndcg_5: 0.0715	 ndcg_10: 0.0906	 hit@1:0.035463	 hit@5:0.1066	 hit@10: 0.1657
epoch 31: train_loss = 1.178040, source_hit@10 = 0.1558, source_ndcg@10 = 0.0796, target_hit@10 = 0.1657, target_ndcg@10 = 0.0906

2024-08-03 21:23:32.737022: step 30304/75760 (epoch 32/80), loss = 1.173934 (558.548 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.079545	 ndcg_5: 0.0717	 ndcg_10: 0.0885	 hit@1:0.032726	 hit@5:0.1091	 hit@10: 0.1610
target: 	 mrr: 0.068959	 ndcg_5: 0.0603	 ndcg_10: 0.0750	 hit@1:0.030923	 hit@5:0.0899	 hit@10: 0.1358
epoch 32: train_loss = 1.173934, source_hit@10 = 0.1610, source_ndcg@10 = 0.0885, target_hit@10 = 0.1358, target_ndcg@10 = 0.0750

2024-08-03 21:32:58.264205: step 31251/75760 (epoch 33/80), loss = 1.172493 (561.589 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068748	 ndcg_5: 0.0608	 ndcg_10: 0.0754	 hit@1:0.028986	 hit@5:0.0927	 hit@10: 0.1382
target: 	 mrr: 0.064858	 ndcg_5: 0.0562	 ndcg_10: 0.0738	 hit@1:0.023752	 hit@5:0.0887	 hit@10: 0.1435
epoch 33: train_loss = 1.172493, source_hit@10 = 0.1382, source_ndcg@10 = 0.0754, target_hit@10 = 0.1435, target_ndcg@10 = 0.0738

2024-08-03 21:42:19.346837: step 32198/75760 (epoch 34/80), loss = 1.168590 (556.985 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.071718	 ndcg_5: 0.0630	 ndcg_10: 0.0806	 hit@1:0.028674	 hit@5:0.0969	 hit@10: 0.1513
target: 	 mrr: 0.071214	 ndcg_5: 0.0624	 ndcg_10: 0.0784	 hit@1:0.029607	 hit@5:0.0950	 hit@10: 0.1448
epoch 34: train_loss = 1.168590, source_hit@10 = 0.1513, source_ndcg@10 = 0.0806, target_hit@10 = 0.1448, target_ndcg@10 = 0.0784

2024-08-03 21:51:45.807595: step 33145/75760 (epoch 35/80), loss = 1.167896 (562.550 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.075230	 ndcg_5: 0.0656	 ndcg_10: 0.0837	 hit@1:0.031011	 hit@5:0.0990	 hit@10: 0.1546
target: 	 mrr: 0.076166	 ndcg_5: 0.0656	 ndcg_10: 0.0832	 hit@1:0.032963	 hit@5:0.0975	 hit@10: 0.1524
epoch 35: train_loss = 1.167896, source_hit@10 = 0.1546, source_ndcg@10 = 0.0837, target_hit@10 = 0.1524, target_ndcg@10 = 0.0832

2024-08-03 22:01:13.549657: step 34092/75760 (epoch 36/80), loss = 1.169013 (563.875 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.035075	 ndcg_5: 0.0288	 ndcg_10: 0.0370	 hit@1:0.013090	 hit@5:0.0449	 hit@10: 0.0701
target: 	 mrr: 0.079690	 ndcg_5: 0.0711	 ndcg_10: 0.0876	 hit@1:0.037042	 hit@5:0.1043	 hit@10: 0.1559
epoch 36: train_loss = 1.169013, source_hit@10 = 0.0701, source_ndcg@10 = 0.0370, target_hit@10 = 0.1559, target_ndcg@10 = 0.0876

2024-08-03 22:10:36.231071: step 35039/75760 (epoch 37/80), loss = 1.164407 (558.790 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066082	 ndcg_5: 0.0552	 ndcg_10: 0.0740	 hit@1:0.026025	 hit@5:0.0838	 hit@10: 0.1418
target: 	 mrr: 0.086617	 ndcg_5: 0.0782	 ndcg_10: 0.0970	 hit@1:0.039213	 hit@5:0.1160	 hit@10: 0.1742
epoch 37: train_loss = 1.164407, source_hit@10 = 0.1418, source_ndcg@10 = 0.0740, target_hit@10 = 0.1742, target_ndcg@10 = 0.0970

2024-08-03 22:19:58.246867: step 35986/75760 (epoch 38/80), loss = 1.165803 (558.151 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.080779	 ndcg_5: 0.0733	 ndcg_10: 0.0889	 hit@1:0.038024	 hit@5:0.1086	 hit@10: 0.1571
target: 	 mrr: 0.044278	 ndcg_5: 0.0341	 ndcg_10: 0.0443	 hit@1:0.015659	 hit@5:0.0522	 hit@10: 0.0841
source best!
...............................................................
source: 	 mrr: 0.082496	 ndcg_5: 0.0741	 ndcg_10: 0.0919	 hit@1:0.036697	 hit@5:0.1098	 hit@10: 0.1650
epoch 38: train_loss = 1.165803, source_hit@10 = 0.1650, source_ndcg@10 = 0.0919, target_hit@10 = 0.0841, target_ndcg@10 = 0.0443

2024-08-03 22:29:21.584706: step 36933/75760 (epoch 39/80), loss = 1.160288 (558.399 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074893	 ndcg_5: 0.0658	 ndcg_10: 0.0845	 hit@1:0.031011	 hit@5:0.1002	 hit@10: 0.1582
target: 	 mrr: 0.082160	 ndcg_5: 0.0738	 ndcg_10: 0.0928	 hit@1:0.033094	 hit@5:0.1143	 hit@10: 0.1736
epoch 39: train_loss = 1.160288, source_hit@10 = 0.1582, source_ndcg@10 = 0.0845, target_hit@10 = 0.1736, target_ndcg@10 = 0.0928

2024-08-03 22:38:51.333760: step 37880/75760 (epoch 40/80), loss = 1.159366 (564.729 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074303	 ndcg_5: 0.0663	 ndcg_10: 0.0816	 hit@1:0.031323	 hit@5:0.1005	 hit@10: 0.1480
target: 	 mrr: 0.084682	 ndcg_5: 0.0766	 ndcg_10: 0.0951	 hit@1:0.036450	 hit@5:0.1171	 hit@10: 0.1744
epoch 40: train_loss = 1.159366, source_hit@10 = 0.1480, source_ndcg@10 = 0.0816, target_hit@10 = 0.1744, target_ndcg@10 = 0.0951
shift to transfer learning mode

2024-08-03 22:48:21.514478: step 38827/75760 (epoch 41/80), loss = 1.161678 (566.256 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074935	 ndcg_5: 0.0678	 ndcg_10: 0.0850	 hit@1:0.029609	 hit@5:0.1047	 hit@10: 0.1582
target: 	 mrr: 0.073225	 ndcg_5: 0.0642	 ndcg_10: 0.0828	 hit@1:0.025923	 hit@5:0.1027	 hit@10: 0.1604
epoch 41: train_loss = 1.161678, source_hit@10 = 0.1582, source_ndcg@10 = 0.0850, target_hit@10 = 0.1604, target_ndcg@10 = 0.0828

2024-08-03 22:57:52.780634: step 39774/75760 (epoch 42/80), loss = 1.158194 (567.163 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073361	 ndcg_5: 0.0652	 ndcg_10: 0.0818	 hit@1:0.029765	 hit@5:0.0988	 hit@10: 0.1504
target: 	 mrr: 0.079294	 ndcg_5: 0.0715	 ndcg_10: 0.0917	 hit@1:0.028883	 hit@5:0.1138	 hit@10: 0.1769
epoch 42: train_loss = 1.158194, source_hit@10 = 0.1504, source_ndcg@10 = 0.0818, target_hit@10 = 0.1769, target_ndcg@10 = 0.0917

2024-08-03 23:07:20.143877: step 40721/75760 (epoch 43/80), loss = 1.158370 (563.309 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078062	 ndcg_5: 0.0690	 ndcg_10: 0.0878	 hit@1:0.033505	 hit@5:0.1033	 hit@10: 0.1618
target: 	 mrr: 0.077952	 ndcg_5: 0.0685	 ndcg_10: 0.0889	 hit@1:0.028752	 hit@5:0.1069	 hit@10: 0.1705
epoch 43: train_loss = 1.158370, source_hit@10 = 0.1618, source_ndcg@10 = 0.0878, target_hit@10 = 0.1705, target_ndcg@10 = 0.0889

2024-08-03 23:16:49.739812: step 41668/75760 (epoch 44/80), loss = 1.157177 (565.752 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073840	 ndcg_5: 0.0674	 ndcg_10: 0.0843	 hit@1:0.027895	 hit@5:0.1060	 hit@10: 0.1582
target: 	 mrr: 0.074320	 ndcg_5: 0.0647	 ndcg_10: 0.0842	 hit@1:0.028620	 hit@5:0.1014	 hit@10: 0.1620
epoch 44: train_loss = 1.157177, source_hit@10 = 0.1582, source_ndcg@10 = 0.0843, target_hit@10 = 0.1620, target_ndcg@10 = 0.0842

2024-08-03 23:26:17.281923: step 42615/75760 (epoch 45/80), loss = 1.155030 (562.527 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.080841	 ndcg_5: 0.0746	 ndcg_10: 0.0897	 hit@1:0.034907	 hit@5:0.1138	 hit@10: 0.1611
target: 	 mrr: 0.080270	 ndcg_5: 0.0711	 ndcg_10: 0.0912	 hit@1:0.031384	 hit@5:0.1099	 hit@10: 0.1726
source best!
...............................................................
source: 	 mrr: 0.082696	 ndcg_5: 0.0750	 ndcg_10: 0.0915	 hit@1:0.035432	 hit@5:0.1129	 hit@10: 0.1639
epoch 45: train_loss = 1.155030, source_hit@10 = 0.1639, source_ndcg@10 = 0.0915, target_hit@10 = 0.1726, target_ndcg@10 = 0.0912

2024-08-03 23:35:46.279287: step 43562/75760 (epoch 46/80), loss = 1.153132 (563.758 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077621	 ndcg_5: 0.0695	 ndcg_10: 0.0870	 hit@1:0.032414	 hit@5:0.1057	 hit@10: 0.1605
target: 	 mrr: 0.075584	 ndcg_5: 0.0669	 ndcg_10: 0.0861	 hit@1:0.028949	 hit@5:0.1040	 hit@10: 0.1638
epoch 46: train_loss = 1.153132, source_hit@10 = 0.1605, source_ndcg@10 = 0.0870, target_hit@10 = 0.1638, target_ndcg@10 = 0.0861

2024-08-03 23:45:12.933769: step 44509/75760 (epoch 47/80), loss = 1.150009 (562.706 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.079943	 ndcg_5: 0.0714	 ndcg_10: 0.0901	 hit@1:0.033505	 hit@5:0.1080	 hit@10: 0.1661
target: 	 mrr: 0.077605	 ndcg_5: 0.0697	 ndcg_10: 0.0883	 hit@1:0.030265	 hit@5:0.1090	 hit@10: 0.1668
epoch 47: train_loss = 1.150009, source_hit@10 = 0.1661, source_ndcg@10 = 0.0901, target_hit@10 = 0.1668, target_ndcg@10 = 0.0883

2024-08-03 23:54:42.246831: step 45456/75760 (epoch 48/80), loss = 1.149350 (564.340 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.075700	 ndcg_5: 0.0671	 ndcg_10: 0.0852	 hit@1:0.030856	 hit@5:0.1021	 hit@10: 0.1582
target: 	 mrr: 0.082800	 ndcg_5: 0.0746	 ndcg_10: 0.0934	 hit@1:0.035529	 hit@5:0.1126	 hit@10: 0.1715
epoch 48: train_loss = 1.149350, source_hit@10 = 0.1582, source_ndcg@10 = 0.0852, target_hit@10 = 0.1715, target_ndcg@10 = 0.0934

2024-08-04 00:04:10.311013: step 46403/75760 (epoch 49/80), loss = 1.147496 (563.104 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078546	 ndcg_5: 0.0710	 ndcg_10: 0.0882	 hit@1:0.032414	 hit@5:0.1088	 hit@10: 0.1625
target: 	 mrr: 0.078373	 ndcg_5: 0.0695	 ndcg_10: 0.0904	 hit@1:0.028555	 hit@5:0.1107	 hit@10: 0.1753
epoch 49: train_loss = 1.147496, source_hit@10 = 0.1625, source_ndcg@10 = 0.0882, target_hit@10 = 0.1753, target_ndcg@10 = 0.0904

2024-08-04 00:13:41.795885: step 47350/75760 (epoch 50/80), loss = 1.144385 (567.477 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077433	 ndcg_5: 0.0704	 ndcg_10: 0.0880	 hit@1:0.031791	 hit@5:0.1086	 hit@10: 0.1635
target: 	 mrr: 0.075883	 ndcg_5: 0.0668	 ndcg_10: 0.0861	 hit@1:0.028752	 hit@5:0.1056	 hit@10: 0.1657
epoch 50: train_loss = 1.144385, source_hit@10 = 0.1635, source_ndcg@10 = 0.0880, target_hit@10 = 0.1657, target_ndcg@10 = 0.0861

2024-08-04 00:23:08.457222: step 48297/75760 (epoch 51/80), loss = 1.141997 (562.807 sec/epoch), lr: 0.001589
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073957	 ndcg_5: 0.0653	 ndcg_10: 0.0831	 hit@1:0.029141	 hit@5:0.1007	 hit@10: 0.1558
target: 	 mrr: 0.088076	 ndcg_5: 0.0785	 ndcg_10: 0.0980	 hit@1:0.039805	 hit@5:0.1161	 hit@10: 0.1765
target best!
......................................................................................................................................................target: 	 mrr: 0.090106	 ndcg_5: 0.0810	 ndcg_10: 0.1002	 hit@1:0.041919	 hit@5:0.1196	 hit@10: 0.1792
epoch 51: train_loss = 1.141997, source_hit@10 = 0.1558, source_ndcg@10 = 0.0831, target_hit@10 = 0.1792, target_ndcg@10 = 0.1002
early termination of training
