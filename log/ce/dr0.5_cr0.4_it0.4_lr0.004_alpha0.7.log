using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.7, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=1), device_id='1', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-04 19:20:25.886994: step 947/75760 (epoch 1/80), loss = 1.377011 (250.079 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.040494	 ndcg_5: 0.0268	 ndcg_10: 0.0444	 hit@1:0.010753	 hit@5:0.0439	 hit@10: 0.0988
target: 	 mrr: 0.073251	 ndcg_5: 0.0648	 ndcg_10: 0.0838	 hit@1:0.028226	 hit@5:0.1013	 hit@10: 0.1600
source best!
...............................................................
source: 	 mrr: 0.044902	 ndcg_5: 0.0323	 ndcg_10: 0.0495	 hit@1:0.012812	 hit@5:0.0528	 hit@10: 0.1066
target best!
......................................................................................................................................................target: 	 mrr: 0.074389	 ndcg_5: 0.0656	 ndcg_10: 0.0846	 hit@1:0.029097	 hit@5:0.1016	 hit@10: 0.1607
epoch 1: train_loss = 1.377011, source_hit@10 = 0.1066, source_ndcg@10 = 0.0495, target_hit@10 = 0.1607, target_ndcg@10 = 0.0846

2024-08-04 19:24:42.142777: step 1894/75760 (epoch 2/80), loss = 1.288843 (251.758 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057022	 ndcg_5: 0.0488	 ndcg_10: 0.0659	 hit@1:0.016674	 hit@5:0.0810	 hit@10: 0.1337
target: 	 mrr: 0.062382	 ndcg_5: 0.0516	 ndcg_10: 0.0727	 hit@1:0.018028	 hit@5:0.0866	 hit@10: 0.1518
source best!
...............................................................
source: 	 mrr: 0.060334	 ndcg_5: 0.0528	 ndcg_10: 0.0697	 hit@1:0.018823	 hit@5:0.0878	 hit@10: 0.1405
epoch 2: train_loss = 1.288843, source_hit@10 = 0.1405, source_ndcg@10 = 0.0697, target_hit@10 = 0.1518, target_ndcg@10 = 0.0727
new best model saved.

2024-08-04 19:28:56.853278: step 2841/75760 (epoch 3/80), loss = 1.279889 (251.463 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059837	 ndcg_5: 0.0511	 ndcg_10: 0.0673	 hit@1:0.022285	 hit@5:0.0803	 hit@10: 0.1303
target: 	 mrr: 0.073417	 ndcg_5: 0.0664	 ndcg_10: 0.0834	 hit@1:0.027765	 hit@5:0.1048	 hit@10: 0.1576
source best!
...............................................................
source: 	 mrr: 0.063409	 ndcg_5: 0.0547	 ndcg_10: 0.0716	 hit@1:0.024518	 hit@5:0.0849	 hit@10: 0.1373
target best!
......................................................................................................................................................target: 	 mrr: 0.073507	 ndcg_5: 0.0658	 ndcg_10: 0.0840	 hit@1:0.027702	 hit@5:0.1038	 hit@10: 0.1602
epoch 3: train_loss = 1.279889, source_hit@10 = 0.1373, source_ndcg@10 = 0.0716, target_hit@10 = 0.1602, target_ndcg@10 = 0.0840
new best model saved.

2024-08-04 19:33:14.175240: step 3788/75760 (epoch 4/80), loss = 1.275915 (252.467 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061463	 ndcg_5: 0.0541	 ndcg_10: 0.0695	 hit@1:0.022908	 hit@5:0.0848	 hit@10: 0.1328
target: 	 mrr: 0.068006	 ndcg_5: 0.0593	 ndcg_10: 0.0797	 hit@1:0.022501	 hit@5:0.0972	 hit@10: 0.1603
source best!
...............................................................
source: 	 mrr: 0.062785	 ndcg_5: 0.0548	 ndcg_10: 0.0710	 hit@1:0.023252	 hit@5:0.0859	 hit@10: 0.1360
epoch 4: train_loss = 1.275915, source_hit@10 = 0.1360, source_ndcg@10 = 0.0710, target_hit@10 = 0.1603, target_ndcg@10 = 0.0797

2024-08-04 19:37:29.285220: step 4735/75760 (epoch 5/80), loss = 1.262538 (252.119 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056460	 ndcg_5: 0.0498	 ndcg_10: 0.0633	 hit@1:0.018856	 hit@5:0.0815	 hit@10: 0.1234
target: 	 mrr: 0.066823	 ndcg_5: 0.0572	 ndcg_10: 0.0764	 hit@1:0.022765	 hit@5:0.0921	 hit@10: 0.1520
epoch 5: train_loss = 1.262538, source_hit@10 = 0.1234, source_ndcg@10 = 0.0633, target_hit@10 = 0.1520, target_ndcg@10 = 0.0764

2024-08-04 19:41:43.422673: step 5682/75760 (epoch 6/80), loss = 1.245975 (251.825 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069742	 ndcg_5: 0.0617	 ndcg_10: 0.0787	 hit@1:0.027895	 hit@5:0.0954	 hit@10: 0.1480
target: 	 mrr: 0.077779	 ndcg_5: 0.0704	 ndcg_10: 0.0880	 hit@1:0.030594	 hit@5:0.1094	 hit@10: 0.1640
source best!
...............................................................
source: 	 mrr: 0.071639	 ndcg_5: 0.0618	 ndcg_10: 0.0799	 hit@1:0.030370	 hit@5:0.0933	 hit@10: 0.1498
target best!
......................................................................................................................................................target: 	 mrr: 0.081479	 ndcg_5: 0.0739	 ndcg_10: 0.0923	 hit@1:0.034478	 hit@5:0.1133	 hit@10: 0.1706
epoch 6: train_loss = 1.245975, source_hit@10 = 0.1498, source_ndcg@10 = 0.0799, target_hit@10 = 0.1706, target_ndcg@10 = 0.0923
new best model saved.

2024-08-04 19:46:00.495091: step 6629/75760 (epoch 7/80), loss = 1.237610 (252.207 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051671	 ndcg_5: 0.0472	 ndcg_10: 0.0581	 hit@1:0.021661	 hit@5:0.0722	 hit@10: 0.1061
target: 	 mrr: 0.049773	 ndcg_5: 0.0365	 ndcg_10: 0.0517	 hit@1:0.013356	 hit@5:0.0597	 hit@10: 0.1072
epoch 7: train_loss = 1.237610, source_hit@10 = 0.1061, source_ndcg@10 = 0.0581, target_hit@10 = 0.1072, target_ndcg@10 = 0.0517

2024-08-04 19:50:15.402358: step 7576/75760 (epoch 8/80), loss = 1.233100 (252.574 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060252	 ndcg_5: 0.0503	 ndcg_10: 0.0669	 hit@1:0.020570	 hit@5:0.0787	 hit@10: 0.1303
target: 	 mrr: 0.077351	 ndcg_5: 0.0685	 ndcg_10: 0.0866	 hit@1:0.032700	 hit@5:0.1039	 hit@10: 0.1603
epoch 8: train_loss = 1.233100, source_hit@10 = 0.1303, source_ndcg@10 = 0.0669, target_hit@10 = 0.1603, target_ndcg@10 = 0.0866

2024-08-04 19:54:29.815178: step 8523/75760 (epoch 9/80), loss = 1.230939 (252.108 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062979	 ndcg_5: 0.0555	 ndcg_10: 0.0710	 hit@1:0.023999	 hit@5:0.0877	 hit@10: 0.1364
target: 	 mrr: 0.082026	 ndcg_5: 0.0730	 ndcg_10: 0.0915	 hit@1:0.036516	 hit@5:0.1084	 hit@10: 0.1659
target best!
......................................................................................................................................................target: 	 mrr: 0.084267	 ndcg_5: 0.0766	 ndcg_10: 0.0926	 hit@1:0.038730	 hit@5:0.1139	 hit@10: 0.1635
epoch 9: train_loss = 1.230939, source_hit@10 = 0.1364, source_ndcg@10 = 0.0710, target_hit@10 = 0.1635, target_ndcg@10 = 0.0926

2024-08-04 19:58:46.674484: step 9470/75760 (epoch 10/80), loss = 1.229951 (252.958 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.040410	 ndcg_5: 0.0322	 ndcg_10: 0.0425	 hit@1:0.015739	 hit@5:0.0486	 hit@10: 0.0809
target: 	 mrr: 0.074130	 ndcg_5: 0.0641	 ndcg_10: 0.0810	 hit@1:0.032173	 hit@5:0.0957	 hit@10: 0.1481
epoch 10: train_loss = 1.229951, source_hit@10 = 0.0809, source_ndcg@10 = 0.0425, target_hit@10 = 0.1481, target_ndcg@10 = 0.0810

2024-08-04 20:03:01.403823: step 10417/75760 (epoch 11/80), loss = 1.227422 (252.389 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064735	 ndcg_5: 0.0557	 ndcg_10: 0.0710	 hit@1:0.027895	 hit@5:0.0832	 hit@10: 0.1309
target: 	 mrr: 0.079611	 ndcg_5: 0.0705	 ndcg_10: 0.0884	 hit@1:0.034805	 hit@5:0.1054	 hit@10: 0.1611
epoch 11: train_loss = 1.227422, source_hit@10 = 0.1309, source_ndcg@10 = 0.0710, target_hit@10 = 0.1611, target_ndcg@10 = 0.0884

2024-08-04 20:07:16.703711: step 11364/75760 (epoch 12/80), loss = 1.225364 (252.899 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064572	 ndcg_5: 0.0564	 ndcg_10: 0.0712	 hit@1:0.025090	 hit@5:0.0868	 hit@10: 0.1329
target: 	 mrr: 0.086439	 ndcg_5: 0.0784	 ndcg_10: 0.0970	 hit@1:0.038753	 hit@5:0.1168	 hit@10: 0.1747
target best!
......................................................................................................................................................target: 	 mrr: 0.087971	 ndcg_5: 0.0799	 ndcg_10: 0.0986	 hit@1:0.040324	 hit@5:0.1177	 hit@10: 0.1760
epoch 12: train_loss = 1.225364, source_hit@10 = 0.1329, source_ndcg@10 = 0.0712, target_hit@10 = 0.1760, target_ndcg@10 = 0.0986

2024-08-04 20:11:34.307865: step 12311/75760 (epoch 13/80), loss = 1.222300 (253.765 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067311	 ndcg_5: 0.0591	 ndcg_10: 0.0740	 hit@1:0.029609	 hit@5:0.0896	 hit@10: 0.1357
target: 	 mrr: 0.067212	 ndcg_5: 0.0586	 ndcg_10: 0.0734	 hit@1:0.025396	 hit@5:0.0907	 hit@10: 0.1370
epoch 13: train_loss = 1.222300, source_hit@10 = 0.1357, source_ndcg@10 = 0.0740, target_hit@10 = 0.1370, target_ndcg@10 = 0.0734

2024-08-04 20:15:48.602623: step 13258/75760 (epoch 14/80), loss = 1.214611 (251.915 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059161	 ndcg_5: 0.0509	 ndcg_10: 0.0657	 hit@1:0.022752	 hit@5:0.0778	 hit@10: 0.1240
target: 	 mrr: 0.067334	 ndcg_5: 0.0564	 ndcg_10: 0.0763	 hit@1:0.025725	 hit@5:0.0876	 hit@10: 0.1495
epoch 14: train_loss = 1.214611, source_hit@10 = 0.1240, source_ndcg@10 = 0.0657, target_hit@10 = 0.1495, target_ndcg@10 = 0.0763

2024-08-04 20:20:02.686423: step 14205/75760 (epoch 15/80), loss = 1.208119 (251.786 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.058613	 ndcg_5: 0.0514	 ndcg_10: 0.0665	 hit@1:0.019324	 hit@5:0.0832	 hit@10: 0.1301
target: 	 mrr: 0.072507	 ndcg_5: 0.0640	 ndcg_10: 0.0819	 hit@1:0.026975	 hit@5:0.1011	 hit@10: 0.1570
epoch 15: train_loss = 1.208119, source_hit@10 = 0.1301, source_ndcg@10 = 0.0665, target_hit@10 = 0.1570, target_ndcg@10 = 0.0819

2024-08-04 20:24:16.621856: step 15152/75760 (epoch 16/80), loss = 1.205972 (251.626 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.055876	 ndcg_5: 0.0461	 ndcg_10: 0.0623	 hit@1:0.018077	 hit@5:0.0740	 hit@10: 0.1242
target: 	 mrr: 0.073313	 ndcg_5: 0.0652	 ndcg_10: 0.0832	 hit@1:0.027699	 hit@5:0.1038	 hit@10: 0.1598
epoch 16: train_loss = 1.205972, source_hit@10 = 0.1242, source_ndcg@10 = 0.0623, target_hit@10 = 0.1598, target_ndcg@10 = 0.0832

2024-08-04 20:28:31.187986: step 16099/75760 (epoch 17/80), loss = 1.200967 (252.257 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052379	 ndcg_5: 0.0445	 ndcg_10: 0.0574	 hit@1:0.019324	 hit@5:0.0698	 hit@10: 0.1099
target: 	 mrr: 0.055326	 ndcg_5: 0.0421	 ndcg_10: 0.0620	 hit@1:0.015856	 hit@5:0.0697	 hit@10: 0.1315
epoch 17: train_loss = 1.200967, source_hit@10 = 0.1099, source_ndcg@10 = 0.0574, target_hit@10 = 0.1315, target_ndcg@10 = 0.0620

2024-08-04 20:32:46.003832: step 17046/75760 (epoch 18/80), loss = 1.192452 (252.462 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074240	 ndcg_5: 0.0658	 ndcg_10: 0.0838	 hit@1:0.030700	 hit@5:0.1011	 hit@10: 0.1569
target: 	 mrr: 0.067223	 ndcg_5: 0.0574	 ndcg_10: 0.0772	 hit@1:0.021449	 hit@5:0.0940	 hit@10: 0.1559
source best!
...............................................................
source: 	 mrr: 0.080945	 ndcg_5: 0.0743	 ndcg_10: 0.0908	 hit@1:0.034641	 hit@5:0.1131	 hit@10: 0.1643
epoch 18: train_loss = 1.192452, source_hit@10 = 0.1643, source_ndcg@10 = 0.0908, target_hit@10 = 0.1559, target_ndcg@10 = 0.0772

2024-08-04 20:37:00.619135: step 17993/75760 (epoch 19/80), loss = 1.189645 (251.690 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065632	 ndcg_5: 0.0562	 ndcg_10: 0.0743	 hit@1:0.023531	 hit@5:0.0885	 hit@10: 0.1446
target: 	 mrr: 0.069428	 ndcg_5: 0.0589	 ndcg_10: 0.0780	 hit@1:0.024738	 hit@5:0.0934	 hit@10: 0.1525
epoch 19: train_loss = 1.189645, source_hit@10 = 0.1446, source_ndcg@10 = 0.0743, target_hit@10 = 0.1525, target_ndcg@10 = 0.0780

2024-08-04 20:41:15.735217: step 18940/75760 (epoch 20/80), loss = 1.187368 (252.817 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077118	 ndcg_5: 0.0686	 ndcg_10: 0.0865	 hit@1:0.033505	 hit@5:0.1030	 hit@10: 0.1582
target: 	 mrr: 0.067077	 ndcg_5: 0.0580	 ndcg_10: 0.0781	 hit@1:0.021449	 hit@5:0.0961	 hit@10: 0.1584
source best!
...............................................................
source: 	 mrr: 0.079511	 ndcg_5: 0.0715	 ndcg_10: 0.0888	 hit@1:0.035274	 hit@5:0.1072	 hit@10: 0.1607
epoch 20: train_loss = 1.187368, source_hit@10 = 0.1607, source_ndcg@10 = 0.0888, target_hit@10 = 0.1584, target_ndcg@10 = 0.0781

2024-08-04 20:45:31.287119: step 19887/75760 (epoch 21/80), loss = 1.183785 (252.618 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.042471	 ndcg_5: 0.0343	 ndcg_10: 0.0456	 hit@1:0.015116	 hit@5:0.0535	 hit@10: 0.0884
target: 	 mrr: 0.058402	 ndcg_5: 0.0477	 ndcg_10: 0.0674	 hit@1:0.016777	 hit@5:0.0788	 hit@10: 0.1401
epoch 21: train_loss = 1.183785, source_hit@10 = 0.0884, source_ndcg@10 = 0.0456, target_hit@10 = 0.1401, target_ndcg@10 = 0.0674

2024-08-04 20:49:46.022818: step 20834/75760 (epoch 22/80), loss = 1.181904 (252.419 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056280	 ndcg_5: 0.0493	 ndcg_10: 0.0625	 hit@1:0.020103	 hit@5:0.0785	 hit@10: 0.1194
target: 	 mrr: 0.082058	 ndcg_5: 0.0744	 ndcg_10: 0.0929	 hit@1:0.034081	 hit@5:0.1146	 hit@10: 0.1719
epoch 22: train_loss = 1.181904, source_hit@10 = 0.1194, source_ndcg@10 = 0.0625, target_hit@10 = 0.1719, target_ndcg@10 = 0.0929

2024-08-04 20:54:00.180219: step 21781/75760 (epoch 23/80), loss = 1.181166 (251.855 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070938	 ndcg_5: 0.0644	 ndcg_10: 0.0808	 hit@1:0.026492	 hit@5:0.1007	 hit@10: 0.1515
target: 	 mrr: 0.072971	 ndcg_5: 0.0647	 ndcg_10: 0.0817	 hit@1:0.027962	 hit@5:0.0997	 hit@10: 0.1526
epoch 23: train_loss = 1.181166, source_hit@10 = 0.1515, source_ndcg@10 = 0.0808, target_hit@10 = 0.1526, target_ndcg@10 = 0.0817

2024-08-04 20:58:14.918159: step 22728/75760 (epoch 24/80), loss = 1.182120 (252.432 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.022414	 ndcg_5: 0.0160	 ndcg_10: 0.0201	 hit@1:0.008259	 hit@5:0.0232	 hit@10: 0.0362
target: 	 mrr: 0.076971	 ndcg_5: 0.0692	 ndcg_10: 0.0864	 hit@1:0.030331	 hit@5:0.1076	 hit@10: 0.1613
epoch 24: train_loss = 1.182120, source_hit@10 = 0.0362, source_ndcg@10 = 0.0201, target_hit@10 = 0.1613, target_ndcg@10 = 0.0864

2024-08-04 21:02:28.721831: step 23675/75760 (epoch 25/80), loss = 1.178367 (251.495 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064470	 ndcg_5: 0.0563	 ndcg_10: 0.0718	 hit@1:0.023687	 hit@5:0.0874	 hit@10: 0.1356
target: 	 mrr: 0.078950	 ndcg_5: 0.0706	 ndcg_10: 0.0874	 hit@1:0.034673	 hit@5:0.1062	 hit@10: 0.1584
epoch 25: train_loss = 1.178367, source_hit@10 = 0.1356, source_ndcg@10 = 0.0718, target_hit@10 = 0.1584, target_ndcg@10 = 0.0874

2024-08-04 21:06:43.444850: step 24622/75760 (epoch 26/80), loss = 1.178847 (252.425 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.075738	 ndcg_5: 0.0688	 ndcg_10: 0.0864	 hit@1:0.030700	 hit@5:0.1074	 hit@10: 0.1616
target: 	 mrr: 0.084616	 ndcg_5: 0.0763	 ndcg_10: 0.0936	 hit@1:0.037897	 hit@5:0.1140	 hit@10: 0.1680
epoch 26: train_loss = 1.178847, source_hit@10 = 0.1616, source_ndcg@10 = 0.0864, target_hit@10 = 0.1680, target_ndcg@10 = 0.0936

2024-08-04 21:10:58.223259: step 25569/75760 (epoch 27/80), loss = 1.175612 (252.489 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074388	 ndcg_5: 0.0651	 ndcg_10: 0.0838	 hit@1:0.029141	 hit@5:0.1004	 hit@10: 0.1582
target: 	 mrr: 0.082438	 ndcg_5: 0.0746	 ndcg_10: 0.0908	 hit@1:0.037371	 hit@5:0.1110	 hit@10: 0.1615
epoch 27: train_loss = 1.175612, source_hit@10 = 0.1582, source_ndcg@10 = 0.0838, target_hit@10 = 0.1615, target_ndcg@10 = 0.0908

2024-08-04 21:15:12.109953: step 26516/75760 (epoch 28/80), loss = 1.172321 (251.586 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064668	 ndcg_5: 0.0551	 ndcg_10: 0.0732	 hit@1:0.024934	 hit@5:0.0854	 hit@10: 0.1413
target: 	 mrr: 0.076684	 ndcg_5: 0.0674	 ndcg_10: 0.0860	 hit@1:0.030463	 hit@5:0.1037	 hit@10: 0.1615
epoch 28: train_loss = 1.172321, source_hit@10 = 0.1413, source_ndcg@10 = 0.0732, target_hit@10 = 0.1615, target_ndcg@10 = 0.0860

2024-08-04 21:19:27.362911: step 27463/75760 (epoch 29/80), loss = 1.169894 (252.938 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069744	 ndcg_5: 0.0603	 ndcg_10: 0.0774	 hit@1:0.028050	 hit@5:0.0927	 hit@10: 0.1460
target: 	 mrr: 0.074733	 ndcg_5: 0.0660	 ndcg_10: 0.0840	 hit@1:0.029081	 hit@5:0.1031	 hit@10: 0.1593
epoch 29: train_loss = 1.169894, source_hit@10 = 0.1460, source_ndcg@10 = 0.0774, target_hit@10 = 0.1593, target_ndcg@10 = 0.0840

2024-08-04 21:23:42.310478: step 28410/75760 (epoch 30/80), loss = 1.169191 (252.616 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063607	 ndcg_5: 0.0548	 ndcg_10: 0.0715	 hit@1:0.023999	 hit@5:0.0856	 hit@10: 0.1370
target: 	 mrr: 0.063469	 ndcg_5: 0.0528	 ndcg_10: 0.0716	 hit@1:0.020396	 hit@5:0.0845	 hit@10: 0.1430
epoch 30: train_loss = 1.169191, source_hit@10 = 0.1370, source_ndcg@10 = 0.0715, target_hit@10 = 0.1430, target_ndcg@10 = 0.0716

2024-08-04 21:27:56.474676: step 29357/75760 (epoch 31/80), loss = 1.166889 (251.830 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065511	 ndcg_5: 0.0576	 ndcg_10: 0.0726	 hit@1:0.023687	 hit@5:0.0916	 hit@10: 0.1382
target: 	 mrr: 0.079741	 ndcg_5: 0.0715	 ndcg_10: 0.0891	 hit@1:0.034147	 hit@5:0.1087	 hit@10: 0.1634
epoch 31: train_loss = 1.166889, source_hit@10 = 0.1382, source_ndcg@10 = 0.0726, target_hit@10 = 0.1634, target_ndcg@10 = 0.0891

2024-08-04 21:32:11.172574: step 30304/75760 (epoch 32/80), loss = 1.164736 (252.396 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072928	 ndcg_5: 0.0641	 ndcg_10: 0.0820	 hit@1:0.028986	 hit@5:0.0980	 hit@10: 0.1540
target: 	 mrr: 0.077726	 ndcg_5: 0.0702	 ndcg_10: 0.0887	 hit@1:0.030528	 hit@5:0.1100	 hit@10: 0.1675
epoch 32: train_loss = 1.164736, source_hit@10 = 0.1540, source_ndcg@10 = 0.0820, target_hit@10 = 0.1675, target_ndcg@10 = 0.0887

2024-08-04 21:36:25.471893: step 31251/75760 (epoch 33/80), loss = 1.165954 (251.985 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077745	 ndcg_5: 0.0694	 ndcg_10: 0.0869	 hit@1:0.032570	 hit@5:0.1052	 hit@10: 0.1599
target: 	 mrr: 0.071743	 ndcg_5: 0.0623	 ndcg_10: 0.0814	 hit@1:0.026515	 hit@5:0.0979	 hit@10: 0.1573
source best!
...............................................................
source: 	 mrr: 0.084798	 ndcg_5: 0.0765	 ndcg_10: 0.0942	 hit@1:0.038121	 hit@5:0.1129	 hit@10: 0.1681
epoch 33: train_loss = 1.165954, source_hit@10 = 0.1681, source_ndcg@10 = 0.0942, target_hit@10 = 0.1573, target_ndcg@10 = 0.0814

2024-08-04 21:40:40.531639: step 32198/75760 (epoch 34/80), loss = 1.161230 (252.122 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078905	 ndcg_5: 0.0699	 ndcg_10: 0.0879	 hit@1:0.034596	 hit@5:0.1049	 hit@10: 0.1607
target: 	 mrr: 0.073669	 ndcg_5: 0.0651	 ndcg_10: 0.0837	 hit@1:0.026975	 hit@5:0.1036	 hit@10: 0.1609
source best!
...............................................................
source: 	 mrr: 0.079363	 ndcg_5: 0.0719	 ndcg_10: 0.0907	 hit@1:0.030528	 hit@5:0.1121	 hit@10: 0.1707
epoch 34: train_loss = 1.161230, source_hit@10 = 0.1707, source_ndcg@10 = 0.0907, target_hit@10 = 0.1609, target_ndcg@10 = 0.0837

2024-08-04 21:44:56.546197: step 33145/75760 (epoch 35/80), loss = 1.160990 (253.054 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.075912	 ndcg_5: 0.0671	 ndcg_10: 0.0836	 hit@1:0.032881	 hit@5:0.1008	 hit@10: 0.1523
target: 	 mrr: 0.074417	 ndcg_5: 0.0660	 ndcg_10: 0.0835	 hit@1:0.028686	 hit@5:0.1031	 hit@10: 0.1572
epoch 35: train_loss = 1.160990, source_hit@10 = 0.1523, source_ndcg@10 = 0.0836, target_hit@10 = 0.1572, target_ndcg@10 = 0.0835

2024-08-04 21:49:10.987851: step 34092/75760 (epoch 36/80), loss = 1.160376 (252.133 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076073	 ndcg_5: 0.0682	 ndcg_10: 0.0857	 hit@1:0.030856	 hit@5:0.1050	 hit@10: 0.1594
target: 	 mrr: 0.078222	 ndcg_5: 0.0707	 ndcg_10: 0.0877	 hit@1:0.033555	 hit@5:0.1074	 hit@10: 0.1605
epoch 36: train_loss = 1.160376, source_hit@10 = 0.1594, source_ndcg@10 = 0.0857, target_hit@10 = 0.1605, target_ndcg@10 = 0.0877

2024-08-04 21:53:24.616783: step 35039/75760 (epoch 37/80), loss = 1.158201 (251.309 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074440	 ndcg_5: 0.0672	 ndcg_10: 0.0826	 hit@1:0.031635	 hit@5:0.1022	 hit@10: 0.1507
target: 	 mrr: 0.060306	 ndcg_5: 0.0506	 ndcg_10: 0.0669	 hit@1:0.021383	 hit@5:0.0797	 hit@10: 0.1304
epoch 37: train_loss = 1.158201, source_hit@10 = 0.1507, source_ndcg@10 = 0.0826, target_hit@10 = 0.1304, target_ndcg@10 = 0.0669

2024-08-04 21:57:38.444415: step 35986/75760 (epoch 38/80), loss = 1.157580 (251.521 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072081	 ndcg_5: 0.0627	 ndcg_10: 0.0809	 hit@1:0.029297	 hit@5:0.0958	 hit@10: 0.1523
target: 	 mrr: 0.078004	 ndcg_5: 0.0706	 ndcg_10: 0.0895	 hit@1:0.029344	 hit@5:0.1117	 hit@10: 0.1704
epoch 38: train_loss = 1.157580, source_hit@10 = 0.1523, source_ndcg@10 = 0.0809, target_hit@10 = 0.1704, target_ndcg@10 = 0.0895

2024-08-04 22:01:52.645194: step 36933/75760 (epoch 39/80), loss = 1.153947 (251.899 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076904	 ndcg_5: 0.0700	 ndcg_10: 0.0870	 hit@1:0.031635	 hit@5:0.1075	 hit@10: 0.1602
target: 	 mrr: 0.075962	 ndcg_5: 0.0678	 ndcg_10: 0.0860	 hit@1:0.030265	 hit@5:0.1047	 hit@10: 0.1612
epoch 39: train_loss = 1.153947, source_hit@10 = 0.1602, source_ndcg@10 = 0.0870, target_hit@10 = 0.1612, target_ndcg@10 = 0.0860

2024-08-04 22:06:06.941394: step 37880/75760 (epoch 40/80), loss = 1.153135 (252.007 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072778	 ndcg_5: 0.0652	 ndcg_10: 0.0823	 hit@1:0.028518	 hit@5:0.1010	 hit@10: 0.1544
target: 	 mrr: 0.068648	 ndcg_5: 0.0600	 ndcg_10: 0.0775	 hit@1:0.025199	 hit@5:0.0950	 hit@10: 0.1492
epoch 40: train_loss = 1.153135, source_hit@10 = 0.1544, source_ndcg@10 = 0.0823, target_hit@10 = 0.1492, target_ndcg@10 = 0.0775
shift to transfer learning mode

2024-08-04 22:10:24.717258: step 38827/75760 (epoch 41/80), loss = 1.151717 (255.480 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065024	 ndcg_5: 0.0571	 ndcg_10: 0.0727	 hit@1:0.025401	 hit@5:0.0868	 hit@10: 0.1353
target: 	 mrr: 0.083692	 ndcg_5: 0.0751	 ndcg_10: 0.0938	 hit@1:0.034937	 hit@5:0.1138	 hit@10: 0.1723
epoch 41: train_loss = 1.151717, source_hit@10 = 0.1353, source_ndcg@10 = 0.0727, target_hit@10 = 0.1723, target_ndcg@10 = 0.0938

2024-08-04 22:14:41.891514: step 39774/75760 (epoch 42/80), loss = 1.152470 (254.882 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077914	 ndcg_5: 0.0695	 ndcg_10: 0.0869	 hit@1:0.033193	 hit@5:0.1055	 hit@10: 0.1596
target: 	 mrr: 0.080666	 ndcg_5: 0.0726	 ndcg_10: 0.0906	 hit@1:0.033489	 hit@5:0.1113	 hit@10: 0.1674
epoch 42: train_loss = 1.152470, source_hit@10 = 0.1596, source_ndcg@10 = 0.0869, target_hit@10 = 0.1674, target_ndcg@10 = 0.0906

2024-08-04 22:18:59.666824: step 40721/75760 (epoch 43/80), loss = 1.150280 (255.456 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078165	 ndcg_5: 0.0707	 ndcg_10: 0.0883	 hit@1:0.031946	 hit@5:0.1092	 hit@10: 0.1639
target: 	 mrr: 0.086372	 ndcg_5: 0.0782	 ndcg_10: 0.0975	 hit@1:0.037502	 hit@5:0.1185	 hit@10: 0.1784
epoch 43: train_loss = 1.150280, source_hit@10 = 0.1639, source_ndcg@10 = 0.0883, target_hit@10 = 0.1784, target_ndcg@10 = 0.0975

2024-08-04 22:23:17.177741: step 41668/75760 (epoch 44/80), loss = 1.150207 (255.203 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076738	 ndcg_5: 0.0678	 ndcg_10: 0.0846	 hit@1:0.034128	 hit@5:0.1008	 hit@10: 0.1529
target: 	 mrr: 0.078086	 ndcg_5: 0.0688	 ndcg_10: 0.0871	 hit@1:0.031844	 hit@5:0.1052	 hit@10: 0.1618
epoch 44: train_loss = 1.150207, source_hit@10 = 0.1529, source_ndcg@10 = 0.0846, target_hit@10 = 0.1618, target_ndcg@10 = 0.0871

2024-08-04 22:27:34.889255: step 42615/75760 (epoch 45/80), loss = 1.148638 (255.319 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065392	 ndcg_5: 0.0557	 ndcg_10: 0.0725	 hit@1:0.027115	 hit@5:0.0834	 hit@10: 0.1356
target: 	 mrr: 0.079955	 ndcg_5: 0.0714	 ndcg_10: 0.0888	 hit@1:0.032831	 hit@5:0.1093	 hit@10: 0.1636
epoch 45: train_loss = 1.148638, source_hit@10 = 0.1356, source_ndcg@10 = 0.0725, target_hit@10 = 0.1636, target_ndcg@10 = 0.0888

2024-08-04 22:31:51.858089: step 43562/75760 (epoch 46/80), loss = 1.145224 (254.653 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.079907	 ndcg_5: 0.0703	 ndcg_10: 0.0893	 hit@1:0.035063	 hit@5:0.1046	 hit@10: 0.1636
target: 	 mrr: 0.074718	 ndcg_5: 0.0651	 ndcg_10: 0.0844	 hit@1:0.028423	 hit@5:0.1018	 hit@10: 0.1621
source best!
...............................................................
source: 	 mrr: 0.081720	 ndcg_5: 0.0734	 ndcg_10: 0.0916	 hit@1:0.034008	 hit@5:0.1117	 hit@10: 0.1681
epoch 46: train_loss = 1.145224, source_hit@10 = 0.1681, source_ndcg@10 = 0.0916, target_hit@10 = 0.1621, target_ndcg@10 = 0.0844

2024-08-04 22:36:09.532838: step 44509/75760 (epoch 47/80), loss = 1.145506 (254.716 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072279	 ndcg_5: 0.0645	 ndcg_10: 0.0805	 hit@1:0.030388	 hit@5:0.0980	 hit@10: 0.1477
target: 	 mrr: 0.069175	 ndcg_5: 0.0589	 ndcg_10: 0.0774	 hit@1:0.026844	 hit@5:0.0915	 hit@10: 0.1490
epoch 47: train_loss = 1.145506, source_hit@10 = 0.1477, source_ndcg@10 = 0.0805, target_hit@10 = 0.1490, target_ndcg@10 = 0.0774

2024-08-04 22:40:27.901652: step 45456/75760 (epoch 48/80), loss = 1.142970 (256.047 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063209	 ndcg_5: 0.0564	 ndcg_10: 0.0727	 hit@1:0.022285	 hit@5:0.0905	 hit@10: 0.1413
target: 	 mrr: 0.084476	 ndcg_5: 0.0765	 ndcg_10: 0.0960	 hit@1:0.034410	 hit@5:0.1178	 hit@10: 0.1784
epoch 48: train_loss = 1.142970, source_hit@10 = 0.1413, source_ndcg@10 = 0.0727, target_hit@10 = 0.1784, target_ndcg@10 = 0.0960

2024-08-04 22:44:45.917089: step 46403/75760 (epoch 49/80), loss = 1.141147 (255.721 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078297	 ndcg_5: 0.0719	 ndcg_10: 0.0874	 hit@1:0.031791	 hit@5:0.1122	 hit@10: 0.1605
target: 	 mrr: 0.071956	 ndcg_5: 0.0643	 ndcg_10: 0.0795	 hit@1:0.027897	 hit@5:0.1005	 hit@10: 0.1480
epoch 49: train_loss = 1.141147, source_hit@10 = 0.1605, source_ndcg@10 = 0.0874, target_hit@10 = 0.1480, target_ndcg@10 = 0.0795

2024-08-04 22:49:03.330945: step 47350/75760 (epoch 50/80), loss = 1.139340 (255.073 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077046	 ndcg_5: 0.0677	 ndcg_10: 0.0874	 hit@1:0.032102	 hit@5:0.1029	 hit@10: 0.1639
target: 	 mrr: 0.081832	 ndcg_5: 0.0747	 ndcg_10: 0.0910	 hit@1:0.037108	 hit@5:0.1119	 hit@10: 0.1625
epoch 50: train_loss = 1.139340, source_hit@10 = 0.1639, source_ndcg@10 = 0.0874, target_hit@10 = 0.1625, target_ndcg@10 = 0.0910

2024-08-04 22:53:20.685764: step 48297/75760 (epoch 51/80), loss = 1.136620 (255.029 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077476	 ndcg_5: 0.0697	 ndcg_10: 0.0868	 hit@1:0.032570	 hit@5:0.1069	 hit@10: 0.1602
target: 	 mrr: 0.085647	 ndcg_5: 0.0759	 ndcg_10: 0.0953	 hit@1:0.038687	 hit@5:0.1122	 hit@10: 0.1725
epoch 51: train_loss = 1.136620, source_hit@10 = 0.1602, source_ndcg@10 = 0.0868, target_hit@10 = 0.1725, target_ndcg@10 = 0.0953
early termination of training
