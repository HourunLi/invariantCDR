nohup: ignoring input
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:54: UserWarning: An issue occurred while importing 'pyg-lib'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'pyg-lib'. "
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:110: UserWarning: An issue occurred while importing 'torch-sparse'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'torch-sparse'. "
using gpu:5 to train the model
using gpu:5 to train the model
cuda:5
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=5), device_id='5', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.5, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:68: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /opt/conda/conda-bld/pytorch_1711403590347/work/torch/csrc/utils/tensor_new.cpp:618.)
  return torch.sparse.FloatTensor(indices, values, shape)
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-03 19:43:07.509802: step 947/75760 (epoch 1/80), loss = 1.201381 (693.136 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.042771	 ndcg_5: 0.0348	 ndcg_10: 0.0472	 hit@1:0.013869	 hit@5:0.0564	 hit@10: 0.0954
target: 	 mrr: 0.070665	 ndcg_5: 0.0663	 ndcg_10: 0.0806	 hit@1:0.026646	 hit@5:0.1059	 hit@10: 0.1499
source best!
...............................................................
source: 	 mrr: 0.048449	 ndcg_5: 0.0411	 ndcg_10: 0.0533	 hit@1:0.016767	 hit@5:0.0650	 hit@10: 0.1036
target best!
......................................................................................................................................................target: 	 mrr: 0.071111	 ndcg_5: 0.0662	 ndcg_10: 0.0808	 hit@1:0.027835	 hit@5:0.1039	 hit@10: 0.1491
epoch 1: train_loss = 1.201381, source_hit@10 = 0.1036, source_ndcg@10 = 0.0533, target_hit@10 = 0.1491, target_ndcg@10 = 0.0808

2024-08-03 19:54:48.637223: step 1894/75760 (epoch 2/80), loss = 1.136549 (690.102 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069268	 ndcg_5: 0.0605	 ndcg_10: 0.0776	 hit@1:0.028830	 hit@5:0.0918	 hit@10: 0.1454
target: 	 mrr: 0.068159	 ndcg_5: 0.0625	 ndcg_10: 0.0769	 hit@1:0.026054	 hit@5:0.0979	 hit@10: 0.1429
source best!
...............................................................
source: 	 mrr: 0.071758	 ndcg_5: 0.0638	 ndcg_10: 0.0801	 hit@1:0.029105	 hit@5:0.0982	 hit@10: 0.1490
epoch 2: train_loss = 1.136549, source_hit@10 = 0.1490, source_ndcg@10 = 0.0801, target_hit@10 = 0.1429, target_ndcg@10 = 0.0769
new best model saved.

2024-08-03 20:06:29.582400: step 2841/75760 (epoch 3/80), loss = 1.125490 (693.464 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069535	 ndcg_5: 0.0621	 ndcg_10: 0.0778	 hit@1:0.028986	 hit@5:0.0949	 hit@10: 0.1437
target: 	 mrr: 0.064905	 ndcg_5: 0.0577	 ndcg_10: 0.0720	 hit@1:0.025067	 hit@5:0.0888	 hit@10: 0.1334
source best!
...............................................................
source: 	 mrr: 0.072904	 ndcg_5: 0.0656	 ndcg_10: 0.0822	 hit@1:0.029737	 hit@5:0.1004	 hit@10: 0.1519
epoch 3: train_loss = 1.125490, source_hit@10 = 0.1519, source_ndcg@10 = 0.0822, target_hit@10 = 0.1334, target_ndcg@10 = 0.0720

2024-08-03 20:18:26.082728: step 3788/75760 (epoch 4/80), loss = 1.113403 (709.833 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063979	 ndcg_5: 0.0567	 ndcg_10: 0.0726	 hit@1:0.023687	 hit@5:0.0898	 hit@10: 0.1392
target: 	 mrr: 0.065226	 ndcg_5: 0.0572	 ndcg_10: 0.0723	 hit@1:0.024607	 hit@5:0.0884	 hit@10: 0.1355
epoch 4: train_loss = 1.113403, source_hit@10 = 0.1392, source_ndcg@10 = 0.0726, target_hit@10 = 0.1355, target_ndcg@10 = 0.0723

2024-08-03 20:29:54.398195: step 4735/75760 (epoch 5/80), loss = 1.081824 (682.832 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061924	 ndcg_5: 0.0529	 ndcg_10: 0.0689	 hit@1:0.023220	 hit@5:0.0843	 hit@10: 0.1346
target: 	 mrr: 0.037465	 ndcg_5: 0.0298	 ndcg_10: 0.0381	 hit@1:0.014409	 hit@5:0.0452	 hit@10: 0.0709
epoch 5: train_loss = 1.081824, source_hit@10 = 0.1346, source_ndcg@10 = 0.0689, target_hit@10 = 0.0709, target_ndcg@10 = 0.0381

2024-08-03 20:41:23.003484: step 5682/75760 (epoch 6/80), loss = 1.042786 (683.109 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.041333	 ndcg_5: 0.0322	 ndcg_10: 0.0454	 hit@1:0.011999	 hit@5:0.0516	 hit@10: 0.0927
target: 	 mrr: 0.067997	 ndcg_5: 0.0580	 ndcg_10: 0.0759	 hit@1:0.024936	 hit@5:0.0905	 hit@10: 0.1460
epoch 6: train_loss = 1.042786, source_hit@10 = 0.0927, source_ndcg@10 = 0.0454, target_hit@10 = 0.1460, target_ndcg@10 = 0.0759

2024-08-03 20:52:58.123918: step 6629/75760 (epoch 7/80), loss = 1.036022 (689.676 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.036240	 ndcg_5: 0.0271	 ndcg_10: 0.0388	 hit@1:0.011064	 hit@5:0.0433	 hit@10: 0.0798
target: 	 mrr: 0.044896	 ndcg_5: 0.0313	 ndcg_10: 0.0453	 hit@1:0.013882	 hit@5:0.0493	 hit@10: 0.0930
epoch 7: train_loss = 1.036022, source_hit@10 = 0.0798, source_ndcg@10 = 0.0388, target_hit@10 = 0.0930, target_ndcg@10 = 0.0453

2024-08-03 21:04:30.646357: step 7576/75760 (epoch 8/80), loss = 1.030016 (687.550 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065745	 ndcg_5: 0.0586	 ndcg_10: 0.0746	 hit@1:0.024622	 hit@5:0.0923	 hit@10: 0.1420
target: 	 mrr: 0.063836	 ndcg_5: 0.0534	 ndcg_10: 0.0723	 hit@1:0.021712	 hit@5:0.0863	 hit@10: 0.1449
epoch 8: train_loss = 1.030016, source_hit@10 = 0.1420, source_ndcg@10 = 0.0746, target_hit@10 = 0.1449, target_ndcg@10 = 0.0723

2024-08-03 21:16:05.706507: step 8523/75760 (epoch 9/80), loss = 1.024317 (689.593 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.043734	 ndcg_5: 0.0353	 ndcg_10: 0.0481	 hit@1:0.013402	 hit@5:0.0575	 hit@10: 0.0976
target: 	 mrr: 0.059033	 ndcg_5: 0.0482	 ndcg_10: 0.0656	 hit@1:0.020330	 hit@5:0.0771	 hit@10: 0.1313
epoch 9: train_loss = 1.024317, source_hit@10 = 0.0976, source_ndcg@10 = 0.0481, target_hit@10 = 0.1313, target_ndcg@10 = 0.0656

2024-08-03 21:27:40.499052: step 9470/75760 (epoch 10/80), loss = 1.020750 (689.765 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.032138	 ndcg_5: 0.0251	 ndcg_10: 0.0327	 hit@1:0.012311	 hit@5:0.0372	 hit@10: 0.0611
target: 	 mrr: 0.063969	 ndcg_5: 0.0572	 ndcg_10: 0.0736	 hit@1:0.020857	 hit@5:0.0941	 hit@10: 0.1451
epoch 10: train_loss = 1.020750, source_hit@10 = 0.0611, source_ndcg@10 = 0.0327, target_hit@10 = 0.1451, target_ndcg@10 = 0.0736

2024-08-03 21:39:17.136681: step 10417/75760 (epoch 11/80), loss = 1.018724 (691.138 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059656	 ndcg_5: 0.0531	 ndcg_10: 0.0679	 hit@1:0.021038	 hit@5:0.0849	 hit@10: 0.1311
target: 	 mrr: 0.049271	 ndcg_5: 0.0395	 ndcg_10: 0.0551	 hit@1:0.014014	 hit@5:0.0665	 hit@10: 0.1150
epoch 11: train_loss = 1.018724, source_hit@10 = 0.1311, source_ndcg@10 = 0.0679, target_hit@10 = 0.1150, target_ndcg@10 = 0.0551

2024-08-03 21:50:50.423945: step 11364/75760 (epoch 12/80), loss = 1.018459 (688.086 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053161	 ndcg_5: 0.0414	 ndcg_10: 0.0594	 hit@1:0.018544	 hit@5:0.0651	 hit@10: 0.1216
target: 	 mrr: 0.050260	 ndcg_5: 0.0386	 ndcg_10: 0.0569	 hit@1:0.014080	 hit@5:0.0642	 hit@10: 0.1213
epoch 12: train_loss = 1.018459, source_hit@10 = 0.1216, source_ndcg@10 = 0.0594, target_hit@10 = 0.1213, target_ndcg@10 = 0.0569

2024-08-03 22:02:25.998588: step 12311/75760 (epoch 13/80), loss = 1.013458 (690.167 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.023622	 ndcg_5: 0.0161	 ndcg_10: 0.0230	 hit@1:0.006857	 hit@5:0.0260	 hit@10: 0.0475
target: 	 mrr: 0.054043	 ndcg_5: 0.0420	 ndcg_10: 0.0597	 hit@1:0.016646	 hit@5:0.0679	 hit@10: 0.1232
epoch 13: train_loss = 1.013458, source_hit@10 = 0.0475, source_ndcg@10 = 0.0230, target_hit@10 = 0.1232, target_ndcg@10 = 0.0597

2024-08-03 22:13:53.662907: step 13258/75760 (epoch 14/80), loss = 1.007058 (682.414 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.039175	 ndcg_5: 0.0298	 ndcg_10: 0.0395	 hit@1:0.014025	 hit@5:0.0455	 hit@10: 0.0757
target: 	 mrr: 0.050155	 ndcg_5: 0.0399	 ndcg_10: 0.0555	 hit@1:0.012303	 hit@5:0.0682	 hit@10: 0.1169
epoch 14: train_loss = 1.007058, source_hit@10 = 0.0757, source_ndcg@10 = 0.0395, target_hit@10 = 0.1169, target_ndcg@10 = 0.0555

2024-08-03 22:25:24.012294: step 14205/75760 (epoch 15/80), loss = 1.005482 (685.057 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.033697	 ndcg_5: 0.0256	 ndcg_10: 0.0341	 hit@1:0.009662	 hit@5:0.0422	 hit@10: 0.0687
target: 	 mrr: 0.062733	 ndcg_5: 0.0528	 ndcg_10: 0.0731	 hit@1:0.018356	 hit@5:0.0884	 hit@10: 0.1513
epoch 15: train_loss = 1.005482, source_hit@10 = 0.0687, source_ndcg@10 = 0.0341, target_hit@10 = 0.1513, target_ndcg@10 = 0.0731

2024-08-03 22:36:56.492012: step 15152/75760 (epoch 16/80), loss = 1.003761 (686.952 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069303	 ndcg_5: 0.0604	 ndcg_10: 0.0784	 hit@1:0.026492	 hit@5:0.0929	 hit@10: 0.1493
target: 	 mrr: 0.077634	 ndcg_5: 0.0684	 ndcg_10: 0.0869	 hit@1:0.030134	 hit@5:0.1055	 hit@10: 0.1630
target best!
......................................................................................................................................................target: 	 mrr: 0.079248	 ndcg_5: 0.0695	 ndcg_10: 0.0880	 hit@1:0.032950	 hit@5:0.1059	 hit@10: 0.1634
epoch 16: train_loss = 1.003761, source_hit@10 = 0.1493, source_ndcg@10 = 0.0784, target_hit@10 = 0.1634, target_ndcg@10 = 0.0880
new best model saved.

2024-08-03 22:48:33.631665: step 16099/75760 (epoch 17/80), loss = 0.996437 (688.276 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060821	 ndcg_5: 0.0515	 ndcg_10: 0.0685	 hit@1:0.021505	 hit@5:0.0810	 hit@10: 0.1342
target: 	 mrr: 0.043226	 ndcg_5: 0.0331	 ndcg_10: 0.0461	 hit@1:0.009935	 hit@5:0.0568	 hit@10: 0.0974
epoch 17: train_loss = 0.996437, source_hit@10 = 0.1342, source_ndcg@10 = 0.0685, target_hit@10 = 0.0974, target_ndcg@10 = 0.0461

2024-08-03 23:00:07.225803: step 17046/75760 (epoch 18/80), loss = 0.989155 (687.994 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.071988	 ndcg_5: 0.0635	 ndcg_10: 0.0809	 hit@1:0.028518	 hit@5:0.0993	 hit@10: 0.1530
target: 	 mrr: 0.075429	 ndcg_5: 0.0665	 ndcg_10: 0.0841	 hit@1:0.029476	 hit@5:0.1036	 hit@10: 0.1583
source best!
...............................................................
source: 	 mrr: 0.077017	 ndcg_5: 0.0688	 ndcg_10: 0.0860	 hit@1:0.031636	 hit@5:0.1053	 hit@10: 0.1588
epoch 18: train_loss = 0.989155, source_hit@10 = 0.1588, source_ndcg@10 = 0.0860, target_hit@10 = 0.1583, target_ndcg@10 = 0.0841
new best model saved.

2024-08-03 23:11:42.431381: step 17993/75760 (epoch 19/80), loss = 0.987288 (688.416 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.042617	 ndcg_5: 0.0335	 ndcg_10: 0.0440	 hit@1:0.014804	 hit@5:0.0524	 hit@10: 0.0852
target: 	 mrr: 0.080843	 ndcg_5: 0.0721	 ndcg_10: 0.0909	 hit@1:0.032765	 hit@5:0.1103	 hit@10: 0.1687
target best!
......................................................................................................................................................target: 	 mrr: 0.081473	 ndcg_5: 0.0728	 ndcg_10: 0.0917	 hit@1:0.033282	 hit@5:0.1116	 hit@10: 0.1700
epoch 19: train_loss = 0.987288, source_hit@10 = 0.0852, source_ndcg@10 = 0.0440, target_hit@10 = 0.1700, target_ndcg@10 = 0.0917

2024-08-03 23:23:19.337119: step 18940/75760 (epoch 20/80), loss = 0.985035 (687.875 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.071290	 ndcg_5: 0.0643	 ndcg_10: 0.0826	 hit@1:0.025869	 hit@5:0.1035	 hit@10: 0.1605
target: 	 mrr: 0.067970	 ndcg_5: 0.0607	 ndcg_10: 0.0785	 hit@1:0.023752	 hit@5:0.0980	 hit@10: 0.1531
epoch 20: train_loss = 0.985035, source_hit@10 = 0.1605, source_ndcg@10 = 0.0826, target_hit@10 = 0.1531, target_ndcg@10 = 0.0785

2024-08-03 23:34:49.982658: step 19887/75760 (epoch 21/80), loss = 0.982890 (685.132 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054015	 ndcg_5: 0.0461	 ndcg_10: 0.0610	 hit@1:0.017921	 hit@5:0.0748	 hit@10: 0.1209
target: 	 mrr: 0.080662	 ndcg_5: 0.0719	 ndcg_10: 0.0890	 hit@1:0.033226	 hit@5:0.1096	 hit@10: 0.1624
epoch 21: train_loss = 0.982890, source_hit@10 = 0.1209, source_ndcg@10 = 0.0610, target_hit@10 = 0.1624, target_ndcg@10 = 0.0890

2024-08-03 23:46:20.300488: step 20834/75760 (epoch 22/80), loss = 0.982398 (684.787 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064328	 ndcg_5: 0.0546	 ndcg_10: 0.0738	 hit@1:0.021350	 hit@5:0.0880	 hit@10: 0.1477
target: 	 mrr: 0.073619	 ndcg_5: 0.0616	 ndcg_10: 0.0805	 hit@1:0.030134	 hit@5:0.0934	 hit@10: 0.1522
epoch 22: train_loss = 0.982398, source_hit@10 = 0.1477, source_ndcg@10 = 0.0738, target_hit@10 = 0.1522, target_ndcg@10 = 0.0805

2024-08-04 00:14:18.155662: step 21781/75760 (epoch 23/80), loss = 0.981008 (1672.804 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060742	 ndcg_5: 0.0510	 ndcg_10: 0.0680	 hit@1:0.021038	 hit@5:0.0813	 hit@10: 0.1342
target: 	 mrr: 0.051390	 ndcg_5: 0.0408	 ndcg_10: 0.0565	 hit@1:0.012764	 hit@5:0.0701	 hit@10: 0.1195
epoch 23: train_loss = 0.981008, source_hit@10 = 0.1342, source_ndcg@10 = 0.0680, target_hit@10 = 0.1195, target_ndcg@10 = 0.0565

2024-08-04 00:48:51.587223: step 22728/75760 (epoch 24/80), loss = 0.979016 (2066.680 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065138	 ndcg_5: 0.0587	 ndcg_10: 0.0736	 hit@1:0.024310	 hit@5:0.0924	 hit@10: 0.1390
target: 	 mrr: 0.070201	 ndcg_5: 0.0578	 ndcg_10: 0.0774	 hit@1:0.027502	 hit@5:0.0877	 hit@10: 0.1491
epoch 24: train_loss = 0.979016, source_hit@10 = 0.1390, source_ndcg@10 = 0.0736, target_hit@10 = 0.1491, target_ndcg@10 = 0.0774

2024-08-04 01:23:52.771864: step 23675/75760 (epoch 25/80), loss = 0.977581 (2070.705 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.040266	 ndcg_5: 0.0327	 ndcg_10: 0.0435	 hit@1:0.012623	 hit@5:0.0525	 hit@10: 0.0860
target: 	 mrr: 0.078975	 ndcg_5: 0.0684	 ndcg_10: 0.0870	 hit@1:0.032634	 hit@5:0.1038	 hit@10: 0.1615
epoch 25: train_loss = 0.977581, source_hit@10 = 0.0860, source_ndcg@10 = 0.0435, target_hit@10 = 0.1615, target_ndcg@10 = 0.0870

2024-08-04 01:57:04.979890: step 24622/75760 (epoch 26/80), loss = 0.976571 (1959.788 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067599	 ndcg_5: 0.0591	 ndcg_10: 0.0739	 hit@1:0.026648	 hit@5:0.0910	 hit@10: 0.1373
target: 	 mrr: 0.079937	 ndcg_5: 0.0699	 ndcg_10: 0.0873	 hit@1:0.035989	 hit@5:0.1038	 hit@10: 0.1581
epoch 26: train_loss = 0.976571, source_hit@10 = 0.1373, source_ndcg@10 = 0.0739, target_hit@10 = 0.1581, target_ndcg@10 = 0.0873

2024-08-04 02:32:06.937396: step 25569/75760 (epoch 27/80), loss = 0.972648 (2071.139 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063117	 ndcg_5: 0.0548	 ndcg_10: 0.0705	 hit@1:0.022129	 hit@5:0.0879	 hit@10: 0.1365
target: 	 mrr: 0.080577	 ndcg_5: 0.0713	 ndcg_10: 0.0901	 hit@1:0.033226	 hit@5:0.1089	 hit@10: 0.1672
epoch 27: train_loss = 0.972648, source_hit@10 = 0.1365, source_ndcg@10 = 0.0705, target_hit@10 = 0.1672, target_ndcg@10 = 0.0901

2024-08-04 03:07:10.266148: step 26516/75760 (epoch 28/80), loss = 0.970377 (2071.295 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076329	 ndcg_5: 0.0678	 ndcg_10: 0.0856	 hit@1:0.031167	 hit@5:0.1025	 hit@10: 0.1580
target: 	 mrr: 0.063254	 ndcg_5: 0.0529	 ndcg_10: 0.0715	 hit@1:0.020593	 hit@5:0.0862	 hit@10: 0.1439
source best!
...............................................................
source: 	 mrr: 0.078203	 ndcg_5: 0.0703	 ndcg_10: 0.0886	 hit@1:0.032426	 hit@5:0.1080	 hit@10: 0.1650
epoch 28: train_loss = 0.970377, source_hit@10 = 0.1650, source_ndcg@10 = 0.0886, target_hit@10 = 0.1439, target_ndcg@10 = 0.0715

2024-08-04 03:40:11.584878: step 27463/75760 (epoch 29/80), loss = 0.969322 (1973.351 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070234	 ndcg_5: 0.0612	 ndcg_10: 0.0784	 hit@1:0.027739	 hit@5:0.0944	 hit@10: 0.1477
target: 	 mrr: 0.067008	 ndcg_5: 0.0551	 ndcg_10: 0.0741	 hit@1:0.025265	 hit@5:0.0857	 hit@10: 0.1452
epoch 29: train_loss = 0.969322, source_hit@10 = 0.1477, source_ndcg@10 = 0.0784, target_hit@10 = 0.1452, target_ndcg@10 = 0.0741

2024-08-04 04:15:18.059240: step 28410/75760 (epoch 30/80), loss = 0.966799 (2073.493 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070614	 ndcg_5: 0.0639	 ndcg_10: 0.0784	 hit@1:0.030076	 hit@5:0.0977	 hit@10: 0.1427
target: 	 mrr: 0.082697	 ndcg_5: 0.0739	 ndcg_10: 0.0932	 hit@1:0.035068	 hit@5:0.1122	 hit@10: 0.1722
target best!
......................................................................................................................................................target: 	 mrr: 0.083729	 ndcg_5: 0.0748	 ndcg_10: 0.0939	 hit@1:0.035608	 hit@5:0.1135	 hit@10: 0.1726
epoch 30: train_loss = 0.966799, source_hit@10 = 0.1427, source_ndcg@10 = 0.0784, target_hit@10 = 0.1726, target_ndcg@10 = 0.0939

2024-08-04 04:49:03.900765: step 29357/75760 (epoch 31/80), loss = 0.966523 (1972.720 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066490	 ndcg_5: 0.0598	 ndcg_10: 0.0755	 hit@1:0.024778	 hit@5:0.0944	 hit@10: 0.1437
target: 	 mrr: 0.073928	 ndcg_5: 0.0635	 ndcg_10: 0.0817	 hit@1:0.028489	 hit@5:0.0990	 hit@10: 0.1559
epoch 31: train_loss = 0.966523, source_hit@10 = 0.1437, source_ndcg@10 = 0.0755, target_hit@10 = 0.1559, target_ndcg@10 = 0.0817

2024-08-04 05:24:02.902277: step 30304/75760 (epoch 32/80), loss = 0.963842 (2071.003 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067192	 ndcg_5: 0.0605	 ndcg_10: 0.0771	 hit@1:0.023064	 hit@5:0.0976	 hit@10: 0.1493
target: 	 mrr: 0.086680	 ndcg_5: 0.0783	 ndcg_10: 0.0965	 hit@1:0.036976	 hit@5:0.1186	 hit@10: 0.1753
target best!
......................................................................................................................................................target: 	 mrr: 0.087120	 ndcg_5: 0.0785	 ndcg_10: 0.0977	 hit@1:0.037335	 hit@5:0.1188	 hit@10: 0.1787
epoch 32: train_loss = 0.963842, source_hit@10 = 0.1493, source_ndcg@10 = 0.0771, target_hit@10 = 0.1787, target_ndcg@10 = 0.0977

2024-08-04 06:00:14.609305: step 31251/75760 (epoch 33/80), loss = 0.964994 (2116.053 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.071720	 ndcg_5: 0.0643	 ndcg_10: 0.0805	 hit@1:0.028674	 hit@5:0.0997	 hit@10: 0.1502
target: 	 mrr: 0.077993	 ndcg_5: 0.0665	 ndcg_10: 0.0861	 hit@1:0.033094	 hit@5:0.0999	 hit@10: 0.1611
epoch 33: train_loss = 0.964994, source_hit@10 = 0.1502, source_ndcg@10 = 0.0805, target_hit@10 = 0.1611, target_ndcg@10 = 0.0861

2024-08-04 06:35:28.974640: step 32198/75760 (epoch 34/80), loss = 0.960699 (2107.360 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072872	 ndcg_5: 0.0649	 ndcg_10: 0.0822	 hit@1:0.028206	 hit@5:0.1010	 hit@10: 0.1547
target: 	 mrr: 0.070531	 ndcg_5: 0.0613	 ndcg_10: 0.0784	 hit@1:0.026975	 hit@5:0.0953	 hit@10: 0.1487
epoch 34: train_loss = 0.960699, source_hit@10 = 0.1547, source_ndcg@10 = 0.0822, target_hit@10 = 0.1487, target_ndcg@10 = 0.0784

2024-08-04 07:11:29.905354: step 33145/75760 (epoch 35/80), loss = 0.959951 (2130.127 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069057	 ndcg_5: 0.0608	 ndcg_10: 0.0768	 hit@1:0.026960	 hit@5:0.0938	 hit@10: 0.1437
target: 	 mrr: 0.083800	 ndcg_5: 0.0746	 ndcg_10: 0.0927	 hit@1:0.035923	 hit@5:0.1118	 hit@10: 0.1682
epoch 35: train_loss = 0.959951, source_hit@10 = 0.1437, source_ndcg@10 = 0.0768, target_hit@10 = 0.1682, target_ndcg@10 = 0.0927

2024-08-04 07:46:39.319877: step 34092/75760 (epoch 36/80), loss = 0.960394 (2078.904 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.071683	 ndcg_5: 0.0628	 ndcg_10: 0.0808	 hit@1:0.027583	 hit@5:0.0966	 hit@10: 0.1521
target: 	 mrr: 0.087966	 ndcg_5: 0.0793	 ndcg_10: 0.0987	 hit@1:0.036647	 hit@5:0.1209	 hit@10: 0.1811
target best!
......................................................................................................................................................target: 	 mrr: 0.090648	 ndcg_5: 0.0826	 ndcg_10: 0.1024	 hit@1:0.037600	 hit@5:0.1260	 hit@10: 0.1877
epoch 36: train_loss = 0.960394, source_hit@10 = 0.1521, source_ndcg@10 = 0.0808, target_hit@10 = 0.1877, target_ndcg@10 = 0.1024

2024-08-04 08:23:08.949194: step 35039/75760 (epoch 37/80), loss = 0.958916 (2135.809 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068804	 ndcg_5: 0.0602	 ndcg_10: 0.0791	 hit@1:0.023375	 hit@5:0.0968	 hit@10: 0.1558
target: 	 mrr: 0.081156	 ndcg_5: 0.0720	 ndcg_10: 0.0904	 hit@1:0.033226	 hit@5:0.1104	 hit@10: 0.1676
epoch 37: train_loss = 0.958916, source_hit@10 = 0.1558, source_ndcg@10 = 0.0791, target_hit@10 = 0.1676, target_ndcg@10 = 0.0904

2024-08-04 08:58:25.347887: step 35986/75760 (epoch 38/80), loss = 0.959472 (2085.608 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062618	 ndcg_5: 0.0537	 ndcg_10: 0.0706	 hit@1:0.023064	 hit@5:0.0843	 hit@10: 0.1365
target: 	 mrr: 0.068905	 ndcg_5: 0.0583	 ndcg_10: 0.0758	 hit@1:0.029015	 hit@5:0.0872	 hit@10: 0.1417
epoch 38: train_loss = 0.959472, source_hit@10 = 0.1365, source_ndcg@10 = 0.0706, target_hit@10 = 0.1417, target_ndcg@10 = 0.0758

2024-08-04 09:20:37.909205: step 36933/75760 (epoch 39/80), loss = 0.955362 (1300.103 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069656	 ndcg_5: 0.0622	 ndcg_10: 0.0789	 hit@1:0.028986	 hit@5:0.0957	 hit@10: 0.1476
target: 	 mrr: 0.080849	 ndcg_5: 0.0717	 ndcg_10: 0.0904	 hit@1:0.032765	 hit@5:0.1107	 hit@10: 0.1689
epoch 39: train_loss = 0.955362, source_hit@10 = 0.1476, source_ndcg@10 = 0.0789, target_hit@10 = 0.1689, target_ndcg@10 = 0.0904

2024-08-04 09:32:07.388258: step 37880/75760 (epoch 40/80), loss = 0.955112 (684.005 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068508	 ndcg_5: 0.0609	 ndcg_10: 0.0777	 hit@1:0.025401	 hit@5:0.0966	 hit@10: 0.1490
target: 	 mrr: 0.071809	 ndcg_5: 0.0637	 ndcg_10: 0.0812	 hit@1:0.025791	 hit@5:0.1019	 hit@10: 0.1563
epoch 40: train_loss = 0.955112, source_hit@10 = 0.1490, source_ndcg@10 = 0.0777, target_hit@10 = 0.1563, target_ndcg@10 = 0.0812
shift to transfer learning mode

2024-08-04 09:43:42.577551: step 38827/75760 (epoch 41/80), loss = 0.953562 (689.781 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076653	 ndcg_5: 0.0678	 ndcg_10: 0.0868	 hit@1:0.031635	 hit@5:0.1035	 hit@10: 0.1625
target: 	 mrr: 0.067928	 ndcg_5: 0.0561	 ndcg_10: 0.0728	 hit@1:0.027897	 hit@5:0.0839	 hit@10: 0.1361
source best!
...............................................................
source: 	 mrr: 0.080516	 ndcg_5: 0.0718	 ndcg_10: 0.0901	 hit@1:0.033850	 hit@5:0.1085	 hit@10: 0.1651
epoch 41: train_loss = 0.953562, source_hit@10 = 0.1651, source_ndcg@10 = 0.0901, target_hit@10 = 0.1361, target_ndcg@10 = 0.0728

2024-08-04 09:55:23.857524: step 39774/75760 (epoch 42/80), loss = 0.952940 (694.648 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074728	 ndcg_5: 0.0659	 ndcg_10: 0.0842	 hit@1:0.030388	 hit@5:0.1011	 hit@10: 0.1580
target: 	 mrr: 0.070230	 ndcg_5: 0.0581	 ndcg_10: 0.0766	 hit@1:0.027633	 hit@5:0.0876	 hit@10: 0.1456
epoch 42: train_loss = 0.952940, source_hit@10 = 0.1580, source_ndcg@10 = 0.0842, target_hit@10 = 0.1456, target_ndcg@10 = 0.0766

2024-08-04 10:07:03.674020: step 40721/75760 (epoch 43/80), loss = 0.953582 (694.402 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073709	 ndcg_5: 0.0651	 ndcg_10: 0.0834	 hit@1:0.030076	 hit@5:0.1000	 hit@10: 0.1571
target: 	 mrr: 0.078966	 ndcg_5: 0.0699	 ndcg_10: 0.0898	 hit@1:0.029147	 hit@5:0.1105	 hit@10: 0.1726
epoch 43: train_loss = 0.953582, source_hit@10 = 0.1571, source_ndcg@10 = 0.0834, target_hit@10 = 0.1726, target_ndcg@10 = 0.0898

2024-08-04 10:18:44.972852: step 41668/75760 (epoch 44/80), loss = 0.952556 (696.087 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067317	 ndcg_5: 0.0584	 ndcg_10: 0.0757	 hit@1:0.025869	 hit@5:0.0912	 hit@10: 0.1451
target: 	 mrr: 0.081544	 ndcg_5: 0.0719	 ndcg_10: 0.0912	 hit@1:0.032371	 hit@5:0.1105	 hit@10: 0.1704
epoch 44: train_loss = 0.952556, source_hit@10 = 0.1451, source_ndcg@10 = 0.0757, target_hit@10 = 0.1704, target_ndcg@10 = 0.0912

2024-08-04 10:30:20.311142: step 42615/75760 (epoch 45/80), loss = 0.950989 (689.987 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.079339	 ndcg_5: 0.0716	 ndcg_10: 0.0899	 hit@1:0.032258	 hit@5:0.1105	 hit@10: 0.1669
target: 	 mrr: 0.086584	 ndcg_5: 0.0785	 ndcg_10: 0.0962	 hit@1:0.038095	 hit@5:0.1177	 hit@10: 0.1727
source best!
...............................................................
source: 	 mrr: 0.080441	 ndcg_5: 0.0719	 ndcg_10: 0.0893	 hit@1:0.034325	 hit@5:0.1085	 hit@10: 0.1626
epoch 45: train_loss = 0.950989, source_hit@10 = 0.1626, source_ndcg@10 = 0.0893, target_hit@10 = 0.1727, target_ndcg@10 = 0.0962
new best model saved.

