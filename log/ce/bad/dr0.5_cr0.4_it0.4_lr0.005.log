nohup: ignoring input
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:54: UserWarning: An issue occurred while importing 'pyg-lib'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'pyg-lib'. "
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:110: UserWarning: An issue occurred while importing 'torch-sparse'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'torch-sparse'. "
using gpu:3 to train the model
using gpu:3 to train the model
cuda:3
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=3), device_id='3', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.005, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:68: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /opt/conda/conda-bld/pytorch_1711403590347/work/torch/csrc/utils/tensor_new.cpp:618.)
  return torch.sparse.FloatTensor(indices, values, shape)
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-03 19:42:31.612733: step 947/75760 (epoch 1/80), loss = 1.378806 (691.621 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.058657	 ndcg_5: 0.0491	 ndcg_10: 0.0656	 hit@1:0.020259	 hit@5:0.0776	 hit@10: 0.1289
target: 	 mrr: 0.054643	 ndcg_5: 0.0457	 ndcg_10: 0.0625	 hit@1:0.017764	 hit@5:0.0742	 hit@10: 0.1266
source best!
...............................................................
source: 	 mrr: 0.061546	 ndcg_5: 0.0516	 ndcg_10: 0.0688	 hit@1:0.022145	 hit@5:0.0808	 hit@10: 0.1348
target best!
......................................................................................................................................................target: 	 mrr: 0.055421	 ndcg_5: 0.0465	 ndcg_10: 0.0621	 hit@1:0.019000	 hit@5:0.0745	 hit@10: 0.1230
epoch 1: train_loss = 1.378806, source_hit@10 = 0.1348, source_ndcg@10 = 0.0688, target_hit@10 = 0.1230, target_ndcg@10 = 0.0621

2024-08-03 19:54:13.037166: step 1894/75760 (epoch 2/80), loss = 1.279661 (690.613 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059970	 ndcg_5: 0.0497	 ndcg_10: 0.0681	 hit@1:0.021661	 hit@5:0.0789	 hit@10: 0.1359
target: 	 mrr: 0.058447	 ndcg_5: 0.0487	 ndcg_10: 0.0666	 hit@1:0.019212	 hit@5:0.0790	 hit@10: 0.1347
source best!
...............................................................
source: 	 mrr: 0.067030	 ndcg_5: 0.0565	 ndcg_10: 0.0743	 hit@1:0.027048	 hit@5:0.0854	 hit@10: 0.1409
target best!
......................................................................................................................................................target: 	 mrr: 0.062447	 ndcg_5: 0.0533	 ndcg_10: 0.0712	 hit@1:0.022122	 hit@5:0.0848	 hit@10: 0.1406
epoch 2: train_loss = 1.279661, source_hit@10 = 0.1409, source_ndcg@10 = 0.0743, target_hit@10 = 0.1406, target_ndcg@10 = 0.0712
new best model saved.

2024-08-03 20:05:55.748016: step 2841/75760 (epoch 3/80), loss = 1.265902 (691.580 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065913	 ndcg_5: 0.0583	 ndcg_10: 0.0730	 hit@1:0.025713	 hit@5:0.0915	 hit@10: 0.1367
target: 	 mrr: 0.051186	 ndcg_5: 0.0393	 ndcg_10: 0.0562	 hit@1:0.014475	 hit@5:0.0655	 hit@10: 0.1186
source best!
...............................................................
source: 	 mrr: 0.068940	 ndcg_5: 0.0622	 ndcg_10: 0.0785	 hit@1:0.025308	 hit@5:0.0982	 hit@10: 0.1492
epoch 3: train_loss = 1.265902, source_hit@10 = 0.1492, source_ndcg@10 = 0.0785, target_hit@10 = 0.1186, target_ndcg@10 = 0.0562

2024-08-03 20:17:50.941870: step 3788/75760 (epoch 4/80), loss = 1.260346 (708.113 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.019213	 ndcg_5: 0.0113	 ndcg_10: 0.0165	 hit@1:0.004208	 hit@5:0.0189	 hit@10: 0.0352
target: 	 mrr: 0.037299	 ndcg_5: 0.0247	 ndcg_10: 0.0351	 hit@1:0.011448	 hit@5:0.0380	 hit@10: 0.0707
epoch 4: train_loss = 1.260346, source_hit@10 = 0.0352, source_ndcg@10 = 0.0165, target_hit@10 = 0.0707, target_ndcg@10 = 0.0351

2024-08-03 20:29:14.519047: step 4735/75760 (epoch 5/80), loss = 1.252524 (678.563 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060111	 ndcg_5: 0.0499	 ndcg_10: 0.0670	 hit@1:0.021505	 hit@5:0.0792	 hit@10: 0.1326
target: 	 mrr: 0.030882	 ndcg_5: 0.0172	 ndcg_10: 0.0278	 hit@1:0.003487	 hit@5:0.0314	 hit@10: 0.0646
epoch 5: train_loss = 1.252524, source_hit@10 = 0.1326, source_ndcg@10 = 0.0670, target_hit@10 = 0.0646, target_ndcg@10 = 0.0278

2024-08-03 20:40:38.940283: step 5682/75760 (epoch 6/80), loss = 1.234814 (679.043 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064635	 ndcg_5: 0.0573	 ndcg_10: 0.0734	 hit@1:0.024778	 hit@5:0.0899	 hit@10: 0.1399
target: 	 mrr: 0.047660	 ndcg_5: 0.0372	 ndcg_10: 0.0531	 hit@1:0.012632	 hit@5:0.0627	 hit@10: 0.1120
epoch 6: train_loss = 1.234814, source_hit@10 = 0.1399, source_ndcg@10 = 0.0734, target_hit@10 = 0.1120, target_ndcg@10 = 0.0531

2024-08-03 20:54:57.453037: step 6629/75760 (epoch 7/80), loss = 1.213817 (853.345 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053469	 ndcg_5: 0.0448	 ndcg_10: 0.0578	 hit@1:0.020570	 hit@5:0.0692	 hit@10: 0.1094
target: 	 mrr: 0.033680	 ndcg_5: 0.0209	 ndcg_10: 0.0316	 hit@1:0.008093	 hit@5:0.0347	 hit@10: 0.0682
epoch 7: train_loss = 1.213817, source_hit@10 = 0.1094, source_ndcg@10 = 0.0578, target_hit@10 = 0.0682, target_ndcg@10 = 0.0316

2024-08-03 21:06:24.969824: step 7576/75760 (epoch 8/80), loss = 1.202271 (682.147 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061435	 ndcg_5: 0.0548	 ndcg_10: 0.0689	 hit@1:0.025090	 hit@5:0.0842	 hit@10: 0.1279
target: 	 mrr: 0.036645	 ndcg_5: 0.0267	 ndcg_10: 0.0386	 hit@1:0.008158	 hit@5:0.0463	 hit@10: 0.0832
epoch 8: train_loss = 1.202271, source_hit@10 = 0.1279, source_ndcg@10 = 0.0689, target_hit@10 = 0.0832, target_ndcg@10 = 0.0386

2024-08-03 21:25:38.945797: step 8523/75760 (epoch 9/80), loss = 1.201525 (1148.905 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059523	 ndcg_5: 0.0502	 ndcg_10: 0.0658	 hit@1:0.022285	 hit@5:0.0773	 hit@10: 0.1256
target: 	 mrr: 0.043184	 ndcg_5: 0.0324	 ndcg_10: 0.0444	 hit@1:0.013225	 hit@5:0.0516	 hit@10: 0.0886
epoch 9: train_loss = 1.201525, source_hit@10 = 0.1256, source_ndcg@10 = 0.0658, target_hit@10 = 0.0886, target_ndcg@10 = 0.0444

2024-08-03 21:47:32.687026: step 9470/75760 (epoch 10/80), loss = 1.199369 (1282.820 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.049168	 ndcg_5: 0.0394	 ndcg_10: 0.0525	 hit@1:0.018544	 hit@5:0.0605	 hit@10: 0.1013
target: 	 mrr: 0.053686	 ndcg_5: 0.0449	 ndcg_10: 0.0572	 hit@1:0.020659	 hit@5:0.0691	 hit@10: 0.1073
epoch 10: train_loss = 1.199369, source_hit@10 = 0.1013, source_ndcg@10 = 0.0525, target_hit@10 = 0.1073, target_ndcg@10 = 0.0572

2024-08-03 22:07:50.035176: step 10417/75760 (epoch 11/80), loss = 1.197902 (1185.170 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056916	 ndcg_5: 0.0490	 ndcg_10: 0.0636	 hit@1:0.020259	 hit@5:0.0782	 hit@10: 0.1239
target: 	 mrr: 0.068111	 ndcg_5: 0.0589	 ndcg_10: 0.0762	 hit@1:0.024738	 hit@5:0.0934	 hit@10: 0.1474
target best!
......................................................................................................................................................target: 	 mrr: 0.068973	 ndcg_5: 0.0593	 ndcg_10: 0.0771	 hit@1:0.025510	 hit@5:0.0931	 hit@10: 0.1486
epoch 11: train_loss = 1.197902, source_hit@10 = 0.1239, source_ndcg@10 = 0.0636, target_hit@10 = 0.1486, target_ndcg@10 = 0.0771
new best model saved.

2024-08-03 22:26:07.109273: step 11364/75760 (epoch 12/80), loss = 1.195415 (1080.269 sec/epoch), lr: 0.005000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.035738	 ndcg_5: 0.0268	 ndcg_10: 0.0359	 hit@1:0.010129	 hit@5:0.0435	 hit@10: 0.0718
target: 	 mrr: 0.048195	 ndcg_5: 0.0401	 ndcg_10: 0.0528	 hit@1:0.014409	 hit@5:0.0659	 hit@10: 0.1055
epoch 12: train_loss = 1.195415, source_hit@10 = 0.0718, source_ndcg@10 = 0.0359, target_hit@10 = 0.1055, target_ndcg@10 = 0.0528

2024-08-03 22:47:31.234049: step 12311/75760 (epoch 13/80), loss = 1.193468 (1275.380 sec/epoch), lr: 0.004750
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.043266	 ndcg_5: 0.0350	 ndcg_10: 0.0453	 hit@1:0.016051	 hit@5:0.0539	 hit@10: 0.0860
target: 	 mrr: 0.025711	 ndcg_5: 0.0156	 ndcg_10: 0.0237	 hit@1:0.003948	 hit@5:0.0276	 hit@10: 0.0530
epoch 13: train_loss = 1.193468, source_hit@10 = 0.0860, source_ndcg@10 = 0.0453, target_hit@10 = 0.0530, target_ndcg@10 = 0.0237

2024-08-03 23:09:24.134611: step 13258/75760 (epoch 14/80), loss = 1.189393 (1281.185 sec/epoch), lr: 0.004513
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060127	 ndcg_5: 0.0505	 ndcg_10: 0.0682	 hit@1:0.020259	 hit@5:0.0807	 hit@10: 0.1354
target: 	 mrr: 0.023351	 ndcg_5: 0.0137	 ndcg_10: 0.0192	 hit@1:0.005987	 hit@5:0.0218	 hit@10: 0.0387
epoch 14: train_loss = 1.189393, source_hit@10 = 0.1354, source_ndcg@10 = 0.0682, target_hit@10 = 0.0387, target_ndcg@10 = 0.0192

2024-08-03 23:28:55.118871: step 14205/75760 (epoch 15/80), loss = 1.189467 (1138.813 sec/epoch), lr: 0.004513
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.023453	 ndcg_5: 0.0163	 ndcg_10: 0.0218	 hit@1:0.007792	 hit@5:0.0248	 hit@10: 0.0419
target: 	 mrr: 0.051269	 ndcg_5: 0.0409	 ndcg_10: 0.0540	 hit@1:0.017633	 hit@5:0.0643	 hit@10: 0.1051
epoch 15: train_loss = 1.189467, source_hit@10 = 0.0419, source_ndcg@10 = 0.0218, target_hit@10 = 0.1051, target_ndcg@10 = 0.0540

2024-08-03 23:47:09.904531: step 15152/75760 (epoch 16/80), loss = 1.186608 (1084.914 sec/epoch), lr: 0.004287
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.074733	 ndcg_5: 0.0666	 ndcg_10: 0.0821	 hit@1:0.032414	 hit@5:0.0999	 hit@10: 0.1480
target: 	 mrr: 0.028854	 ndcg_5: 0.0212	 ndcg_10: 0.0277	 hit@1:0.010001	 hit@5:0.0322	 hit@10: 0.0528
source best!
...............................................................
source: 	 mrr: 0.075305	 ndcg_5: 0.0669	 ndcg_10: 0.0849	 hit@1:0.031003	 hit@5:0.1023	 hit@10: 0.1587
epoch 16: train_loss = 1.186608, source_hit@10 = 0.1587, source_ndcg@10 = 0.0849, target_hit@10 = 0.0528, target_ndcg@10 = 0.0277

2024-08-04 00:09:16.404725: step 16099/75760 (epoch 17/80), loss = 1.185247 (1287.881 sec/epoch), lr: 0.004287
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059975	 ndcg_5: 0.0538	 ndcg_10: 0.0681	 hit@1:0.022440	 hit@5:0.0848	 hit@10: 0.1293
target: 	 mrr: 0.062868	 ndcg_5: 0.0521	 ndcg_10: 0.0696	 hit@1:0.021646	 hit@5:0.0829	 hit@10: 0.1369
epoch 17: train_loss = 1.185247, source_hit@10 = 0.1293, source_ndcg@10 = 0.0681, target_hit@10 = 0.1369, target_ndcg@10 = 0.0696

2024-08-04 00:31:30.642490: step 17046/75760 (epoch 18/80), loss = 1.184933 (1303.924 sec/epoch), lr: 0.004287
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057994	 ndcg_5: 0.0489	 ndcg_10: 0.0656	 hit@1:0.020103	 hit@5:0.0787	 hit@10: 0.1311
target: 	 mrr: 0.074481	 ndcg_5: 0.0664	 ndcg_10: 0.0836	 hit@1:0.028423	 hit@5:0.1042	 hit@10: 0.1574
target best!
......................................................................................................................................................target: 	 mrr: 0.076526	 ndcg_5: 0.0688	 ndcg_10: 0.0859	 hit@1:0.030758	 hit@5:0.1072	 hit@10: 0.1606
epoch 18: train_loss = 1.184933, source_hit@10 = 0.1311, source_ndcg@10 = 0.0656, target_hit@10 = 0.1606, target_ndcg@10 = 0.0859

2024-08-04 00:51:07.677948: step 17993/75760 (epoch 19/80), loss = 1.184138 (1121.984 sec/epoch), lr: 0.004287
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050665	 ndcg_5: 0.0409	 ndcg_10: 0.0549	 hit@1:0.016830	 hit@5:0.0650	 hit@10: 0.1086
target: 	 mrr: 0.050060	 ndcg_5: 0.0386	 ndcg_10: 0.0515	 hit@1:0.017106	 hit@5:0.0603	 hit@10: 0.1009
epoch 19: train_loss = 1.184138, source_hit@10 = 0.1086, source_ndcg@10 = 0.0549, target_hit@10 = 0.1009, target_ndcg@10 = 0.0515

2024-08-04 01:10:41.141099: step 18940/75760 (epoch 20/80), loss = 1.182995 (1144.630 sec/epoch), lr: 0.004073
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077104	 ndcg_5: 0.0710	 ndcg_10: 0.0882	 hit@1:0.029453	 hit@5:0.1116	 hit@10: 0.1649
target: 	 mrr: 0.060897	 ndcg_5: 0.0503	 ndcg_10: 0.0699	 hit@1:0.018488	 hit@5:0.0834	 hit@10: 0.1439
source best!
...............................................................
source: 	 mrr: 0.080657	 ndcg_5: 0.0738	 ndcg_10: 0.0903	 hit@1:0.034641	 hit@5:0.1118	 hit@10: 0.1631
epoch 20: train_loss = 1.182995, source_hit@10 = 0.1631, source_ndcg@10 = 0.0903, target_hit@10 = 0.1439, target_ndcg@10 = 0.0699

2024-08-04 01:32:51.836209: step 19887/75760 (epoch 21/80), loss = 1.183231 (1288.777 sec/epoch), lr: 0.004073
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065414	 ndcg_5: 0.0564	 ndcg_10: 0.0732	 hit@1:0.026336	 hit@5:0.0871	 hit@10: 0.1387
target: 	 mrr: 0.078726	 ndcg_5: 0.0710	 ndcg_10: 0.0891	 hit@1:0.031318	 hit@5:0.1108	 hit@10: 0.1672
target best!
......................................................................................................................................................target: 	 mrr: 0.078767	 ndcg_5: 0.0711	 ndcg_10: 0.0902	 hit@1:0.030227	 hit@5:0.1121	 hit@10: 0.1715
epoch 21: train_loss = 1.183231, source_hit@10 = 0.1387, source_ndcg@10 = 0.0732, target_hit@10 = 0.1715, target_ndcg@10 = 0.0902

2024-08-04 01:55:08.920650: step 20834/75760 (epoch 22/80), loss = 1.182892 (1281.893 sec/epoch), lr: 0.004073
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068170	 ndcg_5: 0.0594	 ndcg_10: 0.0758	 hit@1:0.028362	 hit@5:0.0901	 hit@10: 0.1409
target: 	 mrr: 0.058022	 ndcg_5: 0.0499	 ndcg_10: 0.0627	 hit@1:0.021646	 hit@5:0.0775	 hit@10: 0.1170
epoch 22: train_loss = 1.182892, source_hit@10 = 0.1409, source_ndcg@10 = 0.0758, target_hit@10 = 0.1170, target_ndcg@10 = 0.0627

2024-08-04 02:13:35.178027: step 21781/75760 (epoch 23/80), loss = 1.181380 (1096.251 sec/epoch), lr: 0.003869
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.039149	 ndcg_5: 0.0313	 ndcg_10: 0.0413	 hit@1:0.011688	 hit@5:0.0510	 hit@10: 0.0820
target: 	 mrr: 0.053661	 ndcg_5: 0.0426	 ndcg_10: 0.0608	 hit@1:0.015133	 hit@5:0.0716	 hit@10: 0.1283
epoch 23: train_loss = 1.181380, source_hit@10 = 0.0820, source_ndcg@10 = 0.0413, target_hit@10 = 0.1283, target_ndcg@10 = 0.0608

2024-08-04 02:33:53.288856: step 22728/75760 (epoch 24/80), loss = 1.177799 (1209.344 sec/epoch), lr: 0.003675
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068177	 ndcg_5: 0.0591	 ndcg_10: 0.0768	 hit@1:0.026336	 hit@5:0.0907	 hit@10: 0.1456
target: 	 mrr: 0.042529	 ndcg_5: 0.0294	 ndcg_10: 0.0444	 hit@1:0.011185	 hit@5:0.0484	 hit@10: 0.0955
epoch 24: train_loss = 1.177799, source_hit@10 = 0.1456, source_ndcg@10 = 0.0768, target_hit@10 = 0.0955, target_ndcg@10 = 0.0444

2024-08-04 02:55:59.572902: step 23675/75760 (epoch 25/80), loss = 1.178494 (1293.086 sec/epoch), lr: 0.003675
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057186	 ndcg_5: 0.0499	 ndcg_10: 0.0645	 hit@1:0.020415	 hit@5:0.0806	 hit@10: 0.1259
target: 	 mrr: 0.055057	 ndcg_5: 0.0451	 ndcg_10: 0.0602	 hit@1:0.019738	 hit@5:0.0712	 hit@10: 0.1182
epoch 25: train_loss = 1.178494, source_hit@10 = 0.1259, source_ndcg@10 = 0.0645, target_hit@10 = 0.1182, target_ndcg@10 = 0.0602

2024-08-04 03:16:33.776145: step 24622/75760 (epoch 26/80), loss = 1.179374 (1200.442 sec/epoch), lr: 0.003675
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062287	 ndcg_5: 0.0553	 ndcg_10: 0.0699	 hit@1:0.022752	 hit@5:0.0880	 hit@10: 0.1334
target: 	 mrr: 0.078133	 ndcg_5: 0.0689	 ndcg_10: 0.0875	 hit@1:0.032568	 hit@5:0.1038	 hit@10: 0.1617
epoch 26: train_loss = 1.179374, source_hit@10 = 0.1334, source_ndcg@10 = 0.0699, target_hit@10 = 0.1617, target_ndcg@10 = 0.0875

2024-08-04 03:34:29.875627: step 25569/75760 (epoch 27/80), loss = 1.175462 (1065.780 sec/epoch), lr: 0.003675
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069207	 ndcg_5: 0.0595	 ndcg_10: 0.0768	 hit@1:0.028518	 hit@5:0.0899	 hit@10: 0.1437
target: 	 mrr: 0.064948	 ndcg_5: 0.0566	 ndcg_10: 0.0734	 hit@1:0.022107	 hit@5:0.0914	 hit@10: 0.1436
epoch 27: train_loss = 1.175462, source_hit@10 = 0.1437, source_ndcg@10 = 0.0768, target_hit@10 = 0.1436, target_ndcg@10 = 0.0734

2024-08-04 03:56:38.852890: step 26516/75760 (epoch 28/80), loss = 1.173793 (1320.270 sec/epoch), lr: 0.003492
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.046875	 ndcg_5: 0.0379	 ndcg_10: 0.0494	 hit@1:0.016830	 hit@5:0.0594	 hit@10: 0.0955
target: 	 mrr: 0.062113	 ndcg_5: 0.0528	 ndcg_10: 0.0684	 hit@1:0.024738	 hit@5:0.0810	 hit@10: 0.1295
epoch 28: train_loss = 1.173793, source_hit@10 = 0.0955, source_ndcg@10 = 0.0494, target_hit@10 = 0.1295, target_ndcg@10 = 0.0684

2024-08-04 04:18:55.939502: step 27463/75760 (epoch 29/80), loss = 1.173981 (1305.569 sec/epoch), lr: 0.003317
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078685	 ndcg_5: 0.0694	 ndcg_10: 0.0887	 hit@1:0.033661	 hit@5:0.1036	 hit@10: 0.1633
target: 	 mrr: 0.028795	 ndcg_5: 0.0217	 ndcg_10: 0.0282	 hit@1:0.009869	 hit@5:0.0332	 hit@10: 0.0534
source best!
...............................................................
source: 	 mrr: 0.077924	 ndcg_5: 0.0704	 ndcg_10: 0.0881	 hit@1:0.031952	 hit@5:0.1091	 hit@10: 0.1643
epoch 29: train_loss = 1.173981, source_hit@10 = 0.1643, source_ndcg@10 = 0.0881, target_hit@10 = 0.0534, target_ndcg@10 = 0.0282

2024-08-04 04:38:21.462978: step 28410/75760 (epoch 30/80), loss = 1.169675 (1125.512 sec/epoch), lr: 0.003151
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.044855	 ndcg_5: 0.0354	 ndcg_10: 0.0490	 hit@1:0.014960	 hit@5:0.0570	 hit@10: 0.0996
target: 	 mrr: 0.073015	 ndcg_5: 0.0666	 ndcg_10: 0.0827	 hit@1:0.028752	 hit@5:0.1038	 hit@10: 0.1540
epoch 30: train_loss = 1.169675, source_hit@10 = 0.0996, source_ndcg@10 = 0.0490, target_hit@10 = 0.1540, target_ndcg@10 = 0.0827

2024-08-04 04:57:40.227090: step 29357/75760 (epoch 31/80), loss = 1.169827 (1148.459 sec/epoch), lr: 0.003151
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060610	 ndcg_5: 0.0507	 ndcg_10: 0.0680	 hit@1:0.019480	 hit@5:0.0815	 hit@10: 0.1353
target: 	 mrr: 0.073915	 ndcg_5: 0.0662	 ndcg_10: 0.0829	 hit@1:0.028818	 hit@5:0.1030	 hit@10: 0.1551
epoch 31: train_loss = 1.169827, source_hit@10 = 0.1353, source_ndcg@10 = 0.0680, target_hit@10 = 0.1551, target_ndcg@10 = 0.0829

2024-08-04 05:19:41.726151: step 30304/75760 (epoch 32/80), loss = 1.168733 (1309.664 sec/epoch), lr: 0.003151
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.059835	 ndcg_5: 0.0513	 ndcg_10: 0.0681	 hit@1:0.019324	 hit@5:0.0835	 hit@10: 0.1356
target: 	 mrr: 0.079543	 ndcg_5: 0.0714	 ndcg_10: 0.0884	 hit@1:0.032700	 hit@5:0.1095	 hit@10: 0.1621
target best!
......................................................................................................................................................target: 	 mrr: 0.080344	 ndcg_5: 0.0726	 ndcg_10: 0.0901	 hit@1:0.032286	 hit@5:0.1122	 hit@10: 0.1665
epoch 32: train_loss = 1.168733, source_hit@10 = 0.1356, source_ndcg@10 = 0.0681, target_hit@10 = 0.1665, target_ndcg@10 = 0.0901

2024-08-04 05:42:31.243664: step 31251/75760 (epoch 33/80), loss = 1.169592 (1315.231 sec/epoch), lr: 0.003151
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.039805	 ndcg_5: 0.0303	 ndcg_10: 0.0408	 hit@1:0.014493	 hit@5:0.0469	 hit@10: 0.0796
target: 	 mrr: 0.078400	 ndcg_5: 0.0696	 ndcg_10: 0.0876	 hit@1:0.032634	 hit@5:0.1065	 hit@10: 0.1622
epoch 33: train_loss = 1.169592, source_hit@10 = 0.0796, source_ndcg@10 = 0.0408, target_hit@10 = 0.1622, target_ndcg@10 = 0.0876

2024-08-04 06:01:30.946424: step 32198/75760 (epoch 34/80), loss = 1.166052 (1107.928 sec/epoch), lr: 0.002994
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076581	 ndcg_5: 0.0701	 ndcg_10: 0.0866	 hit@1:0.031479	 hit@5:0.1089	 hit@10: 0.1599
target: 	 mrr: 0.031359	 ndcg_5: 0.0215	 ndcg_10: 0.0297	 hit@1:0.010264	 hit@5:0.0331	 hit@10: 0.0589
epoch 34: train_loss = 1.166052, source_hit@10 = 0.1599, source_ndcg@10 = 0.0866, target_hit@10 = 0.0589, target_ndcg@10 = 0.0297

2024-08-04 06:20:56.009492: step 33145/75760 (epoch 35/80), loss = 1.164808 (1140.185 sec/epoch), lr: 0.002844
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.039958	 ndcg_5: 0.0312	 ndcg_10: 0.0400	 hit@1:0.014025	 hit@5:0.0474	 hit@10: 0.0748
target: 	 mrr: 0.073937	 ndcg_5: 0.0656	 ndcg_10: 0.0827	 hit@1:0.027897	 hit@5:0.1029	 hit@10: 0.1559
epoch 35: train_loss = 1.164808, source_hit@10 = 0.0748, source_ndcg@10 = 0.0400, target_hit@10 = 0.1559, target_ndcg@10 = 0.0827

2024-08-04 06:43:26.137044: step 34092/75760 (epoch 36/80), loss = 1.164133 (1318.510 sec/epoch), lr: 0.002844
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067855	 ndcg_5: 0.0594	 ndcg_10: 0.0751	 hit@1:0.029297	 hit@5:0.0891	 hit@10: 0.1382
target: 	 mrr: 0.077953	 ndcg_5: 0.0700	 ndcg_10: 0.0871	 hit@1:0.031252	 hit@5:0.1080	 hit@10: 0.1615
epoch 36: train_loss = 1.164133, source_hit@10 = 0.1382, source_ndcg@10 = 0.0751, target_hit@10 = 0.1615, target_ndcg@10 = 0.0871

2024-08-04 07:04:35.993917: step 35039/75760 (epoch 37/80), loss = 1.162346 (1243.669 sec/epoch), lr: 0.002844
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.040864	 ndcg_5: 0.0320	 ndcg_10: 0.0415	 hit@1:0.015116	 hit@5:0.0499	 hit@10: 0.0793
target: 	 mrr: 0.046607	 ndcg_5: 0.0380	 ndcg_10: 0.0519	 hit@1:0.012435	 hit@5:0.0643	 hit@10: 0.1073
epoch 37: train_loss = 1.162346, source_hit@10 = 0.0793, source_ndcg@10 = 0.0415, target_hit@10 = 0.1073, target_ndcg@10 = 0.0519

2024-08-04 07:22:35.527161: step 35986/75760 (epoch 38/80), loss = 1.162544 (1069.471 sec/epoch), lr: 0.002702
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.075898	 ndcg_5: 0.0674	 ndcg_10: 0.0850	 hit@1:0.032102	 hit@5:0.1021	 hit@10: 0.1566
target: 	 mrr: 0.028767	 ndcg_5: 0.0209	 ndcg_10: 0.0260	 hit@1:0.009672	 hit@5:0.0320	 hit@10: 0.0481
epoch 38: train_loss = 1.162544, source_hit@10 = 0.1566, source_ndcg@10 = 0.0850, target_hit@10 = 0.0481, target_ndcg@10 = 0.0260

2024-08-04 07:43:48.025012: step 36933/75760 (epoch 39/80), loss = 1.158459 (1263.816 sec/epoch), lr: 0.002702
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072665	 ndcg_5: 0.0643	 ndcg_10: 0.0820	 hit@1:0.028362	 hit@5:0.0996	 hit@10: 0.1549
target: 	 mrr: 0.084162	 ndcg_5: 0.0750	 ndcg_10: 0.0936	 hit@1:0.037437	 hit@5:0.1122	 hit@10: 0.1701
target best!
......................................................................................................................................................target: 	 mrr: 0.084303	 ndcg_5: 0.0761	 ndcg_10: 0.0950	 hit@1:0.035541	 hit@5:0.1158	 hit@10: 0.1744
epoch 39: train_loss = 1.158459, source_hit@10 = 0.1549, source_ndcg@10 = 0.0820, target_hit@10 = 0.1744, target_ndcg@10 = 0.0950

2024-08-04 08:06:29.482765: step 37880/75760 (epoch 40/80), loss = 1.159854 (1306.942 sec/epoch), lr: 0.002702
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.075518	 ndcg_5: 0.0685	 ndcg_10: 0.0852	 hit@1:0.031479	 hit@5:0.1061	 hit@10: 0.1588
target: 	 mrr: 0.075251	 ndcg_5: 0.0664	 ndcg_10: 0.0837	 hit@1:0.030002	 hit@5:0.1023	 hit@10: 0.1562
epoch 40: train_loss = 1.159854, source_hit@10 = 0.1588, source_ndcg@10 = 0.0852, target_hit@10 = 0.1562, target_ndcg@10 = 0.0837
shift to transfer learning mode

2024-08-04 08:26:31.392100: step 38827/75760 (epoch 41/80), loss = 1.158087 (1169.196 sec/epoch), lr: 0.002567
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.044788	 ndcg_5: 0.0368	 ndcg_10: 0.0475	 hit@1:0.015895	 hit@5:0.0575	 hit@10: 0.0909
target: 	 mrr: 0.082621	 ndcg_5: 0.0737	 ndcg_10: 0.0918	 hit@1:0.036910	 hit@5:0.1099	 hit@10: 0.1659
epoch 41: train_loss = 1.158087, source_hit@10 = 0.0909, source_ndcg@10 = 0.0475, target_hit@10 = 0.1659, target_ndcg@10 = 0.0918

2024-08-04 08:46:13.666272: step 39774/75760 (epoch 42/80), loss = 1.156217 (1172.213 sec/epoch), lr: 0.002438
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063828	 ndcg_5: 0.0542	 ndcg_10: 0.0702	 hit@1:0.024934	 hit@5:0.0834	 hit@10: 0.1334
target: 	 mrr: 0.067004	 ndcg_5: 0.0571	 ndcg_10: 0.0747	 hit@1:0.024081	 hit@5:0.0902	 hit@10: 0.1449
epoch 42: train_loss = 1.156217, source_hit@10 = 0.1334, source_ndcg@10 = 0.0702, target_hit@10 = 0.1449, target_ndcg@10 = 0.0747

2024-08-04 09:08:59.833484: step 40721/75760 (epoch 43/80), loss = 1.155848 (1333.542 sec/epoch), lr: 0.002438
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.041352	 ndcg_5: 0.0327	 ndcg_10: 0.0435	 hit@1:0.013090	 hit@5:0.0525	 hit@10: 0.0863
target: 	 mrr: 0.074961	 ndcg_5: 0.0669	 ndcg_10: 0.0855	 hit@1:0.027041	 hit@5:0.1064	 hit@10: 0.1642
epoch 43: train_loss = 1.155848, source_hit@10 = 0.0863, source_ndcg@10 = 0.0435, target_hit@10 = 0.1642, target_ndcg@10 = 0.0855

2024-08-04 09:31:28.951406: step 41668/75760 (epoch 44/80), loss = 1.153389 (1316.527 sec/epoch), lr: 0.002316
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.071693	 ndcg_5: 0.0624	 ndcg_10: 0.0809	 hit@1:0.029609	 hit@5:0.0943	 hit@10: 0.1516
target: 	 mrr: 0.060948	 ndcg_5: 0.0500	 ndcg_10: 0.0662	 hit@1:0.020725	 hit@5:0.0793	 hit@10: 0.1302
epoch 44: train_loss = 1.153389, source_hit@10 = 0.1516, source_ndcg@10 = 0.0809, target_hit@10 = 0.1302, target_ndcg@10 = 0.0662

2024-08-04 09:50:20.949593: step 42615/75760 (epoch 45/80), loss = 1.153068 (1099.875 sec/epoch), lr: 0.002316
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050228	 ndcg_5: 0.0422	 ndcg_10: 0.0544	 hit@1:0.019324	 hit@5:0.0661	 hit@10: 0.1041
target: 	 mrr: 0.067738	 ndcg_5: 0.0591	 ndcg_10: 0.0776	 hit@1:0.026449	 hit@5:0.0931	 hit@10: 0.1503
epoch 45: train_loss = 1.153068, source_hit@10 = 0.1041, source_ndcg@10 = 0.0544, target_hit@10 = 0.1503, target_ndcg@10 = 0.0776

2024-08-04 10:10:05.670654: step 43562/75760 (epoch 46/80), loss = 1.149438 (1152.728 sec/epoch), lr: 0.002201
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068750	 ndcg_5: 0.0588	 ndcg_10: 0.0761	 hit@1:0.026180	 hit@5:0.0927	 hit@10: 0.1465
target: 	 mrr: 0.065369	 ndcg_5: 0.0558	 ndcg_10: 0.0732	 hit@1:0.022304	 hit@5:0.0892	 hit@10: 0.1436
epoch 46: train_loss = 1.149438, source_hit@10 = 0.1465, source_ndcg@10 = 0.0761, target_hit@10 = 0.1436, target_ndcg@10 = 0.0732

