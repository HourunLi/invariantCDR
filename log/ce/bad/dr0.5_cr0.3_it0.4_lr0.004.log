nohup: ignoring input
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:54: UserWarning: An issue occurred while importing 'pyg-lib'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'pyg-lib'. "
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:110: UserWarning: An issue occurred while importing 'torch-sparse'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'torch-sparse'. "
using gpu:4 to train the model
using gpu:4 to train the model
cuda:4
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=4), device_id='4', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.3, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:68: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /opt/conda/conda-bld/pytorch_1711403590347/work/torch/csrc/utils/tensor_new.cpp:618.)
  return torch.sparse.FloatTensor(indices, values, shape)
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-03 19:42:49.487822: step 947/75760 (epoch 1/80), loss = 1.583281 (695.386 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066683	 ndcg_5: 0.0591	 ndcg_10: 0.0759	 hit@1:0.025245	 hit@5:0.0933	 hit@10: 0.1457
target: 	 mrr: 0.069251	 ndcg_5: 0.0599	 ndcg_10: 0.0763	 hit@1:0.029607	 hit@5:0.0899	 hit@10: 0.1407
source best!
...............................................................
source: 	 mrr: 0.071400	 ndcg_5: 0.0644	 ndcg_10: 0.0801	 hit@1:0.028314	 hit@5:0.1006	 hit@10: 0.1495
target best!
......................................................................................................................................................target: 	 mrr: 0.071261	 ndcg_5: 0.0629	 ndcg_10: 0.0798	 hit@1:0.029961	 hit@5:0.0957	 hit@10: 0.1483
epoch 1: train_loss = 1.583281, source_hit@10 = 0.1495, source_ndcg@10 = 0.0801, target_hit@10 = 0.1483, target_ndcg@10 = 0.0798

2024-08-03 19:54:29.279735: step 1894/75760 (epoch 2/80), loss = 1.471588 (689.427 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050263	 ndcg_5: 0.0402	 ndcg_10: 0.0548	 hit@1:0.017142	 hit@5:0.0644	 hit@10: 0.1099
target: 	 mrr: 0.059183	 ndcg_5: 0.0498	 ndcg_10: 0.0666	 hit@1:0.018751	 hit@5:0.0810	 hit@10: 0.1335
epoch 2: train_loss = 1.471588, source_hit@10 = 0.1099, source_ndcg@10 = 0.0548, target_hit@10 = 0.1335, target_ndcg@10 = 0.0666

2024-08-03 20:06:04.280007: step 2841/75760 (epoch 3/80), loss = 1.462235 (689.603 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057795	 ndcg_5: 0.0500	 ndcg_10: 0.0642	 hit@1:0.022285	 hit@5:0.0776	 hit@10: 0.1216
target: 	 mrr: 0.058905	 ndcg_5: 0.0490	 ndcg_10: 0.0661	 hit@1:0.017830	 hit@5:0.0801	 hit@10: 0.1332
epoch 3: train_loss = 1.462235, source_hit@10 = 0.1216, source_ndcg@10 = 0.0642, target_hit@10 = 0.1332, target_ndcg@10 = 0.0661

2024-08-03 20:18:01.130309: step 3788/75760 (epoch 4/80), loss = 1.455366 (711.311 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.046420	 ndcg_5: 0.0334	 ndcg_10: 0.0501	 hit@1:0.014025	 hit@5:0.0542	 hit@10: 0.1063
target: 	 mrr: 0.060319	 ndcg_5: 0.0484	 ndcg_10: 0.0674	 hit@1:0.019343	 hit@5:0.0786	 hit@10: 0.1375
epoch 4: train_loss = 1.455366, source_hit@10 = 0.1063, source_ndcg@10 = 0.0501, target_hit@10 = 0.1375, target_ndcg@10 = 0.0674

2024-08-03 20:29:29.511136: step 4735/75760 (epoch 5/80), loss = 1.448781 (683.345 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.036132	 ndcg_5: 0.0273	 ndcg_10: 0.0390	 hit@1:0.011999	 hit@5:0.0436	 hit@10: 0.0801
target: 	 mrr: 0.062997	 ndcg_5: 0.0562	 ndcg_10: 0.0744	 hit@1:0.021251	 hit@5:0.0911	 hit@10: 0.1471
epoch 5: train_loss = 1.448781, source_hit@10 = 0.0801, source_ndcg@10 = 0.0390, target_hit@10 = 0.1471, target_ndcg@10 = 0.0744

2024-08-03 20:40:56.553555: step 5682/75760 (epoch 6/80), loss = 1.431148 (682.136 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066009	 ndcg_5: 0.0589	 ndcg_10: 0.0755	 hit@1:0.021973	 hit@5:0.0954	 hit@10: 0.1473
target: 	 mrr: 0.054522	 ndcg_5: 0.0441	 ndcg_10: 0.0633	 hit@1:0.014146	 hit@5:0.0756	 hit@10: 0.1356
epoch 6: train_loss = 1.431148, source_hit@10 = 0.1473, source_ndcg@10 = 0.0755, target_hit@10 = 0.1356, target_ndcg@10 = 0.0633

2024-08-03 20:52:29.536815: step 6629/75760 (epoch 7/80), loss = 1.423162 (687.663 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.047023	 ndcg_5: 0.0375	 ndcg_10: 0.0501	 hit@1:0.016986	 hit@5:0.0583	 hit@10: 0.0977
target: 	 mrr: 0.053797	 ndcg_5: 0.0429	 ndcg_10: 0.0606	 hit@1:0.015067	 hit@5:0.0722	 hit@10: 0.1277
epoch 7: train_loss = 1.423162, source_hit@10 = 0.0977, source_ndcg@10 = 0.0501, target_hit@10 = 0.1277, target_ndcg@10 = 0.0606

2024-08-03 21:03:58.307981: step 7576/75760 (epoch 8/80), loss = 1.410299 (683.414 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062603	 ndcg_5: 0.0533	 ndcg_10: 0.0697	 hit@1:0.024778	 hit@5:0.0820	 hit@10: 0.1328
target: 	 mrr: 0.056622	 ndcg_5: 0.0474	 ndcg_10: 0.0637	 hit@1:0.017501	 hit@5:0.0786	 hit@10: 0.1292
epoch 8: train_loss = 1.410299, source_hit@10 = 0.1328, source_ndcg@10 = 0.0697, target_hit@10 = 0.1292, target_ndcg@10 = 0.0637

2024-08-03 21:15:34.493974: step 8523/75760 (epoch 9/80), loss = 1.391746 (690.846 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066878	 ndcg_5: 0.0583	 ndcg_10: 0.0751	 hit@1:0.024934	 hit@5:0.0919	 hit@10: 0.1440
target: 	 mrr: 0.069670	 ndcg_5: 0.0612	 ndcg_10: 0.0791	 hit@1:0.025396	 hit@5:0.0970	 hit@10: 0.1522
source best!
...............................................................
source: 	 mrr: 0.070997	 ndcg_5: 0.0622	 ndcg_10: 0.0802	 hit@1:0.026099	 hit@5:0.0984	 hit@10: 0.1541
target best!
......................................................................................................................................................target: 	 mrr: 0.069701	 ndcg_5: 0.0610	 ndcg_10: 0.0792	 hit@1:0.024779	 hit@5:0.0967	 hit@10: 0.1531
epoch 9: train_loss = 1.391746, source_hit@10 = 0.1541, source_ndcg@10 = 0.0802, target_hit@10 = 0.1531, target_ndcg@10 = 0.0792
new best model saved.

2024-08-03 21:27:13.179220: step 9470/75760 (epoch 10/80), loss = 1.384931 (688.131 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067070	 ndcg_5: 0.0589	 ndcg_10: 0.0759	 hit@1:0.026180	 hit@5:0.0923	 hit@10: 0.1454
target: 	 mrr: 0.029005	 ndcg_5: 0.0190	 ndcg_10: 0.0278	 hit@1:0.007237	 hit@5:0.0315	 hit@10: 0.0587
source best!
...............................................................
source: 	 mrr: 0.065710	 ndcg_5: 0.0559	 ndcg_10: 0.0734	 hit@1:0.024676	 hit@5:0.0878	 hit@10: 0.1424
epoch 10: train_loss = 1.384931, source_hit@10 = 0.1424, source_ndcg@10 = 0.0734, target_hit@10 = 0.0587, target_ndcg@10 = 0.0278

2024-08-03 21:38:50.813425: step 10417/75760 (epoch 11/80), loss = 1.382087 (691.290 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.029313	 ndcg_5: 0.0220	 ndcg_10: 0.0298	 hit@1:0.008415	 hit@5:0.0362	 hit@10: 0.0605
target: 	 mrr: 0.050237	 ndcg_5: 0.0392	 ndcg_10: 0.0582	 hit@1:0.011185	 hit@5:0.0695	 hit@10: 0.1281
epoch 11: train_loss = 1.382087, source_hit@10 = 0.0605, source_ndcg@10 = 0.0298, target_hit@10 = 0.1281, target_ndcg@10 = 0.0582

2024-08-03 21:50:24.180310: step 11364/75760 (epoch 12/80), loss = 1.377463 (688.135 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069834	 ndcg_5: 0.0614	 ndcg_10: 0.0785	 hit@1:0.027115	 hit@5:0.0955	 hit@10: 0.1488
target: 	 mrr: 0.055624	 ndcg_5: 0.0453	 ndcg_10: 0.0614	 hit@1:0.015067	 hit@5:0.0759	 hit@10: 0.1260
source best!
...............................................................
source: 	 mrr: 0.073107	 ndcg_5: 0.0644	 ndcg_10: 0.0827	 hit@1:0.029737	 hit@5:0.0997	 hit@10: 0.1561
epoch 12: train_loss = 1.377463, source_hit@10 = 0.1561, source_ndcg@10 = 0.0827, target_hit@10 = 0.1260, target_ndcg@10 = 0.0614

2024-08-03 22:01:59.253121: step 12311/75760 (epoch 13/80), loss = 1.375724 (688.255 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.024310	 ndcg_5: 0.0161	 ndcg_10: 0.0243	 hit@1:0.005766	 hit@5:0.0271	 hit@10: 0.0527
target: 	 mrr: 0.067314	 ndcg_5: 0.0577	 ndcg_10: 0.0763	 hit@1:0.023554	 hit@5:0.0924	 hit@10: 0.1502
epoch 13: train_loss = 1.375724, source_hit@10 = 0.0527, source_ndcg@10 = 0.0243, target_hit@10 = 0.1502, target_ndcg@10 = 0.0763

2024-08-03 22:13:28.397510: step 13258/75760 (epoch 14/80), loss = 1.369030 (683.824 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.043228	 ndcg_5: 0.0356	 ndcg_10: 0.0453	 hit@1:0.016051	 hit@5:0.0541	 hit@10: 0.0845
target: 	 mrr: 0.068905	 ndcg_5: 0.0598	 ndcg_10: 0.0804	 hit@1:0.021186	 hit@5:0.0995	 hit@10: 0.1636
epoch 14: train_loss = 1.369030, source_hit@10 = 0.0845, source_ndcg@10 = 0.0453, target_hit@10 = 0.1636, target_ndcg@10 = 0.0804

2024-08-03 22:24:59.598244: step 14205/75760 (epoch 15/80), loss = 1.363183 (686.075 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069210	 ndcg_5: 0.0586	 ndcg_10: 0.0771	 hit@1:0.027427	 hit@5:0.0902	 hit@10: 0.1476
target: 	 mrr: 0.036061	 ndcg_5: 0.0263	 ndcg_10: 0.0361	 hit@1:0.009606	 hit@5:0.0438	 hit@10: 0.0743
epoch 15: train_loss = 1.363183, source_hit@10 = 0.1476, source_ndcg@10 = 0.0771, target_hit@10 = 0.0743, target_ndcg@10 = 0.0361

2024-08-03 22:36:32.674435: step 15152/75760 (epoch 16/80), loss = 1.360598 (687.747 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.056179	 ndcg_5: 0.0476	 ndcg_10: 0.0617	 hit@1:0.021817	 hit@5:0.0722	 hit@10: 0.1156
target: 	 mrr: 0.057187	 ndcg_5: 0.0473	 ndcg_10: 0.0633	 hit@1:0.017370	 hit@5:0.0771	 hit@10: 0.1270
epoch 16: train_loss = 1.360598, source_hit@10 = 0.1156, source_ndcg@10 = 0.0617, target_hit@10 = 0.1270, target_ndcg@10 = 0.0633

2024-08-03 22:48:07.771845: step 16099/75760 (epoch 17/80), loss = 1.357297 (689.619 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057543	 ndcg_5: 0.0485	 ndcg_10: 0.0656	 hit@1:0.018856	 hit@5:0.0785	 hit@10: 0.1320
target: 	 mrr: 0.059752	 ndcg_5: 0.0524	 ndcg_10: 0.0680	 hit@1:0.018488	 hit@5:0.0861	 hit@10: 0.1346
epoch 17: train_loss = 1.357297, source_hit@10 = 0.1320, source_ndcg@10 = 0.0656, target_hit@10 = 0.1346, target_ndcg@10 = 0.0680

2024-08-03 22:59:40.706996: step 17046/75760 (epoch 18/80), loss = 1.356990 (687.635 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066907	 ndcg_5: 0.0562	 ndcg_10: 0.0745	 hit@1:0.024310	 hit@5:0.0877	 hit@10: 0.1449
target: 	 mrr: 0.058239	 ndcg_5: 0.0500	 ndcg_10: 0.0679	 hit@1:0.016185	 hit@5:0.0839	 hit@10: 0.1395
epoch 18: train_loss = 1.356990, source_hit@10 = 0.1449, source_ndcg@10 = 0.0745, target_hit@10 = 0.1395, target_ndcg@10 = 0.0679

2024-08-03 23:11:14.014406: step 17993/75760 (epoch 19/80), loss = 1.356079 (687.858 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054876	 ndcg_5: 0.0472	 ndcg_10: 0.0613	 hit@1:0.016674	 hit@5:0.0776	 hit@10: 0.1216
target: 	 mrr: 0.078666	 ndcg_5: 0.0687	 ndcg_10: 0.0877	 hit@1:0.032963	 hit@5:0.1037	 hit@10: 0.1630
target best!
......................................................................................................................................................target: 	 mrr: 0.079889	 ndcg_5: 0.0702	 ndcg_10: 0.0890	 hit@1:0.033349	 hit@5:0.1062	 hit@10: 0.1649
epoch 19: train_loss = 1.356079, source_hit@10 = 0.1216, source_ndcg@10 = 0.0613, target_hit@10 = 0.1649, target_ndcg@10 = 0.0890

2024-08-03 23:22:50.383343: step 18940/75760 (epoch 20/80), loss = 1.356398 (687.754 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072407	 ndcg_5: 0.0656	 ndcg_10: 0.0820	 hit@1:0.027427	 hit@5:0.1024	 hit@10: 0.1530
target: 	 mrr: 0.046061	 ndcg_5: 0.0393	 ndcg_10: 0.0516	 hit@1:0.012764	 hit@5:0.0666	 hit@10: 0.1047
source best!
...............................................................
source: 	 mrr: 0.073625	 ndcg_5: 0.0651	 ndcg_10: 0.0819	 hit@1:0.029579	 hit@5:0.0997	 hit@10: 0.1519
epoch 20: train_loss = 1.356398, source_hit@10 = 0.1519, source_ndcg@10 = 0.0819, target_hit@10 = 0.1047, target_ndcg@10 = 0.0516

2024-08-03 23:34:22.930699: step 19887/75760 (epoch 21/80), loss = 1.352185 (685.882 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070101	 ndcg_5: 0.0621	 ndcg_10: 0.0778	 hit@1:0.027583	 hit@5:0.0971	 hit@10: 0.1460
target: 	 mrr: 0.082165	 ndcg_5: 0.0739	 ndcg_10: 0.0936	 hit@1:0.032634	 hit@5:0.1140	 hit@10: 0.1755
target best!
......................................................................................................................................................target: 	 mrr: 0.084434	 ndcg_5: 0.0766	 ndcg_10: 0.0965	 hit@1:0.034013	 hit@5:0.1186	 hit@10: 0.1810
epoch 21: train_loss = 1.352185, source_hit@10 = 0.1460, source_ndcg@10 = 0.0778, target_hit@10 = 0.1810, target_ndcg@10 = 0.0965
new best model saved.

2024-08-03 23:45:59.678195: step 20834/75760 (epoch 22/80), loss = 1.352158 (687.459 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.063675	 ndcg_5: 0.0536	 ndcg_10: 0.0700	 hit@1:0.021817	 hit@5:0.0842	 hit@10: 0.1350
target: 	 mrr: 0.059305	 ndcg_5: 0.0489	 ndcg_10: 0.0650	 hit@1:0.021712	 hit@5:0.0768	 hit@10: 0.1265
epoch 22: train_loss = 1.352158, source_hit@10 = 0.1350, source_ndcg@10 = 0.0700, target_hit@10 = 0.1265, target_ndcg@10 = 0.0650

2024-08-04 00:11:38.338846: step 21781/75760 (epoch 23/80), loss = 1.350337 (1533.309 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.046706	 ndcg_5: 0.0365	 ndcg_10: 0.0516	 hit@1:0.015272	 hit@5:0.0584	 hit@10: 0.1057
target: 	 mrr: 0.069938	 ndcg_5: 0.0598	 ndcg_10: 0.0780	 hit@1:0.024541	 hit@5:0.0953	 hit@10: 0.1520
epoch 23: train_loss = 1.350337, source_hit@10 = 0.1057, source_ndcg@10 = 0.0516, target_hit@10 = 0.1520, target_ndcg@10 = 0.0780

2024-08-04 00:44:45.894038: step 22728/75760 (epoch 24/80), loss = 1.346530 (1959.701 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057958	 ndcg_5: 0.0472	 ndcg_10: 0.0645	 hit@1:0.019791	 hit@5:0.0759	 hit@10: 0.1293
target: 	 mrr: 0.073712	 ndcg_5: 0.0646	 ndcg_10: 0.0818	 hit@1:0.028423	 hit@5:0.1001	 hit@10: 0.1536
epoch 24: train_loss = 1.346530, source_hit@10 = 0.1293, source_ndcg@10 = 0.0645, target_hit@10 = 0.1536, target_ndcg@10 = 0.0818

2024-08-04 01:16:30.007264: step 23675/75760 (epoch 25/80), loss = 1.343916 (1874.591 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.047586	 ndcg_5: 0.0389	 ndcg_10: 0.0498	 hit@1:0.018077	 hit@5:0.0600	 hit@10: 0.0941
target: 	 mrr: 0.080979	 ndcg_5: 0.0722	 ndcg_10: 0.0894	 hit@1:0.037042	 hit@5:0.1074	 hit@10: 0.1611
epoch 25: train_loss = 1.343916, source_hit@10 = 0.0941, source_ndcg@10 = 0.0498, target_hit@10 = 0.1611, target_ndcg@10 = 0.0894

2024-08-04 01:47:56.406973: step 24622/75760 (epoch 26/80), loss = 1.339726 (1855.320 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067510	 ndcg_5: 0.0587	 ndcg_10: 0.0768	 hit@1:0.022440	 hit@5:0.0952	 hit@10: 0.1521
target: 	 mrr: 0.079815	 ndcg_5: 0.0698	 ndcg_10: 0.0880	 hit@1:0.034081	 hit@5:0.1047	 hit@10: 0.1617
epoch 26: train_loss = 1.339726, source_hit@10 = 0.1521, source_ndcg@10 = 0.0768, target_hit@10 = 0.1617, target_ndcg@10 = 0.0880

2024-08-04 02:21:11.003588: step 25569/75760 (epoch 27/80), loss = 1.334898 (1964.816 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070765	 ndcg_5: 0.0613	 ndcg_10: 0.0806	 hit@1:0.025245	 hit@5:0.0972	 hit@10: 0.1572
target: 	 mrr: 0.080219	 ndcg_5: 0.0722	 ndcg_10: 0.0894	 hit@1:0.032765	 hit@5:0.1101	 hit@10: 0.1634
epoch 27: train_loss = 1.334898, source_hit@10 = 0.1572, source_ndcg@10 = 0.0806, target_hit@10 = 0.1634, target_ndcg@10 = 0.0894

2024-08-04 02:52:32.220349: step 26516/75760 (epoch 28/80), loss = 1.331431 (1850.222 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.071495	 ndcg_5: 0.0626	 ndcg_10: 0.0793	 hit@1:0.028206	 hit@5:0.0971	 hit@10: 0.1493
target: 	 mrr: 0.077989	 ndcg_5: 0.0705	 ndcg_10: 0.0865	 hit@1:0.033357	 hit@5:0.1059	 hit@10: 0.1553
epoch 28: train_loss = 1.331431, source_hit@10 = 0.1493, source_ndcg@10 = 0.0793, target_hit@10 = 0.1553, target_ndcg@10 = 0.0865

2024-08-04 03:24:56.544632: step 27463/75760 (epoch 29/80), loss = 1.329012 (1914.483 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066338	 ndcg_5: 0.0563	 ndcg_10: 0.0736	 hit@1:0.025401	 hit@5:0.0862	 hit@10: 0.1404
target: 	 mrr: 0.062305	 ndcg_5: 0.0512	 ndcg_10: 0.0687	 hit@1:0.022370	 hit@5:0.0803	 hit@10: 0.1349
epoch 29: train_loss = 1.329012, source_hit@10 = 0.1404, source_ndcg@10 = 0.0736, target_hit@10 = 0.1349, target_ndcg@10 = 0.0687

2024-08-04 03:57:34.217248: step 28410/75760 (epoch 30/80), loss = 1.325506 (1950.663 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073655	 ndcg_5: 0.0632	 ndcg_10: 0.0824	 hit@1:0.029453	 hit@5:0.0969	 hit@10: 0.1568
target: 	 mrr: 0.075234	 ndcg_5: 0.0652	 ndcg_10: 0.0856	 hit@1:0.026910	 hit@5:0.1043	 hit@10: 0.1680
source best!
...............................................................
source: 	 mrr: 0.079000	 ndcg_5: 0.0693	 ndcg_10: 0.0890	 hit@1:0.032426	 hit@5:0.1060	 hit@10: 0.1672
epoch 30: train_loss = 1.325506, source_hit@10 = 0.1672, source_ndcg@10 = 0.0890, target_hit@10 = 0.1680, target_ndcg@10 = 0.0856

2024-08-04 04:29:01.482243: step 29357/75760 (epoch 31/80), loss = 1.323556 (1847.000 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.070616	 ndcg_5: 0.0604	 ndcg_10: 0.0767	 hit@1:0.029921	 hit@5:0.0910	 hit@10: 0.1420
target: 	 mrr: 0.076996	 ndcg_5: 0.0675	 ndcg_10: 0.0860	 hit@1:0.032436	 hit@5:0.1018	 hit@10: 0.1592
epoch 31: train_loss = 1.323556, source_hit@10 = 0.1420, source_ndcg@10 = 0.0767, target_hit@10 = 0.1592, target_ndcg@10 = 0.0860

2024-08-04 05:01:54.028640: step 30304/75760 (epoch 32/80), loss = 1.320529 (1943.145 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073889	 ndcg_5: 0.0650	 ndcg_10: 0.0848	 hit@1:0.027583	 hit@5:0.1030	 hit@10: 0.1649
target: 	 mrr: 0.075610	 ndcg_5: 0.0650	 ndcg_10: 0.0841	 hit@1:0.030134	 hit@5:0.0996	 hit@10: 0.1595
source best!
...............................................................
source: 	 mrr: 0.077997	 ndcg_5: 0.0698	 ndcg_10: 0.0886	 hit@1:0.030212	 hit@5:0.1095	 hit@10: 0.1677
epoch 32: train_loss = 1.320529, source_hit@10 = 0.1677, source_ndcg@10 = 0.0886, target_hit@10 = 0.1595, target_ndcg@10 = 0.0841

2024-08-04 05:34:14.719092: step 31251/75760 (epoch 33/80), loss = 1.320118 (1908.433 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.064706	 ndcg_5: 0.0543	 ndcg_10: 0.0720	 hit@1:0.024466	 hit@5:0.0842	 hit@10: 0.1393
target: 	 mrr: 0.061575	 ndcg_5: 0.0560	 ndcg_10: 0.0702	 hit@1:0.023291	 hit@5:0.0882	 hit@10: 0.1324
epoch 33: train_loss = 1.320118, source_hit@10 = 0.1393, source_ndcg@10 = 0.0720, target_hit@10 = 0.1324, target_ndcg@10 = 0.0702

2024-08-04 06:07:13.946020: step 32198/75760 (epoch 34/80), loss = 1.316139 (1950.077 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.078867	 ndcg_5: 0.0695	 ndcg_10: 0.0885	 hit@1:0.032726	 hit@5:0.1058	 hit@10: 0.1652
target: 	 mrr: 0.076173	 ndcg_5: 0.0679	 ndcg_10: 0.0861	 hit@1:0.030660	 hit@5:0.1049	 hit@10: 0.1615
source best!
...............................................................
source: 	 mrr: 0.080290	 ndcg_5: 0.0715	 ndcg_10: 0.0915	 hit@1:0.031794	 hit@5:0.1114	 hit@10: 0.1730
epoch 34: train_loss = 1.316139, source_hit@10 = 0.1730, source_ndcg@10 = 0.0915, target_hit@10 = 0.1615, target_ndcg@10 = 0.0861

2024-08-04 06:39:38.087632: step 33145/75760 (epoch 35/80), loss = 1.312033 (1910.736 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060644	 ndcg_5: 0.0511	 ndcg_10: 0.0673	 hit@1:0.020259	 hit@5:0.0821	 hit@10: 0.1325
target: 	 mrr: 0.077014	 ndcg_5: 0.0676	 ndcg_10: 0.0846	 hit@1:0.033423	 hit@5:0.1011	 hit@10: 0.1543
epoch 35: train_loss = 1.312033, source_hit@10 = 0.1325, source_ndcg@10 = 0.0673, target_hit@10 = 0.1543, target_ndcg@10 = 0.0846

2024-08-04 07:12:34.818433: step 34092/75760 (epoch 36/80), loss = 1.309579 (1970.165 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.079189	 ndcg_5: 0.0712	 ndcg_10: 0.0905	 hit@1:0.032881	 hit@5:0.1092	 hit@10: 0.1692
target: 	 mrr: 0.084769	 ndcg_5: 0.0763	 ndcg_10: 0.0934	 hit@1:0.038226	 hit@5:0.1128	 hit@10: 0.1661
source best!
...............................................................
source: 	 mrr: 0.082012	 ndcg_5: 0.0731	 ndcg_10: 0.0925	 hit@1:0.034641	 hit@5:0.1112	 hit@10: 0.1711
target best!
......................................................................................................................................................target: 	 mrr: 0.086747	 ndcg_5: 0.0784	 ndcg_10: 0.0971	 hit@1:0.039128	 hit@5:0.1166	 hit@10: 0.1749
epoch 36: train_loss = 1.309579, source_hit@10 = 0.1711, source_ndcg@10 = 0.0925, target_hit@10 = 0.1749, target_ndcg@10 = 0.0971
new best model saved.

2024-08-04 07:44:32.660935: step 35039/75760 (epoch 37/80), loss = 1.306991 (1859.685 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.080598	 ndcg_5: 0.0718	 ndcg_10: 0.0902	 hit@1:0.032102	 hit@5:0.1099	 hit@10: 0.1669
target: 	 mrr: 0.075521	 ndcg_5: 0.0656	 ndcg_10: 0.0853	 hit@1:0.028160	 hit@5:0.1035	 hit@10: 0.1646
source best!
...............................................................
source: 	 mrr: 0.081311	 ndcg_5: 0.0728	 ndcg_10: 0.0922	 hit@1:0.033534	 hit@5:0.1133	 hit@10: 0.1737
epoch 37: train_loss = 1.306991, source_hit@10 = 0.1737, source_ndcg@10 = 0.0922, target_hit@10 = 0.1646, target_ndcg@10 = 0.0853

2024-08-04 08:18:03.249864: step 35986/75760 (epoch 38/80), loss = 1.306368 (1972.573 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057602	 ndcg_5: 0.0485	 ndcg_10: 0.0638	 hit@1:0.019635	 hit@5:0.0770	 hit@10: 0.1245
target: 	 mrr: 0.080837	 ndcg_5: 0.0716	 ndcg_10: 0.0888	 hit@1:0.034673	 hit@5:0.1076	 hit@10: 0.1613
epoch 38: train_loss = 1.306368, source_hit@10 = 0.1245, source_ndcg@10 = 0.0638, target_hit@10 = 0.1613, target_ndcg@10 = 0.0888

2024-08-04 08:51:28.626862: step 36933/75760 (epoch 39/80), loss = 1.298958 (1973.895 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.081332	 ndcg_5: 0.0738	 ndcg_10: 0.0916	 hit@1:0.034128	 hit@5:0.1134	 hit@10: 0.1688
target: 	 mrr: 0.082262	 ndcg_5: 0.0710	 ndcg_10: 0.0908	 hit@1:0.036845	 hit@5:0.1051	 hit@10: 0.1669
source best!
...............................................................
source: 	 mrr: 0.084279	 ndcg_5: 0.0762	 ndcg_10: 0.0962	 hit@1:0.034799	 hit@5:0.1174	 hit@10: 0.1795
epoch 39: train_loss = 1.298958, source_hit@10 = 0.1795, source_ndcg@10 = 0.0962, target_hit@10 = 0.1669, target_ndcg@10 = 0.0908

2024-08-04 09:24:55.889137: step 37880/75760 (epoch 40/80), loss = 1.297280 (1969.434 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.047438	 ndcg_5: 0.0414	 ndcg_10: 0.0530	 hit@1:0.016363	 hit@5:0.0669	 hit@10: 0.1030
target: 	 mrr: 0.084070	 ndcg_5: 0.0746	 ndcg_10: 0.0943	 hit@1:0.035792	 hit@5:0.1127	 hit@10: 0.1740
epoch 40: train_loss = 1.297280, source_hit@10 = 0.1030, source_ndcg@10 = 0.0530, target_hit@10 = 0.1740, target_ndcg@10 = 0.0943
shift to transfer learning mode

2024-08-04 09:56:38.437333: step 38827/75760 (epoch 41/80), loss = 1.294355 (1872.873 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065739	 ndcg_5: 0.0571	 ndcg_10: 0.0737	 hit@1:0.025245	 hit@5:0.0888	 hit@10: 0.1401
target: 	 mrr: 0.071282	 ndcg_5: 0.0612	 ndcg_10: 0.0815	 hit@1:0.024673	 hit@5:0.0988	 hit@10: 0.1615
epoch 41: train_loss = 1.294355, source_hit@10 = 0.1401, source_ndcg@10 = 0.0737, target_hit@10 = 0.1615, target_ndcg@10 = 0.0815

2024-08-04 10:30:15.350154: step 39774/75760 (epoch 42/80), loss = 1.293598 (1985.474 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076063	 ndcg_5: 0.0681	 ndcg_10: 0.0874	 hit@1:0.027739	 hit@5:0.1078	 hit@10: 0.1678
target: 	 mrr: 0.068387	 ndcg_5: 0.0596	 ndcg_10: 0.0774	 hit@1:0.026778	 hit@5:0.0922	 hit@10: 0.1474
epoch 42: train_loss = 1.293598, source_hit@10 = 0.1678, source_ndcg@10 = 0.0874, target_hit@10 = 0.1474, target_ndcg@10 = 0.0774

