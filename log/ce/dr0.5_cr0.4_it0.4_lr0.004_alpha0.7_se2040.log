nohup: ignoring input
using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.7, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=1), device_id='1', domains='cell_electronic', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='ce', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=2040, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 27519
number_item 9481
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 107984
number_item 40460
real graph loaded!
graph loaded!
Loading data from cell_electronic with batch size 1024...
unseen test: 0
test length: 6417
unseen test: 0
test length: 6322
unseen test: 0
test length: 15199
unseen test: 0
test length: 15053
source_user_num 27519
target_user_num 107984
source_item_num 9481
target_item_num 40460
shared users id: 16337
test users 2049, 2042
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 148271, target train data: 821301, source test data : 6322, target test data : 15053, source dev data : 1000, target dev data : 1000
2024-08-05 11:09:36.581724: step 947/75760 (epoch 1/80), loss = 1.357726 (250.728 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.046493	 ndcg_5: 0.0393	 ndcg_10: 0.0537	 hit@1:0.014337	 hit@5:0.0655	 hit@10: 0.1102
target: 	 mrr: 0.063889	 ndcg_5: 0.0545	 ndcg_10: 0.0735	 hit@1:0.020528	 hit@5:0.0897	 hit@10: 0.1485
source best!
...............................................................
source: 	 mrr: 0.049107	 ndcg_5: 0.0416	 ndcg_10: 0.0569	 hit@1:0.015660	 hit@5:0.0682	 hit@10: 0.1156
target best!
......................................................................................................................................................target: 	 mrr: 0.064534	 ndcg_5: 0.0554	 ndcg_10: 0.0756	 hit@1:0.019398	 hit@5:0.0923	 hit@10: 0.1548
epoch 1: train_loss = 1.357726, source_hit@10 = 0.1156, source_ndcg@10 = 0.0569, target_hit@10 = 0.1548, target_ndcg@10 = 0.0756

2024-08-05 11:13:51.766438: step 1894/75760 (epoch 2/80), loss = 1.262987 (250.736 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069063	 ndcg_5: 0.0598	 ndcg_10: 0.0784	 hit@1:0.026492	 hit@5:0.0932	 hit@10: 0.1507
target: 	 mrr: 0.056218	 ndcg_5: 0.0494	 ndcg_10: 0.0661	 hit@1:0.018291	 hit@5:0.0813	 hit@10: 0.1330
source best!
...............................................................
source: 	 mrr: 0.071419	 ndcg_5: 0.0638	 ndcg_10: 0.0813	 hit@1:0.027839	 hit@5:0.1011	 hit@10: 0.1553
epoch 2: train_loss = 1.262987, source_hit@10 = 0.1553, source_ndcg@10 = 0.0813, target_hit@10 = 0.1330, target_ndcg@10 = 0.0661
new best model saved.

2024-08-05 11:18:06.227830: step 2841/75760 (epoch 3/80), loss = 1.246425 (251.150 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.067256	 ndcg_5: 0.0574	 ndcg_10: 0.0760	 hit@1:0.026025	 hit@5:0.0888	 hit@10: 0.1462
target: 	 mrr: 0.047919	 ndcg_5: 0.0381	 ndcg_10: 0.0533	 hit@1:0.012830	 hit@5:0.0647	 hit@10: 0.1122
epoch 3: train_loss = 1.246425, source_hit@10 = 0.1462, source_ndcg@10 = 0.0760, target_hit@10 = 0.1122, target_ndcg@10 = 0.0533

2024-08-05 11:22:20.787903: step 3788/75760 (epoch 4/80), loss = 1.234820 (252.261 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066695	 ndcg_5: 0.0583	 ndcg_10: 0.0735	 hit@1:0.026804	 hit@5:0.0905	 hit@10: 0.1376
target: 	 mrr: 0.057866	 ndcg_5: 0.0472	 ndcg_10: 0.0632	 hit@1:0.019278	 hit@5:0.0762	 hit@10: 0.1259
epoch 4: train_loss = 1.234820, source_hit@10 = 0.1376, source_ndcg@10 = 0.0735, target_hit@10 = 0.1259, target_ndcg@10 = 0.0632

2024-08-05 11:26:34.608634: step 4735/75760 (epoch 5/80), loss = 1.223649 (251.448 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.062279	 ndcg_5: 0.0532	 ndcg_10: 0.0690	 hit@1:0.023220	 hit@5:0.0837	 hit@10: 0.1328
target: 	 mrr: 0.058792	 ndcg_5: 0.0480	 ndcg_10: 0.0687	 hit@1:0.016251	 hit@5:0.0820	 hit@10: 0.1467
epoch 5: train_loss = 1.223649, source_hit@10 = 0.1328, source_ndcg@10 = 0.0690, target_hit@10 = 0.1467, target_ndcg@10 = 0.0687

2024-08-05 11:30:49.736407: step 5682/75760 (epoch 6/80), loss = 1.211129 (252.818 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.054542	 ndcg_5: 0.0433	 ndcg_10: 0.0612	 hit@1:0.016207	 hit@5:0.0715	 hit@10: 0.1275
target: 	 mrr: 0.071866	 ndcg_5: 0.0618	 ndcg_10: 0.0796	 hit@1:0.028555	 hit@5:0.0941	 hit@10: 0.1495
target best!
......................................................................................................................................................target: 	 mrr: 0.074504	 ndcg_5: 0.0650	 ndcg_10: 0.0827	 hit@1:0.031821	 hit@5:0.0979	 hit@10: 0.1532
epoch 6: train_loss = 1.211129, source_hit@10 = 0.1275, source_ndcg@10 = 0.0612, target_hit@10 = 0.1532, target_ndcg@10 = 0.0827

2024-08-05 11:35:05.131159: step 6629/75760 (epoch 7/80), loss = 1.202695 (251.545 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061116	 ndcg_5: 0.0530	 ndcg_10: 0.0687	 hit@1:0.022285	 hit@5:0.0845	 hit@10: 0.1329
target: 	 mrr: 0.065563	 ndcg_5: 0.0578	 ndcg_10: 0.0728	 hit@1:0.027173	 hit@5:0.0880	 hit@10: 0.1345
epoch 7: train_loss = 1.202695, source_hit@10 = 0.1329, source_ndcg@10 = 0.0687, target_hit@10 = 0.1345, target_ndcg@10 = 0.0728

2024-08-05 11:39:19.433737: step 7576/75760 (epoch 8/80), loss = 1.194139 (252.010 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.036150	 ndcg_5: 0.0281	 ndcg_10: 0.0370	 hit@1:0.013869	 hit@5:0.0422	 hit@10: 0.0704
target: 	 mrr: 0.029522	 ndcg_5: 0.0210	 ndcg_10: 0.0284	 hit@1:0.008882	 hit@5:0.0332	 hit@10: 0.0564
epoch 8: train_loss = 1.194139, source_hit@10 = 0.0704, source_ndcg@10 = 0.0370, target_hit@10 = 0.0564, target_ndcg@10 = 0.0284

2024-08-05 11:43:33.467240: step 8523/75760 (epoch 9/80), loss = 1.189591 (251.746 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.014192	 ndcg_5: 0.0061	 ndcg_10: 0.0086	 hit@1:0.003428	 hit@5:0.0090	 hit@10: 0.0171
target: 	 mrr: 0.060855	 ndcg_5: 0.0492	 ndcg_10: 0.0665	 hit@1:0.020462	 hit@5:0.0781	 hit@10: 0.1324
epoch 9: train_loss = 1.189591, source_hit@10 = 0.0171, source_ndcg@10 = 0.0086, target_hit@10 = 0.1324, target_ndcg@10 = 0.0665

2024-08-05 11:47:48.020207: step 9470/75760 (epoch 10/80), loss = 1.181416 (252.215 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065626	 ndcg_5: 0.0593	 ndcg_10: 0.0731	 hit@1:0.025713	 hit@5:0.0927	 hit@10: 0.1357
target: 	 mrr: 0.063757	 ndcg_5: 0.0548	 ndcg_10: 0.0727	 hit@1:0.021580	 hit@5:0.0882	 hit@10: 0.1436
epoch 10: train_loss = 1.181416, source_hit@10 = 0.1357, source_ndcg@10 = 0.0731, target_hit@10 = 0.1436, target_ndcg@10 = 0.0727

2024-08-05 11:52:01.984214: step 10417/75760 (epoch 11/80), loss = 1.177493 (251.623 sec/epoch), lr: 0.004000
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.026386	 ndcg_5: 0.0224	 ndcg_10: 0.0271	 hit@1:0.011999	 hit@5:0.0327	 hit@10: 0.0474
target: 	 mrr: 0.054013	 ndcg_5: 0.0424	 ndcg_10: 0.0631	 hit@1:0.012830	 hit@5:0.0740	 hit@10: 0.1381
epoch 11: train_loss = 1.177493, source_hit@10 = 0.0474, source_ndcg@10 = 0.0271, target_hit@10 = 0.1381, target_ndcg@10 = 0.0631

2024-08-05 11:56:16.571621: step 11364/75760 (epoch 12/80), loss = 1.171750 (252.304 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.051161	 ndcg_5: 0.0437	 ndcg_10: 0.0571	 hit@1:0.019012	 hit@5:0.0683	 hit@10: 0.1097
target: 	 mrr: 0.039660	 ndcg_5: 0.0252	 ndcg_10: 0.0380	 hit@1:0.009145	 hit@5:0.0419	 hit@10: 0.0818
epoch 12: train_loss = 1.171750, source_hit@10 = 0.1097, source_ndcg@10 = 0.0571, target_hit@10 = 0.0818, target_ndcg@10 = 0.0380

2024-08-05 12:00:32.618146: step 12311/75760 (epoch 13/80), loss = 1.168151 (253.759 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050999	 ndcg_5: 0.0444	 ndcg_10: 0.0554	 hit@1:0.020259	 hit@5:0.0676	 hit@10: 0.1018
target: 	 mrr: 0.061586	 ndcg_5: 0.0535	 ndcg_10: 0.0684	 hit@1:0.023291	 hit@5:0.0830	 hit@10: 0.1294
epoch 13: train_loss = 1.168151, source_hit@10 = 0.1018, source_ndcg@10 = 0.0554, target_hit@10 = 0.1294, target_ndcg@10 = 0.0684

2024-08-05 12:04:46.784410: step 13258/75760 (epoch 14/80), loss = 1.167443 (251.853 sec/epoch), lr: 0.003800
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.061029	 ndcg_5: 0.0523	 ndcg_10: 0.0698	 hit@1:0.022596	 hit@5:0.0826	 hit@10: 0.1373
target: 	 mrr: 0.044215	 ndcg_5: 0.0313	 ndcg_10: 0.0460	 hit@1:0.011580	 hit@5:0.0518	 hit@10: 0.0980
epoch 14: train_loss = 1.167443, source_hit@10 = 0.1373, source_ndcg@10 = 0.0698, target_hit@10 = 0.0980, target_ndcg@10 = 0.0460

2024-08-05 12:09:01.117496: step 14205/75760 (epoch 15/80), loss = 1.162629 (251.978 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.035425	 ndcg_5: 0.0275	 ndcg_10: 0.0369	 hit@1:0.014025	 hit@5:0.0405	 hit@10: 0.0697
target: 	 mrr: 0.072532	 ndcg_5: 0.0601	 ndcg_10: 0.0795	 hit@1:0.028226	 hit@5:0.0912	 hit@10: 0.1517
target best!
......................................................................................................................................................target: 	 mrr: 0.075325	 ndcg_5: 0.0627	 ndcg_10: 0.0808	 hit@1:0.031821	 hit@5:0.0924	 hit@10: 0.1491
epoch 15: train_loss = 1.162629, source_hit@10 = 0.0697, source_ndcg@10 = 0.0369, target_hit@10 = 0.1491, target_ndcg@10 = 0.0808

2024-08-05 12:13:17.329971: step 15152/75760 (epoch 16/80), loss = 1.162768 (252.383 sec/epoch), lr: 0.003610
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.042957	 ndcg_5: 0.0358	 ndcg_10: 0.0468	 hit@1:0.015739	 hit@5:0.0566	 hit@10: 0.0907
target: 	 mrr: 0.059540	 ndcg_5: 0.0471	 ndcg_10: 0.0664	 hit@1:0.018422	 hit@5:0.0767	 hit@10: 0.1368
epoch 16: train_loss = 1.162768, source_hit@10 = 0.0907, source_ndcg@10 = 0.0468, target_hit@10 = 0.1368, target_ndcg@10 = 0.0664

2024-08-05 12:17:32.546818: step 16099/75760 (epoch 17/80), loss = 1.159748 (252.920 sec/epoch), lr: 0.003429
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.053343	 ndcg_5: 0.0484	 ndcg_10: 0.0606	 hit@1:0.021350	 hit@5:0.0750	 hit@10: 0.1127
target: 	 mrr: 0.048269	 ndcg_5: 0.0372	 ndcg_10: 0.0542	 hit@1:0.012830	 hit@5:0.0632	 hit@10: 0.1163
epoch 17: train_loss = 1.159748, source_hit@10 = 0.1127, source_ndcg@10 = 0.0606, target_hit@10 = 0.1163, target_ndcg@10 = 0.0542

2024-08-05 12:21:46.280517: step 17046/75760 (epoch 18/80), loss = 1.153690 (251.444 sec/epoch), lr: 0.003258
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.021408	 ndcg_5: 0.0157	 ndcg_10: 0.0202	 hit@1:0.008727	 hit@5:0.0231	 hit@10: 0.0371
target: 	 mrr: 0.058554	 ndcg_5: 0.0485	 ndcg_10: 0.0642	 hit@1:0.019343	 hit@5:0.0782	 hit@10: 0.1269
epoch 18: train_loss = 1.153690, source_hit@10 = 0.0371, source_ndcg@10 = 0.0202, target_hit@10 = 0.1269, target_ndcg@10 = 0.0642

2024-08-05 12:26:00.799308: step 17993/75760 (epoch 19/80), loss = 1.152802 (252.229 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.042891	 ndcg_5: 0.0330	 ndcg_10: 0.0466	 hit@1:0.014025	 hit@5:0.0533	 hit@10: 0.0955
target: 	 mrr: 0.045215	 ndcg_5: 0.0350	 ndcg_10: 0.0463	 hit@1:0.015462	 hit@5:0.0548	 hit@10: 0.0900
epoch 19: train_loss = 1.152802, source_hit@10 = 0.0955, source_ndcg@10 = 0.0466, target_hit@10 = 0.0900, target_ndcg@10 = 0.0463

2024-08-05 12:30:15.348705: step 18940/75760 (epoch 20/80), loss = 1.151440 (252.243 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.050554	 ndcg_5: 0.0417	 ndcg_10: 0.0559	 hit@1:0.016674	 hit@5:0.0681	 hit@10: 0.1124
target: 	 mrr: 0.052856	 ndcg_5: 0.0436	 ndcg_10: 0.0583	 hit@1:0.019014	 hit@5:0.0684	 hit@10: 0.1141
epoch 20: train_loss = 1.151440, source_hit@10 = 0.1124, source_ndcg@10 = 0.0559, target_hit@10 = 0.1141, target_ndcg@10 = 0.0583

2024-08-05 12:34:29.996397: step 19887/75760 (epoch 21/80), loss = 1.150835 (252.352 sec/epoch), lr: 0.003095
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.034272	 ndcg_5: 0.0255	 ndcg_10: 0.0347	 hit@1:0.011688	 hit@5:0.0402	 hit@10: 0.0686
target: 	 mrr: 0.067304	 ndcg_5: 0.0570	 ndcg_10: 0.0772	 hit@1:0.024607	 hit@5:0.0907	 hit@10: 0.1535
epoch 21: train_loss = 1.150835, source_hit@10 = 0.0686, source_ndcg@10 = 0.0347, target_hit@10 = 0.1535, target_ndcg@10 = 0.0772

2024-08-05 12:38:45.175330: step 20834/75760 (epoch 22/80), loss = 1.147158 (252.862 sec/epoch), lr: 0.002940
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052437	 ndcg_5: 0.0435	 ndcg_10: 0.0569	 hit@1:0.019012	 hit@5:0.0678	 hit@10: 0.1096
target: 	 mrr: 0.036543	 ndcg_5: 0.0266	 ndcg_10: 0.0417	 hit@1:0.006250	 hit@5:0.0489	 hit@10: 0.0957
epoch 22: train_loss = 1.147158, source_hit@10 = 0.1096, source_ndcg@10 = 0.0569, target_hit@10 = 0.0957, target_ndcg@10 = 0.0417

2024-08-05 12:42:59.179356: step 21781/75760 (epoch 23/80), loss = 1.144473 (251.632 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.069933	 ndcg_5: 0.0612	 ndcg_10: 0.0766	 hit@1:0.028050	 hit@5:0.0929	 hit@10: 0.1410
target: 	 mrr: 0.085778	 ndcg_5: 0.0770	 ndcg_10: 0.0960	 hit@1:0.037831	 hit@5:0.1153	 hit@10: 0.1745
source best!
...............................................................
source: 	 mrr: 0.072477	 ndcg_5: 0.0638	 ndcg_10: 0.0810	 hit@1:0.029579	 hit@5:0.0973	 hit@10: 0.1511
target best!
......................................................................................................................................................target: 	 mrr: 0.087131	 ndcg_5: 0.0789	 ndcg_10: 0.0979	 hit@1:0.038398	 hit@5:0.1194	 hit@10: 0.1786
epoch 23: train_loss = 1.144473, source_hit@10 = 0.1511, source_ndcg@10 = 0.0810, target_hit@10 = 0.1786, target_ndcg@10 = 0.0979
new best model saved.

2024-08-05 12:47:16.011618: step 22728/75760 (epoch 24/80), loss = 1.142323 (252.089 sec/epoch), lr: 0.002793
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072670	 ndcg_5: 0.0632	 ndcg_10: 0.0807	 hit@1:0.030076	 hit@5:0.0966	 hit@10: 0.1512
target: 	 mrr: 0.029851	 ndcg_5: 0.0195	 ndcg_10: 0.0252	 hit@1:0.009211	 hit@5:0.0294	 hit@10: 0.0474
source best!
...............................................................
source: 	 mrr: 0.075072	 ndcg_5: 0.0669	 ndcg_10: 0.0863	 hit@1:0.028472	 hit@5:0.1057	 hit@10: 0.1658
epoch 24: train_loss = 1.142323, source_hit@10 = 0.1658, source_ndcg@10 = 0.0863, target_hit@10 = 0.0474, target_ndcg@10 = 0.0252

2024-08-05 12:51:31.399871: step 23675/75760 (epoch 25/80), loss = 1.140355 (252.468 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.045549	 ndcg_5: 0.0366	 ndcg_10: 0.0513	 hit@1:0.011999	 hit@5:0.0626	 hit@10: 0.1083
target: 	 mrr: 0.068296	 ndcg_5: 0.0584	 ndcg_10: 0.0765	 hit@1:0.024738	 hit@5:0.0925	 hit@10: 0.1486
epoch 25: train_loss = 1.140355, source_hit@10 = 0.1083, source_ndcg@10 = 0.0513, target_hit@10 = 0.1486, target_ndcg@10 = 0.0765

2024-08-05 12:55:46.377591: step 24622/75760 (epoch 26/80), loss = 1.139714 (252.622 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.038914	 ndcg_5: 0.0295	 ndcg_10: 0.0402	 hit@1:0.014337	 hit@5:0.0449	 hit@10: 0.0781
target: 	 mrr: 0.079922	 ndcg_5: 0.0704	 ndcg_10: 0.0886	 hit@1:0.034410	 hit@5:0.1061	 hit@10: 0.1632
epoch 26: train_loss = 1.139714, source_hit@10 = 0.0781, source_ndcg@10 = 0.0402, target_hit@10 = 0.1632, target_ndcg@10 = 0.0886

2024-08-05 13:00:00.382187: step 25569/75760 (epoch 27/80), loss = 1.140045 (251.650 sec/epoch), lr: 0.002654
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.041763	 ndcg_5: 0.0316	 ndcg_10: 0.0428	 hit@1:0.016519	 hit@5:0.0474	 hit@10: 0.0823
target: 	 mrr: 0.057480	 ndcg_5: 0.0484	 ndcg_10: 0.0628	 hit@1:0.018751	 hit@5:0.0780	 hit@10: 0.1229
epoch 27: train_loss = 1.140045, source_hit@10 = 0.0823, source_ndcg@10 = 0.0428, target_hit@10 = 0.1229, target_ndcg@10 = 0.0628

2024-08-05 13:04:14.810806: step 26516/75760 (epoch 28/80), loss = 1.135913 (252.138 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.045818	 ndcg_5: 0.0357	 ndcg_10: 0.0489	 hit@1:0.016986	 hit@5:0.0542	 hit@10: 0.0957
target: 	 mrr: 0.069363	 ndcg_5: 0.0613	 ndcg_10: 0.0786	 hit@1:0.023291	 hit@5:0.0993	 hit@10: 0.1530
epoch 28: train_loss = 1.135913, source_hit@10 = 0.0957, source_ndcg@10 = 0.0489, target_hit@10 = 0.1530, target_ndcg@10 = 0.0786

2024-08-05 13:08:28.907891: step 27463/75760 (epoch 29/80), loss = 1.137809 (251.791 sec/epoch), lr: 0.002521
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.041388	 ndcg_5: 0.0321	 ndcg_10: 0.0452	 hit@1:0.012467	 hit@5:0.0524	 hit@10: 0.0930
target: 	 mrr: 0.057414	 ndcg_5: 0.0475	 ndcg_10: 0.0638	 hit@1:0.018028	 hit@5:0.0774	 hit@10: 0.1281
epoch 29: train_loss = 1.137809, source_hit@10 = 0.0930, source_ndcg@10 = 0.0452, target_hit@10 = 0.1281, target_ndcg@10 = 0.0638

2024-08-05 13:12:42.963718: step 28410/75760 (epoch 30/80), loss = 1.134102 (251.725 sec/epoch), lr: 0.002395
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.032139	 ndcg_5: 0.0253	 ndcg_10: 0.0319	 hit@1:0.014337	 hit@5:0.0362	 hit@10: 0.0566
target: 	 mrr: 0.061045	 ndcg_5: 0.0500	 ndcg_10: 0.0656	 hit@1:0.024541	 hit@5:0.0753	 hit@10: 0.1239
epoch 30: train_loss = 1.134102, source_hit@10 = 0.0566, source_ndcg@10 = 0.0319, target_hit@10 = 0.1239, target_ndcg@10 = 0.0656

2024-08-05 13:16:57.852001: step 29357/75760 (epoch 31/80), loss = 1.131101 (252.544 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.068956	 ndcg_5: 0.0609	 ndcg_10: 0.0764	 hit@1:0.027583	 hit@5:0.0944	 hit@10: 0.1429
target: 	 mrr: 0.081202	 ndcg_5: 0.0710	 ndcg_10: 0.0894	 hit@1:0.037042	 hit@5:0.1042	 hit@10: 0.1615
epoch 31: train_loss = 1.131101, source_hit@10 = 0.1429, source_ndcg@10 = 0.0764, target_hit@10 = 0.1615, target_ndcg@10 = 0.0894

2024-08-05 13:21:12.408222: step 30304/75760 (epoch 32/80), loss = 1.131598 (252.160 sec/epoch), lr: 0.002275
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.052415	 ndcg_5: 0.0430	 ndcg_10: 0.0580	 hit@1:0.016051	 hit@5:0.0709	 hit@10: 0.1178
target: 	 mrr: 0.060305	 ndcg_5: 0.0489	 ndcg_10: 0.0655	 hit@1:0.021383	 hit@5:0.0765	 hit@10: 0.1282
epoch 32: train_loss = 1.131598, source_hit@10 = 0.1178, source_ndcg@10 = 0.0580, target_hit@10 = 0.1282, target_ndcg@10 = 0.0655

2024-08-05 13:25:26.955463: step 31251/75760 (epoch 33/80), loss = 1.127640 (252.224 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073113	 ndcg_5: 0.0646	 ndcg_10: 0.0818	 hit@1:0.029141	 hit@5:0.1000	 hit@10: 0.1533
target: 	 mrr: 0.079081	 ndcg_5: 0.0682	 ndcg_10: 0.0887	 hit@1:0.035200	 hit@5:0.1025	 hit@10: 0.1665
source best!
...............................................................
source: 	 mrr: 0.076533	 ndcg_5: 0.0676	 ndcg_10: 0.0870	 hit@1:0.030686	 hit@5:0.1041	 hit@10: 0.1645
epoch 33: train_loss = 1.127640, source_hit@10 = 0.1645, source_ndcg@10 = 0.0870, target_hit@10 = 0.1665, target_ndcg@10 = 0.0887

2024-08-05 13:29:42.146238: step 32198/75760 (epoch 34/80), loss = 1.125413 (252.251 sec/epoch), lr: 0.002161
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065494	 ndcg_5: 0.0574	 ndcg_10: 0.0724	 hit@1:0.024934	 hit@5:0.0891	 hit@10: 0.1359
target: 	 mrr: 0.043535	 ndcg_5: 0.0330	 ndcg_10: 0.0449	 hit@1:0.013948	 hit@5:0.0522	 hit@10: 0.0894
epoch 34: train_loss = 1.125413, source_hit@10 = 0.1359, source_ndcg@10 = 0.0724, target_hit@10 = 0.0894, target_ndcg@10 = 0.0449

2024-08-05 13:33:56.908532: step 33145/75760 (epoch 35/80), loss = 1.123579 (252.449 sec/epoch), lr: 0.002053
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.042889	 ndcg_5: 0.0359	 ndcg_10: 0.0440	 hit@1:0.019012	 hit@5:0.0536	 hit@10: 0.0792
target: 	 mrr: 0.064117	 ndcg_5: 0.0541	 ndcg_10: 0.0703	 hit@1:0.024212	 hit@5:0.0828	 hit@10: 0.1334
epoch 35: train_loss = 1.123579, source_hit@10 = 0.0792, source_ndcg@10 = 0.0440, target_hit@10 = 0.1334, target_ndcg@10 = 0.0703

2024-08-05 13:38:10.495898: step 34092/75760 (epoch 36/80), loss = 1.120897 (251.279 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076659	 ndcg_5: 0.0677	 ndcg_10: 0.0848	 hit@1:0.033037	 hit@5:0.1018	 hit@10: 0.1549
target: 	 mrr: 0.081527	 ndcg_5: 0.0722	 ndcg_10: 0.0907	 hit@1:0.036318	 hit@5:0.1065	 hit@10: 0.1645
source best!
...............................................................
source: 	 mrr: 0.078950	 ndcg_5: 0.0700	 ndcg_10: 0.0889	 hit@1:0.032426	 hit@5:0.1068	 hit@10: 0.1651
epoch 36: train_loss = 1.120897, source_hit@10 = 0.1651, source_ndcg@10 = 0.0889, target_hit@10 = 0.1645, target_ndcg@10 = 0.0907

2024-08-05 13:42:25.064017: step 35039/75760 (epoch 37/80), loss = 1.120666 (251.604 sec/epoch), lr: 0.001951
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.049994	 ndcg_5: 0.0412	 ndcg_10: 0.0549	 hit@1:0.017765	 hit@5:0.0651	 hit@10: 0.1080
target: 	 mrr: 0.078231	 ndcg_5: 0.0699	 ndcg_10: 0.0862	 hit@1:0.035923	 hit@5:0.1029	 hit@10: 0.1536
epoch 37: train_loss = 1.120666, source_hit@10 = 0.1080, source_ndcg@10 = 0.0549, target_hit@10 = 0.1536, target_ndcg@10 = 0.0862

2024-08-05 13:46:38.631971: step 35986/75760 (epoch 38/80), loss = 1.119766 (251.267 sec/epoch), lr: 0.001853
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.023725	 ndcg_5: 0.0189	 ndcg_10: 0.0233	 hit@1:0.011220	 hit@5:0.0262	 hit@10: 0.0399
target: 	 mrr: 0.064361	 ndcg_5: 0.0540	 ndcg_10: 0.0734	 hit@1:0.021646	 hit@5:0.0870	 hit@10: 0.1472
epoch 38: train_loss = 1.119766, source_hit@10 = 0.0399, source_ndcg@10 = 0.0233, target_hit@10 = 0.1472, target_ndcg@10 = 0.0734

2024-08-05 13:50:53.859386: step 36933/75760 (epoch 39/80), loss = 1.112977 (252.877 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.072667	 ndcg_5: 0.0622	 ndcg_10: 0.0810	 hit@1:0.029453	 hit@5:0.0941	 hit@10: 0.1529
target: 	 mrr: 0.080587	 ndcg_5: 0.0702	 ndcg_10: 0.0895	 hit@1:0.035068	 hit@5:0.1045	 hit@10: 0.1646
epoch 39: train_loss = 1.112977, source_hit@10 = 0.1529, source_ndcg@10 = 0.0810, target_hit@10 = 0.1646, target_ndcg@10 = 0.0895

2024-08-05 13:55:08.679450: step 37880/75760 (epoch 40/80), loss = 1.109645 (252.519 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.077187	 ndcg_5: 0.0679	 ndcg_10: 0.0871	 hit@1:0.032414	 hit@5:0.1033	 hit@10: 0.1630
target: 	 mrr: 0.077403	 ndcg_5: 0.0680	 ndcg_10: 0.0851	 hit@1:0.034147	 hit@5:0.1008	 hit@10: 0.1540
source best!
...............................................................
source: 	 mrr: 0.076823	 ndcg_5: 0.0677	 ndcg_10: 0.0864	 hit@1:0.032110	 hit@5:0.1046	 hit@10: 0.1631
epoch 40: train_loss = 1.109645, source_hit@10 = 0.1631, source_ndcg@10 = 0.0864, target_hit@10 = 0.1540, target_ndcg@10 = 0.0851
shift to transfer learning mode

2024-08-05 13:59:27.787470: step 38827/75760 (epoch 41/80), loss = 1.106999 (256.179 sec/epoch), lr: 0.001761
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.060630	 ndcg_5: 0.0510	 ndcg_10: 0.0666	 hit@1:0.021973	 hit@5:0.0806	 hit@10: 0.1292
target: 	 mrr: 0.066455	 ndcg_5: 0.0571	 ndcg_10: 0.0720	 hit@1:0.030199	 hit@5:0.0832	 hit@10: 0.1292
epoch 41: train_loss = 1.106999, source_hit@10 = 0.1292, source_ndcg@10 = 0.0666, target_hit@10 = 0.1292, target_ndcg@10 = 0.0720

2024-08-05 14:03:45.700827: step 39774/75760 (epoch 42/80), loss = 1.101253 (255.602 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.076376	 ndcg_5: 0.0685	 ndcg_10: 0.0865	 hit@1:0.029453	 hit@5:0.1069	 hit@10: 0.1628
target: 	 mrr: 0.081295	 ndcg_5: 0.0718	 ndcg_10: 0.0888	 hit@1:0.036516	 hit@5:0.1054	 hit@10: 0.1583
epoch 42: train_loss = 1.101253, source_hit@10 = 0.1628, source_ndcg@10 = 0.0865, target_hit@10 = 0.1583, target_ndcg@10 = 0.0888

2024-08-05 14:08:03.507219: step 40721/75760 (epoch 43/80), loss = 1.097221 (255.458 sec/epoch), lr: 0.001672
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.066974	 ndcg_5: 0.0586	 ndcg_10: 0.0749	 hit@1:0.024155	 hit@5:0.0927	 hit@10: 0.1437
target: 	 mrr: 0.064773	 ndcg_5: 0.0547	 ndcg_10: 0.0706	 hit@1:0.026778	 hit@5:0.0827	 hit@10: 0.1323
epoch 43: train_loss = 1.097221, source_hit@10 = 0.1437, source_ndcg@10 = 0.0749, target_hit@10 = 0.1323, target_ndcg@10 = 0.0706

2024-08-05 14:12:20.926606: step 41668/75760 (epoch 44/80), loss = 1.094136 (255.121 sec/epoch), lr: 0.001589
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.028132	 ndcg_5: 0.0219	 ndcg_10: 0.0285	 hit@1:0.007792	 hit@5:0.0365	 hit@10: 0.0572
target: 	 mrr: 0.078679	 ndcg_5: 0.0698	 ndcg_10: 0.0867	 hit@1:0.034805	 hit@5:0.1041	 hit@10: 0.1567
epoch 44: train_loss = 1.094136, source_hit@10 = 0.0572, source_ndcg@10 = 0.0285, target_hit@10 = 0.1567, target_ndcg@10 = 0.0867

2024-08-05 14:16:38.686214: step 42615/75760 (epoch 45/80), loss = 1.088236 (255.428 sec/epoch), lr: 0.001509
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.033828	 ndcg_5: 0.0230	 ndcg_10: 0.0341	 hit@1:0.008571	 hit@5:0.0376	 hit@10: 0.0726
target: 	 mrr: 0.080976	 ndcg_5: 0.0712	 ndcg_10: 0.0892	 hit@1:0.037305	 hit@5:0.1046	 hit@10: 0.1607
epoch 45: train_loss = 1.088236, source_hit@10 = 0.0726, source_ndcg@10 = 0.0341, target_hit@10 = 0.1607, target_ndcg@10 = 0.0892

2024-08-05 14:20:56.285471: step 43562/75760 (epoch 46/80), loss = 1.085547 (255.247 sec/epoch), lr: 0.001509
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.073660	 ndcg_5: 0.0650	 ndcg_10: 0.0836	 hit@1:0.027895	 hit@5:0.1016	 hit@10: 0.1590
target: 	 mrr: 0.070453	 ndcg_5: 0.0586	 ndcg_10: 0.0775	 hit@1:0.028555	 hit@5:0.0889	 hit@10: 0.1474
epoch 46: train_loss = 1.085547, source_hit@10 = 0.1590, source_ndcg@10 = 0.0836, target_hit@10 = 0.1474, target_ndcg@10 = 0.0775

2024-08-05 14:25:15.262570: step 44509/75760 (epoch 47/80), loss = 1.084089 (256.584 sec/epoch), lr: 0.001509
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.040938	 ndcg_5: 0.0316	 ndcg_10: 0.0436	 hit@1:0.012311	 hit@5:0.0516	 hit@10: 0.0891
target: 	 mrr: 0.077712	 ndcg_5: 0.0691	 ndcg_10: 0.0875	 hit@1:0.031844	 hit@5:0.1057	 hit@10: 0.1626
epoch 47: train_loss = 1.084089, source_hit@10 = 0.0891, source_ndcg@10 = 0.0436, target_hit@10 = 0.1626, target_ndcg@10 = 0.0875

2024-08-05 14:29:32.810958: step 45456/75760 (epoch 48/80), loss = 1.081345 (255.227 sec/epoch), lr: 0.001434
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.080737	 ndcg_5: 0.0714	 ndcg_10: 0.0905	 hit@1:0.035375	 hit@5:0.1075	 hit@10: 0.1666
target: 	 mrr: 0.078049	 ndcg_5: 0.0689	 ndcg_10: 0.0872	 hit@1:0.032700	 hit@5:0.1047	 hit@10: 0.1617
source best!
...............................................................
source: 	 mrr: 0.081488	 ndcg_5: 0.0733	 ndcg_10: 0.0927	 hit@1:0.033376	 hit@5:0.1131	 hit@10: 0.1737
epoch 48: train_loss = 1.081345, source_hit@10 = 0.1737, source_ndcg@10 = 0.0927, target_hit@10 = 0.1617, target_ndcg@10 = 0.0872

2024-08-05 14:33:50.937854: step 46403/75760 (epoch 49/80), loss = 1.077963 (255.179 sec/epoch), lr: 0.001434
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.071165	 ndcg_5: 0.0619	 ndcg_10: 0.0805	 hit@1:0.027427	 hit@5:0.0960	 hit@10: 0.1540
target: 	 mrr: 0.081847	 ndcg_5: 0.0722	 ndcg_10: 0.0919	 hit@1:0.035068	 hit@5:0.1082	 hit@10: 0.1694
epoch 49: train_loss = 1.077963, source_hit@10 = 0.1540, source_ndcg@10 = 0.0805, target_hit@10 = 0.1694, target_ndcg@10 = 0.0919

2024-08-05 14:38:05.239760: step 47350/75760 (epoch 50/80), loss = 1.074984 (251.925 sec/epoch), lr: 0.001362
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.035685	 ndcg_5: 0.0256	 ndcg_10: 0.0364	 hit@1:0.009506	 hit@5:0.0424	 hit@10: 0.0760
target: 	 mrr: 0.079323	 ndcg_5: 0.0704	 ndcg_10: 0.0898	 hit@1:0.033226	 hit@5:0.1075	 hit@10: 0.1676
epoch 50: train_loss = 1.074984, source_hit@10 = 0.0760, source_ndcg@10 = 0.0364, target_hit@10 = 0.1676, target_ndcg@10 = 0.0898

2024-08-05 14:42:17.204645: step 48297/75760 (epoch 51/80), loss = 1.071792 (249.706 sec/epoch), lr: 0.001294
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.057461	 ndcg_5: 0.0476	 ndcg_10: 0.0636	 hit@1:0.020103	 hit@5:0.0756	 hit@10: 0.1250
target: 	 mrr: 0.091481	 ndcg_5: 0.0834	 ndcg_10: 0.1029	 hit@1:0.041187	 hit@5:0.1234	 hit@10: 0.1836
target best!
......................................................................................................................................................target: 	 mrr: 0.092928	 ndcg_5: 0.0859	 ndcg_10: 0.1046	 hit@1:0.042051	 hit@5:0.1281	 hit@10: 0.1863
epoch 51: train_loss = 1.071792, source_hit@10 = 0.1250, source_ndcg@10 = 0.0636, target_hit@10 = 0.1863, target_ndcg@10 = 0.1046

2024-08-05 14:46:30.340807: step 49244/75760 (epoch 52/80), loss = 1.071147 (249.371 sec/epoch), lr: 0.001294
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.044484	 ndcg_5: 0.0336	 ndcg_10: 0.0453	 hit@1:0.015428	 hit@5:0.0524	 hit@10: 0.0891
target: 	 mrr: 0.081651	 ndcg_5: 0.0721	 ndcg_10: 0.0921	 hit@1:0.035792	 hit@5:0.1086	 hit@10: 0.1705
epoch 52: train_loss = 1.071147, source_hit@10 = 0.0891, source_ndcg@10 = 0.0453, target_hit@10 = 0.1705, target_ndcg@10 = 0.0921

2024-08-05 14:50:44.807321: step 50191/75760 (epoch 53/80), loss = 1.066645 (252.196 sec/epoch), lr: 0.001229
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.065514	 ndcg_5: 0.0550	 ndcg_10: 0.0733	 hit@1:0.024778	 hit@5:0.0852	 hit@10: 0.1421
target: 	 mrr: 0.085463	 ndcg_5: 0.0779	 ndcg_10: 0.0962	 hit@1:0.036121	 hit@5:0.1188	 hit@10: 0.1758
epoch 53: train_loss = 1.066645, source_hit@10 = 0.1421, source_ndcg@10 = 0.0733, target_hit@10 = 0.1758, target_ndcg@10 = 0.0962

2024-08-05 14:54:55.967670: step 51138/75760 (epoch 54/80), loss = 1.066213 (248.914 sec/epoch), lr: 0.001229
Evaluating on dev set...
.......................................................................................................................................................................................................................
source: 	 mrr: 0.055335	 ndcg_5: 0.0449	 ndcg_10: 0.0612	 hit@1:0.018077	 hit@5:0.0715	 hit@10: 0.1228
target: 	 mrr: 0.086959	 ndcg_5: 0.0779	 ndcg_10: 0.0958	 hit@1:0.039213	 hit@5:0.1153	 hit@10: 0.1714
epoch 54: train_loss = 1.066213, source_hit@10 = 0.1228, source_ndcg@10 = 0.0612, target_hit@10 = 0.1714, target_ndcg@10 = 0.0958
early termination of training
