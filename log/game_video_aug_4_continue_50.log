nohup: ignoring input
using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, batch_size=1024, beta=1.5, conv_layers=4, cuda=True, decay_epoch=5, device=device(type='cuda', index=1), device_id='1', domains='game_video', dropout=0.2, epoch=70, feature_dim=126, hidden_dim=126, keep_prob=0.6, lambda_constra=0.3, lambda_critic=0.3, lambda_ease=50, leakey=0.01, load=True, log='logs.txt', log_epoch=1, lr=0.0005, lr_decay=0.95, lr_transfer=0.0005, min_epoch=50, mode='train', model_file='single_50.pt', model_name='gv_4', num_latent_factors=3, num_negative=10, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=32, sim_threshold=0.9, tau=0.4, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:47: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
augmented graph loaded!
number_user 19457
number_item 8751
real graph loaded!
augmented graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
Loading model from ./saved_models/gv_4/single_50.pt
2024-07-11 10:35:14.224335: step 304/21280 (epoch 50/70), loss = 0.545993 (23.085 sec/epoch), lr: 0.000500
Evaluating on dev set...
....................
source: 	 mrr: 0.182564	 ndcg_5: 0.1724	 ndcg_10: 0.2128	 hit@1:0.087000	 hit@5:0.2570	 hit@10: 0.3820
target: 	 mrr: 0.206549	 ndcg_5: 0.2002	 ndcg_10: 0.2570	 hit@1:0.079000	 hit@5:0.3170	 hit@10: 0.4930
new best model saved.

2024-07-11 10:35:36.846835: step 608/21280 (epoch 51/70), loss = 0.502672 (22.277 sec/epoch), lr: 0.000500
Evaluating on dev set...
...........................
source: 	 mrr: 0.043955	 ndcg_5: 0.0329	 ndcg_10: 0.0439	 hit@1:0.015206	 hit@5:0.0492	 hit@10: 0.0833
target: 	 mrr: 0.061040	 ndcg_5: 0.0541	 ndcg_10: 0.0673	 hit@1:0.022997	 hit@5:0.0850	 hit@10: 0.1261
epoch 51: train_loss = 0.502672, source_hit@10 = 0.0833, source_ndcg@10 = 0.0439, target_hit@10 = 0.1261, target_ndcg@10 = 0.0673

2024-07-11 10:35:59.346286: step 912/21280 (epoch 52/70), loss = 0.475758 (22.187 sec/epoch), lr: 0.000475
Evaluating on dev set...
...........................
source: 	 mrr: 0.041688	 ndcg_5: 0.0313	 ndcg_10: 0.0400	 hit@1:0.015206	 hit@5:0.0456	 hit@10: 0.0731
target: 	 mrr: 0.059644	 ndcg_5: 0.0520	 ndcg_10: 0.0642	 hit@1:0.023693	 hit@5:0.0801	 hit@10: 0.1185
epoch 52: train_loss = 0.475758, source_hit@10 = 0.0731, source_ndcg@10 = 0.0400, target_hit@10 = 0.1185, target_ndcg@10 = 0.0642

2024-07-11 10:36:21.828810: step 1216/21280 (epoch 53/70), loss = 0.457763 (22.171 sec/epoch), lr: 0.000451
Evaluating on dev set...
...........................
source: 	 mrr: 0.044206	 ndcg_5: 0.0336	 ndcg_10: 0.0425	 hit@1:0.016655	 hit@5:0.0500	 hit@10: 0.0782
target: 	 mrr: 0.069047	 ndcg_5: 0.0622	 ndcg_10: 0.0749	 hit@1:0.029965	 hit@5:0.0913	 hit@10: 0.1317
epoch 53: train_loss = 0.457763, source_hit@10 = 0.0782, source_ndcg@10 = 0.0425, target_hit@10 = 0.1317, target_ndcg@10 = 0.0749

2024-07-11 10:36:44.319537: step 1520/21280 (epoch 54/70), loss = 0.442439 (22.182 sec/epoch), lr: 0.000451
Evaluating on dev set...
...........................
source: 	 mrr: 0.037809	 ndcg_5: 0.0277	 ndcg_10: 0.0352	 hit@1:0.013758	 hit@5:0.0434	 hit@10: 0.0666
target: 	 mrr: 0.057205	 ndcg_5: 0.0484	 ndcg_10: 0.0589	 hit@1:0.025087	 hit@5:0.0725	 hit@10: 0.1052
epoch 54: train_loss = 0.442439, source_hit@10 = 0.0666, source_ndcg@10 = 0.0352, target_hit@10 = 0.1052, target_ndcg@10 = 0.0589

2024-07-11 10:37:06.790679: step 1824/21280 (epoch 55/70), loss = 0.426899 (22.163 sec/epoch), lr: 0.000429
Evaluating on dev set...
...........................
source: 	 mrr: 0.037171	 ndcg_5: 0.0275	 ndcg_10: 0.0365	 hit@1:0.007965	 hit@5:0.0456	 hit@10: 0.0739
target: 	 mrr: 0.063257	 ndcg_5: 0.0537	 ndcg_10: 0.0688	 hit@1:0.028571	 hit@5:0.0787	 hit@10: 0.1254
epoch 55: train_loss = 0.426899, source_hit@10 = 0.0739, source_ndcg@10 = 0.0365, target_hit@10 = 0.1254, target_ndcg@10 = 0.0688

2024-07-11 10:37:29.235806: step 2128/21280 (epoch 56/70), loss = 0.416438 (22.134 sec/epoch), lr: 0.000429
Evaluating on dev set...
...........................
source: 	 mrr: 0.038579	 ndcg_5: 0.0288	 ndcg_10: 0.0388	 hit@1:0.009413	 hit@5:0.0492	 hit@10: 0.0797
target: 	 mrr: 0.057785	 ndcg_5: 0.0500	 ndcg_10: 0.0627	 hit@1:0.023693	 hit@5:0.0767	 hit@10: 0.1164
epoch 56: train_loss = 0.416438, source_hit@10 = 0.0797, source_ndcg@10 = 0.0388, target_hit@10 = 0.1164, target_ndcg@10 = 0.0627

2024-07-11 10:37:51.675949: step 2432/21280 (epoch 57/70), loss = 0.409931 (22.130 sec/epoch), lr: 0.000407
Evaluating on dev set...
...........................
source: 	 mrr: 0.040690	 ndcg_5: 0.0306	 ndcg_10: 0.0407	 hit@1:0.012310	 hit@5:0.0492	 hit@10: 0.0804
target: 	 mrr: 0.053253	 ndcg_5: 0.0450	 ndcg_10: 0.0568	 hit@1:0.022300	 hit@5:0.0683	 hit@10: 0.1052
epoch 57: train_loss = 0.409931, source_hit@10 = 0.0804, source_ndcg@10 = 0.0407, target_hit@10 = 0.1052, target_ndcg@10 = 0.0568

2024-07-11 10:38:14.145268: step 2736/21280 (epoch 58/70), loss = 0.395884 (22.149 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.039260	 ndcg_5: 0.0291	 ndcg_10: 0.0390	 hit@1:0.011586	 hit@5:0.0463	 hit@10: 0.0775
target: 	 mrr: 0.053078	 ndcg_5: 0.0433	 ndcg_10: 0.0557	 hit@1:0.023693	 hit@5:0.0648	 hit@10: 0.1038
epoch 58: train_loss = 0.395884, source_hit@10 = 0.0775, source_ndcg@10 = 0.0390, target_hit@10 = 0.1038, target_ndcg@10 = 0.0557

2024-07-11 10:38:36.594313: step 3040/21280 (epoch 59/70), loss = 0.387847 (22.141 sec/epoch), lr: 0.000368
Evaluating on dev set...
...........................
source: 	 mrr: 0.040215	 ndcg_5: 0.0282	 ndcg_10: 0.0423	 hit@1:0.010862	 hit@5:0.0449	 hit@10: 0.0898
target: 	 mrr: 0.055915	 ndcg_5: 0.0462	 ndcg_10: 0.0605	 hit@1:0.022997	 hit@5:0.0690	 hit@10: 0.1136
epoch 59: train_loss = 0.387847, source_hit@10 = 0.0898, source_ndcg@10 = 0.0423, target_hit@10 = 0.1136, target_ndcg@10 = 0.0605

2024-07-11 10:38:59.029006: step 3344/21280 (epoch 60/70), loss = 0.384722 (22.122 sec/epoch), lr: 0.000368
Evaluating on dev set...
...........................
source: 	 mrr: 0.037144	 ndcg_5: 0.0268	 ndcg_10: 0.0388	 hit@1:0.006517	 hit@5:0.0463	 hit@10: 0.0833
target: 	 mrr: 0.054703	 ndcg_5: 0.0467	 ndcg_10: 0.0598	 hit@1:0.021603	 hit@5:0.0725	 hit@10: 0.1129
epoch 60: train_loss = 0.384722, source_hit@10 = 0.0833, source_ndcg@10 = 0.0388, target_hit@10 = 0.1129, target_ndcg@10 = 0.0598

2024-07-11 10:39:21.475753: step 3648/21280 (epoch 61/70), loss = 0.376048 (22.135 sec/epoch), lr: 0.000349
Evaluating on dev set...
...........................
source: 	 mrr: 0.038280	 ndcg_5: 0.0265	 ndcg_10: 0.0392	 hit@1:0.008689	 hit@5:0.0427	 hit@10: 0.0818
target: 	 mrr: 0.053300	 ndcg_5: 0.0463	 ndcg_10: 0.0585	 hit@1:0.018815	 hit@5:0.0739	 hit@10: 0.1115
epoch 61: train_loss = 0.376048, source_hit@10 = 0.0818, source_ndcg@10 = 0.0392, target_hit@10 = 0.1115, target_ndcg@10 = 0.0585

2024-07-11 10:39:43.954851: step 3952/21280 (epoch 62/70), loss = 0.364955 (22.164 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.037295	 ndcg_5: 0.0273	 ndcg_10: 0.0376	 hit@1:0.008689	 hit@5:0.0449	 hit@10: 0.0775
target: 	 mrr: 0.056184	 ndcg_5: 0.0485	 ndcg_10: 0.0602	 hit@1:0.021603	 hit@5:0.0732	 hit@10: 0.1101
epoch 62: train_loss = 0.364955, source_hit@10 = 0.0775, source_ndcg@10 = 0.0376, target_hit@10 = 0.1101, target_ndcg@10 = 0.0602

2024-07-11 10:40:06.400699: step 4256/21280 (epoch 63/70), loss = 0.359400 (22.139 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.039199	 ndcg_5: 0.0266	 ndcg_10: 0.0385	 hit@1:0.012310	 hit@5:0.0406	 hit@10: 0.0782
target: 	 mrr: 0.054230	 ndcg_5: 0.0474	 ndcg_10: 0.0580	 hit@1:0.020906	 hit@5:0.0739	 hit@10: 0.1066
epoch 63: train_loss = 0.359400, source_hit@10 = 0.0782, source_ndcg@10 = 0.0385, target_hit@10 = 0.1066, target_ndcg@10 = 0.0580

2024-07-11 10:40:28.877514: step 4560/21280 (epoch 64/70), loss = 0.354672 (22.171 sec/epoch), lr: 0.000315
Evaluating on dev set...
...........................
source: 	 mrr: 0.037474	 ndcg_5: 0.0270	 ndcg_10: 0.0395	 hit@1:0.007241	 hit@5:0.0485	 hit@10: 0.0869
target: 	 mrr: 0.055869	 ndcg_5: 0.0483	 ndcg_10: 0.0604	 hit@1:0.022300	 hit@5:0.0732	 hit@10: 0.1101
epoch 64: train_loss = 0.354672, source_hit@10 = 0.0869, source_ndcg@10 = 0.0395, target_hit@10 = 0.1101, target_ndcg@10 = 0.0604

2024-07-11 10:40:51.350282: step 4864/21280 (epoch 65/70), loss = 0.347751 (22.157 sec/epoch), lr: 0.000299
Evaluating on dev set...
...........................
source: 	 mrr: 0.041195	 ndcg_5: 0.0309	 ndcg_10: 0.0417	 hit@1:0.011586	 hit@5:0.0500	 hit@10: 0.0840
target: 	 mrr: 0.055950	 ndcg_5: 0.0491	 ndcg_10: 0.0596	 hit@1:0.023693	 hit@5:0.0753	 hit@10: 0.1073
epoch 65: train_loss = 0.347751, source_hit@10 = 0.0840, source_ndcg@10 = 0.0417, target_hit@10 = 0.1073, target_ndcg@10 = 0.0596

2024-07-11 10:41:13.805384: step 5168/21280 (epoch 66/70), loss = 0.341106 (22.142 sec/epoch), lr: 0.000299
Evaluating on dev set...
...........................
source: 	 mrr: 0.040696	 ndcg_5: 0.0284	 ndcg_10: 0.0388	 hit@1:0.014482	 hit@5:0.0413	 hit@10: 0.0739
target: 	 mrr: 0.053838	 ndcg_5: 0.0480	 ndcg_10: 0.0588	 hit@1:0.020209	 hit@5:0.0753	 hit@10: 0.1087
epoch 66: train_loss = 0.341106, source_hit@10 = 0.0739, source_ndcg@10 = 0.0388, target_hit@10 = 0.1087, target_ndcg@10 = 0.0588

2024-07-11 10:41:36.290003: step 5472/21280 (epoch 67/70), loss = 0.335091 (22.173 sec/epoch), lr: 0.000284
Evaluating on dev set...
...........................
source: 	 mrr: 0.040468	 ndcg_5: 0.0283	 ndcg_10: 0.0409	 hit@1:0.013034	 hit@5:0.0442	 hit@10: 0.0833
target: 	 mrr: 0.052840	 ndcg_5: 0.0454	 ndcg_10: 0.0570	 hit@1:0.021603	 hit@5:0.0690	 hit@10: 0.1052
epoch 67: train_loss = 0.335091, source_hit@10 = 0.0833, source_ndcg@10 = 0.0409, target_hit@10 = 0.1052, target_ndcg@10 = 0.0570

2024-07-11 10:41:58.655783: step 5776/21280 (epoch 68/70), loss = 0.324823 (22.057 sec/epoch), lr: 0.000270
Evaluating on dev set...
...........................
source: 	 mrr: 0.038650	 ndcg_5: 0.0254	 ndcg_10: 0.0393	 hit@1:0.010862	 hit@5:0.0391	 hit@10: 0.0825
target: 	 mrr: 0.046031	 ndcg_5: 0.0382	 ndcg_10: 0.0490	 hit@1:0.016725	 hit@5:0.0585	 hit@10: 0.0927
epoch 68: train_loss = 0.324823, source_hit@10 = 0.0825, source_ndcg@10 = 0.0393, target_hit@10 = 0.0927, target_ndcg@10 = 0.0490

2024-07-11 10:42:21.098071: step 6080/21280 (epoch 69/70), loss = 0.322964 (22.136 sec/epoch), lr: 0.000257
Evaluating on dev set...
...........................
source: 	 mrr: 0.037702	 ndcg_5: 0.0267	 ndcg_10: 0.0375	 hit@1:0.011586	 hit@5:0.0434	 hit@10: 0.0775
target: 	 mrr: 0.055105	 ndcg_5: 0.0482	 ndcg_10: 0.0605	 hit@1:0.021603	 hit@5:0.0732	 hit@10: 0.1122
epoch 69: train_loss = 0.322964, source_hit@10 = 0.0775, source_ndcg@10 = 0.0375, target_hit@10 = 0.1122, target_ndcg@10 = 0.0605

2024-07-11 10:42:43.524938: step 6384/21280 (epoch 70/70), loss = 0.315971 (22.120 sec/epoch), lr: 0.000257
Evaluating on dev set...
...........................
source: 	 mrr: 0.038752	 ndcg_5: 0.0271	 ndcg_10: 0.0392	 hit@1:0.013034	 hit@5:0.0420	 hit@10: 0.0797
target: 	 mrr: 0.050886	 ndcg_5: 0.0427	 ndcg_10: 0.0548	 hit@1:0.018118	 hit@5:0.0655	 hit@10: 0.1031
epoch 70: train_loss = 0.315971, source_hit@10 = 0.0797, source_ndcg@10 = 0.0392, target_hit@10 = 0.1031, target_ndcg@10 = 0.0548

