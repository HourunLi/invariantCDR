nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, batch_size=1024, beta=1.5, conv_layers=3, cuda=True, decay_epoch=5, device=device(type='cuda', index=0), device_id='0', domains='game_video', dropout=0.2, epoch=70, feature_dim=126, hidden_dim=126, keep_prob=0.6, lambda_constra=0.3, lambda_critic=0.3, lambda_ease=50, leakey=0.01, load=True, log='logs.txt', log_epoch=1, lr=0.0005, lr_decay=0.95, lr_transfer=0.0005, min_epoch=50, mode='train', model_file='single_50.pt', model_name='gv', num_latent_factors=3, num_negative=10, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=32, sim_threshold=0.9, tau=0.4, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:47: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
augmented graph loaded!
number_user 19457
number_item 8751
real graph loaded!
augmented graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
Loading model from ./saved_models/gv/single_50.pt
2024-07-11 10:36:12.528282: step 304/21280 (epoch 50/70), loss = 0.545552 (15.830 sec/epoch), lr: 0.000500
Evaluating on dev set...
....................
source: 	 mrr: 0.166000	 ndcg_5: 0.1596	 ndcg_10: 0.1902	 hit@1:0.080000	 hit@5:0.2360	 hit@10: 0.3310
target: 	 mrr: 0.249620	 ndcg_5: 0.2479	 ndcg_10: 0.3014	 hit@1:0.118000	 hit@5:0.3700	 hit@10: 0.5360
new best model saved.

2024-07-11 10:36:28.103806: step 608/21280 (epoch 51/70), loss = 0.496857 (15.331 sec/epoch), lr: 0.000500
Evaluating on dev set...
...........................
source: 	 mrr: 0.037997	 ndcg_5: 0.0254	 ndcg_10: 0.0385	 hit@1:0.007965	 hit@5:0.0427	 hit@10: 0.0833
target: 	 mrr: 0.047836	 ndcg_5: 0.0398	 ndcg_10: 0.0517	 hit@1:0.017422	 hit@5:0.0613	 hit@10: 0.0983
epoch 51: train_loss = 0.496857, source_hit@10 = 0.0833, source_ndcg@10 = 0.0385, target_hit@10 = 0.0983, target_ndcg@10 = 0.0517

2024-07-11 10:36:43.782903: step 912/21280 (epoch 52/70), loss = 0.470793 (15.415 sec/epoch), lr: 0.000475
Evaluating on dev set...
...........................
source: 	 mrr: 0.038222	 ndcg_5: 0.0288	 ndcg_10: 0.0387	 hit@1:0.007241	 hit@5:0.0514	 hit@10: 0.0825
target: 	 mrr: 0.047736	 ndcg_5: 0.0413	 ndcg_10: 0.0494	 hit@1:0.019512	 hit@5:0.0641	 hit@10: 0.0892
epoch 52: train_loss = 0.470793, source_hit@10 = 0.0825, source_ndcg@10 = 0.0387, target_hit@10 = 0.0892, target_ndcg@10 = 0.0494

2024-07-11 10:36:59.432322: step 1216/21280 (epoch 53/70), loss = 0.456905 (15.386 sec/epoch), lr: 0.000475
Evaluating on dev set...
...........................
source: 	 mrr: 0.043757	 ndcg_5: 0.0338	 ndcg_10: 0.0445	 hit@1:0.012310	 hit@5:0.0550	 hit@10: 0.0883
target: 	 mrr: 0.049010	 ndcg_5: 0.0421	 ndcg_10: 0.0536	 hit@1:0.017422	 hit@5:0.0669	 hit@10: 0.1024
epoch 53: train_loss = 0.456905, source_hit@10 = 0.0883, source_ndcg@10 = 0.0445, target_hit@10 = 0.1024, target_ndcg@10 = 0.0536

2024-07-11 10:37:15.000206: step 1520/21280 (epoch 54/70), loss = 0.442772 (15.315 sec/epoch), lr: 0.000475
Evaluating on dev set...
...........................
source: 	 mrr: 0.041339	 ndcg_5: 0.0310	 ndcg_10: 0.0425	 hit@1:0.012310	 hit@5:0.0514	 hit@10: 0.0876
target: 	 mrr: 0.045872	 ndcg_5: 0.0384	 ndcg_10: 0.0485	 hit@1:0.016725	 hit@5:0.0606	 hit@10: 0.0927
epoch 54: train_loss = 0.442772, source_hit@10 = 0.0876, source_ndcg@10 = 0.0425, target_hit@10 = 0.0927, target_ndcg@10 = 0.0485

2024-07-11 10:37:30.622549: step 1824/21280 (epoch 55/70), loss = 0.426562 (15.362 sec/epoch), lr: 0.000451
Evaluating on dev set...
...........................
source: 	 mrr: 0.040130	 ndcg_5: 0.0270	 ndcg_10: 0.0389	 hit@1:0.012310	 hit@5:0.0420	 hit@10: 0.0789
target: 	 mrr: 0.047590	 ndcg_5: 0.0406	 ndcg_10: 0.0517	 hit@1:0.015331	 hit@5:0.0655	 hit@10: 0.1003
epoch 55: train_loss = 0.426562, source_hit@10 = 0.0789, source_ndcg@10 = 0.0389, target_hit@10 = 0.1003, target_ndcg@10 = 0.0517

2024-07-11 10:37:46.264067: step 2128/21280 (epoch 56/70), loss = 0.416619 (15.382 sec/epoch), lr: 0.000451
Evaluating on dev set...
...........................
source: 	 mrr: 0.037983	 ndcg_5: 0.0252	 ndcg_10: 0.0366	 hit@1:0.010138	 hit@5:0.0391	 hit@10: 0.0746
target: 	 mrr: 0.044067	 ndcg_5: 0.0346	 ndcg_10: 0.0451	 hit@1:0.017422	 hit@5:0.0509	 hit@10: 0.0836
epoch 56: train_loss = 0.416619, source_hit@10 = 0.0746, source_ndcg@10 = 0.0366, target_hit@10 = 0.0836, target_ndcg@10 = 0.0451

2024-07-11 10:38:01.842676: step 2432/21280 (epoch 57/70), loss = 0.407577 (15.320 sec/epoch), lr: 0.000429
Evaluating on dev set...
...........................
source: 	 mrr: 0.042316	 ndcg_5: 0.0302	 ndcg_10: 0.0419	 hit@1:0.014482	 hit@5:0.0471	 hit@10: 0.0840
target: 	 mrr: 0.042063	 ndcg_5: 0.0317	 ndcg_10: 0.0443	 hit@1:0.016028	 hit@5:0.0474	 hit@10: 0.0864
epoch 57: train_loss = 0.407577, source_hit@10 = 0.0840, source_ndcg@10 = 0.0419, target_hit@10 = 0.0864, target_ndcg@10 = 0.0443

2024-07-11 10:38:17.444383: step 2736/21280 (epoch 58/70), loss = 0.400797 (15.348 sec/epoch), lr: 0.000429
Evaluating on dev set...
...........................
source: 	 mrr: 0.041722	 ndcg_5: 0.0291	 ndcg_10: 0.0381	 hit@1:0.016655	 hit@5:0.0420	 hit@10: 0.0695
target: 	 mrr: 0.042423	 ndcg_5: 0.0340	 ndcg_10: 0.0445	 hit@1:0.016028	 hit@5:0.0523	 hit@10: 0.0850
epoch 58: train_loss = 0.400797, source_hit@10 = 0.0695, source_ndcg@10 = 0.0381, target_hit@10 = 0.0850, target_ndcg@10 = 0.0445

2024-07-11 10:38:33.046170: step 3040/21280 (epoch 59/70), loss = 0.390616 (15.345 sec/epoch), lr: 0.000407
Evaluating on dev set...
...........................
source: 	 mrr: 0.036682	 ndcg_5: 0.0219	 ndcg_10: 0.0346	 hit@1:0.011586	 hit@5:0.0326	 hit@10: 0.0724
target: 	 mrr: 0.041615	 ndcg_5: 0.0339	 ndcg_10: 0.0444	 hit@1:0.013240	 hit@5:0.0551	 hit@10: 0.0878
epoch 59: train_loss = 0.390616, source_hit@10 = 0.0724, source_ndcg@10 = 0.0346, target_hit@10 = 0.0878, target_ndcg@10 = 0.0444

2024-07-11 10:38:48.718506: step 3344/21280 (epoch 60/70), loss = 0.382553 (15.418 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.038467	 ndcg_5: 0.0273	 ndcg_10: 0.0387	 hit@1:0.007241	 hit@5:0.0478	 hit@10: 0.0825
target: 	 mrr: 0.041313	 ndcg_5: 0.0335	 ndcg_10: 0.0433	 hit@1:0.013240	 hit@5:0.0551	 hit@10: 0.0857
epoch 60: train_loss = 0.382553, source_hit@10 = 0.0825, source_ndcg@10 = 0.0387, target_hit@10 = 0.0857, target_ndcg@10 = 0.0433

2024-07-11 10:39:04.395715: step 3648/21280 (epoch 61/70), loss = 0.375018 (15.415 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.038118	 ndcg_5: 0.0267	 ndcg_10: 0.0376	 hit@1:0.010138	 hit@5:0.0442	 hit@10: 0.0782
target: 	 mrr: 0.045671	 ndcg_5: 0.0382	 ndcg_10: 0.0490	 hit@1:0.015331	 hit@5:0.0606	 hit@10: 0.0934
epoch 61: train_loss = 0.375018, source_hit@10 = 0.0782, source_ndcg@10 = 0.0376, target_hit@10 = 0.0934, target_ndcg@10 = 0.0490

2024-07-11 10:39:20.071986: step 3952/21280 (epoch 62/70), loss = 0.370065 (15.416 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.043182	 ndcg_5: 0.0313	 ndcg_10: 0.0427	 hit@1:0.016655	 hit@5:0.0463	 hit@10: 0.0818
target: 	 mrr: 0.037899	 ndcg_5: 0.0291	 ndcg_10: 0.0389	 hit@1:0.011847	 hit@5:0.0460	 hit@10: 0.0767
epoch 62: train_loss = 0.370065, source_hit@10 = 0.0818, source_ndcg@10 = 0.0427, target_hit@10 = 0.0767, target_ndcg@10 = 0.0389

2024-07-11 10:39:35.689050: step 4256/21280 (epoch 63/70), loss = 0.364294 (15.364 sec/epoch), lr: 0.000368
Evaluating on dev set...
...........................
source: 	 mrr: 0.041307	 ndcg_5: 0.0292	 ndcg_10: 0.0411	 hit@1:0.013758	 hit@5:0.0463	 hit@10: 0.0840
target: 	 mrr: 0.038669	 ndcg_5: 0.0298	 ndcg_10: 0.0401	 hit@1:0.010453	 hit@5:0.0474	 hit@10: 0.0787
epoch 63: train_loss = 0.364294, source_hit@10 = 0.0840, source_ndcg@10 = 0.0411, target_hit@10 = 0.0787, target_ndcg@10 = 0.0401

2024-07-11 10:39:51.340264: step 4560/21280 (epoch 64/70), loss = 0.354140 (15.398 sec/epoch), lr: 0.000349
Evaluating on dev set...
...........................
source: 	 mrr: 0.042985	 ndcg_5: 0.0322	 ndcg_10: 0.0418	 hit@1:0.015930	 hit@5:0.0492	 hit@10: 0.0797
target: 	 mrr: 0.042818	 ndcg_5: 0.0335	 ndcg_10: 0.0460	 hit@1:0.014634	 hit@5:0.0537	 hit@10: 0.0920
epoch 64: train_loss = 0.354140, source_hit@10 = 0.0797, source_ndcg@10 = 0.0418, target_hit@10 = 0.0920, target_ndcg@10 = 0.0460

2024-07-11 10:40:07.052373: step 4864/21280 (epoch 65/70), loss = 0.350161 (15.447 sec/epoch), lr: 0.000349
Evaluating on dev set...
...........................
source: 	 mrr: 0.038083	 ndcg_5: 0.0265	 ndcg_10: 0.0370	 hit@1:0.013034	 hit@5:0.0413	 hit@10: 0.0746
target: 	 mrr: 0.038381	 ndcg_5: 0.0273	 ndcg_10: 0.0407	 hit@1:0.013240	 hit@5:0.0425	 hit@10: 0.0836
epoch 65: train_loss = 0.350161, source_hit@10 = 0.0746, source_ndcg@10 = 0.0370, target_hit@10 = 0.0836, target_ndcg@10 = 0.0407

2024-07-11 10:40:22.750369: step 5168/21280 (epoch 66/70), loss = 0.344243 (15.445 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.041562	 ndcg_5: 0.0292	 ndcg_10: 0.0388	 hit@1:0.012310	 hit@5:0.0449	 hit@10: 0.0746
target: 	 mrr: 0.039964	 ndcg_5: 0.0300	 ndcg_10: 0.0416	 hit@1:0.014634	 hit@5:0.0453	 hit@10: 0.0815
epoch 66: train_loss = 0.344243, source_hit@10 = 0.0746, source_ndcg@10 = 0.0388, target_hit@10 = 0.0815, target_ndcg@10 = 0.0416

2024-07-11 10:40:38.446494: step 5472/21280 (epoch 67/70), loss = 0.338390 (15.437 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.037573	 ndcg_5: 0.0259	 ndcg_10: 0.0358	 hit@1:0.009413	 hit@5:0.0420	 hit@10: 0.0731
target: 	 mrr: 0.041704	 ndcg_5: 0.0326	 ndcg_10: 0.0425	 hit@1:0.016028	 hit@5:0.0495	 hit@10: 0.0808
epoch 67: train_loss = 0.338390, source_hit@10 = 0.0731, source_ndcg@10 = 0.0358, target_hit@10 = 0.0808, target_ndcg@10 = 0.0425

2024-07-11 10:40:54.150399: step 5776/21280 (epoch 68/70), loss = 0.329663 (15.443 sec/epoch), lr: 0.000315
Evaluating on dev set...
...........................
source: 	 mrr: 0.042116	 ndcg_5: 0.0321	 ndcg_10: 0.0430	 hit@1:0.011586	 hit@5:0.0514	 hit@10: 0.0862
target: 	 mrr: 0.039073	 ndcg_5: 0.0311	 ndcg_10: 0.0404	 hit@1:0.013240	 hit@5:0.0481	 hit@10: 0.0774
epoch 68: train_loss = 0.329663, source_hit@10 = 0.0862, source_ndcg@10 = 0.0430, target_hit@10 = 0.0774, target_ndcg@10 = 0.0404

2024-07-11 10:41:09.844149: step 6080/21280 (epoch 69/70), loss = 0.328222 (15.429 sec/epoch), lr: 0.000315
Evaluating on dev set...
...........................
source: 	 mrr: 0.044618	 ndcg_5: 0.0337	 ndcg_10: 0.0452	 hit@1:0.016655	 hit@5:0.0507	 hit@10: 0.0869
target: 	 mrr: 0.036422	 ndcg_5: 0.0284	 ndcg_10: 0.0395	 hit@1:0.009756	 hit@5:0.0474	 hit@10: 0.0822
epoch 69: train_loss = 0.328222, source_hit@10 = 0.0869, source_ndcg@10 = 0.0452, target_hit@10 = 0.0822, target_ndcg@10 = 0.0395

2024-07-11 10:41:25.555275: step 6384/21280 (epoch 70/70), loss = 0.321817 (15.446 sec/epoch), lr: 0.000299
Evaluating on dev set...
...........................
source: 	 mrr: 0.042580	 ndcg_5: 0.0304	 ndcg_10: 0.0418	 hit@1:0.014482	 hit@5:0.0456	 hit@10: 0.0818
target: 	 mrr: 0.038881	 ndcg_5: 0.0294	 ndcg_10: 0.0409	 hit@1:0.013937	 hit@5:0.0446	 hit@10: 0.0801
epoch 70: train_loss = 0.321817, source_hit@10 = 0.0818, source_ndcg@10 = 0.0418, target_hit@10 = 0.0801, target_ndcg@10 = 0.0409

