nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=0), device_id='0', domains='cloth_sport', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.5, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='cs', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=2040, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 41829
number_item 17943
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 27328
number_item 12655
real graph loaded!
graph loaded!
Loading data from cloth_sport with batch size 1024...
unseen test: 0
test length: 3156
unseen test: 0
test length: 3085
unseen test: 0
test length: 3589
unseen test: 0
test length: 3546
source_user_num 41829
target_user_num 27328
source_item_num 17943
target_item_num 12655
shared users id: 7857
test users 990, 982
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 187880, target train data: 163291, source test data : 3085, target test data : 3546, source dev data : 1000, target dev data : 1000
2024-08-03 10:46:58.195331: step 343/27440 (epoch 1/80), loss = 1.206132 (48.136 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039785	 ndcg_5: 0.0324	 ndcg_10: 0.0423	 hit@1:0.011724	 hit@5:0.0545	 hit@10: 0.0846
target: 	 mrr: 0.033189	 ndcg_5: 0.0259	 ndcg_10: 0.0351	 hit@1:0.009473	 hit@5:0.0424	 hit@10: 0.0711
source best!
..............................
source: 	 mrr: 0.039489	 ndcg_5: 0.0314	 ndcg_10: 0.0397	 hit@1:0.015559	 hit@5:0.0483	 hit@10: 0.0742
target best!
...................................target: 	 mrr: 0.033864	 ndcg_5: 0.0263	 ndcg_10: 0.0351	 hit@1:0.010434	 hit@5:0.0426	 hit@10: 0.0699
epoch 1: train_loss = 1.206132, source_hit@10 = 0.0742, source_ndcg@10 = 0.0397, target_hit@10 = 0.0699, target_ndcg@10 = 0.0351

2024-08-03 10:47:47.451723: step 686/27440 (epoch 2/80), loss = 1.081255 (47.986 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040770	 ndcg_5: 0.0329	 ndcg_10: 0.0442	 hit@1:0.011724	 hit@5:0.0539	 hit@10: 0.0894
target: 	 mrr: 0.035577	 ndcg_5: 0.0260	 ndcg_10: 0.0371	 hit@1:0.012817	 hit@5:0.0396	 hit@10: 0.0741
source best!
..............................
source: 	 mrr: 0.037565	 ndcg_5: 0.0290	 ndcg_10: 0.0405	 hit@1:0.011021	 hit@5:0.0473	 hit@10: 0.0833
target best!
...................................target: 	 mrr: 0.036875	 ndcg_5: 0.0282	 ndcg_10: 0.0396	 hit@1:0.010998	 hit@5:0.0448	 hit@10: 0.0804
epoch 2: train_loss = 1.081255, source_hit@10 = 0.0833, source_ndcg@10 = 0.0405, target_hit@10 = 0.0804, target_ndcg@10 = 0.0396
new best model saved.

2024-08-03 10:48:36.686903: step 1029/27440 (epoch 3/80), loss = 1.063700 (47.903 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038771	 ndcg_5: 0.0304	 ndcg_10: 0.0408	 hit@1:0.013308	 hit@5:0.0478	 hit@10: 0.0805
target: 	 mrr: 0.033684	 ndcg_5: 0.0251	 ndcg_10: 0.0349	 hit@1:0.009752	 hit@5:0.0410	 hit@10: 0.0716
epoch 3: train_loss = 1.063700, source_hit@10 = 0.0805, source_ndcg@10 = 0.0408, target_hit@10 = 0.0716, target_ndcg@10 = 0.0349

2024-08-03 10:49:25.291641: step 1372/27440 (epoch 4/80), loss = 1.056687 (47.964 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045387	 ndcg_5: 0.0348	 ndcg_10: 0.0492	 hit@1:0.016477	 hit@5:0.0532	 hit@10: 0.0979
target: 	 mrr: 0.028743	 ndcg_5: 0.0201	 ndcg_10: 0.0291	 hit@1:0.006966	 hit@5:0.0343	 hit@10: 0.0624
source best!
..............................
source: 	 mrr: 0.039788	 ndcg_5: 0.0313	 ndcg_10: 0.0428	 hit@1:0.011994	 hit@5:0.0502	 hit@10: 0.0865
epoch 4: train_loss = 1.056687, source_hit@10 = 0.0865, source_ndcg@10 = 0.0428, target_hit@10 = 0.0624, target_ndcg@10 = 0.0291

2024-08-03 10:50:14.122704: step 1715/27440 (epoch 5/80), loss = 1.042341 (47.942 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041075	 ndcg_5: 0.0329	 ndcg_10: 0.0466	 hit@1:0.010139	 hit@5:0.0561	 hit@10: 0.0989
target: 	 mrr: 0.033514	 ndcg_5: 0.0246	 ndcg_10: 0.0345	 hit@1:0.009752	 hit@5:0.0390	 hit@10: 0.0702
epoch 5: train_loss = 1.042341, source_hit@10 = 0.0989, source_ndcg@10 = 0.0466, target_hit@10 = 0.0702, target_ndcg@10 = 0.0345

2024-08-03 10:51:02.473551: step 2058/27440 (epoch 6/80), loss = 1.034044 (47.712 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040601	 ndcg_5: 0.0318	 ndcg_10: 0.0442	 hit@1:0.011090	 hit@5:0.0516	 hit@10: 0.0897
target: 	 mrr: 0.037080	 ndcg_5: 0.0288	 ndcg_10: 0.0395	 hit@1:0.012817	 hit@5:0.0449	 hit@10: 0.0780
target best!
...................................target: 	 mrr: 0.038539	 ndcg_5: 0.0315	 ndcg_10: 0.0407	 hit@1:0.014100	 hit@5:0.0496	 hit@10: 0.0784
epoch 6: train_loss = 1.034044, source_hit@10 = 0.0897, source_ndcg@10 = 0.0442, target_hit@10 = 0.0784, target_ndcg@10 = 0.0407

2024-08-03 10:51:50.848960: step 2401/27440 (epoch 7/80), loss = 1.032179 (47.433 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036857	 ndcg_5: 0.0267	 ndcg_10: 0.0398	 hit@1:0.009506	 hit@5:0.0453	 hit@10: 0.0862
target: 	 mrr: 0.033286	 ndcg_5: 0.0259	 ndcg_10: 0.0344	 hit@1:0.010867	 hit@5:0.0412	 hit@10: 0.0677
epoch 7: train_loss = 1.032179, source_hit@10 = 0.0862, source_ndcg@10 = 0.0398, target_hit@10 = 0.0677, target_ndcg@10 = 0.0344

2024-08-03 10:52:39.424040: step 2744/27440 (epoch 8/80), loss = 1.028561 (47.945 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.034886	 ndcg_5: 0.0247	 ndcg_10: 0.0360	 hit@1:0.010139	 hit@5:0.0396	 hit@10: 0.0745
target: 	 mrr: 0.038589	 ndcg_5: 0.0315	 ndcg_10: 0.0401	 hit@1:0.013096	 hit@5:0.0507	 hit@10: 0.0783
target best!
...................................target: 	 mrr: 0.038556	 ndcg_5: 0.0289	 ndcg_10: 0.0410	 hit@1:0.012690	 hit@5:0.0446	 hit@10: 0.0821
epoch 8: train_loss = 1.028561, source_hit@10 = 0.0745, source_ndcg@10 = 0.0360, target_hit@10 = 0.0821, target_ndcg@10 = 0.0410

2024-08-03 10:53:27.572608: step 3087/27440 (epoch 9/80), loss = 1.027253 (47.210 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046223	 ndcg_5: 0.0381	 ndcg_10: 0.0498	 hit@1:0.016160	 hit@5:0.0596	 hit@10: 0.0954
target: 	 mrr: 0.033684	 ndcg_5: 0.0253	 ndcg_10: 0.0342	 hit@1:0.010867	 hit@5:0.0404	 hit@10: 0.0683
source best!
..............................
source: 	 mrr: 0.045565	 ndcg_5: 0.0375	 ndcg_10: 0.0475	 hit@1:0.019125	 hit@5:0.0571	 hit@10: 0.0882
epoch 9: train_loss = 1.027253, source_hit@10 = 0.0882, source_ndcg@10 = 0.0475, target_hit@10 = 0.0683, target_ndcg@10 = 0.0342

2024-08-03 10:54:15.946959: step 3430/27440 (epoch 10/80), loss = 1.024711 (47.481 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039680	 ndcg_5: 0.0312	 ndcg_10: 0.0420	 hit@1:0.009823	 hit@5:0.0523	 hit@10: 0.0856
target: 	 mrr: 0.035159	 ndcg_5: 0.0266	 ndcg_10: 0.0380	 hit@1:0.011424	 hit@5:0.0424	 hit@10: 0.0780
epoch 10: train_loss = 1.024711, source_hit@10 = 0.0856, source_ndcg@10 = 0.0420, target_hit@10 = 0.0780, target_ndcg@10 = 0.0380

2024-08-03 10:55:04.745886: step 3773/27440 (epoch 11/80), loss = 1.023324 (48.124 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042707	 ndcg_5: 0.0338	 ndcg_10: 0.0467	 hit@1:0.014259	 hit@5:0.0542	 hit@10: 0.0951
target: 	 mrr: 0.034135	 ndcg_5: 0.0260	 ndcg_10: 0.0365	 hit@1:0.009473	 hit@5:0.0426	 hit@10: 0.0755
epoch 11: train_loss = 1.023324, source_hit@10 = 0.0951, source_ndcg@10 = 0.0467, target_hit@10 = 0.0755, target_ndcg@10 = 0.0365

2024-08-03 10:55:53.266610: step 4116/27440 (epoch 12/80), loss = 1.023393 (47.894 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040949	 ndcg_5: 0.0324	 ndcg_10: 0.0436	 hit@1:0.012357	 hit@5:0.0532	 hit@10: 0.0878
target: 	 mrr: 0.032486	 ndcg_5: 0.0232	 ndcg_10: 0.0336	 hit@1:0.009195	 hit@5:0.0376	 hit@10: 0.0699
epoch 12: train_loss = 1.023393, source_hit@10 = 0.0878, source_ndcg@10 = 0.0436, target_hit@10 = 0.0699, target_ndcg@10 = 0.0336

2024-08-03 10:56:41.712268: step 4459/27440 (epoch 13/80), loss = 1.015506 (47.785 sec/epoch), lr: 0.003800
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038123	 ndcg_5: 0.0295	 ndcg_10: 0.0389	 hit@1:0.011407	 hit@5:0.0478	 hit@10: 0.0773
target: 	 mrr: 0.036601	 ndcg_5: 0.0296	 ndcg_10: 0.0373	 hit@1:0.012260	 hit@5:0.0485	 hit@10: 0.0722
epoch 13: train_loss = 1.015506, source_hit@10 = 0.0773, source_ndcg@10 = 0.0389, target_hit@10 = 0.0722, target_ndcg@10 = 0.0373

2024-08-03 10:57:30.184924: step 4802/27440 (epoch 14/80), loss = 1.007632 (47.835 sec/epoch), lr: 0.003800
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043995	 ndcg_5: 0.0346	 ndcg_10: 0.0471	 hit@1:0.015843	 hit@5:0.0548	 hit@10: 0.0941
target: 	 mrr: 0.033724	 ndcg_5: 0.0245	 ndcg_10: 0.0338	 hit@1:0.011702	 hit@5:0.0368	 hit@10: 0.0658
epoch 14: train_loss = 1.007632, source_hit@10 = 0.0941, source_ndcg@10 = 0.0471, target_hit@10 = 0.0658, target_ndcg@10 = 0.0338

2024-08-03 10:58:19.115495: step 5145/27440 (epoch 15/80), loss = 0.995855 (48.300 sec/epoch), lr: 0.003800
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036423	 ndcg_5: 0.0278	 ndcg_10: 0.0364	 hit@1:0.011090	 hit@5:0.0440	 hit@10: 0.0713
target: 	 mrr: 0.034275	 ndcg_5: 0.0263	 ndcg_10: 0.0349	 hit@1:0.010031	 hit@5:0.0429	 hit@10: 0.0697
epoch 15: train_loss = 0.995855, source_hit@10 = 0.0713, source_ndcg@10 = 0.0364, target_hit@10 = 0.0697, target_ndcg@10 = 0.0349

2024-08-03 10:59:07.062727: step 5488/27440 (epoch 16/80), loss = 0.991717 (47.315 sec/epoch), lr: 0.003610
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043212	 ndcg_5: 0.0351	 ndcg_10: 0.0453	 hit@1:0.014892	 hit@5:0.0548	 hit@10: 0.0865
target: 	 mrr: 0.037681	 ndcg_5: 0.0298	 ndcg_10: 0.0385	 hit@1:0.010867	 hit@5:0.0479	 hit@10: 0.0752
epoch 16: train_loss = 0.991717, source_hit@10 = 0.0865, source_ndcg@10 = 0.0453, target_hit@10 = 0.0752, target_ndcg@10 = 0.0385

2024-08-03 10:59:54.986237: step 5831/27440 (epoch 17/80), loss = 0.989517 (47.265 sec/epoch), lr: 0.003610
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044842	 ndcg_5: 0.0353	 ndcg_10: 0.0466	 hit@1:0.016160	 hit@5:0.0551	 hit@10: 0.0900
target: 	 mrr: 0.034317	 ndcg_5: 0.0254	 ndcg_10: 0.0364	 hit@1:0.010031	 hit@5:0.0410	 hit@10: 0.0752
epoch 17: train_loss = 0.989517, source_hit@10 = 0.0900, source_ndcg@10 = 0.0466, target_hit@10 = 0.0752, target_ndcg@10 = 0.0364

2024-08-03 11:00:43.796985: step 6174/27440 (epoch 18/80), loss = 0.982891 (48.111 sec/epoch), lr: 0.003429
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043924	 ndcg_5: 0.0351	 ndcg_10: 0.0474	 hit@1:0.013308	 hit@5:0.0580	 hit@10: 0.0963
target: 	 mrr: 0.036213	 ndcg_5: 0.0282	 ndcg_10: 0.0377	 hit@1:0.009473	 hit@5:0.0474	 hit@10: 0.0772
epoch 18: train_loss = 0.982891, source_hit@10 = 0.0963, source_ndcg@10 = 0.0474, target_hit@10 = 0.0772, target_ndcg@10 = 0.0377

2024-08-03 11:01:32.429176: step 6517/27440 (epoch 19/80), loss = 0.978836 (47.996 sec/epoch), lr: 0.003429
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.022559	 ndcg_5: 0.0160	 ndcg_10: 0.0223	 hit@1:0.006020	 hit@5:0.0260	 hit@10: 0.0459
target: 	 mrr: 0.036055	 ndcg_5: 0.0272	 ndcg_10: 0.0365	 hit@1:0.011145	 hit@5:0.0429	 hit@10: 0.0722
epoch 19: train_loss = 0.978836, source_hit@10 = 0.0459, source_ndcg@10 = 0.0223, target_hit@10 = 0.0722, target_ndcg@10 = 0.0365

2024-08-03 11:02:21.285432: step 6860/27440 (epoch 20/80), loss = 0.972181 (48.214 sec/epoch), lr: 0.003258
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048685	 ndcg_5: 0.0408	 ndcg_10: 0.0533	 hit@1:0.017427	 hit@5:0.0640	 hit@10: 0.1030
target: 	 mrr: 0.041396	 ndcg_5: 0.0335	 ndcg_10: 0.0434	 hit@1:0.014489	 hit@5:0.0527	 hit@10: 0.0833
source best!
..............................
source: 	 mrr: 0.042447	 ndcg_5: 0.0339	 ndcg_10: 0.0452	 hit@1:0.013938	 hit@5:0.0541	 hit@10: 0.0888
target best!
...................................target: 	 mrr: 0.040423	 ndcg_5: 0.0323	 ndcg_10: 0.0421	 hit@1:0.014946	 hit@5:0.0485	 hit@10: 0.0790
epoch 20: train_loss = 0.972181, source_hit@10 = 0.0888, source_ndcg@10 = 0.0452, target_hit@10 = 0.0790, target_ndcg@10 = 0.0421
new best model saved.

2024-08-03 11:03:10.146573: step 7203/27440 (epoch 21/80), loss = 0.962802 (47.524 sec/epoch), lr: 0.003258
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045108	 ndcg_5: 0.0365	 ndcg_10: 0.0476	 hit@1:0.013942	 hit@5:0.0577	 hit@10: 0.0922
target: 	 mrr: 0.032050	 ndcg_5: 0.0244	 ndcg_10: 0.0327	 hit@1:0.010867	 hit@5:0.0390	 hit@10: 0.0655
epoch 21: train_loss = 0.962802, source_hit@10 = 0.0922, source_ndcg@10 = 0.0476, target_hit@10 = 0.0655, target_ndcg@10 = 0.0327

2024-08-03 11:03:58.221558: step 7546/27440 (epoch 22/80), loss = 0.956379 (47.429 sec/epoch), lr: 0.003095
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.051428	 ndcg_5: 0.0444	 ndcg_10: 0.0557	 hit@1:0.020913	 hit@5:0.0678	 hit@10: 0.1036
target: 	 mrr: 0.034277	 ndcg_5: 0.0268	 ndcg_10: 0.0363	 hit@1:0.009473	 hit@5:0.0440	 hit@10: 0.0738
source best!
..............................
source: 	 mrr: 0.044340	 ndcg_5: 0.0361	 ndcg_10: 0.0482	 hit@1:0.015559	 hit@5:0.0567	 hit@10: 0.0947
epoch 22: train_loss = 0.956379, source_hit@10 = 0.0947, source_ndcg@10 = 0.0482, target_hit@10 = 0.0738, target_ndcg@10 = 0.0363

2024-08-03 11:04:47.191336: step 7889/27440 (epoch 23/80), loss = 0.952699 (48.071 sec/epoch), lr: 0.003095
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.033366	 ndcg_5: 0.0251	 ndcg_10: 0.0340	 hit@1:0.009189	 hit@5:0.0415	 hit@10: 0.0697
target: 	 mrr: 0.029869	 ndcg_5: 0.0223	 ndcg_10: 0.0300	 hit@1:0.008359	 hit@5:0.0362	 hit@10: 0.0599
epoch 23: train_loss = 0.952699, source_hit@10 = 0.0697, source_ndcg@10 = 0.0340, target_hit@10 = 0.0599, target_ndcg@10 = 0.0300

2024-08-03 11:05:35.652826: step 8232/27440 (epoch 24/80), loss = 0.945467 (47.816 sec/epoch), lr: 0.002940
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041682	 ndcg_5: 0.0326	 ndcg_10: 0.0450	 hit@1:0.011724	 hit@5:0.0542	 hit@10: 0.0925
target: 	 mrr: 0.037543	 ndcg_5: 0.0285	 ndcg_10: 0.0389	 hit@1:0.013374	 hit@5:0.0440	 hit@10: 0.0763
epoch 24: train_loss = 0.945467, source_hit@10 = 0.0925, source_ndcg@10 = 0.0450, target_hit@10 = 0.0763, target_ndcg@10 = 0.0389

2024-08-03 11:06:24.114505: step 8575/27440 (epoch 25/80), loss = 0.944479 (47.830 sec/epoch), lr: 0.002940
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049367	 ndcg_5: 0.0400	 ndcg_10: 0.0532	 hit@1:0.018378	 hit@5:0.0608	 hit@10: 0.1020
target: 	 mrr: 0.035714	 ndcg_5: 0.0274	 ndcg_10: 0.0377	 hit@1:0.013096	 hit@5:0.0421	 hit@10: 0.0741
epoch 25: train_loss = 0.944479, source_hit@10 = 0.1020, source_ndcg@10 = 0.0532, target_hit@10 = 0.0741, target_ndcg@10 = 0.0377

2024-08-03 11:07:12.766014: step 8918/27440 (epoch 26/80), loss = 0.939404 (48.021 sec/epoch), lr: 0.002940
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044566	 ndcg_5: 0.0333	 ndcg_10: 0.0473	 hit@1:0.014575	 hit@5:0.0513	 hit@10: 0.0947
target: 	 mrr: 0.033831	 ndcg_5: 0.0268	 ndcg_10: 0.0340	 hit@1:0.009195	 hit@5:0.0443	 hit@10: 0.0671
epoch 26: train_loss = 0.939404, source_hit@10 = 0.0947, source_ndcg@10 = 0.0473, target_hit@10 = 0.0671, target_ndcg@10 = 0.0340

2024-08-03 11:08:01.469979: step 9261/27440 (epoch 27/80), loss = 0.934427 (48.068 sec/epoch), lr: 0.002793
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036661	 ndcg_5: 0.0267	 ndcg_10: 0.0388	 hit@1:0.012674	 hit@5:0.0421	 hit@10: 0.0798
target: 	 mrr: 0.033693	 ndcg_5: 0.0245	 ndcg_10: 0.0347	 hit@1:0.010309	 hit@5:0.0390	 hit@10: 0.0708
epoch 27: train_loss = 0.934427, source_hit@10 = 0.0798, source_ndcg@10 = 0.0388, target_hit@10 = 0.0708, target_ndcg@10 = 0.0347

2024-08-03 11:08:50.072054: step 9604/27440 (epoch 28/80), loss = 0.932448 (47.955 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.037180	 ndcg_5: 0.0282	 ndcg_10: 0.0394	 hit@1:0.010139	 hit@5:0.0466	 hit@10: 0.0811
target: 	 mrr: 0.033804	 ndcg_5: 0.0256	 ndcg_10: 0.0358	 hit@1:0.008359	 hit@5:0.0432	 hit@10: 0.0747
epoch 28: train_loss = 0.932448, source_hit@10 = 0.0811, source_ndcg@10 = 0.0394, target_hit@10 = 0.0747, target_ndcg@10 = 0.0358

2024-08-03 11:09:39.652040: step 9947/27440 (epoch 29/80), loss = 0.931090 (48.950 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044510	 ndcg_5: 0.0333	 ndcg_10: 0.0481	 hit@1:0.014892	 hit@5:0.0507	 hit@10: 0.0963
target: 	 mrr: 0.035443	 ndcg_5: 0.0259	 ndcg_10: 0.0375	 hit@1:0.010031	 hit@5:0.0424	 hit@10: 0.0786
epoch 29: train_loss = 0.931090, source_hit@10 = 0.0963, source_ndcg@10 = 0.0481, target_hit@10 = 0.0786, target_ndcg@10 = 0.0375

2024-08-03 11:10:27.691864: step 10290/27440 (epoch 30/80), loss = 0.929693 (47.404 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040254	 ndcg_5: 0.0311	 ndcg_10: 0.0423	 hit@1:0.012357	 hit@5:0.0497	 hit@10: 0.0849
target: 	 mrr: 0.030684	 ndcg_5: 0.0216	 ndcg_10: 0.0304	 hit@1:0.008916	 hit@5:0.0351	 hit@10: 0.0624
epoch 30: train_loss = 0.929693, source_hit@10 = 0.0849, source_ndcg@10 = 0.0423, target_hit@10 = 0.0624, target_ndcg@10 = 0.0304

2024-08-03 11:11:16.042895: step 10633/27440 (epoch 31/80), loss = 0.927401 (47.644 sec/epoch), lr: 0.002521
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048122	 ndcg_5: 0.0406	 ndcg_10: 0.0525	 hit@1:0.018061	 hit@5:0.0640	 hit@10: 0.1011
target: 	 mrr: 0.036500	 ndcg_5: 0.0276	 ndcg_10: 0.0389	 hit@1:0.008916	 hit@5:0.0457	 hit@10: 0.0811
epoch 31: train_loss = 0.927401, source_hit@10 = 0.1011, source_ndcg@10 = 0.0525, target_hit@10 = 0.0811, target_ndcg@10 = 0.0389

2024-08-03 11:12:04.932076: step 10976/27440 (epoch 32/80), loss = 0.925037 (48.258 sec/epoch), lr: 0.002521
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.028196	 ndcg_5: 0.0206	 ndcg_10: 0.0297	 hit@1:0.005070	 hit@5:0.0364	 hit@10: 0.0653
target: 	 mrr: 0.040402	 ndcg_5: 0.0310	 ndcg_10: 0.0429	 hit@1:0.013096	 hit@5:0.0482	 hit@10: 0.0853
epoch 32: train_loss = 0.925037, source_hit@10 = 0.0653, source_ndcg@10 = 0.0297, target_hit@10 = 0.0853, target_ndcg@10 = 0.0429

2024-08-03 11:12:53.212250: step 11319/27440 (epoch 33/80), loss = 0.922157 (47.641 sec/epoch), lr: 0.002395
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.051461	 ndcg_5: 0.0427	 ndcg_10: 0.0548	 hit@1:0.020279	 hit@5:0.0646	 hit@10: 0.1027
target: 	 mrr: 0.040299	 ndcg_5: 0.0316	 ndcg_10: 0.0428	 hit@1:0.013653	 hit@5:0.0496	 hit@10: 0.0847
source best!
..............................
source: 	 mrr: 0.047934	 ndcg_5: 0.0391	 ndcg_10: 0.0512	 hit@1:0.018801	 hit@5:0.0606	 hit@10: 0.0982
epoch 33: train_loss = 0.922157, source_hit@10 = 0.0982, source_ndcg@10 = 0.0512, target_hit@10 = 0.0847, target_ndcg@10 = 0.0428

2024-08-03 11:13:41.620348: step 11662/27440 (epoch 34/80), loss = 0.923543 (47.515 sec/epoch), lr: 0.002395
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039454	 ndcg_5: 0.0303	 ndcg_10: 0.0414	 hit@1:0.013625	 hit@5:0.0472	 hit@10: 0.0817
target: 	 mrr: 0.035450	 ndcg_5: 0.0277	 ndcg_10: 0.0388	 hit@1:0.008916	 hit@5:0.0451	 hit@10: 0.0794
epoch 34: train_loss = 0.923543, source_hit@10 = 0.0817, source_ndcg@10 = 0.0414, target_hit@10 = 0.0794, target_ndcg@10 = 0.0388

2024-08-03 11:14:30.144372: step 12005/27440 (epoch 35/80), loss = 0.918723 (47.862 sec/epoch), lr: 0.002275
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.026347	 ndcg_5: 0.0174	 ndcg_10: 0.0261	 hit@1:0.003802	 hit@5:0.0320	 hit@10: 0.0593
target: 	 mrr: 0.040662	 ndcg_5: 0.0323	 ndcg_10: 0.0423	 hit@1:0.013653	 hit@5:0.0510	 hit@10: 0.0825
epoch 35: train_loss = 0.918723, source_hit@10 = 0.0593, source_ndcg@10 = 0.0261, target_hit@10 = 0.0825, target_ndcg@10 = 0.0423

2024-08-03 11:15:18.250681: step 12348/27440 (epoch 36/80), loss = 0.915242 (47.474 sec/epoch), lr: 0.002161
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.052065	 ndcg_5: 0.0457	 ndcg_10: 0.0566	 hit@1:0.022180	 hit@5:0.0694	 hit@10: 0.1033
target: 	 mrr: 0.039951	 ndcg_5: 0.0322	 ndcg_10: 0.0430	 hit@1:0.014489	 hit@5:0.0507	 hit@10: 0.0844
source best!
..............................
source: 	 mrr: 0.041804	 ndcg_5: 0.0331	 ndcg_10: 0.0452	 hit@1:0.013290	 hit@5:0.0532	 hit@10: 0.0904
epoch 36: train_loss = 0.915242, source_hit@10 = 0.0904, source_ndcg@10 = 0.0452, target_hit@10 = 0.0844, target_ndcg@10 = 0.0430

2024-08-03 11:16:06.860137: step 12691/27440 (epoch 37/80), loss = 0.914412 (47.716 sec/epoch), lr: 0.002161
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040509	 ndcg_5: 0.0313	 ndcg_10: 0.0417	 hit@1:0.014259	 hit@5:0.0488	 hit@10: 0.0811
target: 	 mrr: 0.036082	 ndcg_5: 0.0268	 ndcg_10: 0.0362	 hit@1:0.012817	 hit@5:0.0404	 hit@10: 0.0694
epoch 37: train_loss = 0.914412, source_hit@10 = 0.0811, source_ndcg@10 = 0.0417, target_hit@10 = 0.0694, target_ndcg@10 = 0.0362

2024-08-03 11:16:55.714242: step 13034/27440 (epoch 38/80), loss = 0.912299 (48.226 sec/epoch), lr: 0.002053
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045078	 ndcg_5: 0.0360	 ndcg_10: 0.0495	 hit@1:0.014892	 hit@5:0.0580	 hit@10: 0.0998
target: 	 mrr: 0.034346	 ndcg_5: 0.0265	 ndcg_10: 0.0362	 hit@1:0.009195	 hit@5:0.0440	 hit@10: 0.0738
epoch 38: train_loss = 0.912299, source_hit@10 = 0.0998, source_ndcg@10 = 0.0495, target_hit@10 = 0.0738, target_ndcg@10 = 0.0362

2024-08-03 11:17:44.133083: step 13377/27440 (epoch 39/80), loss = 0.911314 (47.741 sec/epoch), lr: 0.002053
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047179	 ndcg_5: 0.0373	 ndcg_10: 0.0498	 hit@1:0.017110	 hit@5:0.0580	 hit@10: 0.0966
target: 	 mrr: 0.039809	 ndcg_5: 0.0309	 ndcg_10: 0.0412	 hit@1:0.014489	 hit@5:0.0482	 hit@10: 0.0802
epoch 39: train_loss = 0.911314, source_hit@10 = 0.0966, source_ndcg@10 = 0.0498, target_hit@10 = 0.0802, target_ndcg@10 = 0.0412

2024-08-03 11:18:33.044315: step 13720/27440 (epoch 40/80), loss = 0.908734 (48.280 sec/epoch), lr: 0.002053
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041152	 ndcg_5: 0.0297	 ndcg_10: 0.0445	 hit@1:0.012041	 hit@5:0.0485	 hit@10: 0.0944
target: 	 mrr: 0.039244	 ndcg_5: 0.0301	 ndcg_10: 0.0427	 hit@1:0.011981	 hit@5:0.0493	 hit@10: 0.0886
epoch 40: train_loss = 0.908734, source_hit@10 = 0.0944, source_ndcg@10 = 0.0445, target_hit@10 = 0.0886, target_ndcg@10 = 0.0427
shift to transfer learning mode

2024-08-03 11:19:22.405323: step 14063/27440 (epoch 41/80), loss = 0.907683 (48.715 sec/epoch), lr: 0.001951
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049299	 ndcg_5: 0.0414	 ndcg_10: 0.0532	 hit@1:0.017427	 hit@5:0.0662	 hit@10: 0.1023
target: 	 mrr: 0.036207	 ndcg_5: 0.0291	 ndcg_10: 0.0391	 hit@1:0.009195	 hit@5:0.0499	 hit@10: 0.0814
epoch 41: train_loss = 0.907683, source_hit@10 = 0.1023, source_ndcg@10 = 0.0532, target_hit@10 = 0.0814, target_ndcg@10 = 0.0391

2024-08-03 11:20:11.767627: step 14406/27440 (epoch 42/80), loss = 0.905824 (48.719 sec/epoch), lr: 0.001951
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041137	 ndcg_5: 0.0319	 ndcg_10: 0.0437	 hit@1:0.011090	 hit@5:0.0526	 hit@10: 0.0894
target: 	 mrr: 0.038164	 ndcg_5: 0.0298	 ndcg_10: 0.0414	 hit@1:0.013096	 hit@5:0.0476	 hit@10: 0.0839
epoch 42: train_loss = 0.905824, source_hit@10 = 0.0894, source_ndcg@10 = 0.0437, target_hit@10 = 0.0839, target_ndcg@10 = 0.0414

2024-08-03 11:21:01.072443: step 14749/27440 (epoch 43/80), loss = 0.905013 (48.669 sec/epoch), lr: 0.001853
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.054818	 ndcg_5: 0.0465	 ndcg_10: 0.0598	 hit@1:0.021863	 hit@5:0.0697	 hit@10: 0.1106
target: 	 mrr: 0.037597	 ndcg_5: 0.0296	 ndcg_10: 0.0395	 hit@1:0.011424	 hit@5:0.0476	 hit@10: 0.0783
source best!
..............................
source: 	 mrr: 0.048620	 ndcg_5: 0.0406	 ndcg_10: 0.0529	 hit@1:0.017504	 hit@5:0.0645	 hit@10: 0.1028
epoch 43: train_loss = 0.905013, source_hit@10 = 0.1028, source_ndcg@10 = 0.0529, target_hit@10 = 0.0783, target_ndcg@10 = 0.0395

2024-08-03 11:21:51.020612: step 15092/27440 (epoch 44/80), loss = 0.903616 (49.056 sec/epoch), lr: 0.001853
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047633	 ndcg_5: 0.0398	 ndcg_10: 0.0510	 hit@1:0.019962	 hit@5:0.0599	 hit@10: 0.0944
target: 	 mrr: 0.040590	 ndcg_5: 0.0313	 ndcg_10: 0.0448	 hit@1:0.012538	 hit@5:0.0499	 hit@10: 0.0922
epoch 44: train_loss = 0.903616, source_hit@10 = 0.0944, source_ndcg@10 = 0.0510, target_hit@10 = 0.0922, target_ndcg@10 = 0.0448

2024-08-03 11:22:40.932781: step 15435/27440 (epoch 45/80), loss = 0.899083 (49.233 sec/epoch), lr: 0.001761
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.050046	 ndcg_5: 0.0400	 ndcg_10: 0.0547	 hit@1:0.018378	 hit@5:0.0612	 hit@10: 0.1068
target: 	 mrr: 0.038858	 ndcg_5: 0.0299	 ndcg_10: 0.0424	 hit@1:0.013096	 hit@5:0.0474	 hit@10: 0.0861
epoch 45: train_loss = 0.899083, source_hit@10 = 0.1068, source_ndcg@10 = 0.0547, target_hit@10 = 0.0861, target_ndcg@10 = 0.0424

2024-08-03 11:23:30.350074: step 15778/27440 (epoch 46/80), loss = 0.899720 (48.768 sec/epoch), lr: 0.001761
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046329	 ndcg_5: 0.0359	 ndcg_10: 0.0496	 hit@1:0.014575	 hit@5:0.0567	 hit@10: 0.0992
target: 	 mrr: 0.036213	 ndcg_5: 0.0282	 ndcg_10: 0.0370	 hit@1:0.011702	 hit@5:0.0440	 hit@10: 0.0716
epoch 46: train_loss = 0.899720, source_hit@10 = 0.0992, source_ndcg@10 = 0.0496, target_hit@10 = 0.0716, target_ndcg@10 = 0.0370

2024-08-03 11:24:19.653936: step 16121/27440 (epoch 47/80), loss = 0.897249 (48.659 sec/epoch), lr: 0.001672
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048802	 ndcg_5: 0.0409	 ndcg_10: 0.0536	 hit@1:0.016477	 hit@5:0.0659	 hit@10: 0.1055
target: 	 mrr: 0.036894	 ndcg_5: 0.0282	 ndcg_10: 0.0380	 hit@1:0.013096	 hit@5:0.0432	 hit@10: 0.0738
epoch 47: train_loss = 0.897249, source_hit@10 = 0.1055, source_ndcg@10 = 0.0536, target_hit@10 = 0.0738, target_ndcg@10 = 0.0380

2024-08-03 11:25:09.131823: step 16464/27440 (epoch 48/80), loss = 0.897347 (48.850 sec/epoch), lr: 0.001672
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048071	 ndcg_5: 0.0393	 ndcg_10: 0.0525	 hit@1:0.016793	 hit@5:0.0621	 hit@10: 0.1030
target: 	 mrr: 0.035725	 ndcg_5: 0.0268	 ndcg_10: 0.0375	 hit@1:0.010588	 hit@5:0.0443	 hit@10: 0.0777
epoch 48: train_loss = 0.897347, source_hit@10 = 0.1030, source_ndcg@10 = 0.0525, target_hit@10 = 0.0777, target_ndcg@10 = 0.0375

2024-08-03 11:25:58.711561: step 16807/27440 (epoch 49/80), loss = 0.893484 (48.947 sec/epoch), lr: 0.001589
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045208	 ndcg_5: 0.0365	 ndcg_10: 0.0488	 hit@1:0.016477	 hit@5:0.0567	 hit@10: 0.0951
target: 	 mrr: 0.043034	 ndcg_5: 0.0353	 ndcg_10: 0.0459	 hit@1:0.014489	 hit@5:0.0557	 hit@10: 0.0883
target best!
...................................target: 	 mrr: 0.042414	 ndcg_5: 0.0344	 ndcg_10: 0.0453	 hit@1:0.015510	 hit@5:0.0536	 hit@10: 0.0874
epoch 49: train_loss = 0.893484, source_hit@10 = 0.0951, source_ndcg@10 = 0.0488, target_hit@10 = 0.0874, target_ndcg@10 = 0.0453

2024-08-03 11:26:48.007796: step 17150/27440 (epoch 50/80), loss = 0.891310 (48.363 sec/epoch), lr: 0.001589
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.051329	 ndcg_5: 0.0417	 ndcg_10: 0.0551	 hit@1:0.020279	 hit@5:0.0631	 hit@10: 0.1046
target: 	 mrr: 0.036322	 ndcg_5: 0.0267	 ndcg_10: 0.0377	 hit@1:0.011981	 hit@5:0.0418	 hit@10: 0.0763
epoch 50: train_loss = 0.891310, source_hit@10 = 0.1046, source_ndcg@10 = 0.0551, target_hit@10 = 0.0763, target_ndcg@10 = 0.0377

2024-08-03 11:27:37.714023: step 17493/27440 (epoch 51/80), loss = 0.891359 (49.074 sec/epoch), lr: 0.001509
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045868	 ndcg_5: 0.0371	 ndcg_10: 0.0502	 hit@1:0.014892	 hit@5:0.0599	 hit@10: 0.1011
target: 	 mrr: 0.041219	 ndcg_5: 0.0321	 ndcg_10: 0.0431	 hit@1:0.014210	 hit@5:0.0507	 hit@10: 0.0853
epoch 51: train_loss = 0.891359, source_hit@10 = 0.1011, source_ndcg@10 = 0.0502, target_hit@10 = 0.0853, target_ndcg@10 = 0.0431
early termination of training
