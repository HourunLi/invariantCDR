nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=0), device_id='0', domains='cloth_sport', dropout=0.4, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='cs', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 41829
number_item 17943
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 27328
number_item 12655
real graph loaded!
graph loaded!
Loading data from cloth_sport with batch size 1024...
unseen test: 0
test length: 3156
unseen test: 0
test length: 3085
unseen test: 0
test length: 3589
unseen test: 0
test length: 3546
source_user_num 41829
target_user_num 27328
source_item_num 17943
target_item_num 12655
shared users id: 7857
test users 990, 982
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 187880, target train data: 163291, source test data : 3085, target test data : 3546, source dev data : 1000, target dev data : 1000
2024-08-02 17:49:17.610798: step 343/27440 (epoch 1/80), loss = 1.421571 (47.841 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041717	 ndcg_5: 0.0338	 ndcg_10: 0.0437	 hit@1:0.013625	 hit@5:0.0542	 hit@10: 0.0849
target: 	 mrr: 0.031555	 ndcg_5: 0.0238	 ndcg_10: 0.0319	 hit@1:0.008638	 hit@5:0.0390	 hit@10: 0.0644
source best!
..............................
source: 	 mrr: 0.038004	 ndcg_5: 0.0288	 ndcg_10: 0.0385	 hit@1:0.013290	 hit@5:0.0438	 hit@10: 0.0742
target best!
...................................target: 	 mrr: 0.034553	 ndcg_5: 0.0272	 ndcg_10: 0.0354	 hit@1:0.012126	 hit@5:0.0423	 hit@10: 0.0680
epoch 1: train_loss = 1.421571, source_hit@10 = 0.0742, source_ndcg@10 = 0.0385, target_hit@10 = 0.0680, target_ndcg@10 = 0.0354

2024-08-02 17:50:07.151084: step 686/27440 (epoch 2/80), loss = 1.299304 (48.322 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046742	 ndcg_5: 0.0392	 ndcg_10: 0.0503	 hit@1:0.016477	 hit@5:0.0615	 hit@10: 0.0957
target: 	 mrr: 0.036189	 ndcg_5: 0.0264	 ndcg_10: 0.0366	 hit@1:0.013653	 hit@5:0.0398	 hit@10: 0.0716
source best!
..............................
source: 	 mrr: 0.042729	 ndcg_5: 0.0348	 ndcg_10: 0.0458	 hit@1:0.016856	 hit@5:0.0538	 hit@10: 0.0882
target best!
...................................target: 	 mrr: 0.034241	 ndcg_5: 0.0252	 ndcg_10: 0.0357	 hit@1:0.009870	 hit@5:0.0403	 hit@10: 0.0730
epoch 2: train_loss = 1.299304, source_hit@10 = 0.0882, source_ndcg@10 = 0.0458, target_hit@10 = 0.0730, target_ndcg@10 = 0.0357
new best model saved.

2024-08-02 17:50:56.226732: step 1029/27440 (epoch 3/80), loss = 1.274628 (47.693 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039085	 ndcg_5: 0.0305	 ndcg_10: 0.0411	 hit@1:0.012041	 hit@5:0.0497	 hit@10: 0.0827
target: 	 mrr: 0.020197	 ndcg_5: 0.0118	 ndcg_10: 0.0195	 hit@1:0.004179	 hit@5:0.0192	 hit@10: 0.0435
epoch 3: train_loss = 1.274628, source_hit@10 = 0.0827, source_ndcg@10 = 0.0411, target_hit@10 = 0.0435, target_ndcg@10 = 0.0195

2024-08-02 17:51:44.554674: step 1372/27440 (epoch 4/80), loss = 1.259275 (47.687 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.034389	 ndcg_5: 0.0263	 ndcg_10: 0.0365	 hit@1:0.010773	 hit@5:0.0418	 hit@10: 0.0738
target: 	 mrr: 0.034348	 ndcg_5: 0.0256	 ndcg_10: 0.0340	 hit@1:0.009752	 hit@5:0.0418	 hit@10: 0.0680
epoch 4: train_loss = 1.259275, source_hit@10 = 0.0738, source_ndcg@10 = 0.0365, target_hit@10 = 0.0680, target_ndcg@10 = 0.0340

2024-08-02 17:52:33.202168: step 1715/27440 (epoch 5/80), loss = 1.249241 (48.005 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041599	 ndcg_5: 0.0342	 ndcg_10: 0.0445	 hit@1:0.014575	 hit@5:0.0542	 hit@10: 0.0862
target: 	 mrr: 0.035983	 ndcg_5: 0.0283	 ndcg_10: 0.0371	 hit@1:0.010588	 hit@5:0.0460	 hit@10: 0.0730
epoch 5: train_loss = 1.249241, source_hit@10 = 0.0862, source_ndcg@10 = 0.0445, target_hit@10 = 0.0730, target_ndcg@10 = 0.0371

2024-08-02 17:53:21.925090: step 2058/27440 (epoch 6/80), loss = 1.243553 (48.085 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.033631	 ndcg_5: 0.0248	 ndcg_10: 0.0337	 hit@1:0.009506	 hit@5:0.0406	 hit@10: 0.0684
target: 	 mrr: 0.034940	 ndcg_5: 0.0281	 ndcg_10: 0.0365	 hit@1:0.011702	 hit@5:0.0457	 hit@10: 0.0719
epoch 6: train_loss = 1.243553, source_hit@10 = 0.0684, source_ndcg@10 = 0.0337, target_hit@10 = 0.0719, target_ndcg@10 = 0.0365

2024-08-02 17:54:10.244471: step 2401/27440 (epoch 7/80), loss = 1.235884 (47.675 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041256	 ndcg_5: 0.0331	 ndcg_10: 0.0443	 hit@1:0.013625	 hit@5:0.0535	 hit@10: 0.0887
target: 	 mrr: 0.033800	 ndcg_5: 0.0238	 ndcg_10: 0.0333	 hit@1:0.010588	 hit@5:0.0379	 hit@10: 0.0674
epoch 7: train_loss = 1.235884, source_hit@10 = 0.0887, source_ndcg@10 = 0.0443, target_hit@10 = 0.0674, target_ndcg@10 = 0.0333

2024-08-02 17:54:58.860840: step 2744/27440 (epoch 8/80), loss = 1.231575 (47.975 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042086	 ndcg_5: 0.0332	 ndcg_10: 0.0450	 hit@1:0.014575	 hit@5:0.0520	 hit@10: 0.0887
target: 	 mrr: 0.031771	 ndcg_5: 0.0233	 ndcg_10: 0.0328	 hit@1:0.008080	 hit@5:0.0385	 hit@10: 0.0685
epoch 8: train_loss = 1.231575, source_hit@10 = 0.0887, source_ndcg@10 = 0.0450, target_hit@10 = 0.0685, target_ndcg@10 = 0.0328

2024-08-02 17:55:47.197301: step 3087/27440 (epoch 9/80), loss = 1.220199 (47.697 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041266	 ndcg_5: 0.0320	 ndcg_10: 0.0432	 hit@1:0.013625	 hit@5:0.0497	 hit@10: 0.0846
target: 	 mrr: 0.032109	 ndcg_5: 0.0232	 ndcg_10: 0.0323	 hit@1:0.009473	 hit@5:0.0368	 hit@10: 0.0655
epoch 9: train_loss = 1.220199, source_hit@10 = 0.0846, source_ndcg@10 = 0.0432, target_hit@10 = 0.0655, target_ndcg@10 = 0.0323

2024-08-02 17:56:35.804568: step 3430/27440 (epoch 10/80), loss = 1.213319 (47.932 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038154	 ndcg_5: 0.0304	 ndcg_10: 0.0403	 hit@1:0.012041	 hit@5:0.0504	 hit@10: 0.0814
target: 	 mrr: 0.037093	 ndcg_5: 0.0282	 ndcg_10: 0.0387	 hit@1:0.011145	 hit@5:0.0454	 hit@10: 0.0780
target best!
...................................target: 	 mrr: 0.036931	 ndcg_5: 0.0271	 ndcg_10: 0.0372	 hit@1:0.013536	 hit@5:0.0412	 hit@10: 0.0728
epoch 10: train_loss = 1.213319, source_hit@10 = 0.0814, source_ndcg@10 = 0.0403, target_hit@10 = 0.0728, target_ndcg@10 = 0.0372

2024-08-02 17:57:24.604443: step 3773/27440 (epoch 11/80), loss = 1.197332 (47.854 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039743	 ndcg_5: 0.0314	 ndcg_10: 0.0436	 hit@1:0.011724	 hit@5:0.0523	 hit@10: 0.0906
target: 	 mrr: 0.030730	 ndcg_5: 0.0228	 ndcg_10: 0.0325	 hit@1:0.008638	 hit@5:0.0379	 hit@10: 0.0683
epoch 11: train_loss = 1.197332, source_hit@10 = 0.0906, source_ndcg@10 = 0.0436, target_hit@10 = 0.0683, target_ndcg@10 = 0.0325

2024-08-02 17:58:13.163082: step 4116/27440 (epoch 12/80), loss = 1.182591 (47.919 sec/epoch), lr: 0.003800
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043559	 ndcg_5: 0.0366	 ndcg_10: 0.0472	 hit@1:0.015209	 hit@5:0.0589	 hit@10: 0.0919
target: 	 mrr: 0.036269	 ndcg_5: 0.0265	 ndcg_10: 0.0385	 hit@1:0.010031	 hit@5:0.0437	 hit@10: 0.0808
epoch 12: train_loss = 1.182591, source_hit@10 = 0.0919, source_ndcg@10 = 0.0472, target_hit@10 = 0.0808, target_ndcg@10 = 0.0385

2024-08-02 17:59:01.706792: step 4459/27440 (epoch 13/80), loss = 1.173771 (47.861 sec/epoch), lr: 0.003800
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.033983	 ndcg_5: 0.0255	 ndcg_10: 0.0350	 hit@1:0.009506	 hit@5:0.0425	 hit@10: 0.0722
target: 	 mrr: 0.037546	 ndcg_5: 0.0280	 ndcg_10: 0.0395	 hit@1:0.011145	 hit@5:0.0454	 hit@10: 0.0811
target best!
...................................target: 	 mrr: 0.039105	 ndcg_5: 0.0291	 ndcg_10: 0.0410	 hit@1:0.012690	 hit@5:0.0454	 hit@10: 0.0821
epoch 13: train_loss = 1.173771, source_hit@10 = 0.0722, source_ndcg@10 = 0.0350, target_hit@10 = 0.0821, target_ndcg@10 = 0.0410

2024-08-02 17:59:51.099582: step 4802/27440 (epoch 14/80), loss = 1.162956 (48.451 sec/epoch), lr: 0.003610
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.037032	 ndcg_5: 0.0290	 ndcg_10: 0.0389	 hit@1:0.010773	 hit@5:0.0466	 hit@10: 0.0773
target: 	 mrr: 0.037151	 ndcg_5: 0.0280	 ndcg_10: 0.0391	 hit@1:0.010588	 hit@5:0.0457	 hit@10: 0.0802
epoch 14: train_loss = 1.162956, source_hit@10 = 0.0773, source_ndcg@10 = 0.0389, target_hit@10 = 0.0802, target_ndcg@10 = 0.0391

2024-08-02 18:00:39.895922: step 5145/27440 (epoch 15/80), loss = 1.160680 (48.156 sec/epoch), lr: 0.003610
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043188	 ndcg_5: 0.0344	 ndcg_10: 0.0472	 hit@1:0.013308	 hit@5:0.0548	 hit@10: 0.0947
target: 	 mrr: 0.031368	 ndcg_5: 0.0218	 ndcg_10: 0.0316	 hit@1:0.006966	 hit@5:0.0359	 hit@10: 0.0669
epoch 15: train_loss = 1.160680, source_hit@10 = 0.0947, source_ndcg@10 = 0.0472, target_hit@10 = 0.0669, target_ndcg@10 = 0.0316

2024-08-02 18:01:28.280133: step 5488/27440 (epoch 16/80), loss = 1.158474 (47.737 sec/epoch), lr: 0.003610
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046640	 ndcg_5: 0.0375	 ndcg_10: 0.0487	 hit@1:0.018378	 hit@5:0.0558	 hit@10: 0.0909
target: 	 mrr: 0.039602	 ndcg_5: 0.0303	 ndcg_10: 0.0416	 hit@1:0.010588	 hit@5:0.0490	 hit@10: 0.0839
target best!
...................................target: 	 mrr: 0.038456	 ndcg_5: 0.0283	 ndcg_10: 0.0414	 hit@1:0.011844	 hit@5:0.0446	 hit@10: 0.0854
epoch 16: train_loss = 1.158474, source_hit@10 = 0.0909, source_ndcg@10 = 0.0487, target_hit@10 = 0.0854, target_ndcg@10 = 0.0414
new best model saved.

2024-08-02 18:02:17.153105: step 5831/27440 (epoch 17/80), loss = 1.155793 (47.787 sec/epoch), lr: 0.003610
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041827	 ndcg_5: 0.0344	 ndcg_10: 0.0460	 hit@1:0.012041	 hit@5:0.0586	 hit@10: 0.0947
target: 	 mrr: 0.038252	 ndcg_5: 0.0299	 ndcg_10: 0.0415	 hit@1:0.009752	 hit@5:0.0504	 hit@10: 0.0869
epoch 17: train_loss = 1.155793, source_hit@10 = 0.0947, source_ndcg@10 = 0.0460, target_hit@10 = 0.0869, target_ndcg@10 = 0.0415

2024-08-02 18:03:05.408166: step 6174/27440 (epoch 18/80), loss = 1.150713 (47.616 sec/epoch), lr: 0.003429
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048009	 ndcg_5: 0.0388	 ndcg_10: 0.0536	 hit@1:0.016160	 hit@5:0.0608	 hit@10: 0.1068
target: 	 mrr: 0.039688	 ndcg_5: 0.0312	 ndcg_10: 0.0408	 hit@1:0.013374	 hit@5:0.0490	 hit@10: 0.0789
source best!
..............................
source: 	 mrr: 0.045255	 ndcg_5: 0.0359	 ndcg_10: 0.0479	 hit@1:0.016856	 hit@5:0.0548	 hit@10: 0.0917
target best!
...................................target: 	 mrr: 0.039214	 ndcg_5: 0.0308	 ndcg_10: 0.0415	 hit@1:0.011562	 hit@5:0.0485	 hit@10: 0.0818
epoch 18: train_loss = 1.150713, source_hit@10 = 0.0917, source_ndcg@10 = 0.0479, target_hit@10 = 0.0818, target_ndcg@10 = 0.0415
new best model saved.

2024-08-02 18:03:54.412088: step 6517/27440 (epoch 19/80), loss = 1.149135 (47.680 sec/epoch), lr: 0.003429
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042986	 ndcg_5: 0.0351	 ndcg_10: 0.0458	 hit@1:0.014259	 hit@5:0.0561	 hit@10: 0.0890
target: 	 mrr: 0.036034	 ndcg_5: 0.0280	 ndcg_10: 0.0372	 hit@1:0.011702	 hit@5:0.0446	 hit@10: 0.0736
epoch 19: train_loss = 1.149135, source_hit@10 = 0.0890, source_ndcg@10 = 0.0458, target_hit@10 = 0.0736, target_ndcg@10 = 0.0372

2024-08-02 18:04:42.787221: step 6860/27440 (epoch 20/80), loss = 1.143099 (47.708 sec/epoch), lr: 0.003258
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042011	 ndcg_5: 0.0334	 ndcg_10: 0.0443	 hit@1:0.013308	 hit@5:0.0526	 hit@10: 0.0862
target: 	 mrr: 0.035712	 ndcg_5: 0.0265	 ndcg_10: 0.0371	 hit@1:0.010867	 hit@5:0.0426	 hit@10: 0.0755
epoch 20: train_loss = 1.143099, source_hit@10 = 0.0862, source_ndcg@10 = 0.0443, target_hit@10 = 0.0755, target_ndcg@10 = 0.0371

2024-08-02 18:05:31.100525: step 7203/27440 (epoch 21/80), loss = 1.139699 (47.665 sec/epoch), lr: 0.003095
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040959	 ndcg_5: 0.0320	 ndcg_10: 0.0434	 hit@1:0.014575	 hit@5:0.0504	 hit@10: 0.0859
target: 	 mrr: 0.039406	 ndcg_5: 0.0294	 ndcg_10: 0.0403	 hit@1:0.013096	 hit@5:0.0457	 hit@10: 0.0800
epoch 21: train_loss = 1.139699, source_hit@10 = 0.0859, source_ndcg@10 = 0.0434, target_hit@10 = 0.0800, target_ndcg@10 = 0.0403

2024-08-02 18:06:19.740472: step 7546/27440 (epoch 22/80), loss = 1.139057 (47.983 sec/epoch), lr: 0.003095
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039527	 ndcg_5: 0.0312	 ndcg_10: 0.0423	 hit@1:0.010456	 hit@5:0.0526	 hit@10: 0.0871
target: 	 mrr: 0.029661	 ndcg_5: 0.0216	 ndcg_10: 0.0304	 hit@1:0.006966	 hit@5:0.0368	 hit@10: 0.0641
epoch 22: train_loss = 1.139057, source_hit@10 = 0.0871, source_ndcg@10 = 0.0423, target_hit@10 = 0.0641, target_ndcg@10 = 0.0304

2024-08-02 18:07:08.072735: step 7889/27440 (epoch 23/80), loss = 1.133074 (47.632 sec/epoch), lr: 0.002940
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045771	 ndcg_5: 0.0370	 ndcg_10: 0.0493	 hit@1:0.015209	 hit@5:0.0586	 hit@10: 0.0973
target: 	 mrr: 0.041000	 ndcg_5: 0.0313	 ndcg_10: 0.0430	 hit@1:0.015046	 hit@5:0.0485	 hit@10: 0.0847
target best!
...................................target: 	 mrr: 0.040606	 ndcg_5: 0.0321	 ndcg_10: 0.0438	 hit@1:0.013254	 hit@5:0.0513	 hit@10: 0.0883
epoch 23: train_loss = 1.133074, source_hit@10 = 0.0973, source_ndcg@10 = 0.0493, target_hit@10 = 0.0883, target_ndcg@10 = 0.0438

2024-08-02 18:07:56.522071: step 8232/27440 (epoch 24/80), loss = 1.127137 (47.512 sec/epoch), lr: 0.002940
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040011	 ndcg_5: 0.0321	 ndcg_10: 0.0423	 hit@1:0.014892	 hit@5:0.0501	 hit@10: 0.0814
target: 	 mrr: 0.038325	 ndcg_5: 0.0294	 ndcg_10: 0.0393	 hit@1:0.011702	 hit@5:0.0468	 hit@10: 0.0772
epoch 24: train_loss = 1.127137, source_hit@10 = 0.0814, source_ndcg@10 = 0.0423, target_hit@10 = 0.0772, target_ndcg@10 = 0.0393

2024-08-02 18:08:45.030942: step 8575/27440 (epoch 25/80), loss = 1.123586 (47.869 sec/epoch), lr: 0.002793
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041060	 ndcg_5: 0.0320	 ndcg_10: 0.0447	 hit@1:0.013942	 hit@5:0.0510	 hit@10: 0.0906
target: 	 mrr: 0.038692	 ndcg_5: 0.0291	 ndcg_10: 0.0396	 hit@1:0.012538	 hit@5:0.0457	 hit@10: 0.0789
epoch 25: train_loss = 1.123586, source_hit@10 = 0.0906, source_ndcg@10 = 0.0447, target_hit@10 = 0.0789, target_ndcg@10 = 0.0396

2024-08-02 18:09:33.453630: step 8918/27440 (epoch 26/80), loss = 1.116938 (47.722 sec/epoch), lr: 0.002793
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044680	 ndcg_5: 0.0362	 ndcg_10: 0.0492	 hit@1:0.013625	 hit@5:0.0574	 hit@10: 0.0973
target: 	 mrr: 0.039666	 ndcg_5: 0.0301	 ndcg_10: 0.0407	 hit@1:0.012538	 hit@5:0.0474	 hit@10: 0.0808
epoch 26: train_loss = 1.116938, source_hit@10 = 0.0973, source_ndcg@10 = 0.0492, target_hit@10 = 0.0808, target_ndcg@10 = 0.0407

2024-08-02 18:10:22.054707: step 9261/27440 (epoch 27/80), loss = 1.114295 (47.953 sec/epoch), lr: 0.002793
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039399	 ndcg_5: 0.0318	 ndcg_10: 0.0399	 hit@1:0.016793	 hit@5:0.0482	 hit@10: 0.0735
target: 	 mrr: 0.037890	 ndcg_5: 0.0297	 ndcg_10: 0.0403	 hit@1:0.009473	 hit@5:0.0507	 hit@10: 0.0839
epoch 27: train_loss = 1.114295, source_hit@10 = 0.0735, source_ndcg@10 = 0.0399, target_hit@10 = 0.0839, target_ndcg@10 = 0.0403

2024-08-02 18:11:10.258449: step 9604/27440 (epoch 28/80), loss = 1.108185 (47.557 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.035812	 ndcg_5: 0.0261	 ndcg_10: 0.0364	 hit@1:0.010456	 hit@5:0.0428	 hit@10: 0.0751
target: 	 mrr: 0.042537	 ndcg_5: 0.0329	 ndcg_10: 0.0444	 hit@1:0.014767	 hit@5:0.0510	 hit@10: 0.0867
target best!
...................................target: 	 mrr: 0.042494	 ndcg_5: 0.0346	 ndcg_10: 0.0451	 hit@1:0.013536	 hit@5:0.0558	 hit@10: 0.0886
epoch 28: train_loss = 1.108185, source_hit@10 = 0.0751, source_ndcg@10 = 0.0364, target_hit@10 = 0.0886, target_ndcg@10 = 0.0451

2024-08-02 18:11:59.763568: step 9947/27440 (epoch 29/80), loss = 1.105457 (48.560 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041779	 ndcg_5: 0.0329	 ndcg_10: 0.0429	 hit@1:0.013942	 hit@5:0.0516	 hit@10: 0.0830
target: 	 mrr: 0.037758	 ndcg_5: 0.0284	 ndcg_10: 0.0396	 hit@1:0.011702	 hit@5:0.0465	 hit@10: 0.0814
epoch 29: train_loss = 1.105457, source_hit@10 = 0.0830, source_ndcg@10 = 0.0429, target_hit@10 = 0.0814, target_ndcg@10 = 0.0396

2024-08-02 18:12:47.837280: step 10290/27440 (epoch 30/80), loss = 1.100420 (47.434 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048974	 ndcg_5: 0.0393	 ndcg_10: 0.0513	 hit@1:0.019328	 hit@5:0.0593	 hit@10: 0.0966
target: 	 mrr: 0.040276	 ndcg_5: 0.0329	 ndcg_10: 0.0427	 hit@1:0.013374	 hit@5:0.0521	 hit@10: 0.0830
source best!
..............................
source: 	 mrr: 0.043523	 ndcg_5: 0.0341	 ndcg_10: 0.0467	 hit@1:0.012966	 hit@5:0.0558	 hit@10: 0.0953
epoch 30: train_loss = 1.100420, source_hit@10 = 0.0953, source_ndcg@10 = 0.0467, target_hit@10 = 0.0830, target_ndcg@10 = 0.0427

2024-08-02 18:13:37.065651: step 10633/27440 (epoch 31/80), loss = 1.096077 (48.270 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038686	 ndcg_5: 0.0321	 ndcg_10: 0.0405	 hit@1:0.012357	 hit@5:0.0520	 hit@10: 0.0783
target: 	 mrr: 0.035473	 ndcg_5: 0.0262	 ndcg_10: 0.0372	 hit@1:0.010309	 hit@5:0.0435	 hit@10: 0.0777
epoch 31: train_loss = 1.096077, source_hit@10 = 0.0783, source_ndcg@10 = 0.0405, target_hit@10 = 0.0777, target_ndcg@10 = 0.0372

2024-08-02 18:14:25.403476: step 10976/27440 (epoch 32/80), loss = 1.092736 (47.682 sec/epoch), lr: 0.002521
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040407	 ndcg_5: 0.0313	 ndcg_10: 0.0409	 hit@1:0.014575	 hit@5:0.0478	 hit@10: 0.0779
target: 	 mrr: 0.043980	 ndcg_5: 0.0345	 ndcg_10: 0.0459	 hit@1:0.015603	 hit@5:0.0529	 hit@10: 0.0886
target best!
...................................target: 	 mrr: 0.041272	 ndcg_5: 0.0319	 ndcg_10: 0.0437	 hit@1:0.013536	 hit@5:0.0508	 hit@10: 0.0877
epoch 32: train_loss = 1.092736, source_hit@10 = 0.0779, source_ndcg@10 = 0.0409, target_hit@10 = 0.0877, target_ndcg@10 = 0.0437

2024-08-02 18:15:14.313221: step 11319/27440 (epoch 33/80), loss = 1.092507 (47.970 sec/epoch), lr: 0.002521
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.035494	 ndcg_5: 0.0268	 ndcg_10: 0.0361	 hit@1:0.010139	 hit@5:0.0434	 hit@10: 0.0726
target: 	 mrr: 0.040769	 ndcg_5: 0.0307	 ndcg_10: 0.0428	 hit@1:0.012817	 hit@5:0.0476	 hit@10: 0.0850
epoch 33: train_loss = 1.092507, source_hit@10 = 0.0726, source_ndcg@10 = 0.0361, target_hit@10 = 0.0850, target_ndcg@10 = 0.0428

2024-08-02 18:16:02.733568: step 11662/27440 (epoch 34/80), loss = 1.085751 (47.772 sec/epoch), lr: 0.002395
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044470	 ndcg_5: 0.0348	 ndcg_10: 0.0473	 hit@1:0.015209	 hit@5:0.0542	 hit@10: 0.0928
target: 	 mrr: 0.039587	 ndcg_5: 0.0306	 ndcg_10: 0.0420	 hit@1:0.011981	 hit@5:0.0496	 hit@10: 0.0850
epoch 34: train_loss = 1.085751, source_hit@10 = 0.0928, source_ndcg@10 = 0.0473, target_hit@10 = 0.0850, target_ndcg@10 = 0.0420

2024-08-02 18:16:51.543201: step 12005/27440 (epoch 35/80), loss = 1.086381 (48.168 sec/epoch), lr: 0.002395
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045265	 ndcg_5: 0.0375	 ndcg_10: 0.0460	 hit@1:0.017110	 hit@5:0.0580	 hit@10: 0.0843
target: 	 mrr: 0.030410	 ndcg_5: 0.0225	 ndcg_10: 0.0308	 hit@1:0.008359	 hit@5:0.0365	 hit@10: 0.0627
epoch 35: train_loss = 1.086381, source_hit@10 = 0.0843, source_ndcg@10 = 0.0460, target_hit@10 = 0.0627, target_ndcg@10 = 0.0308

2024-08-02 18:17:40.624983: step 12348/27440 (epoch 36/80), loss = 1.082911 (48.419 sec/epoch), lr: 0.002275
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.050021	 ndcg_5: 0.0405	 ndcg_10: 0.0534	 hit@1:0.018378	 hit@5:0.0631	 hit@10: 0.1033
target: 	 mrr: 0.040830	 ndcg_5: 0.0316	 ndcg_10: 0.0426	 hit@1:0.012817	 hit@5:0.0504	 hit@10: 0.0853
source best!
..............................
source: 	 mrr: 0.046066	 ndcg_5: 0.0362	 ndcg_10: 0.0492	 hit@1:0.014911	 hit@5:0.0567	 hit@10: 0.0979
epoch 36: train_loss = 1.082911, source_hit@10 = 0.0979, source_ndcg@10 = 0.0492, target_hit@10 = 0.0853, target_ndcg@10 = 0.0426

2024-08-02 18:18:29.758172: step 12691/27440 (epoch 37/80), loss = 1.079298 (48.222 sec/epoch), lr: 0.002275
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048655	 ndcg_5: 0.0396	 ndcg_10: 0.0524	 hit@1:0.017427	 hit@5:0.0615	 hit@10: 0.1017
target: 	 mrr: 0.038791	 ndcg_5: 0.0296	 ndcg_10: 0.0409	 hit@1:0.011981	 hit@5:0.0476	 hit@10: 0.0830
epoch 37: train_loss = 1.079298, source_hit@10 = 0.1017, source_ndcg@10 = 0.0524, target_hit@10 = 0.0830, target_ndcg@10 = 0.0409

2024-08-02 18:19:18.203426: step 13034/27440 (epoch 38/80), loss = 1.077743 (47.772 sec/epoch), lr: 0.002161
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.050672	 ndcg_5: 0.0413	 ndcg_10: 0.0531	 hit@1:0.020596	 hit@5:0.0631	 hit@10: 0.0998
target: 	 mrr: 0.041228	 ndcg_5: 0.0316	 ndcg_10: 0.0434	 hit@1:0.012817	 hit@5:0.0499	 hit@10: 0.0869
source best!
..............................
source: 	 mrr: 0.048662	 ndcg_5: 0.0402	 ndcg_10: 0.0514	 hit@1:0.018152	 hit@5:0.0619	 hit@10: 0.0969
epoch 38: train_loss = 1.077743, source_hit@10 = 0.0969, source_ndcg@10 = 0.0514, target_hit@10 = 0.0869, target_ndcg@10 = 0.0434

2024-08-02 18:20:07.088170: step 13377/27440 (epoch 39/80), loss = 1.076141 (47.977 sec/epoch), lr: 0.002161
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043109	 ndcg_5: 0.0345	 ndcg_10: 0.0463	 hit@1:0.013942	 hit@5:0.0554	 hit@10: 0.0922
target: 	 mrr: 0.044689	 ndcg_5: 0.0358	 ndcg_10: 0.0481	 hit@1:0.014210	 hit@5:0.0571	 hit@10: 0.0956
target best!
...................................target: 	 mrr: 0.044498	 ndcg_5: 0.0367	 ndcg_10: 0.0482	 hit@1:0.013254	 hit@5:0.0603	 hit@10: 0.0959
epoch 39: train_loss = 1.076141, source_hit@10 = 0.0922, source_ndcg@10 = 0.0463, target_hit@10 = 0.0959, target_ndcg@10 = 0.0482

2024-08-02 18:20:56.193017: step 13720/27440 (epoch 40/80), loss = 1.072442 (48.133 sec/epoch), lr: 0.002053
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042695	 ndcg_5: 0.0340	 ndcg_10: 0.0449	 hit@1:0.015526	 hit@5:0.0526	 hit@10: 0.0868
target: 	 mrr: 0.043924	 ndcg_5: 0.0336	 ndcg_10: 0.0456	 hit@1:0.015046	 hit@5:0.0518	 hit@10: 0.0892
epoch 40: train_loss = 1.072442, source_hit@10 = 0.0868, source_ndcg@10 = 0.0449, target_hit@10 = 0.0892, target_ndcg@10 = 0.0456
shift to transfer learning mode

2024-08-02 18:21:45.398889: step 14063/27440 (epoch 41/80), loss = 1.069263 (48.559 sec/epoch), lr: 0.001951
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045566	 ndcg_5: 0.0362	 ndcg_10: 0.0471	 hit@1:0.017744	 hit@5:0.0545	 hit@10: 0.0881
target: 	 mrr: 0.039748	 ndcg_5: 0.0306	 ndcg_10: 0.0397	 hit@1:0.013374	 hit@5:0.0479	 hit@10: 0.0766
epoch 41: train_loss = 1.069263, source_hit@10 = 0.0881, source_ndcg@10 = 0.0471, target_hit@10 = 0.0766, target_ndcg@10 = 0.0397

2024-08-02 18:22:34.449339: step 14406/27440 (epoch 42/80), loss = 1.065051 (48.380 sec/epoch), lr: 0.001853
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.052667	 ndcg_5: 0.0431	 ndcg_10: 0.0561	 hit@1:0.022180	 hit@5:0.0646	 hit@10: 0.1049
target: 	 mrr: 0.039251	 ndcg_5: 0.0297	 ndcg_10: 0.0405	 hit@1:0.013931	 hit@5:0.0457	 hit@10: 0.0794
source best!
..............................
source: 	 mrr: 0.050561	 ndcg_5: 0.0431	 ndcg_10: 0.0547	 hit@1:0.018476	 hit@5:0.0684	 hit@10: 0.1044
epoch 42: train_loss = 1.065051, source_hit@10 = 0.1044, source_ndcg@10 = 0.0547, target_hit@10 = 0.0794, target_ndcg@10 = 0.0405

2024-08-02 18:23:24.047896: step 14749/27440 (epoch 43/80), loss = 1.062470 (48.672 sec/epoch), lr: 0.001853
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.033173	 ndcg_5: 0.0243	 ndcg_10: 0.0326	 hit@1:0.010139	 hit@5:0.0380	 hit@10: 0.0640
target: 	 mrr: 0.046671	 ndcg_5: 0.0382	 ndcg_10: 0.0490	 hit@1:0.017275	 hit@5:0.0596	 hit@10: 0.0936
target best!
...................................target: 	 mrr: 0.047122	 ndcg_5: 0.0390	 ndcg_10: 0.0512	 hit@1:0.016356	 hit@5:0.0615	 hit@10: 0.0998
epoch 43: train_loss = 1.062470, source_hit@10 = 0.0640, source_ndcg@10 = 0.0326, target_hit@10 = 0.0998, target_ndcg@10 = 0.0512

2024-08-02 18:24:13.874749: step 15092/27440 (epoch 44/80), loss = 1.058623 (48.875 sec/epoch), lr: 0.001761
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042353	 ndcg_5: 0.0324	 ndcg_10: 0.0447	 hit@1:0.012991	 hit@5:0.0513	 hit@10: 0.0890
target: 	 mrr: 0.042760	 ndcg_5: 0.0337	 ndcg_10: 0.0461	 hit@1:0.012817	 hit@5:0.0541	 hit@10: 0.0933
epoch 44: train_loss = 1.058623, source_hit@10 = 0.0890, source_ndcg@10 = 0.0447, target_hit@10 = 0.0933, target_ndcg@10 = 0.0461

2024-08-02 18:25:03.288907: step 15435/27440 (epoch 45/80), loss = 1.060022 (48.770 sec/epoch), lr: 0.001761
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046520	 ndcg_5: 0.0377	 ndcg_10: 0.0488	 hit@1:0.019645	 hit@5:0.0574	 hit@10: 0.0919
target: 	 mrr: 0.043906	 ndcg_5: 0.0354	 ndcg_10: 0.0473	 hit@1:0.013374	 hit@5:0.0574	 hit@10: 0.0945
epoch 45: train_loss = 1.060022, source_hit@10 = 0.0919, source_ndcg@10 = 0.0488, target_hit@10 = 0.0945, target_ndcg@10 = 0.0473

2024-08-02 18:25:52.904857: step 15778/27440 (epoch 46/80), loss = 1.058603 (48.977 sec/epoch), lr: 0.001761
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038198	 ndcg_5: 0.0279	 ndcg_10: 0.0384	 hit@1:0.012674	 hit@5:0.0421	 hit@10: 0.0751
target: 	 mrr: 0.041059	 ndcg_5: 0.0314	 ndcg_10: 0.0431	 hit@1:0.012538	 hit@5:0.0510	 hit@10: 0.0875
epoch 46: train_loss = 1.058603, source_hit@10 = 0.0751, source_ndcg@10 = 0.0384, target_hit@10 = 0.0875, target_ndcg@10 = 0.0431

2024-08-02 18:26:42.110394: step 16121/27440 (epoch 47/80), loss = 1.055256 (48.554 sec/epoch), lr: 0.001672
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049325	 ndcg_5: 0.0390	 ndcg_10: 0.0537	 hit@1:0.019328	 hit@5:0.0599	 hit@10: 0.1055
target: 	 mrr: 0.042163	 ndcg_5: 0.0324	 ndcg_10: 0.0437	 hit@1:0.015325	 hit@5:0.0504	 hit@10: 0.0858
epoch 47: train_loss = 1.055256, source_hit@10 = 0.1055, source_ndcg@10 = 0.0537, target_hit@10 = 0.0858, target_ndcg@10 = 0.0437

2024-08-02 18:27:31.971143: step 16464/27440 (epoch 48/80), loss = 1.054878 (49.193 sec/epoch), lr: 0.001672
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040127	 ndcg_5: 0.0318	 ndcg_10: 0.0404	 hit@1:0.015526	 hit@5:0.0488	 hit@10: 0.0757
target: 	 mrr: 0.042525	 ndcg_5: 0.0330	 ndcg_10: 0.0439	 hit@1:0.015046	 hit@5:0.0513	 hit@10: 0.0853
epoch 48: train_loss = 1.054878, source_hit@10 = 0.0757, source_ndcg@10 = 0.0404, target_hit@10 = 0.0853, target_ndcg@10 = 0.0439

2024-08-02 18:28:21.142858: step 16807/27440 (epoch 49/80), loss = 1.051553 (48.496 sec/epoch), lr: 0.001589
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.053617	 ndcg_5: 0.0444	 ndcg_10: 0.0566	 hit@1:0.023764	 hit@5:0.0659	 hit@10: 0.1039
target: 	 mrr: 0.042898	 ndcg_5: 0.0339	 ndcg_10: 0.0463	 hit@1:0.013653	 hit@5:0.0541	 hit@10: 0.0931
source best!
..............................
source: 	 mrr: 0.048787	 ndcg_5: 0.0396	 ndcg_10: 0.0516	 hit@1:0.018152	 hit@5:0.0613	 hit@10: 0.0985
epoch 49: train_loss = 1.051553, source_hit@10 = 0.0985, source_ndcg@10 = 0.0516, target_hit@10 = 0.0931, target_ndcg@10 = 0.0463

2024-08-02 18:29:10.844150: step 17150/27440 (epoch 50/80), loss = 1.050628 (48.783 sec/epoch), lr: 0.001589
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.050313	 ndcg_5: 0.0410	 ndcg_10: 0.0523	 hit@1:0.021863	 hit@5:0.0608	 hit@10: 0.0957
target: 	 mrr: 0.037480	 ndcg_5: 0.0298	 ndcg_10: 0.0408	 hit@1:0.011145	 hit@5:0.0488	 hit@10: 0.0830
epoch 50: train_loss = 1.050628, source_hit@10 = 0.0957, source_ndcg@10 = 0.0523, target_hit@10 = 0.0830, target_ndcg@10 = 0.0408

2024-08-02 18:29:59.924860: step 17493/27440 (epoch 51/80), loss = 1.050523 (48.437 sec/epoch), lr: 0.001509
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046443	 ndcg_5: 0.0371	 ndcg_10: 0.0494	 hit@1:0.017427	 hit@5:0.0574	 hit@10: 0.0954
target: 	 mrr: 0.044473	 ndcg_5: 0.0362	 ndcg_10: 0.0491	 hit@1:0.013096	 hit@5:0.0602	 hit@10: 0.1006
epoch 51: train_loss = 1.050523, source_hit@10 = 0.0954, source_ndcg@10 = 0.0494, target_hit@10 = 0.1006, target_ndcg@10 = 0.0491
early termination of training
