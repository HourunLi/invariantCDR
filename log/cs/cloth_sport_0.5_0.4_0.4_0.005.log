nohup: ignoring input
using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=1), device_id='1', domains='cloth_sport', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.005, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='cs', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 41829
number_item 17943
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 27328
number_item 12655
real graph loaded!
graph loaded!
Loading data from cloth_sport with batch size 1024...
unseen test: 0
test length: 3156
unseen test: 0
test length: 3085
unseen test: 0
test length: 3589
unseen test: 0
test length: 3546
source_user_num 41829
target_user_num 27328
source_item_num 17943
target_item_num 12655
shared users id: 7857
test users 990, 982
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 187880, target train data: 163291, source test data : 3085, target test data : 3546, source dev data : 1000, target dev data : 1000
2024-08-02 17:13:19.218078: step 343/27440 (epoch 1/80), loss = 1.388044 (50.213 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036266	 ndcg_5: 0.0281	 ndcg_10: 0.0403	 hit@1:0.009506	 hit@5:0.0472	 hit@10: 0.0852
target: 	 mrr: 0.029970	 ndcg_5: 0.0205	 ndcg_10: 0.0297	 hit@1:0.008916	 hit@5:0.0320	 hit@10: 0.0607
source best!
..............................
source: 	 mrr: 0.033196	 ndcg_5: 0.0251	 ndcg_10: 0.0342	 hit@1:0.010049	 hit@5:0.0408	 hit@10: 0.0690
target best!
...................................target: 	 mrr: 0.030904	 ndcg_5: 0.0223	 ndcg_10: 0.0305	 hit@1:0.008742	 hit@5:0.0353	 hit@10: 0.0612
epoch 1: train_loss = 1.388044, source_hit@10 = 0.0690, source_ndcg@10 = 0.0342, target_hit@10 = 0.0612, target_ndcg@10 = 0.0305

2024-08-02 17:14:11.074894: step 686/27440 (epoch 2/80), loss = 1.285190 (50.456 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.029238	 ndcg_5: 0.0219	 ndcg_10: 0.0292	 hit@1:0.008555	 hit@5:0.0361	 hit@10: 0.0586
target: 	 mrr: 0.030986	 ndcg_5: 0.0221	 ndcg_10: 0.0316	 hit@1:0.008916	 hit@5:0.0354	 hit@10: 0.0649
target best!
...................................target: 	 mrr: 0.031688	 ndcg_5: 0.0247	 ndcg_10: 0.0333	 hit@1:0.007896	 hit@5:0.0415	 hit@10: 0.0685
epoch 2: train_loss = 1.285190, source_hit@10 = 0.0586, source_ndcg@10 = 0.0292, target_hit@10 = 0.0685, target_ndcg@10 = 0.0333

2024-08-02 17:15:02.524323: step 1029/27440 (epoch 3/80), loss = 1.273125 (50.352 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.032527	 ndcg_5: 0.0238	 ndcg_10: 0.0339	 hit@1:0.007921	 hit@5:0.0396	 hit@10: 0.0713
target: 	 mrr: 0.025858	 ndcg_5: 0.0200	 ndcg_10: 0.0273	 hit@1:0.006966	 hit@5:0.0332	 hit@10: 0.0560
epoch 3: train_loss = 1.273125, source_hit@10 = 0.0713, source_ndcg@10 = 0.0339, target_hit@10 = 0.0560, target_ndcg@10 = 0.0273

2024-08-02 17:15:53.458848: step 1372/27440 (epoch 4/80), loss = 1.258928 (50.193 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.032226	 ndcg_5: 0.0234	 ndcg_10: 0.0328	 hit@1:0.008872	 hit@5:0.0387	 hit@10: 0.0681
target: 	 mrr: 0.032624	 ndcg_5: 0.0249	 ndcg_10: 0.0320	 hit@1:0.010588	 hit@5:0.0404	 hit@10: 0.0627
target best!
...................................target: 	 mrr: 0.032346	 ndcg_5: 0.0247	 ndcg_10: 0.0322	 hit@1:0.009306	 hit@5:0.0406	 hit@10: 0.0637
epoch 4: train_loss = 1.258928, source_hit@10 = 0.0681, source_ndcg@10 = 0.0328, target_hit@10 = 0.0637, target_ndcg@10 = 0.0322

2024-08-02 17:16:44.314781: step 1715/27440 (epoch 5/80), loss = 1.251407 (49.748 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036514	 ndcg_5: 0.0280	 ndcg_10: 0.0396	 hit@1:0.008872	 hit@5:0.0472	 hit@10: 0.0830
target: 	 mrr: 0.028457	 ndcg_5: 0.0195	 ndcg_10: 0.0276	 hit@1:0.006966	 hit@5:0.0326	 hit@10: 0.0577
source best!
..............................
source: 	 mrr: 0.034017	 ndcg_5: 0.0255	 ndcg_10: 0.0333	 hit@1:0.010373	 hit@5:0.0408	 hit@10: 0.0648
epoch 5: train_loss = 1.251407, source_hit@10 = 0.0648, source_ndcg@10 = 0.0333, target_hit@10 = 0.0577, target_ndcg@10 = 0.0276

2024-08-02 17:17:35.953996: step 2058/27440 (epoch 6/80), loss = 1.242085 (50.560 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038740	 ndcg_5: 0.0292	 ndcg_10: 0.0417	 hit@1:0.012041	 hit@5:0.0482	 hit@10: 0.0868
target: 	 mrr: 0.030221	 ndcg_5: 0.0226	 ndcg_10: 0.0303	 hit@1:0.008080	 hit@5:0.0368	 hit@10: 0.0610
source best!
..............................
source: 	 mrr: 0.038849	 ndcg_5: 0.0290	 ndcg_10: 0.0406	 hit@1:0.014263	 hit@5:0.0438	 hit@10: 0.0797
epoch 6: train_loss = 1.242085, source_hit@10 = 0.0797, source_ndcg@10 = 0.0406, target_hit@10 = 0.0610, target_ndcg@10 = 0.0303

2024-08-02 17:18:27.316651: step 2401/27440 (epoch 7/80), loss = 1.237361 (50.321 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.031846	 ndcg_5: 0.0228	 ndcg_10: 0.0315	 hit@1:0.010456	 hit@5:0.0358	 hit@10: 0.0631
target: 	 mrr: 0.036792	 ndcg_5: 0.0284	 ndcg_10: 0.0388	 hit@1:0.011424	 hit@5:0.0463	 hit@10: 0.0783
target best!
...................................target: 	 mrr: 0.036526	 ndcg_5: 0.0289	 ndcg_10: 0.0395	 hit@1:0.010152	 hit@5:0.0485	 hit@10: 0.0818
epoch 7: train_loss = 1.237361, source_hit@10 = 0.0631, source_ndcg@10 = 0.0315, target_hit@10 = 0.0818, target_ndcg@10 = 0.0395

2024-08-02 17:19:18.312115: step 2744/27440 (epoch 8/80), loss = 1.235674 (49.881 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.031372	 ndcg_5: 0.0213	 ndcg_10: 0.0322	 hit@1:0.009189	 hit@5:0.0336	 hit@10: 0.0675
target: 	 mrr: 0.028313	 ndcg_5: 0.0193	 ndcg_10: 0.0287	 hit@1:0.007244	 hit@5:0.0320	 hit@10: 0.0610
epoch 8: train_loss = 1.235674, source_hit@10 = 0.0675, source_ndcg@10 = 0.0322, target_hit@10 = 0.0610, target_ndcg@10 = 0.0287

2024-08-02 17:20:09.188611: step 3087/27440 (epoch 9/80), loss = 1.224825 (50.112 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036422	 ndcg_5: 0.0276	 ndcg_10: 0.0391	 hit@1:0.010456	 hit@5:0.0450	 hit@10: 0.0811
target: 	 mrr: 0.035247	 ndcg_5: 0.0260	 ndcg_10: 0.0371	 hit@1:0.010309	 hit@5:0.0421	 hit@10: 0.0772
epoch 9: train_loss = 1.224825, source_hit@10 = 0.0811, source_ndcg@10 = 0.0391, target_hit@10 = 0.0772, target_ndcg@10 = 0.0371

2024-08-02 17:20:59.889976: step 3430/27440 (epoch 10/80), loss = 1.215132 (49.937 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038376	 ndcg_5: 0.0307	 ndcg_10: 0.0420	 hit@1:0.011407	 hit@5:0.0513	 hit@10: 0.0862
target: 	 mrr: 0.041116	 ndcg_5: 0.0317	 ndcg_10: 0.0418	 hit@1:0.016996	 hit@5:0.0465	 hit@10: 0.0783
target best!
...................................target: 	 mrr: 0.040348	 ndcg_5: 0.0310	 ndcg_10: 0.0408	 hit@1:0.015510	 hit@5:0.0460	 hit@10: 0.0767
epoch 10: train_loss = 1.215132, source_hit@10 = 0.0862, source_ndcg@10 = 0.0420, target_hit@10 = 0.0767, target_ndcg@10 = 0.0408
new best model saved.

2024-08-02 17:21:51.433074: step 3773/27440 (epoch 11/80), loss = 1.209643 (50.258 sec/epoch), lr: 0.005000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042842	 ndcg_5: 0.0336	 ndcg_10: 0.0449	 hit@1:0.015526	 hit@5:0.0507	 hit@10: 0.0856
target: 	 mrr: 0.033345	 ndcg_5: 0.0236	 ndcg_10: 0.0341	 hit@1:0.010309	 hit@5:0.0376	 hit@10: 0.0705
source best!
..............................
source: 	 mrr: 0.039446	 ndcg_5: 0.0310	 ndcg_10: 0.0416	 hit@1:0.012318	 hit@5:0.0496	 hit@10: 0.0827
epoch 11: train_loss = 1.209643, source_hit@10 = 0.0827, source_ndcg@10 = 0.0416, target_hit@10 = 0.0705, target_ndcg@10 = 0.0341

2024-08-02 17:22:43.141406: step 4116/27440 (epoch 12/80), loss = 1.209513 (50.653 sec/epoch), lr: 0.004750
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040943	 ndcg_5: 0.0338	 ndcg_10: 0.0448	 hit@1:0.011090	 hit@5:0.0564	 hit@10: 0.0909
target: 	 mrr: 0.034721	 ndcg_5: 0.0273	 ndcg_10: 0.0357	 hit@1:0.011424	 hit@5:0.0432	 hit@10: 0.0691
epoch 12: train_loss = 1.209513, source_hit@10 = 0.0909, source_ndcg@10 = 0.0448, target_hit@10 = 0.0691, target_ndcg@10 = 0.0357

2024-08-02 17:23:34.231386: step 4459/27440 (epoch 13/80), loss = 1.200765 (50.351 sec/epoch), lr: 0.004513
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038895	 ndcg_5: 0.0293	 ndcg_10: 0.0397	 hit@1:0.012357	 hit@5:0.0463	 hit@10: 0.0786
target: 	 mrr: 0.034575	 ndcg_5: 0.0242	 ndcg_10: 0.0351	 hit@1:0.010867	 hit@5:0.0379	 hit@10: 0.0722
epoch 13: train_loss = 1.200765, source_hit@10 = 0.0786, source_ndcg@10 = 0.0397, target_hit@10 = 0.0722, target_ndcg@10 = 0.0351

2024-08-02 17:24:25.337579: step 4802/27440 (epoch 14/80), loss = 1.196024 (50.341 sec/epoch), lr: 0.004287
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044788	 ndcg_5: 0.0360	 ndcg_10: 0.0484	 hit@1:0.016160	 hit@5:0.0561	 hit@10: 0.0951
target: 	 mrr: 0.036339	 ndcg_5: 0.0268	 ndcg_10: 0.0371	 hit@1:0.012538	 hit@5:0.0415	 hit@10: 0.0736
source best!
..............................
source: 	 mrr: 0.042286	 ndcg_5: 0.0345	 ndcg_10: 0.0452	 hit@1:0.015883	 hit@5:0.0538	 hit@10: 0.0875
epoch 14: train_loss = 1.196024, source_hit@10 = 0.0875, source_ndcg@10 = 0.0452, target_hit@10 = 0.0736, target_ndcg@10 = 0.0371

2024-08-02 17:25:16.366614: step 5145/27440 (epoch 15/80), loss = 1.195119 (49.969 sec/epoch), lr: 0.004287
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046169	 ndcg_5: 0.0364	 ndcg_10: 0.0491	 hit@1:0.016477	 hit@5:0.0561	 hit@10: 0.0957
target: 	 mrr: 0.036906	 ndcg_5: 0.0282	 ndcg_10: 0.0386	 hit@1:0.009752	 hit@5:0.0468	 hit@10: 0.0791
source best!
..............................
source: 	 mrr: 0.042643	 ndcg_5: 0.0344	 ndcg_10: 0.0446	 hit@1:0.015559	 hit@5:0.0548	 hit@10: 0.0862
epoch 15: train_loss = 1.195119, source_hit@10 = 0.0862, source_ndcg@10 = 0.0446, target_hit@10 = 0.0791, target_ndcg@10 = 0.0386

2024-08-02 17:26:07.544696: step 5488/27440 (epoch 16/80), loss = 1.192810 (50.128 sec/epoch), lr: 0.004287
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042002	 ndcg_5: 0.0315	 ndcg_10: 0.0432	 hit@1:0.015526	 hit@5:0.0475	 hit@10: 0.0837
target: 	 mrr: 0.033104	 ndcg_5: 0.0240	 ndcg_10: 0.0345	 hit@1:0.007244	 hit@5:0.0418	 hit@10: 0.0744
epoch 16: train_loss = 1.192810, source_hit@10 = 0.0837, source_ndcg@10 = 0.0432, target_hit@10 = 0.0744, target_ndcg@10 = 0.0345

2024-08-02 17:26:58.517077: step 5831/27440 (epoch 17/80), loss = 1.188022 (50.213 sec/epoch), lr: 0.004073
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.033771	 ndcg_5: 0.0248	 ndcg_10: 0.0368	 hit@1:0.008555	 hit@5:0.0409	 hit@10: 0.0779
target: 	 mrr: 0.033724	 ndcg_5: 0.0251	 ndcg_10: 0.0345	 hit@1:0.009752	 hit@5:0.0404	 hit@10: 0.0702
epoch 17: train_loss = 1.188022, source_hit@10 = 0.0779, source_ndcg@10 = 0.0368, target_hit@10 = 0.0702, target_ndcg@10 = 0.0345

2024-08-02 17:27:49.395527: step 6174/27440 (epoch 18/80), loss = 1.179980 (50.135 sec/epoch), lr: 0.003869
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044696	 ndcg_5: 0.0367	 ndcg_10: 0.0483	 hit@1:0.014259	 hit@5:0.0596	 hit@10: 0.0954
target: 	 mrr: 0.034793	 ndcg_5: 0.0252	 ndcg_10: 0.0348	 hit@1:0.010309	 hit@5:0.0412	 hit@10: 0.0711
epoch 18: train_loss = 1.179980, source_hit@10 = 0.0954, source_ndcg@10 = 0.0483, target_hit@10 = 0.0711, target_ndcg@10 = 0.0348

2024-08-02 17:28:40.330977: step 6517/27440 (epoch 19/80), loss = 1.177458 (50.188 sec/epoch), lr: 0.003869
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.050032	 ndcg_5: 0.0414	 ndcg_10: 0.0556	 hit@1:0.018695	 hit@5:0.0646	 hit@10: 0.1090
target: 	 mrr: 0.035511	 ndcg_5: 0.0269	 ndcg_10: 0.0358	 hit@1:0.011981	 hit@5:0.0429	 hit@10: 0.0705
source best!
..............................
source: 	 mrr: 0.045281	 ndcg_5: 0.0373	 ndcg_10: 0.0487	 hit@1:0.015235	 hit@5:0.0587	 hit@10: 0.0943
epoch 19: train_loss = 1.177458, source_hit@10 = 0.0943, source_ndcg@10 = 0.0487, target_hit@10 = 0.0705, target_ndcg@10 = 0.0358

2024-08-02 17:29:31.789778: step 6860/27440 (epoch 20/80), loss = 1.173417 (50.412 sec/epoch), lr: 0.003869
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048765	 ndcg_5: 0.0399	 ndcg_10: 0.0514	 hit@1:0.020279	 hit@5:0.0596	 hit@10: 0.0951
target: 	 mrr: 0.034172	 ndcg_5: 0.0247	 ndcg_10: 0.0351	 hit@1:0.010588	 hit@5:0.0398	 hit@10: 0.0722
epoch 20: train_loss = 1.173417, source_hit@10 = 0.0951, source_ndcg@10 = 0.0514, target_hit@10 = 0.0722, target_ndcg@10 = 0.0351

2024-08-02 17:30:22.948560: step 7203/27440 (epoch 21/80), loss = 1.170828 (50.412 sec/epoch), lr: 0.003675
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038750	 ndcg_5: 0.0305	 ndcg_10: 0.0406	 hit@1:0.013625	 hit@5:0.0482	 hit@10: 0.0798
target: 	 mrr: 0.035696	 ndcg_5: 0.0273	 ndcg_10: 0.0355	 hit@1:0.011145	 hit@5:0.0443	 hit@10: 0.0699
epoch 21: train_loss = 1.170828, source_hit@10 = 0.0798, source_ndcg@10 = 0.0406, target_hit@10 = 0.0699, target_ndcg@10 = 0.0355

2024-08-02 17:31:14.306467: step 7546/27440 (epoch 22/80), loss = 1.166252 (50.608 sec/epoch), lr: 0.003492
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040204	 ndcg_5: 0.0301	 ndcg_10: 0.0419	 hit@1:0.011724	 hit@5:0.0488	 hit@10: 0.0859
target: 	 mrr: 0.039984	 ndcg_5: 0.0314	 ndcg_10: 0.0428	 hit@1:0.010309	 hit@5:0.0510	 hit@10: 0.0861
epoch 22: train_loss = 1.166252, source_hit@10 = 0.0859, source_ndcg@10 = 0.0419, target_hit@10 = 0.0861, target_ndcg@10 = 0.0428

2024-08-02 17:32:05.589028: step 7889/27440 (epoch 23/80), loss = 1.165586 (50.544 sec/epoch), lr: 0.003492
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036788	 ndcg_5: 0.0281	 ndcg_10: 0.0399	 hit@1:0.010139	 hit@5:0.0466	 hit@10: 0.0833
target: 	 mrr: 0.035397	 ndcg_5: 0.0265	 ndcg_10: 0.0372	 hit@1:0.009752	 hit@5:0.0440	 hit@10: 0.0775
epoch 23: train_loss = 1.165586, source_hit@10 = 0.0833, source_ndcg@10 = 0.0399, target_hit@10 = 0.0775, target_ndcg@10 = 0.0372

2024-08-02 17:32:56.781489: step 8232/27440 (epoch 24/80), loss = 1.160758 (50.443 sec/epoch), lr: 0.003317
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041278	 ndcg_5: 0.0337	 ndcg_10: 0.0437	 hit@1:0.014259	 hit@5:0.0535	 hit@10: 0.0846
target: 	 mrr: 0.036988	 ndcg_5: 0.0279	 ndcg_10: 0.0389	 hit@1:0.010867	 hit@5:0.0449	 hit@10: 0.0791
epoch 24: train_loss = 1.160758, source_hit@10 = 0.0846, source_ndcg@10 = 0.0437, target_hit@10 = 0.0791, target_ndcg@10 = 0.0389

2024-08-02 17:33:48.438957: step 8575/27440 (epoch 25/80), loss = 1.159812 (50.910 sec/epoch), lr: 0.003317
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047789	 ndcg_5: 0.0368	 ndcg_10: 0.0512	 hit@1:0.018378	 hit@5:0.0554	 hit@10: 0.1001
target: 	 mrr: 0.035150	 ndcg_5: 0.0262	 ndcg_10: 0.0354	 hit@1:0.012538	 hit@5:0.0398	 hit@10: 0.0688
epoch 25: train_loss = 1.159812, source_hit@10 = 0.1001, source_ndcg@10 = 0.0512, target_hit@10 = 0.0688, target_ndcg@10 = 0.0354

2024-08-02 17:34:39.368622: step 8918/27440 (epoch 26/80), loss = 1.156880 (50.161 sec/epoch), lr: 0.003317
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040031	 ndcg_5: 0.0317	 ndcg_10: 0.0410	 hit@1:0.013625	 hit@5:0.0504	 hit@10: 0.0792
target: 	 mrr: 0.037489	 ndcg_5: 0.0275	 ndcg_10: 0.0397	 hit@1:0.010309	 hit@5:0.0454	 hit@10: 0.0836
epoch 26: train_loss = 1.156880, source_hit@10 = 0.0792, source_ndcg@10 = 0.0410, target_hit@10 = 0.0836, target_ndcg@10 = 0.0397

2024-08-02 17:35:30.181946: step 9261/27440 (epoch 27/80), loss = 1.152837 (50.028 sec/epoch), lr: 0.003151
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.030205	 ndcg_5: 0.0232	 ndcg_10: 0.0312	 hit@1:0.008872	 hit@5:0.0377	 hit@10: 0.0631
target: 	 mrr: 0.037235	 ndcg_5: 0.0289	 ndcg_10: 0.0394	 hit@1:0.009752	 hit@5:0.0488	 hit@10: 0.0814
epoch 27: train_loss = 1.152837, source_hit@10 = 0.0631, source_ndcg@10 = 0.0312, target_hit@10 = 0.0814, target_ndcg@10 = 0.0394

2024-08-02 17:36:21.366830: step 9604/27440 (epoch 28/80), loss = 1.150051 (50.398 sec/epoch), lr: 0.002994
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.030219	 ndcg_5: 0.0224	 ndcg_10: 0.0300	 hit@1:0.008238	 hit@5:0.0368	 hit@10: 0.0605
target: 	 mrr: 0.035526	 ndcg_5: 0.0271	 ndcg_10: 0.0364	 hit@1:0.010867	 hit@5:0.0437	 hit@10: 0.0727
epoch 28: train_loss = 1.150051, source_hit@10 = 0.0605, source_ndcg@10 = 0.0300, target_hit@10 = 0.0727, target_ndcg@10 = 0.0364

2024-08-02 17:37:13.434292: step 9947/27440 (epoch 29/80), loss = 1.146323 (51.325 sec/epoch), lr: 0.002844
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.050368	 ndcg_5: 0.0418	 ndcg_10: 0.0545	 hit@1:0.019011	 hit@5:0.0650	 hit@10: 0.1042
target: 	 mrr: 0.037164	 ndcg_5: 0.0275	 ndcg_10: 0.0392	 hit@1:0.010309	 hit@5:0.0451	 hit@10: 0.0814
source best!
..............................
source: 	 mrr: 0.048078	 ndcg_5: 0.0389	 ndcg_10: 0.0500	 hit@1:0.018801	 hit@5:0.0596	 hit@10: 0.0943
epoch 29: train_loss = 1.146323, source_hit@10 = 0.0943, source_ndcg@10 = 0.0500, target_hit@10 = 0.0814, target_ndcg@10 = 0.0392

2024-08-02 17:38:04.803918: step 10290/27440 (epoch 30/80), loss = 1.145383 (50.311 sec/epoch), lr: 0.002844
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044230	 ndcg_5: 0.0348	 ndcg_10: 0.0490	 hit@1:0.013942	 hit@5:0.0567	 hit@10: 0.1008
target: 	 mrr: 0.038873	 ndcg_5: 0.0275	 ndcg_10: 0.0407	 hit@1:0.012817	 hit@5:0.0426	 hit@10: 0.0839
epoch 30: train_loss = 1.145383, source_hit@10 = 0.1008, source_ndcg@10 = 0.0490, target_hit@10 = 0.0839, target_ndcg@10 = 0.0407

2024-08-02 17:38:56.012718: step 10633/27440 (epoch 31/80), loss = 1.137882 (50.473 sec/epoch), lr: 0.002702
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045723	 ndcg_5: 0.0367	 ndcg_10: 0.0476	 hit@1:0.016160	 hit@5:0.0580	 hit@10: 0.0922
target: 	 mrr: 0.039394	 ndcg_5: 0.0304	 ndcg_10: 0.0411	 hit@1:0.012817	 hit@5:0.0485	 hit@10: 0.0816
epoch 31: train_loss = 1.137882, source_hit@10 = 0.0922, source_ndcg@10 = 0.0476, target_hit@10 = 0.0816, target_ndcg@10 = 0.0411

2024-08-02 17:39:47.334760: step 10976/27440 (epoch 32/80), loss = 1.138974 (50.584 sec/epoch), lr: 0.002702
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.034837	 ndcg_5: 0.0272	 ndcg_10: 0.0385	 hit@1:0.009189	 hit@5:0.0463	 hit@10: 0.0814
target: 	 mrr: 0.040274	 ndcg_5: 0.0327	 ndcg_10: 0.0424	 hit@1:0.014489	 hit@5:0.0518	 hit@10: 0.0819
epoch 32: train_loss = 1.138974, source_hit@10 = 0.0814, source_ndcg@10 = 0.0385, target_hit@10 = 0.0819, target_ndcg@10 = 0.0424

2024-08-02 17:40:38.873026: step 11319/27440 (epoch 33/80), loss = 1.135609 (50.798 sec/epoch), lr: 0.002567
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043589	 ndcg_5: 0.0349	 ndcg_10: 0.0461	 hit@1:0.016160	 hit@5:0.0542	 hit@10: 0.0894
target: 	 mrr: 0.041682	 ndcg_5: 0.0325	 ndcg_10: 0.0431	 hit@1:0.014210	 hit@5:0.0507	 hit@10: 0.0836
target best!
...................................target: 	 mrr: 0.040393	 ndcg_5: 0.0324	 ndcg_10: 0.0427	 hit@1:0.011844	 hit@5:0.0530	 hit@10: 0.0849
epoch 33: train_loss = 1.135609, source_hit@10 = 0.0894, source_ndcg@10 = 0.0461, target_hit@10 = 0.0849, target_ndcg@10 = 0.0427

2024-08-02 17:41:29.900779: step 11662/27440 (epoch 34/80), loss = 1.131065 (49.841 sec/epoch), lr: 0.002567
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038845	 ndcg_5: 0.0307	 ndcg_10: 0.0412	 hit@1:0.010456	 hit@5:0.0501	 hit@10: 0.0833
target: 	 mrr: 0.041784	 ndcg_5: 0.0333	 ndcg_10: 0.0458	 hit@1:0.012260	 hit@5:0.0554	 hit@10: 0.0942
target best!
...................................target: 	 mrr: 0.041601	 ndcg_5: 0.0330	 ndcg_10: 0.0436	 hit@1:0.014946	 hit@5:0.0522	 hit@10: 0.0852
epoch 34: train_loss = 1.131065, source_hit@10 = 0.0833, source_ndcg@10 = 0.0412, target_hit@10 = 0.0852, target_ndcg@10 = 0.0436

2024-08-02 17:42:21.233548: step 12005/27440 (epoch 35/80), loss = 1.128438 (50.240 sec/epoch), lr: 0.002438
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.052394	 ndcg_5: 0.0443	 ndcg_10: 0.0567	 hit@1:0.021229	 hit@5:0.0684	 hit@10: 0.1074
target: 	 mrr: 0.039314	 ndcg_5: 0.0292	 ndcg_10: 0.0414	 hit@1:0.011424	 hit@5:0.0474	 hit@10: 0.0858
source best!
..............................
source: 	 mrr: 0.047367	 ndcg_5: 0.0402	 ndcg_10: 0.0507	 hit@1:0.013938	 hit@5:0.0674	 hit@10: 0.1002
epoch 35: train_loss = 1.128438, source_hit@10 = 0.1002, source_ndcg@10 = 0.0507, target_hit@10 = 0.0858, target_ndcg@10 = 0.0414

2024-08-02 17:43:12.311765: step 12348/27440 (epoch 36/80), loss = 1.122505 (50.033 sec/epoch), lr: 0.002438
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044223	 ndcg_5: 0.0339	 ndcg_10: 0.0466	 hit@1:0.015526	 hit@5:0.0516	 hit@10: 0.0913
target: 	 mrr: 0.038902	 ndcg_5: 0.0296	 ndcg_10: 0.0413	 hit@1:0.011981	 hit@5:0.0479	 hit@10: 0.0841
epoch 36: train_loss = 1.122505, source_hit@10 = 0.0913, source_ndcg@10 = 0.0466, target_hit@10 = 0.0841, target_ndcg@10 = 0.0413

2024-08-02 17:44:03.521684: step 12691/27440 (epoch 37/80), loss = 1.114417 (50.459 sec/epoch), lr: 0.002316
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044309	 ndcg_5: 0.0350	 ndcg_10: 0.0466	 hit@1:0.016160	 hit@5:0.0548	 hit@10: 0.0913
target: 	 mrr: 0.041066	 ndcg_5: 0.0332	 ndcg_10: 0.0437	 hit@1:0.013653	 hit@5:0.0546	 hit@10: 0.0875
epoch 37: train_loss = 1.114417, source_hit@10 = 0.0913, source_ndcg@10 = 0.0466, target_hit@10 = 0.0875, target_ndcg@10 = 0.0437

2024-08-02 17:44:54.892123: step 13034/27440 (epoch 38/80), loss = 1.113387 (50.634 sec/epoch), lr: 0.002316
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048940	 ndcg_5: 0.0398	 ndcg_10: 0.0524	 hit@1:0.016160	 hit@5:0.0631	 hit@10: 0.1020
target: 	 mrr: 0.041034	 ndcg_5: 0.0329	 ndcg_10: 0.0439	 hit@1:0.011981	 hit@5:0.0543	 hit@10: 0.0889
epoch 38: train_loss = 1.113387, source_hit@10 = 0.1020, source_ndcg@10 = 0.0524, target_hit@10 = 0.0889, target_ndcg@10 = 0.0439

2024-08-02 17:45:46.029976: step 13377/27440 (epoch 39/80), loss = 1.107747 (50.397 sec/epoch), lr: 0.002316
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040898	 ndcg_5: 0.0319	 ndcg_10: 0.0421	 hit@1:0.014575	 hit@5:0.0494	 hit@10: 0.0814
target: 	 mrr: 0.039891	 ndcg_5: 0.0331	 ndcg_10: 0.0430	 hit@1:0.010031	 hit@5:0.0560	 hit@10: 0.0869
epoch 39: train_loss = 1.107747, source_hit@10 = 0.0814, source_ndcg@10 = 0.0421, target_hit@10 = 0.0869, target_ndcg@10 = 0.0430

