nohup: ignoring input
using gpu:2 to train the model
using gpu:2 to train the model
cuda:2
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=2), device_id='2', domains='cloth_sport', dropout=0.5, epoch=80, feature_dim=252, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='cs', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 41829
number_item 17943
/home/disk2/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 27328
number_item 12655
real graph loaded!
graph loaded!
Loading data from cloth_sport with batch size 1024...
unseen test: 0
test length: 3156
unseen test: 0
test length: 3085
unseen test: 0
test length: 3589
unseen test: 0
test length: 3546
source_user_num 41829
target_user_num 27328
source_item_num 17943
target_item_num 12655
shared users id: 7857
test users 990, 982
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 187880, target train data: 163291, source test data : 3085, target test data : 3546, source dev data : 1000, target dev data : 1000
2024-08-04 11:31:51.124479: step 343/27440 (epoch 1/80), loss = 1.439902 (145.328 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.032744	 ndcg_5: 0.0260	 ndcg_10: 0.0349	 hit@1:0.009189	 hit@5:0.0437	 hit@10: 0.0713
target: 	 mrr: 0.031409	 ndcg_5: 0.0221	 ndcg_10: 0.0313	 hit@1:0.010588	 hit@5:0.0337	 hit@10: 0.0619
source best!
..............................
source: 	 mrr: 0.031796	 ndcg_5: 0.0241	 ndcg_10: 0.0320	 hit@1:0.010373	 hit@5:0.0379	 hit@10: 0.0629
target best!
...................................target: 	 mrr: 0.027674	 ndcg_5: 0.0192	 ndcg_10: 0.0285	 hit@1:0.006768	 hit@5:0.0321	 hit@10: 0.0618
epoch 1: train_loss = 1.439902, source_hit@10 = 0.0629, source_ndcg@10 = 0.0320, target_hit@10 = 0.0618, target_ndcg@10 = 0.0285

2024-08-04 11:34:20.599959: step 686/27440 (epoch 2/80), loss = 1.303889 (146.902 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041504	 ndcg_5: 0.0353	 ndcg_10: 0.0441	 hit@1:0.013308	 hit@5:0.0586	 hit@10: 0.0859
target: 	 mrr: 0.028812	 ndcg_5: 0.0206	 ndcg_10: 0.0290	 hit@1:0.007244	 hit@5:0.0346	 hit@10: 0.0605
source best!
..............................
source: 	 mrr: 0.038166	 ndcg_5: 0.0282	 ndcg_10: 0.0383	 hit@1:0.014587	 hit@5:0.0418	 hit@10: 0.0736
epoch 2: train_loss = 1.303889, source_hit@10 = 0.0736, source_ndcg@10 = 0.0383, target_hit@10 = 0.0605, target_ndcg@10 = 0.0290
new best model saved.

2024-08-04 11:36:53.764195: step 1029/27440 (epoch 3/80), loss = 1.278912 (150.147 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042131	 ndcg_5: 0.0341	 ndcg_10: 0.0453	 hit@1:0.012674	 hit@5:0.0551	 hit@10: 0.0900
target: 	 mrr: 0.028170	 ndcg_5: 0.0187	 ndcg_10: 0.0284	 hit@1:0.007244	 hit@5:0.0309	 hit@10: 0.0607
source best!
..............................
source: 	 mrr: 0.034373	 ndcg_5: 0.0257	 ndcg_10: 0.0367	 hit@1:0.009400	 hit@5:0.0425	 hit@10: 0.0765
epoch 3: train_loss = 1.278912, source_hit@10 = 0.0765, source_ndcg@10 = 0.0367, target_hit@10 = 0.0607, target_ndcg@10 = 0.0284

2024-08-04 11:39:20.218459: step 1372/27440 (epoch 4/80), loss = 1.269412 (144.062 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036777	 ndcg_5: 0.0271	 ndcg_10: 0.0380	 hit@1:0.010773	 hit@5:0.0440	 hit@10: 0.0783
target: 	 mrr: 0.030109	 ndcg_5: 0.0215	 ndcg_10: 0.0302	 hit@1:0.008080	 hit@5:0.0354	 hit@10: 0.0621
epoch 4: train_loss = 1.269412, source_hit@10 = 0.0783, source_ndcg@10 = 0.0380, target_hit@10 = 0.0621, target_ndcg@10 = 0.0302

2024-08-04 11:41:45.657531: step 1715/27440 (epoch 5/80), loss = 1.250340 (144.036 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039967	 ndcg_5: 0.0324	 ndcg_10: 0.0414	 hit@1:0.014575	 hit@5:0.0507	 hit@10: 0.0792
target: 	 mrr: 0.031428	 ndcg_5: 0.0230	 ndcg_10: 0.0332	 hit@1:0.008638	 hit@5:0.0379	 hit@10: 0.0697
target best!
...................................target: 	 mrr: 0.033420	 ndcg_5: 0.0258	 ndcg_10: 0.0365	 hit@1:0.008742	 hit@5:0.0429	 hit@10: 0.0761
epoch 5: train_loss = 1.250340, source_hit@10 = 0.0792, source_ndcg@10 = 0.0414, target_hit@10 = 0.0761, target_ndcg@10 = 0.0365

2024-08-04 11:44:12.888173: step 2058/27440 (epoch 6/80), loss = 1.238433 (145.097 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040186	 ndcg_5: 0.0301	 ndcg_10: 0.0430	 hit@1:0.013942	 hit@5:0.0482	 hit@10: 0.0884
target: 	 mrr: 0.029459	 ndcg_5: 0.0212	 ndcg_10: 0.0303	 hit@1:0.006687	 hit@5:0.0362	 hit@10: 0.0644
epoch 6: train_loss = 1.238433, source_hit@10 = 0.0884, source_ndcg@10 = 0.0430, target_hit@10 = 0.0644, target_ndcg@10 = 0.0303

2024-08-04 11:46:38.587485: step 2401/27440 (epoch 7/80), loss = 1.224374 (144.293 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.035873	 ndcg_5: 0.0266	 ndcg_10: 0.0359	 hit@1:0.010456	 hit@5:0.0440	 hit@10: 0.0732
target: 	 mrr: 0.033546	 ndcg_5: 0.0247	 ndcg_10: 0.0349	 hit@1:0.011145	 hit@5:0.0393	 hit@10: 0.0713
target best!
...................................target: 	 mrr: 0.032336	 ndcg_5: 0.0231	 ndcg_10: 0.0318	 hit@1:0.010716	 hit@5:0.0358	 hit@10: 0.0629
epoch 7: train_loss = 1.224374, source_hit@10 = 0.0732, source_ndcg@10 = 0.0359, target_hit@10 = 0.0629, target_ndcg@10 = 0.0318

2024-08-04 11:49:04.559564: step 2744/27440 (epoch 8/80), loss = 1.219319 (143.962 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041000	 ndcg_5: 0.0337	 ndcg_10: 0.0446	 hit@1:0.013308	 hit@5:0.0554	 hit@10: 0.0890
target: 	 mrr: 0.029034	 ndcg_5: 0.0201	 ndcg_10: 0.0295	 hit@1:0.008080	 hit@5:0.0334	 hit@10: 0.0627
epoch 8: train_loss = 1.219319, source_hit@10 = 0.0890, source_ndcg@10 = 0.0446, target_hit@10 = 0.0627, target_ndcg@10 = 0.0295

2024-08-04 11:51:30.070870: step 3087/27440 (epoch 9/80), loss = 1.212590 (144.068 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042018	 ndcg_5: 0.0338	 ndcg_10: 0.0458	 hit@1:0.013308	 hit@5:0.0548	 hit@10: 0.0919
target: 	 mrr: 0.029915	 ndcg_5: 0.0230	 ndcg_10: 0.0303	 hit@1:0.007523	 hit@5:0.0393	 hit@10: 0.0621
epoch 9: train_loss = 1.212590, source_hit@10 = 0.0919, source_ndcg@10 = 0.0458, target_hit@10 = 0.0621, target_ndcg@10 = 0.0303

2024-08-04 11:53:55.653787: step 3430/27440 (epoch 10/80), loss = 1.205502 (144.163 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040662	 ndcg_5: 0.0316	 ndcg_10: 0.0438	 hit@1:0.012674	 hit@5:0.0520	 hit@10: 0.0906
target: 	 mrr: 0.030951	 ndcg_5: 0.0225	 ndcg_10: 0.0314	 hit@1:0.008916	 hit@5:0.0373	 hit@10: 0.0649
epoch 10: train_loss = 1.205502, source_hit@10 = 0.0906, source_ndcg@10 = 0.0438, target_hit@10 = 0.0649, target_ndcg@10 = 0.0314

2024-08-04 11:56:21.342574: step 3773/27440 (epoch 11/80), loss = 1.197200 (144.282 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039731	 ndcg_5: 0.0321	 ndcg_10: 0.0429	 hit@1:0.012991	 hit@5:0.0526	 hit@10: 0.0865
target: 	 mrr: 0.029318	 ndcg_5: 0.0205	 ndcg_10: 0.0296	 hit@1:0.006408	 hit@5:0.0348	 hit@10: 0.0632
epoch 11: train_loss = 1.197200, source_hit@10 = 0.0865, source_ndcg@10 = 0.0429, target_hit@10 = 0.0632, target_ndcg@10 = 0.0296

2024-08-04 11:58:46.596961: step 4116/27440 (epoch 12/80), loss = 1.192923 (143.856 sec/epoch), lr: 0.003800
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042798	 ndcg_5: 0.0337	 ndcg_10: 0.0451	 hit@1:0.015843	 hit@5:0.0520	 hit@10: 0.0871
target: 	 mrr: 0.032837	 ndcg_5: 0.0239	 ndcg_10: 0.0333	 hit@1:0.008080	 hit@5:0.0404	 hit@10: 0.0697
source best!
..............................
source: 	 mrr: 0.041199	 ndcg_5: 0.0337	 ndcg_10: 0.0437	 hit@1:0.013290	 hit@5:0.0551	 hit@10: 0.0862
epoch 12: train_loss = 1.192923, source_hit@10 = 0.0862, source_ndcg@10 = 0.0437, target_hit@10 = 0.0697, target_ndcg@10 = 0.0333

2024-08-04 12:01:13.103028: step 4459/27440 (epoch 13/80), loss = 1.184431 (144.503 sec/epoch), lr: 0.003800
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043314	 ndcg_5: 0.0340	 ndcg_10: 0.0465	 hit@1:0.014259	 hit@5:0.0539	 hit@10: 0.0928
target: 	 mrr: 0.032961	 ndcg_5: 0.0231	 ndcg_10: 0.0342	 hit@1:0.008638	 hit@5:0.0393	 hit@10: 0.0736
source best!
..............................
source: 	 mrr: 0.040287	 ndcg_5: 0.0311	 ndcg_10: 0.0427	 hit@1:0.012642	 hit@5:0.0506	 hit@10: 0.0869
epoch 13: train_loss = 1.184431, source_hit@10 = 0.0869, source_ndcg@10 = 0.0427, target_hit@10 = 0.0736, target_ndcg@10 = 0.0342

2024-08-04 12:03:40.217684: step 4802/27440 (epoch 14/80), loss = 1.175925 (145.150 sec/epoch), lr: 0.003800
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041504	 ndcg_5: 0.0338	 ndcg_10: 0.0450	 hit@1:0.011724	 hit@5:0.0558	 hit@10: 0.0909
target: 	 mrr: 0.030091	 ndcg_5: 0.0223	 ndcg_10: 0.0310	 hit@1:0.008080	 hit@5:0.0368	 hit@10: 0.0638
epoch 14: train_loss = 1.175925, source_hit@10 = 0.0909, source_ndcg@10 = 0.0450, target_hit@10 = 0.0638, target_ndcg@10 = 0.0310

2024-08-04 12:06:06.028736: step 5145/27440 (epoch 15/80), loss = 1.169355 (144.414 sec/epoch), lr: 0.003610
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040527	 ndcg_5: 0.0310	 ndcg_10: 0.0435	 hit@1:0.011724	 hit@5:0.0510	 hit@10: 0.0900
target: 	 mrr: 0.032851	 ndcg_5: 0.0243	 ndcg_10: 0.0321	 hit@1:0.010031	 hit@5:0.0385	 hit@10: 0.0627
epoch 15: train_loss = 1.169355, source_hit@10 = 0.0900, source_ndcg@10 = 0.0435, target_hit@10 = 0.0627, target_ndcg@10 = 0.0321

2024-08-04 12:08:33.445618: step 5488/27440 (epoch 16/80), loss = 1.164891 (145.946 sec/epoch), lr: 0.003610
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040778	 ndcg_5: 0.0321	 ndcg_10: 0.0445	 hit@1:0.013625	 hit@5:0.0497	 hit@10: 0.0884
target: 	 mrr: 0.027813	 ndcg_5: 0.0182	 ndcg_10: 0.0271	 hit@1:0.006408	 hit@5:0.0306	 hit@10: 0.0585
epoch 16: train_loss = 1.164891, source_hit@10 = 0.0884, source_ndcg@10 = 0.0445, target_hit@10 = 0.0585, target_ndcg@10 = 0.0271

2024-08-04 12:10:59.407127: step 5831/27440 (epoch 17/80), loss = 1.156117 (144.552 sec/epoch), lr: 0.003429
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038630	 ndcg_5: 0.0288	 ndcg_10: 0.0406	 hit@1:0.012041	 hit@5:0.0459	 hit@10: 0.0827
target: 	 mrr: 0.032771	 ndcg_5: 0.0227	 ndcg_10: 0.0338	 hit@1:0.008080	 hit@5:0.0376	 hit@10: 0.0719
epoch 17: train_loss = 1.156117, source_hit@10 = 0.0827, source_ndcg@10 = 0.0406, target_hit@10 = 0.0719, target_ndcg@10 = 0.0338

2024-08-04 12:13:24.770048: step 6174/27440 (epoch 18/80), loss = 1.153257 (143.949 sec/epoch), lr: 0.003429
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041912	 ndcg_5: 0.0337	 ndcg_10: 0.0453	 hit@1:0.012041	 hit@5:0.0561	 hit@10: 0.0928
target: 	 mrr: 0.028890	 ndcg_5: 0.0207	 ndcg_10: 0.0303	 hit@1:0.006966	 hit@5:0.0357	 hit@10: 0.0660
epoch 18: train_loss = 1.153257, source_hit@10 = 0.0928, source_ndcg@10 = 0.0453, target_hit@10 = 0.0660, target_ndcg@10 = 0.0303

2024-08-04 12:15:50.065919: step 6517/27440 (epoch 19/80), loss = 1.148598 (143.893 sec/epoch), lr: 0.003258
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046946	 ndcg_5: 0.0366	 ndcg_10: 0.0501	 hit@1:0.016477	 hit@5:0.0561	 hit@10: 0.0979
target: 	 mrr: 0.033854	 ndcg_5: 0.0246	 ndcg_10: 0.0339	 hit@1:0.008638	 hit@5:0.0412	 hit@10: 0.0705
source best!
..............................
source: 	 mrr: 0.041547	 ndcg_5: 0.0310	 ndcg_10: 0.0434	 hit@1:0.013290	 hit@5:0.0483	 hit@10: 0.0872
target best!
...................................target: 	 mrr: 0.035034	 ndcg_5: 0.0245	 ndcg_10: 0.0356	 hit@1:0.010716	 hit@5:0.0381	 hit@10: 0.0728
epoch 19: train_loss = 1.148598, source_hit@10 = 0.0872, source_ndcg@10 = 0.0434, target_hit@10 = 0.0728, target_ndcg@10 = 0.0356
new best model saved.

2024-08-04 12:18:20.799596: step 6860/27440 (epoch 20/80), loss = 1.145000 (147.418 sec/epoch), lr: 0.003258
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043852	 ndcg_5: 0.0364	 ndcg_10: 0.0455	 hit@1:0.016477	 hit@5:0.0561	 hit@10: 0.0846
target: 	 mrr: 0.035885	 ndcg_5: 0.0270	 ndcg_10: 0.0375	 hit@1:0.009195	 hit@5:0.0457	 hit@10: 0.0789
target best!
...................................target: 	 mrr: 0.035000	 ndcg_5: 0.0266	 ndcg_10: 0.0365	 hit@1:0.008460	 hit@5:0.0446	 hit@10: 0.0753
epoch 20: train_loss = 1.145000, source_hit@10 = 0.0846, source_ndcg@10 = 0.0455, target_hit@10 = 0.0753, target_ndcg@10 = 0.0365

2024-08-04 12:20:47.343899: step 7203/27440 (epoch 21/80), loss = 1.140143 (144.567 sec/epoch), lr: 0.003095
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046219	 ndcg_5: 0.0376	 ndcg_10: 0.0497	 hit@1:0.016160	 hit@5:0.0596	 hit@10: 0.0973
target: 	 mrr: 0.037147	 ndcg_5: 0.0289	 ndcg_10: 0.0380	 hit@1:0.010309	 hit@5:0.0471	 hit@10: 0.0755
target best!
...................................target: 	 mrr: 0.038498	 ndcg_5: 0.0300	 ndcg_10: 0.0417	 hit@1:0.011844	 hit@5:0.0491	 hit@10: 0.0852
epoch 21: train_loss = 1.140143, source_hit@10 = 0.0973, source_ndcg@10 = 0.0497, target_hit@10 = 0.0852, target_ndcg@10 = 0.0417
new best model saved.

2024-08-04 12:23:14.172588: step 7546/27440 (epoch 22/80), loss = 1.139199 (143.491 sec/epoch), lr: 0.003095
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039322	 ndcg_5: 0.0307	 ndcg_10: 0.0407	 hit@1:0.013308	 hit@5:0.0488	 hit@10: 0.0802
target: 	 mrr: 0.036788	 ndcg_5: 0.0273	 ndcg_10: 0.0369	 hit@1:0.011145	 hit@5:0.0435	 hit@10: 0.0733
epoch 22: train_loss = 1.139199, source_hit@10 = 0.0802, source_ndcg@10 = 0.0407, target_hit@10 = 0.0733, target_ndcg@10 = 0.0369

2024-08-04 12:25:44.096954: step 7889/27440 (epoch 23/80), loss = 1.135490 (148.548 sec/epoch), lr: 0.002940
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044596	 ndcg_5: 0.0355	 ndcg_10: 0.0480	 hit@1:0.014575	 hit@5:0.0567	 hit@10: 0.0954
target: 	 mrr: 0.037366	 ndcg_5: 0.0271	 ndcg_10: 0.0380	 hit@1:0.011424	 hit@5:0.0429	 hit@10: 0.0769
target best!
...................................target: 	 mrr: 0.037323	 ndcg_5: 0.0283	 ndcg_10: 0.0396	 hit@1:0.009870	 hit@5:0.0471	 hit@10: 0.0826
epoch 23: train_loss = 1.135490, source_hit@10 = 0.0954, source_ndcg@10 = 0.0480, target_hit@10 = 0.0826, target_ndcg@10 = 0.0396

2024-08-04 12:28:11.095546: step 8232/27440 (epoch 24/80), loss = 1.132469 (144.971 sec/epoch), lr: 0.002940
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043434	 ndcg_5: 0.0355	 ndcg_10: 0.0471	 hit@1:0.013308	 hit@5:0.0583	 hit@10: 0.0944
target: 	 mrr: 0.034259	 ndcg_5: 0.0253	 ndcg_10: 0.0359	 hit@1:0.009752	 hit@5:0.0407	 hit@10: 0.0738
epoch 24: train_loss = 1.132469, source_hit@10 = 0.0944, source_ndcg@10 = 0.0471, target_hit@10 = 0.0738, target_ndcg@10 = 0.0359

2024-08-04 12:30:38.433484: step 8575/27440 (epoch 25/80), loss = 1.130622 (145.589 sec/epoch), lr: 0.002793
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042449	 ndcg_5: 0.0330	 ndcg_10: 0.0461	 hit@1:0.013308	 hit@5:0.0535	 hit@10: 0.0941
target: 	 mrr: 0.032393	 ndcg_5: 0.0239	 ndcg_10: 0.0329	 hit@1:0.009752	 hit@5:0.0385	 hit@10: 0.0663
epoch 25: train_loss = 1.130622, source_hit@10 = 0.0941, source_ndcg@10 = 0.0461, target_hit@10 = 0.0663, target_ndcg@10 = 0.0329

2024-08-04 12:33:05.857882: step 8918/27440 (epoch 26/80), loss = 1.124719 (146.028 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044548	 ndcg_5: 0.0361	 ndcg_10: 0.0470	 hit@1:0.015209	 hit@5:0.0577	 hit@10: 0.0913
target: 	 mrr: 0.036161	 ndcg_5: 0.0267	 ndcg_10: 0.0380	 hit@1:0.010309	 hit@5:0.0418	 hit@10: 0.0769
epoch 26: train_loss = 1.124719, source_hit@10 = 0.0913, source_ndcg@10 = 0.0470, target_hit@10 = 0.0769, target_ndcg@10 = 0.0380

2024-08-04 12:35:33.051924: step 9261/27440 (epoch 27/80), loss = 1.124594 (145.788 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047767	 ndcg_5: 0.0396	 ndcg_10: 0.0517	 hit@1:0.016160	 hit@5:0.0634	 hit@10: 0.1011
target: 	 mrr: 0.035063	 ndcg_5: 0.0256	 ndcg_10: 0.0370	 hit@1:0.009473	 hit@5:0.0429	 hit@10: 0.0789
source best!
..............................
source: 	 mrr: 0.045693	 ndcg_5: 0.0354	 ndcg_10: 0.0476	 hit@1:0.016856	 hit@5:0.0535	 hit@10: 0.0914
epoch 27: train_loss = 1.124594, source_hit@10 = 0.0914, source_ndcg@10 = 0.0476, target_hit@10 = 0.0789, target_ndcg@10 = 0.0370

2024-08-04 12:38:00.844192: step 9604/27440 (epoch 28/80), loss = 1.124170 (145.841 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048365	 ndcg_5: 0.0395	 ndcg_10: 0.0529	 hit@1:0.018061	 hit@5:0.0615	 hit@10: 0.1033
target: 	 mrr: 0.035599	 ndcg_5: 0.0252	 ndcg_10: 0.0368	 hit@1:0.010588	 hit@5:0.0410	 hit@10: 0.0772
source best!
..............................
source: 	 mrr: 0.045283	 ndcg_5: 0.0346	 ndcg_10: 0.0491	 hit@1:0.016532	 hit@5:0.0525	 hit@10: 0.0982
epoch 28: train_loss = 1.124170, source_hit@10 = 0.0982, source_ndcg@10 = 0.0491, target_hit@10 = 0.0772, target_ndcg@10 = 0.0368

2024-08-04 12:40:28.142225: step 9947/27440 (epoch 29/80), loss = 1.124347 (144.814 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046074	 ndcg_5: 0.0380	 ndcg_10: 0.0500	 hit@1:0.016477	 hit@5:0.0612	 hit@10: 0.0989
target: 	 mrr: 0.038858	 ndcg_5: 0.0286	 ndcg_10: 0.0409	 hit@1:0.011981	 hit@5:0.0463	 hit@10: 0.0844
target best!
...................................target: 	 mrr: 0.040022	 ndcg_5: 0.0309	 ndcg_10: 0.0419	 hit@1:0.012408	 hit@5:0.0494	 hit@10: 0.0835
epoch 29: train_loss = 1.124347, source_hit@10 = 0.0989, source_ndcg@10 = 0.0500, target_hit@10 = 0.0835, target_ndcg@10 = 0.0419

2024-08-04 12:42:53.851487: step 10290/27440 (epoch 30/80), loss = 1.121157 (143.597 sec/epoch), lr: 0.002654
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041910	 ndcg_5: 0.0321	 ndcg_10: 0.0446	 hit@1:0.013942	 hit@5:0.0507	 hit@10: 0.0894
target: 	 mrr: 0.037451	 ndcg_5: 0.0273	 ndcg_10: 0.0380	 hit@1:0.011424	 hit@5:0.0432	 hit@10: 0.0769
epoch 30: train_loss = 1.121157, source_hit@10 = 0.0894, source_ndcg@10 = 0.0446, target_hit@10 = 0.0769, target_ndcg@10 = 0.0380

2024-08-04 12:45:20.012887: step 10633/27440 (epoch 31/80), loss = 1.114686 (144.765 sec/epoch), lr: 0.002521
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046941	 ndcg_5: 0.0372	 ndcg_10: 0.0492	 hit@1:0.017427	 hit@5:0.0577	 hit@10: 0.0951
target: 	 mrr: 0.038653	 ndcg_5: 0.0296	 ndcg_10: 0.0413	 hit@1:0.011424	 hit@5:0.0482	 hit@10: 0.0847
epoch 31: train_loss = 1.114686, source_hit@10 = 0.0951, source_ndcg@10 = 0.0492, target_hit@10 = 0.0847, target_ndcg@10 = 0.0413

2024-08-04 12:47:47.395201: step 10976/27440 (epoch 32/80), loss = 1.117126 (145.976 sec/epoch), lr: 0.002521
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.037195	 ndcg_5: 0.0278	 ndcg_10: 0.0392	 hit@1:0.011407	 hit@5:0.0434	 hit@10: 0.0789
target: 	 mrr: 0.040958	 ndcg_5: 0.0325	 ndcg_10: 0.0429	 hit@1:0.016160	 hit@5:0.0488	 hit@10: 0.0808
target best!
...................................target: 	 mrr: 0.037107	 ndcg_5: 0.0289	 ndcg_10: 0.0392	 hit@1:0.011562	 hit@5:0.0457	 hit@10: 0.0781
epoch 32: train_loss = 1.117126, source_hit@10 = 0.0789, source_ndcg@10 = 0.0392, target_hit@10 = 0.0781, target_ndcg@10 = 0.0392

2024-08-04 12:50:18.874738: step 11319/27440 (epoch 33/80), loss = 1.114010 (149.328 sec/epoch), lr: 0.002395
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041567	 ndcg_5: 0.0326	 ndcg_10: 0.0464	 hit@1:0.012357	 hit@5:0.0532	 hit@10: 0.0966
target: 	 mrr: 0.038453	 ndcg_5: 0.0295	 ndcg_10: 0.0402	 hit@1:0.010588	 hit@5:0.0488	 hit@10: 0.0819
epoch 33: train_loss = 1.114010, source_hit@10 = 0.0966, source_ndcg@10 = 0.0464, target_hit@10 = 0.0819, target_ndcg@10 = 0.0402

2024-08-04 12:52:45.636119: step 11662/27440 (epoch 34/80), loss = 1.110783 (145.343 sec/epoch), lr: 0.002395
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043077	 ndcg_5: 0.0340	 ndcg_10: 0.0459	 hit@1:0.015843	 hit@5:0.0523	 hit@10: 0.0894
target: 	 mrr: 0.039037	 ndcg_5: 0.0298	 ndcg_10: 0.0406	 hit@1:0.012260	 hit@5:0.0488	 hit@10: 0.0828
epoch 34: train_loss = 1.110783, source_hit@10 = 0.0894, source_ndcg@10 = 0.0459, target_hit@10 = 0.0828, target_ndcg@10 = 0.0406

2024-08-04 12:55:11.106660: step 12005/27440 (epoch 35/80), loss = 1.111913 (144.082 sec/epoch), lr: 0.002395
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043270	 ndcg_5: 0.0342	 ndcg_10: 0.0448	 hit@1:0.015843	 hit@5:0.0529	 hit@10: 0.0856
target: 	 mrr: 0.039003	 ndcg_5: 0.0276	 ndcg_10: 0.0409	 hit@1:0.012817	 hit@5:0.0429	 hit@10: 0.0847
epoch 35: train_loss = 1.111913, source_hit@10 = 0.0856, source_ndcg@10 = 0.0448, target_hit@10 = 0.0847, target_ndcg@10 = 0.0409

2024-08-04 12:57:37.014212: step 12348/27440 (epoch 36/80), loss = 1.106385 (144.495 sec/epoch), lr: 0.002395
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042764	 ndcg_5: 0.0333	 ndcg_10: 0.0447	 hit@1:0.014575	 hit@5:0.0516	 hit@10: 0.0871
target: 	 mrr: 0.036113	 ndcg_5: 0.0281	 ndcg_10: 0.0385	 hit@1:0.009752	 hit@5:0.0463	 hit@10: 0.0789
epoch 36: train_loss = 1.106385, source_hit@10 = 0.0871, source_ndcg@10 = 0.0447, target_hit@10 = 0.0789, target_ndcg@10 = 0.0385

2024-08-04 13:00:03.510286: step 12691/27440 (epoch 37/80), loss = 1.101164 (145.047 sec/epoch), lr: 0.002275
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044733	 ndcg_5: 0.0361	 ndcg_10: 0.0477	 hit@1:0.014575	 hit@5:0.0580	 hit@10: 0.0944
target: 	 mrr: 0.038921	 ndcg_5: 0.0292	 ndcg_10: 0.0411	 hit@1:0.010588	 hit@5:0.0479	 hit@10: 0.0847
epoch 37: train_loss = 1.101164, source_hit@10 = 0.0944, source_ndcg@10 = 0.0477, target_hit@10 = 0.0847, target_ndcg@10 = 0.0411

2024-08-04 13:02:31.785507: step 13034/27440 (epoch 38/80), loss = 1.103259 (146.853 sec/epoch), lr: 0.002275
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041531	 ndcg_5: 0.0327	 ndcg_10: 0.0434	 hit@1:0.016160	 hit@5:0.0494	 hit@10: 0.0830
target: 	 mrr: 0.040556	 ndcg_5: 0.0306	 ndcg_10: 0.0416	 hit@1:0.013653	 hit@5:0.0482	 hit@10: 0.0825
epoch 38: train_loss = 1.103259, source_hit@10 = 0.0830, source_ndcg@10 = 0.0434, target_hit@10 = 0.0825, target_ndcg@10 = 0.0416

2024-08-04 13:05:00.002723: step 13377/27440 (epoch 39/80), loss = 1.099775 (146.799 sec/epoch), lr: 0.002161
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044035	 ndcg_5: 0.0353	 ndcg_10: 0.0458	 hit@1:0.015526	 hit@5:0.0545	 hit@10: 0.0868
target: 	 mrr: 0.040359	 ndcg_5: 0.0314	 ndcg_10: 0.0427	 hit@1:0.012538	 hit@5:0.0513	 hit@10: 0.0864
epoch 39: train_loss = 1.099775, source_hit@10 = 0.0868, source_ndcg@10 = 0.0458, target_hit@10 = 0.0864, target_ndcg@10 = 0.0427

2024-08-04 13:07:27.996810: step 13720/27440 (epoch 40/80), loss = 1.098878 (146.581 sec/epoch), lr: 0.002161
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047353	 ndcg_5: 0.0376	 ndcg_10: 0.0518	 hit@1:0.014259	 hit@5:0.0596	 hit@10: 0.1036
target: 	 mrr: 0.039777	 ndcg_5: 0.0298	 ndcg_10: 0.0419	 hit@1:0.011981	 hit@5:0.0476	 hit@10: 0.0850
epoch 40: train_loss = 1.098878, source_hit@10 = 0.1036, source_ndcg@10 = 0.0518, target_hit@10 = 0.0850, target_ndcg@10 = 0.0419
shift to transfer learning mode

2024-08-04 13:09:55.381428: step 14063/27440 (epoch 41/80), loss = 1.098187 (145.912 sec/epoch), lr: 0.002161
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048381	 ndcg_5: 0.0392	 ndcg_10: 0.0517	 hit@1:0.016793	 hit@5:0.0612	 hit@10: 0.1001
target: 	 mrr: 0.034736	 ndcg_5: 0.0256	 ndcg_10: 0.0368	 hit@1:0.011981	 hit@5:0.0396	 hit@10: 0.0744
source best!
..............................
source: 	 mrr: 0.046567	 ndcg_5: 0.0367	 ndcg_10: 0.0498	 hit@1:0.014587	 hit@5:0.0577	 hit@10: 0.0985
epoch 41: train_loss = 1.098187, source_hit@10 = 0.0985, source_ndcg@10 = 0.0498, target_hit@10 = 0.0744, target_ndcg@10 = 0.0368

2024-08-04 13:12:23.713758: step 14406/27440 (epoch 42/80), loss = 1.092713 (146.402 sec/epoch), lr: 0.002053
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044464	 ndcg_5: 0.0358	 ndcg_10: 0.0484	 hit@1:0.015843	 hit@5:0.0561	 hit@10: 0.0954
target: 	 mrr: 0.037729	 ndcg_5: 0.0272	 ndcg_10: 0.0404	 hit@1:0.010588	 hit@5:0.0446	 hit@10: 0.0855
epoch 42: train_loss = 1.092713, source_hit@10 = 0.0954, source_ndcg@10 = 0.0484, target_hit@10 = 0.0855, target_ndcg@10 = 0.0404

2024-08-04 13:14:47.863023: step 14749/27440 (epoch 43/80), loss = 1.091683 (142.772 sec/epoch), lr: 0.001951
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044631	 ndcg_5: 0.0346	 ndcg_10: 0.0463	 hit@1:0.016160	 hit@5:0.0523	 hit@10: 0.0887
target: 	 mrr: 0.042085	 ndcg_5: 0.0317	 ndcg_10: 0.0452	 hit@1:0.013096	 hit@5:0.0504	 hit@10: 0.0928
target best!
...................................target: 	 mrr: 0.040987	 ndcg_5: 0.0316	 ndcg_10: 0.0439	 hit@1:0.011844	 hit@5:0.0513	 hit@10: 0.0900
epoch 43: train_loss = 1.091683, source_hit@10 = 0.0887, source_ndcg@10 = 0.0463, target_hit@10 = 0.0900, target_ndcg@10 = 0.0439

2024-08-04 13:17:12.674796: step 15092/27440 (epoch 44/80), loss = 1.089164 (142.815 sec/epoch), lr: 0.001951
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042862	 ndcg_5: 0.0323	 ndcg_10: 0.0467	 hit@1:0.014575	 hit@5:0.0513	 hit@10: 0.0963
target: 	 mrr: 0.042779	 ndcg_5: 0.0329	 ndcg_10: 0.0455	 hit@1:0.014489	 hit@5:0.0518	 hit@10: 0.0914
target best!
...................................target: 	 mrr: 0.041038	 ndcg_5: 0.0326	 ndcg_10: 0.0433	 hit@1:0.013254	 hit@5:0.0522	 hit@10: 0.0854
epoch 44: train_loss = 1.089164, source_hit@10 = 0.0963, source_ndcg@10 = 0.0467, target_hit@10 = 0.0854, target_ndcg@10 = 0.0433

2024-08-04 13:19:36.919462: step 15435/27440 (epoch 45/80), loss = 1.087191 (142.260 sec/epoch), lr: 0.001853
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040626	 ndcg_5: 0.0313	 ndcg_10: 0.0421	 hit@1:0.014575	 hit@5:0.0488	 hit@10: 0.0824
target: 	 mrr: 0.042621	 ndcg_5: 0.0343	 ndcg_10: 0.0451	 hit@1:0.013931	 hit@5:0.0554	 hit@10: 0.0892
epoch 45: train_loss = 1.087191, source_hit@10 = 0.0824, source_ndcg@10 = 0.0421, target_hit@10 = 0.0892, target_ndcg@10 = 0.0451

2024-08-04 13:22:00.097300: step 15778/27440 (epoch 46/80), loss = 1.083589 (141.807 sec/epoch), lr: 0.001761
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043427	 ndcg_5: 0.0342	 ndcg_10: 0.0448	 hit@1:0.015209	 hit@5:0.0520	 hit@10: 0.0852
target: 	 mrr: 0.041975	 ndcg_5: 0.0319	 ndcg_10: 0.0447	 hit@1:0.011981	 hit@5:0.0518	 hit@10: 0.0911
epoch 46: train_loss = 1.083589, source_hit@10 = 0.0852, source_ndcg@10 = 0.0448, target_hit@10 = 0.0911, target_ndcg@10 = 0.0447

2024-08-04 13:24:22.330815: step 16121/27440 (epoch 47/80), loss = 1.081878 (140.904 sec/epoch), lr: 0.001761
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046198	 ndcg_5: 0.0356	 ndcg_10: 0.0497	 hit@1:0.017110	 hit@5:0.0554	 hit@10: 0.0995
target: 	 mrr: 0.040241	 ndcg_5: 0.0317	 ndcg_10: 0.0418	 hit@1:0.014210	 hit@5:0.0496	 hit@10: 0.0811
epoch 47: train_loss = 1.081878, source_hit@10 = 0.0995, source_ndcg@10 = 0.0497, target_hit@10 = 0.0811, target_ndcg@10 = 0.0418

2024-08-04 13:26:49.124709: step 16464/27440 (epoch 48/80), loss = 1.082799 (145.474 sec/epoch), lr: 0.001761
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044993	 ndcg_5: 0.0357	 ndcg_10: 0.0489	 hit@1:0.014259	 hit@5:0.0577	 hit@10: 0.0982
target: 	 mrr: 0.040432	 ndcg_5: 0.0314	 ndcg_10: 0.0415	 hit@1:0.013653	 hit@5:0.0499	 hit@10: 0.0811
epoch 48: train_loss = 1.082799, source_hit@10 = 0.0982, source_ndcg@10 = 0.0489, target_hit@10 = 0.0811, target_ndcg@10 = 0.0415

2024-08-04 13:29:16.337473: step 16807/27440 (epoch 49/80), loss = 1.078425 (145.523 sec/epoch), lr: 0.001672
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045219	 ndcg_5: 0.0357	 ndcg_10: 0.0475	 hit@1:0.017744	 hit@5:0.0548	 hit@10: 0.0919
target: 	 mrr: 0.040276	 ndcg_5: 0.0304	 ndcg_10: 0.0436	 hit@1:0.011145	 hit@5:0.0499	 hit@10: 0.0906
epoch 49: train_loss = 1.078425, source_hit@10 = 0.0919, source_ndcg@10 = 0.0475, target_hit@10 = 0.0906, target_ndcg@10 = 0.0436

2024-08-04 13:31:39.047207: step 17150/27440 (epoch 50/80), loss = 1.079311 (141.336 sec/epoch), lr: 0.001672
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043737	 ndcg_5: 0.0358	 ndcg_10: 0.0466	 hit@1:0.016160	 hit@5:0.0558	 hit@10: 0.0894
target: 	 mrr: 0.038485	 ndcg_5: 0.0298	 ndcg_10: 0.0401	 hit@1:0.011145	 hit@5:0.0490	 hit@10: 0.0814
epoch 50: train_loss = 1.079311, source_hit@10 = 0.0894, source_ndcg@10 = 0.0466, target_hit@10 = 0.0814, target_ndcg@10 = 0.0401

2024-08-04 13:34:01.823105: step 17493/27440 (epoch 51/80), loss = 1.077396 (141.436 sec/epoch), lr: 0.001589
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039123	 ndcg_5: 0.0304	 ndcg_10: 0.0407	 hit@1:0.013308	 hit@5:0.0478	 hit@10: 0.0802
target: 	 mrr: 0.045391	 ndcg_5: 0.0359	 ndcg_10: 0.0486	 hit@1:0.015046	 hit@5:0.0560	 hit@10: 0.0961
target best!
...................................target: 	 mrr: 0.040914	 ndcg_5: 0.0322	 ndcg_10: 0.0443	 hit@1:0.011280	 hit@5:0.0539	 hit@10: 0.0917
epoch 51: train_loss = 1.077396, source_hit@10 = 0.0802, source_ndcg@10 = 0.0407, target_hit@10 = 0.0917, target_ndcg@10 = 0.0443

2024-08-04 13:36:24.106531: step 17836/27440 (epoch 52/80), loss = 1.074501 (140.286 sec/epoch), lr: 0.001589
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040693	 ndcg_5: 0.0304	 ndcg_10: 0.0435	 hit@1:0.012674	 hit@5:0.0475	 hit@10: 0.0881
target: 	 mrr: 0.038648	 ndcg_5: 0.0294	 ndcg_10: 0.0418	 hit@1:0.009752	 hit@5:0.0490	 hit@10: 0.0875
epoch 52: train_loss = 1.074501, source_hit@10 = 0.0881, source_ndcg@10 = 0.0435, target_hit@10 = 0.0875, target_ndcg@10 = 0.0418
early termination of training
