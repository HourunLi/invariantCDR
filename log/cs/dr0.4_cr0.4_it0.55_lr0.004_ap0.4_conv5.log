nohup: ignoring input
using gpu:3 to train the model
using gpu:3 to train the model
cuda:3
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.4, batch_size=1024, beta_inter=0.55, conv_layers=5, cuda=True, decay_epoch=10, device=device(type='cuda', index=3), device_id='3', domains='cloth_sport', dropout=0.4, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='cs', momentum=0.98, num_latent_factors=3, num_negative=100, optim='adam', patience=20, proj_layers=1, projection=1, rectify_epoch=30, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, user_batch_size=256, weight_decay=0.0002)
number_user 41829
number_item 17943
/home/disk2/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 27328
number_item 12655
real graph loaded!
graph loaded!
Loading data from cloth_sport with batch size 1024...
unseen test: 0
test length: 3156
unseen test: 0
test length: 3085
unseen test: 0
test length: 3589
unseen test: 0
test length: 3546
source_user_num 41829
target_user_num 27328
source_item_num 17943
target_item_num 12655
shared users id: 7857
test users 990, 982
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 187880, target train data: 163291, source test data : 3085, target test data : 3546, source dev data : 1000, target dev data : 1000
2024-08-07 07:34:40.504514: step 343/27440 (epoch 1/80), loss = 1.411207 (119.009 sec/epoch), lr: 0.004000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.033723	 ndcg_5: 0.0263	 ndcg_10: 0.0356	 hit@1:0.012674	 hit@5:0.0402	 hit@10: 0.0691
target: 	 mrr: 0.025340	 ndcg_5: 0.0187	 ndcg_10: 0.0251	 hit@1:0.007523	 hit@5:0.0304	 hit@10: 0.0502
source best!
..............................
source: 	 mrr: 0.027514	 ndcg_5: 0.0206	 ndcg_10: 0.0277	 hit@1:0.007455	 hit@5:0.0344	 hit@10: 0.0564
target best!
...................................target: 	 mrr: 0.022848	 ndcg_5: 0.0152	 ndcg_10: 0.0222	 hit@1:0.005640	 hit@5:0.0251	 hit@10: 0.0471
epoch 1: train_loss = 1.411207, source_hit@10 = 0.0564, source_ndcg@10 = 0.0277, target_hit@10 = 0.0471, target_ndcg@10 = 0.0222

