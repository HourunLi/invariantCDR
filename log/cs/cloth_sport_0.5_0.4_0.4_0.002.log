nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=0), device_id='0', domains='cloth_sport', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.002, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='cs', momentum=0.9, num_latent_factors=3, num_negative=100, optim='adam', patience=30, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 41829
number_item 17943
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 27328
number_item 12655
real graph loaded!
graph loaded!
Loading data from cloth_sport with batch size 1024...
unseen test: 0
test length: 3156
unseen test: 0
test length: 3085
unseen test: 0
test length: 3589
unseen test: 0
test length: 3546
source_user_num 41829
target_user_num 27328
source_item_num 17943
target_item_num 12655
shared users id: 7857
test users 990, 982
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 187880, target train data: 163291, source test data : 3085, target test data : 3546, source dev data : 1000, target dev data : 1000
2024-08-02 17:12:19.256278: step 343/27440 (epoch 1/80), loss = 1.455382 (46.245 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042057	 ndcg_5: 0.0340	 ndcg_10: 0.0460	 hit@1:0.012674	 hit@5:0.0548	 hit@10: 0.0928
target: 	 mrr: 0.031871	 ndcg_5: 0.0238	 ndcg_10: 0.0337	 hit@1:0.007523	 hit@5:0.0412	 hit@10: 0.0724
source best!
..............................
source: 	 mrr: 0.037317	 ndcg_5: 0.0285	 ndcg_10: 0.0388	 hit@1:0.012318	 hit@5:0.0451	 hit@10: 0.0768
target best!
...................................target: 	 mrr: 0.036751	 ndcg_5: 0.0286	 ndcg_10: 0.0386	 hit@1:0.012972	 hit@5:0.0448	 hit@10: 0.0759
epoch 1: train_loss = 1.455382, source_hit@10 = 0.0768, source_ndcg@10 = 0.0388, target_hit@10 = 0.0759, target_ndcg@10 = 0.0386

2024-08-02 17:13:08.336460: step 686/27440 (epoch 2/80), loss = 1.255617 (47.888 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039407	 ndcg_5: 0.0323	 ndcg_10: 0.0403	 hit@1:0.010139	 hit@5:0.0539	 hit@10: 0.0789
target: 	 mrr: 0.033565	 ndcg_5: 0.0228	 ndcg_10: 0.0352	 hit@1:0.010309	 hit@5:0.0371	 hit@10: 0.0761
target best!
...................................target: 	 mrr: 0.037032	 ndcg_5: 0.0274	 ndcg_10: 0.0386	 hit@1:0.011562	 hit@5:0.0429	 hit@10: 0.0776
epoch 2: train_loss = 1.255617, source_hit@10 = 0.0789, source_ndcg@10 = 0.0403, target_hit@10 = 0.0776, target_ndcg@10 = 0.0386

2024-08-02 17:13:56.868433: step 1029/27440 (epoch 3/80), loss = 1.224801 (47.601 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042672	 ndcg_5: 0.0348	 ndcg_10: 0.0459	 hit@1:0.013942	 hit@5:0.0564	 hit@10: 0.0913
target: 	 mrr: 0.032307	 ndcg_5: 0.0254	 ndcg_10: 0.0327	 hit@1:0.008080	 hit@5:0.0424	 hit@10: 0.0652
source best!
..............................
source: 	 mrr: 0.037838	 ndcg_5: 0.0280	 ndcg_10: 0.0398	 hit@1:0.011345	 hit@5:0.0460	 hit@10: 0.0827
epoch 3: train_loss = 1.224801, source_hit@10 = 0.0827, source_ndcg@10 = 0.0398, target_hit@10 = 0.0652, target_ndcg@10 = 0.0327

2024-08-02 17:14:45.421519: step 1372/27440 (epoch 4/80), loss = 1.199726 (47.650 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038115	 ndcg_5: 0.0305	 ndcg_10: 0.0409	 hit@1:0.009823	 hit@5:0.0520	 hit@10: 0.0843
target: 	 mrr: 0.039830	 ndcg_5: 0.0308	 ndcg_10: 0.0407	 hit@1:0.013096	 hit@5:0.0490	 hit@10: 0.0797
target best!
...................................target: 	 mrr: 0.036635	 ndcg_5: 0.0283	 ndcg_10: 0.0390	 hit@1:0.009306	 hit@5:0.0482	 hit@10: 0.0818
epoch 4: train_loss = 1.199726, source_hit@10 = 0.0843, source_ndcg@10 = 0.0409, target_hit@10 = 0.0818, target_ndcg@10 = 0.0390
new best model saved.

2024-08-02 17:15:34.505162: step 1715/27440 (epoch 5/80), loss = 1.186245 (48.038 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044471	 ndcg_5: 0.0365	 ndcg_10: 0.0471	 hit@1:0.016477	 hit@5:0.0561	 hit@10: 0.0894
target: 	 mrr: 0.037077	 ndcg_5: 0.0280	 ndcg_10: 0.0394	 hit@1:0.010867	 hit@5:0.0451	 hit@10: 0.0811
source best!
..............................
source: 	 mrr: 0.039619	 ndcg_5: 0.0300	 ndcg_10: 0.0393	 hit@1:0.014911	 hit@5:0.0451	 hit@10: 0.0739
epoch 5: train_loss = 1.186245, source_hit@10 = 0.0739, source_ndcg@10 = 0.0393, target_hit@10 = 0.0811, target_ndcg@10 = 0.0394

2024-08-02 17:16:23.355550: step 2058/27440 (epoch 6/80), loss = 1.177315 (47.934 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036876	 ndcg_5: 0.0285	 ndcg_10: 0.0388	 hit@1:0.012041	 hit@5:0.0447	 hit@10: 0.0770
target: 	 mrr: 0.037085	 ndcg_5: 0.0273	 ndcg_10: 0.0387	 hit@1:0.010867	 hit@5:0.0435	 hit@10: 0.0794
epoch 6: train_loss = 1.177315, source_hit@10 = 0.0770, source_ndcg@10 = 0.0388, target_hit@10 = 0.0794, target_ndcg@10 = 0.0387

2024-08-02 17:17:11.542809: step 2401/27440 (epoch 7/80), loss = 1.166296 (47.559 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.032079	 ndcg_5: 0.0230	 ndcg_10: 0.0332	 hit@1:0.007921	 hit@5:0.0383	 hit@10: 0.0697
target: 	 mrr: 0.035550	 ndcg_5: 0.0257	 ndcg_10: 0.0372	 hit@1:0.009752	 hit@5:0.0424	 hit@10: 0.0783
epoch 7: train_loss = 1.166296, source_hit@10 = 0.0697, source_ndcg@10 = 0.0332, target_hit@10 = 0.0783, target_ndcg@10 = 0.0372

2024-08-02 17:18:00.133346: step 2744/27440 (epoch 8/80), loss = 1.161212 (47.928 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.033588	 ndcg_5: 0.0250	 ndcg_10: 0.0353	 hit@1:0.011407	 hit@5:0.0383	 hit@10: 0.0703
target: 	 mrr: 0.032672	 ndcg_5: 0.0232	 ndcg_10: 0.0345	 hit@1:0.007802	 hit@5:0.0385	 hit@10: 0.0736
epoch 8: train_loss = 1.161212, source_hit@10 = 0.0703, source_ndcg@10 = 0.0353, target_hit@10 = 0.0736, target_ndcg@10 = 0.0345

2024-08-02 17:18:48.323315: step 3087/27440 (epoch 9/80), loss = 1.153763 (47.553 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.037643	 ndcg_5: 0.0289	 ndcg_10: 0.0406	 hit@1:0.011407	 hit@5:0.0456	 hit@10: 0.0817
target: 	 mrr: 0.037064	 ndcg_5: 0.0279	 ndcg_10: 0.0393	 hit@1:0.009752	 hit@5:0.0457	 hit@10: 0.0811
epoch 9: train_loss = 1.153763, source_hit@10 = 0.0817, source_ndcg@10 = 0.0406, target_hit@10 = 0.0811, target_ndcg@10 = 0.0393

2024-08-02 17:19:36.843580: step 3430/27440 (epoch 10/80), loss = 1.146675 (47.886 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040861	 ndcg_5: 0.0329	 ndcg_10: 0.0413	 hit@1:0.016160	 hit@5:0.0507	 hit@10: 0.0767
target: 	 mrr: 0.039544	 ndcg_5: 0.0308	 ndcg_10: 0.0422	 hit@1:0.011981	 hit@5:0.0499	 hit@10: 0.0853
epoch 10: train_loss = 1.146675, source_hit@10 = 0.0767, source_ndcg@10 = 0.0413, target_hit@10 = 0.0853, target_ndcg@10 = 0.0422

2024-08-02 17:20:25.507164: step 3773/27440 (epoch 11/80), loss = 1.140265 (48.024 sec/epoch), lr: 0.002000
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038045	 ndcg_5: 0.0299	 ndcg_10: 0.0406	 hit@1:0.012357	 hit@5:0.0485	 hit@10: 0.0814
target: 	 mrr: 0.035255	 ndcg_5: 0.0250	 ndcg_10: 0.0369	 hit@1:0.009752	 hit@5:0.0407	 hit@10: 0.0780
epoch 11: train_loss = 1.140265, source_hit@10 = 0.0814, source_ndcg@10 = 0.0406, target_hit@10 = 0.0780, target_ndcg@10 = 0.0369

2024-08-02 17:21:14.248039: step 4116/27440 (epoch 12/80), loss = 1.137502 (48.114 sec/epoch), lr: 0.001900
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044463	 ndcg_5: 0.0354	 ndcg_10: 0.0460	 hit@1:0.015209	 hit@5:0.0551	 hit@10: 0.0878
target: 	 mrr: 0.039826	 ndcg_5: 0.0296	 ndcg_10: 0.0418	 hit@1:0.011424	 hit@5:0.0476	 hit@10: 0.0858
epoch 12: train_loss = 1.137502, source_hit@10 = 0.0878, source_ndcg@10 = 0.0460, target_hit@10 = 0.0858, target_ndcg@10 = 0.0418

2024-08-02 17:22:02.841022: step 4459/27440 (epoch 13/80), loss = 1.130223 (47.944 sec/epoch), lr: 0.001900
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041570	 ndcg_5: 0.0320	 ndcg_10: 0.0428	 hit@1:0.014259	 hit@5:0.0497	 hit@10: 0.0833
target: 	 mrr: 0.035604	 ndcg_5: 0.0255	 ndcg_10: 0.0376	 hit@1:0.008359	 hit@5:0.0435	 hit@10: 0.0814
epoch 13: train_loss = 1.130223, source_hit@10 = 0.0833, source_ndcg@10 = 0.0428, target_hit@10 = 0.0814, target_ndcg@10 = 0.0376

2024-08-02 17:22:51.185637: step 4802/27440 (epoch 14/80), loss = 1.124347 (47.677 sec/epoch), lr: 0.001805
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047997	 ndcg_5: 0.0383	 ndcg_10: 0.0516	 hit@1:0.017744	 hit@5:0.0589	 hit@10: 0.1001
target: 	 mrr: 0.034598	 ndcg_5: 0.0253	 ndcg_10: 0.0367	 hit@1:0.007523	 hit@5:0.0429	 hit@10: 0.0783
source best!
..............................
source: 	 mrr: 0.047066	 ndcg_5: 0.0379	 ndcg_10: 0.0504	 hit@1:0.018476	 hit@5:0.0574	 hit@10: 0.0969
epoch 14: train_loss = 1.124347, source_hit@10 = 0.0969, source_ndcg@10 = 0.0504, target_hit@10 = 0.0783, target_ndcg@10 = 0.0367

2024-08-02 17:23:40.112253: step 5145/27440 (epoch 15/80), loss = 1.122698 (48.029 sec/epoch), lr: 0.001805
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.043277	 ndcg_5: 0.0333	 ndcg_10: 0.0469	 hit@1:0.014575	 hit@5:0.0520	 hit@10: 0.0947
target: 	 mrr: 0.036727	 ndcg_5: 0.0257	 ndcg_10: 0.0396	 hit@1:0.010031	 hit@5:0.0424	 hit@10: 0.0858
epoch 15: train_loss = 1.122698, source_hit@10 = 0.0947, source_ndcg@10 = 0.0469, target_hit@10 = 0.0858, target_ndcg@10 = 0.0396

2024-08-02 17:24:29.494652: step 5488/27440 (epoch 16/80), loss = 1.117553 (48.738 sec/epoch), lr: 0.001715
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048038	 ndcg_5: 0.0391	 ndcg_10: 0.0512	 hit@1:0.019011	 hit@5:0.0593	 hit@10: 0.0973
target: 	 mrr: 0.038418	 ndcg_5: 0.0300	 ndcg_10: 0.0417	 hit@1:0.010867	 hit@5:0.0504	 hit@10: 0.0869
source best!
..............................
source: 	 mrr: 0.045135	 ndcg_5: 0.0369	 ndcg_10: 0.0483	 hit@1:0.015559	 hit@5:0.0583	 hit@10: 0.0940
epoch 16: train_loss = 1.117553, source_hit@10 = 0.0940, source_ndcg@10 = 0.0483, target_hit@10 = 0.0869, target_ndcg@10 = 0.0417

2024-08-02 17:25:18.145861: step 5831/27440 (epoch 17/80), loss = 1.113815 (47.735 sec/epoch), lr: 0.001715
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048315	 ndcg_5: 0.0387	 ndcg_10: 0.0516	 hit@1:0.016793	 hit@5:0.0605	 hit@10: 0.1004
target: 	 mrr: 0.039425	 ndcg_5: 0.0289	 ndcg_10: 0.0407	 hit@1:0.013374	 hit@5:0.0443	 hit@10: 0.0808
source best!
..............................
source: 	 mrr: 0.044589	 ndcg_5: 0.0346	 ndcg_10: 0.0482	 hit@1:0.015559	 hit@5:0.0541	 hit@10: 0.0966
epoch 17: train_loss = 1.113815, source_hit@10 = 0.0966, source_ndcg@10 = 0.0482, target_hit@10 = 0.0808, target_ndcg@10 = 0.0407

2024-08-02 17:26:07.174426: step 6174/27440 (epoch 18/80), loss = 1.111059 (48.124 sec/epoch), lr: 0.001715
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044012	 ndcg_5: 0.0344	 ndcg_10: 0.0468	 hit@1:0.014892	 hit@5:0.0532	 hit@10: 0.0919
target: 	 mrr: 0.039422	 ndcg_5: 0.0294	 ndcg_10: 0.0410	 hit@1:0.011702	 hit@5:0.0471	 hit@10: 0.0833
epoch 18: train_loss = 1.111059, source_hit@10 = 0.0919, source_ndcg@10 = 0.0468, target_hit@10 = 0.0833, target_ndcg@10 = 0.0410

2024-08-02 17:26:55.966241: step 6517/27440 (epoch 19/80), loss = 1.107280 (48.150 sec/epoch), lr: 0.001629
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.052155	 ndcg_5: 0.0452	 ndcg_10: 0.0562	 hit@1:0.020913	 hit@5:0.0697	 hit@10: 0.1039
target: 	 mrr: 0.039479	 ndcg_5: 0.0302	 ndcg_10: 0.0416	 hit@1:0.012538	 hit@5:0.0482	 hit@10: 0.0839
source best!
..............................
source: 	 mrr: 0.046096	 ndcg_5: 0.0377	 ndcg_10: 0.0471	 hit@1:0.017828	 hit@5:0.0567	 hit@10: 0.0862
epoch 19: train_loss = 1.107280, source_hit@10 = 0.0862, source_ndcg@10 = 0.0471, target_hit@10 = 0.0839, target_ndcg@10 = 0.0416
new best model saved.

2024-08-02 17:27:45.243860: step 6860/27440 (epoch 20/80), loss = 1.103813 (48.265 sec/epoch), lr: 0.001629
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.050593	 ndcg_5: 0.0423	 ndcg_10: 0.0546	 hit@1:0.018061	 hit@5:0.0662	 hit@10: 0.1046
target: 	 mrr: 0.039226	 ndcg_5: 0.0308	 ndcg_10: 0.0419	 hit@1:0.013374	 hit@5:0.0493	 hit@10: 0.0841
epoch 20: train_loss = 1.103813, source_hit@10 = 0.1046, source_ndcg@10 = 0.0546, target_hit@10 = 0.0841, target_ndcg@10 = 0.0419

2024-08-02 17:28:33.608487: step 7203/27440 (epoch 21/80), loss = 1.099264 (47.730 sec/epoch), lr: 0.001548
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040190	 ndcg_5: 0.0324	 ndcg_10: 0.0425	 hit@1:0.013308	 hit@5:0.0526	 hit@10: 0.0837
target: 	 mrr: 0.039082	 ndcg_5: 0.0287	 ndcg_10: 0.0403	 hit@1:0.012817	 hit@5:0.0454	 hit@10: 0.0814
epoch 21: train_loss = 1.099264, source_hit@10 = 0.0837, source_ndcg@10 = 0.0425, target_hit@10 = 0.0814, target_ndcg@10 = 0.0403

2024-08-02 17:29:22.478891: step 7546/27440 (epoch 22/80), loss = 1.095232 (48.203 sec/epoch), lr: 0.001470
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046931	 ndcg_5: 0.0391	 ndcg_10: 0.0502	 hit@1:0.015843	 hit@5:0.0627	 hit@10: 0.0973
target: 	 mrr: 0.036660	 ndcg_5: 0.0292	 ndcg_10: 0.0374	 hit@1:0.010867	 hit@5:0.0476	 hit@10: 0.0733
epoch 22: train_loss = 1.095232, source_hit@10 = 0.0973, source_ndcg@10 = 0.0502, target_hit@10 = 0.0733, target_ndcg@10 = 0.0374

2024-08-02 17:30:10.617996: step 7889/27440 (epoch 23/80), loss = 1.094570 (47.505 sec/epoch), lr: 0.001470
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047956	 ndcg_5: 0.0388	 ndcg_10: 0.0518	 hit@1:0.016793	 hit@5:0.0605	 hit@10: 0.1011
target: 	 mrr: 0.036209	 ndcg_5: 0.0255	 ndcg_10: 0.0392	 hit@1:0.010309	 hit@5:0.0415	 hit@10: 0.0841
epoch 23: train_loss = 1.094570, source_hit@10 = 0.1011, source_ndcg@10 = 0.0518, target_hit@10 = 0.0841, target_ndcg@10 = 0.0392

2024-08-02 17:30:59.442269: step 8232/27440 (epoch 24/80), loss = 1.090639 (48.187 sec/epoch), lr: 0.001470
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045142	 ndcg_5: 0.0355	 ndcg_10: 0.0470	 hit@1:0.016160	 hit@5:0.0532	 hit@10: 0.0890
target: 	 mrr: 0.036373	 ndcg_5: 0.0255	 ndcg_10: 0.0387	 hit@1:0.011702	 hit@5:0.0401	 hit@10: 0.0811
epoch 24: train_loss = 1.090639, source_hit@10 = 0.0890, source_ndcg@10 = 0.0470, target_hit@10 = 0.0811, target_ndcg@10 = 0.0387

2024-08-02 17:31:48.146547: step 8575/27440 (epoch 25/80), loss = 1.086548 (48.064 sec/epoch), lr: 0.001397
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046855	 ndcg_5: 0.0378	 ndcg_10: 0.0509	 hit@1:0.016477	 hit@5:0.0596	 hit@10: 0.1004
target: 	 mrr: 0.038166	 ndcg_5: 0.0303	 ndcg_10: 0.0410	 hit@1:0.012260	 hit@5:0.0499	 hit@10: 0.0833
epoch 25: train_loss = 1.086548, source_hit@10 = 0.1004, source_ndcg@10 = 0.0509, target_hit@10 = 0.0833, target_ndcg@10 = 0.0410

2024-08-02 17:32:36.955495: step 8918/27440 (epoch 26/80), loss = 1.085545 (48.163 sec/epoch), lr: 0.001397
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047721	 ndcg_5: 0.0383	 ndcg_10: 0.0520	 hit@1:0.017744	 hit@5:0.0599	 hit@10: 0.1023
target: 	 mrr: 0.034071	 ndcg_5: 0.0247	 ndcg_10: 0.0358	 hit@1:0.008916	 hit@5:0.0415	 hit@10: 0.0763
epoch 26: train_loss = 1.085545, source_hit@10 = 0.1023, source_ndcg@10 = 0.0520, target_hit@10 = 0.0763, target_ndcg@10 = 0.0358

2024-08-02 17:33:25.660885: step 9261/27440 (epoch 27/80), loss = 1.079929 (48.072 sec/epoch), lr: 0.001327
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049365	 ndcg_5: 0.0405	 ndcg_10: 0.0525	 hit@1:0.019328	 hit@5:0.0618	 hit@10: 0.0995
target: 	 mrr: 0.035848	 ndcg_5: 0.0269	 ndcg_10: 0.0381	 hit@1:0.009473	 hit@5:0.0446	 hit@10: 0.0797
epoch 27: train_loss = 1.079929, source_hit@10 = 0.0995, source_ndcg@10 = 0.0525, target_hit@10 = 0.0797, target_ndcg@10 = 0.0381

2024-08-02 17:34:14.514817: step 9604/27440 (epoch 28/80), loss = 1.079034 (48.222 sec/epoch), lr: 0.001327
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040826	 ndcg_5: 0.0338	 ndcg_10: 0.0421	 hit@1:0.015843	 hit@5:0.0507	 hit@10: 0.0767
target: 	 mrr: 0.036772	 ndcg_5: 0.0292	 ndcg_10: 0.0383	 hit@1:0.011424	 hit@5:0.0474	 hit@10: 0.0761
epoch 28: train_loss = 1.079034, source_hit@10 = 0.0767, source_ndcg@10 = 0.0421, target_hit@10 = 0.0761, target_ndcg@10 = 0.0383

2024-08-02 17:35:03.667762: step 9947/27440 (epoch 29/80), loss = 1.073604 (48.518 sec/epoch), lr: 0.001260
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047357	 ndcg_5: 0.0379	 ndcg_10: 0.0504	 hit@1:0.018695	 hit@5:0.0580	 hit@10: 0.0963
target: 	 mrr: 0.034629	 ndcg_5: 0.0260	 ndcg_10: 0.0351	 hit@1:0.010588	 hit@5:0.0407	 hit@10: 0.0691
epoch 29: train_loss = 1.073604, source_hit@10 = 0.0963, source_ndcg@10 = 0.0504, target_hit@10 = 0.0691, target_ndcg@10 = 0.0351

2024-08-02 17:35:52.259927: step 10290/27440 (epoch 30/80), loss = 1.070858 (47.934 sec/epoch), lr: 0.001260
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049776	 ndcg_5: 0.0411	 ndcg_10: 0.0526	 hit@1:0.020279	 hit@5:0.0608	 hit@10: 0.0966
target: 	 mrr: 0.040095	 ndcg_5: 0.0315	 ndcg_10: 0.0424	 hit@1:0.013653	 hit@5:0.0496	 hit@10: 0.0836
target best!
...................................target: 	 mrr: 0.037865	 ndcg_5: 0.0304	 ndcg_10: 0.0404	 hit@1:0.012126	 hit@5:0.0502	 hit@10: 0.0812
epoch 30: train_loss = 1.070858, source_hit@10 = 0.0966, source_ndcg@10 = 0.0526, target_hit@10 = 0.0812, target_ndcg@10 = 0.0404

2024-08-02 17:36:41.279681: step 10633/27440 (epoch 31/80), loss = 1.066859 (48.084 sec/epoch), lr: 0.001260
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046530	 ndcg_5: 0.0372	 ndcg_10: 0.0503	 hit@1:0.017427	 hit@5:0.0561	 hit@10: 0.0966
target: 	 mrr: 0.037036	 ndcg_5: 0.0274	 ndcg_10: 0.0382	 hit@1:0.013931	 hit@5:0.0424	 hit@10: 0.0761
epoch 31: train_loss = 1.066859, source_hit@10 = 0.0966, source_ndcg@10 = 0.0503, target_hit@10 = 0.0761, target_ndcg@10 = 0.0382

2024-08-02 17:37:30.015277: step 10976/27440 (epoch 32/80), loss = 1.063128 (48.070 sec/epoch), lr: 0.001197
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.044855	 ndcg_5: 0.0379	 ndcg_10: 0.0498	 hit@1:0.013308	 hit@5:0.0637	 hit@10: 0.1008
target: 	 mrr: 0.036262	 ndcg_5: 0.0267	 ndcg_10: 0.0375	 hit@1:0.011702	 hit@5:0.0410	 hit@10: 0.0744
epoch 32: train_loss = 1.063128, source_hit@10 = 0.1008, source_ndcg@10 = 0.0498, target_hit@10 = 0.0744, target_ndcg@10 = 0.0375

2024-08-02 17:38:18.745750: step 11319/27440 (epoch 33/80), loss = 1.058205 (48.088 sec/epoch), lr: 0.001138
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046576	 ndcg_5: 0.0381	 ndcg_10: 0.0514	 hit@1:0.014259	 hit@5:0.0618	 hit@10: 0.1030
target: 	 mrr: 0.037089	 ndcg_5: 0.0286	 ndcg_10: 0.0375	 hit@1:0.012538	 hit@5:0.0454	 hit@10: 0.0733
epoch 33: train_loss = 1.058205, source_hit@10 = 0.1030, source_ndcg@10 = 0.0514, target_hit@10 = 0.0733, target_ndcg@10 = 0.0375

2024-08-02 17:39:07.415807: step 11662/27440 (epoch 34/80), loss = 1.052318 (48.037 sec/epoch), lr: 0.001138
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.047035	 ndcg_5: 0.0389	 ndcg_10: 0.0504	 hit@1:0.017427	 hit@5:0.0602	 hit@10: 0.0960
target: 	 mrr: 0.033840	 ndcg_5: 0.0250	 ndcg_10: 0.0355	 hit@1:0.009752	 hit@5:0.0407	 hit@10: 0.0733
epoch 34: train_loss = 1.052318, source_hit@10 = 0.0960, source_ndcg@10 = 0.0504, target_hit@10 = 0.0733, target_ndcg@10 = 0.0355

2024-08-02 17:39:56.457567: step 12005/27440 (epoch 35/80), loss = 1.049255 (48.406 sec/epoch), lr: 0.001081
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048411	 ndcg_5: 0.0396	 ndcg_10: 0.0506	 hit@1:0.019645	 hit@5:0.0593	 hit@10: 0.0938
target: 	 mrr: 0.036238	 ndcg_5: 0.0265	 ndcg_10: 0.0372	 hit@1:0.012260	 hit@5:0.0407	 hit@10: 0.0744
epoch 35: train_loss = 1.049255, source_hit@10 = 0.0938, source_ndcg@10 = 0.0506, target_hit@10 = 0.0744, target_ndcg@10 = 0.0372

2024-08-02 17:40:45.408704: step 12348/27440 (epoch 36/80), loss = 1.044047 (48.267 sec/epoch), lr: 0.001081
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041701	 ndcg_5: 0.0342	 ndcg_10: 0.0441	 hit@1:0.014892	 hit@5:0.0539	 hit@10: 0.0846
target: 	 mrr: 0.034415	 ndcg_5: 0.0251	 ndcg_10: 0.0354	 hit@1:0.010309	 hit@5:0.0401	 hit@10: 0.0722
epoch 36: train_loss = 1.044047, source_hit@10 = 0.0846, source_ndcg@10 = 0.0441, target_hit@10 = 0.0722, target_ndcg@10 = 0.0354

2024-08-02 17:41:33.825158: step 12691/27440 (epoch 37/80), loss = 1.035544 (47.737 sec/epoch), lr: 0.001027
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038055	 ndcg_5: 0.0281	 ndcg_10: 0.0386	 hit@1:0.012357	 hit@5:0.0437	 hit@10: 0.0764
target: 	 mrr: 0.032789	 ndcg_5: 0.0248	 ndcg_10: 0.0350	 hit@1:0.009195	 hit@5:0.0410	 hit@10: 0.0727
epoch 37: train_loss = 1.035544, source_hit@10 = 0.0764, source_ndcg@10 = 0.0386, target_hit@10 = 0.0727, target_ndcg@10 = 0.0350

2024-08-02 17:42:22.295703: step 13034/27440 (epoch 38/80), loss = 1.030605 (47.831 sec/epoch), lr: 0.000975
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038748	 ndcg_5: 0.0283	 ndcg_10: 0.0399	 hit@1:0.013625	 hit@5:0.0431	 hit@10: 0.0792
target: 	 mrr: 0.035912	 ndcg_5: 0.0286	 ndcg_10: 0.0385	 hit@1:0.011981	 hit@5:0.0454	 hit@10: 0.0763
epoch 38: train_loss = 1.030605, source_hit@10 = 0.0792, source_ndcg@10 = 0.0399, target_hit@10 = 0.0763, target_ndcg@10 = 0.0385

2024-08-02 17:43:11.318723: step 13377/27440 (epoch 39/80), loss = 1.026092 (48.360 sec/epoch), lr: 0.000975
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036175	 ndcg_5: 0.0275	 ndcg_10: 0.0369	 hit@1:0.010456	 hit@5:0.0444	 hit@10: 0.0738
target: 	 mrr: 0.032697	 ndcg_5: 0.0248	 ndcg_10: 0.0341	 hit@1:0.010309	 hit@5:0.0390	 hit@10: 0.0685
epoch 39: train_loss = 1.026092, source_hit@10 = 0.0738, source_ndcg@10 = 0.0369, target_hit@10 = 0.0685, target_ndcg@10 = 0.0341

2024-08-02 17:43:59.941420: step 13720/27440 (epoch 40/80), loss = 1.021686 (47.929 sec/epoch), lr: 0.000927
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040876	 ndcg_5: 0.0324	 ndcg_10: 0.0438	 hit@1:0.012991	 hit@5:0.0526	 hit@10: 0.0884
target: 	 mrr: 0.034847	 ndcg_5: 0.0263	 ndcg_10: 0.0365	 hit@1:0.010588	 hit@5:0.0424	 hit@10: 0.0736
epoch 40: train_loss = 1.021686, source_hit@10 = 0.0884, source_ndcg@10 = 0.0438, target_hit@10 = 0.0736, target_ndcg@10 = 0.0365
shift to transfer learning mode

2024-08-02 17:44:49.027160: step 14063/27440 (epoch 41/80), loss = 1.018713 (48.428 sec/epoch), lr: 0.000927
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038592	 ndcg_5: 0.0304	 ndcg_10: 0.0396	 hit@1:0.013942	 hit@5:0.0459	 hit@10: 0.0748
target: 	 mrr: 0.028741	 ndcg_5: 0.0214	 ndcg_10: 0.0294	 hit@1:0.007244	 hit@5:0.0357	 hit@10: 0.0610
epoch 41: train_loss = 1.018713, source_hit@10 = 0.0748, source_ndcg@10 = 0.0396, target_hit@10 = 0.0610, target_ndcg@10 = 0.0294

2024-08-02 17:45:38.340932: step 14406/27440 (epoch 42/80), loss = 1.011325 (48.679 sec/epoch), lr: 0.000880
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.038091	 ndcg_5: 0.0300	 ndcg_10: 0.0386	 hit@1:0.013942	 hit@5:0.0459	 hit@10: 0.0732
target: 	 mrr: 0.029784	 ndcg_5: 0.0220	 ndcg_10: 0.0299	 hit@1:0.007523	 hit@5:0.0371	 hit@10: 0.0619
epoch 42: train_loss = 1.011325, source_hit@10 = 0.0732, source_ndcg@10 = 0.0386, target_hit@10 = 0.0619, target_ndcg@10 = 0.0299

