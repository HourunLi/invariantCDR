nohup: ignoring input
using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=1), device_id='1', domains='cd_movie', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.01, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='cm', momentum=0.98, num_latent_factors=3, num_negative=100, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 50841
number_item 43858
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 87875
number_item 38643
real graph loaded!
graph loaded!
Loading data from cd_movie with batch size 1024...
unseen test: 0
test length: 19837
unseen test: 0
test length: 19670
unseen test: 0
test length: 28589
unseen test: 0
test length: 28876
source_user_num 50841
target_user_num 87875
source_item_num 43858
target_item_num 38643
shared users id: 15081
test users 1893, 1885
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 674233, target train data: 1127424, source test data : 19670, target test data : 28876, source dev data : 1000, target dev data : 1000
Directory ./saved_models/cm do not exist; creating...
2024-08-02 13:53:05.348349: step 1760/140800 (epoch 1/80), loss = 1.232027 (617.209 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.030397	 ndcg_5: 0.0235	 ndcg_10: 0.0311	 hit@1:0.009175	 hit@5:0.0375	 hit@10: 0.0617
target: 	 mrr: 0.033972	 ndcg_5: 0.0205	 ndcg_10: 0.0320	 hit@1:0.008010	 hit@5:0.0335	 hit@10: 0.0695
source best!
....................................................................................................................................................................................................
source: 	 mrr: 0.031382	 ndcg_5: 0.0239	 ndcg_10: 0.0317	 hit@1:0.011134	 hit@5:0.0367	 hit@10: 0.0608
target best!
................................................................................................................................................................................................................................................................................................target: 	 mrr: 0.033513	 ndcg_5: 0.0202	 ndcg_10: 0.0308	 hit@1:0.007723	 hit@5:0.0333	 hit@10: 0.0664
epoch 1: train_loss = 1.232027, source_hit@10 = 0.0608, source_ndcg@10 = 0.0317, target_hit@10 = 0.0664, target_ndcg@10 = 0.0308

2024-08-02 14:03:35.366162: step 3520/140800 (epoch 2/80), loss = 1.171444 (619.854 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.036278	 ndcg_5: 0.0279	 ndcg_10: 0.0366	 hit@1:0.011897	 hit@5:0.0443	 hit@10: 0.0715
target: 	 mrr: 0.054852	 ndcg_5: 0.0446	 ndcg_10: 0.0585	 hit@1:0.019833	 hit@5:0.0697	 hit@10: 0.1132
source best!
....................................................................................................................................................................................................
source: 	 mrr: 0.036246	 ndcg_5: 0.0274	 ndcg_10: 0.0364	 hit@1:0.012659	 hit@5:0.0423	 hit@10: 0.0702
target best!
................................................................................................................................................................................................................................................................................................target: 	 mrr: 0.054499	 ndcg_5: 0.0445	 ndcg_10: 0.0591	 hit@1:0.018458	 hit@5:0.0707	 hit@10: 0.1158
epoch 2: train_loss = 1.171444, source_hit@10 = 0.0702, source_ndcg@10 = 0.0364, target_hit@10 = 0.1158, target_ndcg@10 = 0.0591
new best model saved.

2024-08-02 14:14:05.859215: step 5280/140800 (epoch 3/80), loss = 1.157073 (620.083 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.032253	 ndcg_5: 0.0236	 ndcg_10: 0.0322	 hit@1:0.009679	 hit@5:0.0376	 hit@10: 0.0641
target: 	 mrr: 0.054944	 ndcg_5: 0.0439	 ndcg_10: 0.0590	 hit@1:0.017629	 hit@5:0.0699	 hit@10: 0.1166
target best!
................................................................................................................................................................................................................................................................................................target: 	 mrr: 0.055673	 ndcg_5: 0.0448	 ndcg_10: 0.0601	 hit@1:0.018701	 hit@5:0.0710	 hit@10: 0.1189
epoch 3: train_loss = 1.157073, source_hit@10 = 0.0641, source_ndcg@10 = 0.0322, target_hit@10 = 0.1189, target_ndcg@10 = 0.0601

2024-08-02 14:24:34.058451: step 7040/140800 (epoch 4/80), loss = 1.107402 (620.136 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.040723	 ndcg_5: 0.0322	 ndcg_10: 0.0436	 hit@1:0.013712	 hit@5:0.0514	 hit@10: 0.0870
target: 	 mrr: 0.044738	 ndcg_5: 0.0328	 ndcg_10: 0.0462	 hit@1:0.012942	 hit@5:0.0534	 hit@10: 0.0953
source best!
....................................................................................................................................................................................................
source: 	 mrr: 0.040153	 ndcg_5: 0.0318	 ndcg_10: 0.0426	 hit@1:0.013015	 hit@5:0.0508	 hit@10: 0.0845
epoch 4: train_loss = 1.107402, source_hit@10 = 0.0845, source_ndcg@10 = 0.0426, target_hit@10 = 0.0953, target_ndcg@10 = 0.0462

2024-08-02 14:35:02.047607: step 8800/140800 (epoch 5/80), loss = 1.082230 (620.885 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.046157	 ndcg_5: 0.0380	 ndcg_10: 0.0498	 hit@1:0.016283	 hit@5:0.0599	 hit@10: 0.0965
target: 	 mrr: 0.053306	 ndcg_5: 0.0412	 ndcg_10: 0.0580	 hit@1:0.016545	 hit@5:0.0663	 hit@10: 0.1190
source best!
....................................................................................................................................................................................................
source: 	 mrr: 0.047276	 ndcg_5: 0.0388	 ndcg_10: 0.0509	 hit@1:0.017794	 hit@5:0.0597	 hit@10: 0.0975
epoch 5: train_loss = 1.082230, source_hit@10 = 0.0975, source_ndcg@10 = 0.0509, target_hit@10 = 0.1190, target_ndcg@10 = 0.0580
new best model saved.

2024-08-02 14:45:30.406820: step 10560/140800 (epoch 6/80), loss = 1.075008 (620.788 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.041432	 ndcg_5: 0.0330	 ndcg_10: 0.0442	 hit@1:0.014569	 hit@5:0.0517	 hit@10: 0.0868
target: 	 mrr: 0.050314	 ndcg_5: 0.0403	 ndcg_10: 0.0542	 hit@1:0.014866	 hit@5:0.0660	 hit@10: 0.1093
epoch 6: train_loss = 1.075008, source_hit@10 = 0.0868, source_ndcg@10 = 0.0442, target_hit@10 = 0.1093, target_ndcg@10 = 0.0542

2024-08-02 14:56:00.532316: step 12320/140800 (epoch 7/80), loss = 1.071028 (624.980 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.038259	 ndcg_5: 0.0304	 ndcg_10: 0.0404	 hit@1:0.012855	 hit@5:0.0477	 hit@10: 0.0788
target: 	 mrr: 0.040891	 ndcg_5: 0.0297	 ndcg_10: 0.0430	 hit@1:0.010249	 hit@5:0.0501	 hit@10: 0.0915
epoch 7: train_loss = 1.071028, source_hit@10 = 0.0788, source_ndcg@10 = 0.0404, target_hit@10 = 0.0915, target_ndcg@10 = 0.0430

2024-08-02 15:06:26.465403: step 14080/140800 (epoch 8/80), loss = 1.066070 (620.825 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.045955	 ndcg_5: 0.0359	 ndcg_10: 0.0491	 hit@1:0.015123	 hit@5:0.0573	 hit@10: 0.0987
target: 	 mrr: 0.053982	 ndcg_5: 0.0433	 ndcg_10: 0.0586	 hit@1:0.016615	 hit@5:0.0699	 hit@10: 0.1175
epoch 8: train_loss = 1.066070, source_hit@10 = 0.0987, source_ndcg@10 = 0.0491, target_hit@10 = 0.1175, target_ndcg@10 = 0.0586

2024-08-02 15:16:52.650127: step 15840/140800 (epoch 9/80), loss = 1.063620 (620.897 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.043803	 ndcg_5: 0.0349	 ndcg_10: 0.0464	 hit@1:0.013561	 hit@5:0.0566	 hit@10: 0.0925
target: 	 mrr: 0.051978	 ndcg_5: 0.0411	 ndcg_10: 0.0558	 hit@1:0.016545	 hit@5:0.0661	 hit@10: 0.1123
epoch 9: train_loss = 1.063620, source_hit@10 = 0.0925, source_ndcg@10 = 0.0464, target_hit@10 = 0.1123, target_ndcg@10 = 0.0558

2024-08-02 15:27:19.068565: step 17600/140800 (epoch 10/80), loss = 1.061674 (621.301 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.041908	 ndcg_5: 0.0322	 ndcg_10: 0.0438	 hit@1:0.013510	 hit@5:0.0512	 hit@10: 0.0873
target: 	 mrr: 0.053735	 ndcg_5: 0.0422	 ndcg_10: 0.0573	 hit@1:0.017174	 hit@5:0.0678	 hit@10: 0.1150
epoch 10: train_loss = 1.061674, source_hit@10 = 0.0873, source_ndcg@10 = 0.0438, target_hit@10 = 0.1150, target_ndcg@10 = 0.0573

2024-08-02 15:37:46.441530: step 19360/140800 (epoch 11/80), loss = 1.061301 (622.253 sec/epoch), lr: 0.004000
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.029730	 ndcg_5: 0.0225	 ndcg_10: 0.0304	 hit@1:0.008217	 hit@5:0.0371	 hit@10: 0.0616
target: 	 mrr: 0.046559	 ndcg_5: 0.0362	 ndcg_10: 0.0494	 hit@1:0.014901	 hit@5:0.0580	 hit@10: 0.0991
epoch 11: train_loss = 1.061301, source_hit@10 = 0.0616, source_ndcg@10 = 0.0304, target_hit@10 = 0.0991, target_ndcg@10 = 0.0494

2024-08-02 15:48:09.495932: step 21120/140800 (epoch 12/80), loss = 1.058686 (617.922 sec/epoch), lr: 0.003800
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.055991	 ndcg_5: 0.0468	 ndcg_10: 0.0604	 hit@1:0.021677	 hit@5:0.0721	 hit@10: 0.1149
target: 	 mrr: 0.052063	 ndcg_5: 0.0413	 ndcg_10: 0.0548	 hit@1:0.018364	 hit@5:0.0638	 hit@10: 0.1060
source best!
....................................................................................................................................................................................................
source: 	 mrr: 0.056443	 ndcg_5: 0.0466	 ndcg_10: 0.0607	 hit@1:0.021657	 hit@5:0.0709	 hit@10: 0.1148
epoch 12: train_loss = 1.058686, source_hit@10 = 0.1148, source_ndcg@10 = 0.0607, target_hit@10 = 0.1060, target_ndcg@10 = 0.0548
new best model saved.

2024-08-02 15:58:38.331142: step 22880/140800 (epoch 13/80), loss = 1.057234 (621.295 sec/epoch), lr: 0.003800
Evaluating on dev set...
...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
source: 	 mrr: 0.042504	 ndcg_5: 0.0338	 ndcg_10: 0.0453	 hit@1:0.015476	 hit@5:0.0524	 hit@10: 0.0882
target: 	 mrr: 0.057256	 ndcg_5: 0.0458	 ndcg_10: 0.0619	 hit@1:0.018224	 hit@5:0.0741	 hit@10: 0.1241
target best!
................................................................................................................................................................................................................................................................................................target: 	 mrr: 0.056274	 ndcg_5: 0.0443	 ndcg_10: 0.0606	 hit@1:0.017766	 hit@5:0.0714	 hit@10: 0.1222
epoch 13: train_loss = 1.057234, source_hit@10 = 0.0882, source_ndcg@10 = 0.0453, target_hit@10 = 0.1222, target_ndcg@10 = 0.0606

