nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, batch_size=1024, beta=1.5, conv_layers=6, cuda=True, decay_epoch=5, device=device(type='cuda', index=0), device_id='0', domains='game_video', dropout=0.2, epoch=70, feature_dim=126, hidden_dim=126, keep_prob=0.6, lambda_constra=0.3, lambda_critic=0.3, lambda_ease=50, leakey=0.01, load=True, log='logs.txt', log_epoch=1, lr=0.0005, lr_decay=0.95, lr_transfer=0.0005, min_epoch=50, mode='train', model_file='single_50.pt', model_name='gv_6', num_latent_factors=3, num_negative=10, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=32, sim_threshold=0.9, tau=0.4, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:47: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
augmented graph loaded!
number_user 19457
number_item 8751
real graph loaded!
augmented graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
Loading model from ./saved_models/gv_6/single_50.pt
2024-07-11 12:25:16.941318: step 304/21280 (epoch 50/70), loss = 0.569633 (22.974 sec/epoch), lr: 0.000500
Evaluating on dev set...
....................
source: 	 mrr: 0.193523	 ndcg_5: 0.1906	 ndcg_10: 0.2290	 hit@1:0.091000	 hit@5:0.2860	 hit@10: 0.4060
target: 	 mrr: 0.207859	 ndcg_5: 0.1990	 ndcg_10: 0.2492	 hit@1:0.093000	 hit@5:0.3030	 hit@10: 0.4580
new best model saved.

2024-07-11 12:25:39.621233: step 608/21280 (epoch 51/70), loss = 0.528159 (22.406 sec/epoch), lr: 0.000500
Evaluating on dev set...
...........................
source: 	 mrr: 0.040597	 ndcg_5: 0.0296	 ndcg_10: 0.0394	 hit@1:0.012310	 hit@5:0.0485	 hit@10: 0.0789
target: 	 mrr: 0.047394	 ndcg_5: 0.0363	 ndcg_10: 0.0529	 hit@1:0.013937	 hit@5:0.0592	 hit@10: 0.1101
epoch 51: train_loss = 0.528159, source_hit@10 = 0.0789, source_ndcg@10 = 0.0394, target_hit@10 = 0.1101, target_ndcg@10 = 0.0529

2024-07-11 12:26:02.342323: step 912/21280 (epoch 52/70), loss = 0.496631 (22.455 sec/epoch), lr: 0.000475
Evaluating on dev set...
...........................
source: 	 mrr: 0.037452	 ndcg_5: 0.0272	 ndcg_10: 0.0389	 hit@1:0.007965	 hit@5:0.0456	 hit@10: 0.0818
target: 	 mrr: 0.046929	 ndcg_5: 0.0393	 ndcg_10: 0.0505	 hit@1:0.016028	 hit@5:0.0641	 hit@10: 0.0990
epoch 52: train_loss = 0.496631, source_hit@10 = 0.0818, source_ndcg@10 = 0.0389, target_hit@10 = 0.0990, target_ndcg@10 = 0.0505

2024-07-11 12:26:25.025354: step 1216/21280 (epoch 53/70), loss = 0.479272 (22.415 sec/epoch), lr: 0.000451
Evaluating on dev set...
...........................
source: 	 mrr: 0.033352	 ndcg_5: 0.0214	 ndcg_10: 0.0325	 hit@1:0.008689	 hit@5:0.0348	 hit@10: 0.0695
target: 	 mrr: 0.050955	 ndcg_5: 0.0419	 ndcg_10: 0.0529	 hit@1:0.018815	 hit@5:0.0662	 hit@10: 0.1003
epoch 53: train_loss = 0.479272, source_hit@10 = 0.0695, source_ndcg@10 = 0.0325, target_hit@10 = 0.1003, target_ndcg@10 = 0.0529

2024-07-11 12:26:47.721663: step 1520/21280 (epoch 54/70), loss = 0.459226 (22.433 sec/epoch), lr: 0.000429
Evaluating on dev set...
...........................
source: 	 mrr: 0.034350	 ndcg_5: 0.0236	 ndcg_10: 0.0333	 hit@1:0.009413	 hit@5:0.0391	 hit@10: 0.0688
target: 	 mrr: 0.040678	 ndcg_5: 0.0298	 ndcg_10: 0.0424	 hit@1:0.011150	 hit@5:0.0481	 hit@10: 0.0871
epoch 54: train_loss = 0.459226, source_hit@10 = 0.0688, source_ndcg@10 = 0.0333, target_hit@10 = 0.0871, target_ndcg@10 = 0.0424

2024-07-11 12:27:10.432426: step 1824/21280 (epoch 55/70), loss = 0.442146 (22.446 sec/epoch), lr: 0.000407
Evaluating on dev set...
...........................
source: 	 mrr: 0.033922	 ndcg_5: 0.0251	 ndcg_10: 0.0333	 hit@1:0.009413	 hit@5:0.0420	 hit@10: 0.0673
target: 	 mrr: 0.045717	 ndcg_5: 0.0378	 ndcg_10: 0.0478	 hit@1:0.014634	 hit@5:0.0620	 hit@10: 0.0934
epoch 55: train_loss = 0.442146, source_hit@10 = 0.0673, source_ndcg@10 = 0.0333, target_hit@10 = 0.0934, target_ndcg@10 = 0.0478

2024-07-11 12:27:33.129217: step 2128/21280 (epoch 56/70), loss = 0.434494 (22.434 sec/epoch), lr: 0.000407
Evaluating on dev set...
...........................
source: 	 mrr: 0.035155	 ndcg_5: 0.0260	 ndcg_10: 0.0335	 hit@1:0.009413	 hit@5:0.0420	 hit@10: 0.0652
target: 	 mrr: 0.039307	 ndcg_5: 0.0301	 ndcg_10: 0.0409	 hit@1:0.012544	 hit@5:0.0495	 hit@10: 0.0829
epoch 56: train_loss = 0.434494, source_hit@10 = 0.0652, source_ndcg@10 = 0.0335, target_hit@10 = 0.0829, target_ndcg@10 = 0.0409

2024-07-11 12:27:55.832613: step 2432/21280 (epoch 57/70), loss = 0.427194 (22.440 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.031477	 ndcg_5: 0.0213	 ndcg_10: 0.0304	 hit@1:0.008689	 hit@5:0.0355	 hit@10: 0.0637
target: 	 mrr: 0.044218	 ndcg_5: 0.0353	 ndcg_10: 0.0473	 hit@1:0.012544	 hit@5:0.0578	 hit@10: 0.0955
epoch 57: train_loss = 0.427194, source_hit@10 = 0.0637, source_ndcg@10 = 0.0304, target_hit@10 = 0.0955, target_ndcg@10 = 0.0473

2024-07-11 12:28:18.539294: step 2736/21280 (epoch 58/70), loss = 0.418128 (22.443 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.029647	 ndcg_5: 0.0193	 ndcg_10: 0.0292	 hit@1:0.006517	 hit@5:0.0326	 hit@10: 0.0637
target: 	 mrr: 0.052860	 ndcg_5: 0.0427	 ndcg_10: 0.0552	 hit@1:0.022300	 hit@5:0.0634	 hit@10: 0.1017
epoch 58: train_loss = 0.418128, source_hit@10 = 0.0637, source_ndcg@10 = 0.0292, target_hit@10 = 0.1017, target_ndcg@10 = 0.0552

2024-07-11 12:28:41.253476: step 3040/21280 (epoch 59/70), loss = 0.413008 (22.451 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.029363	 ndcg_5: 0.0178	 ndcg_10: 0.0278	 hit@1:0.007241	 hit@5:0.0297	 hit@10: 0.0608
target: 	 mrr: 0.040679	 ndcg_5: 0.0311	 ndcg_10: 0.0413	 hit@1:0.011150	 hit@5:0.0509	 hit@10: 0.0822
epoch 59: train_loss = 0.413008, source_hit@10 = 0.0608, source_ndcg@10 = 0.0278, target_hit@10 = 0.0822, target_ndcg@10 = 0.0413

2024-07-11 12:29:03.968850: step 3344/21280 (epoch 60/70), loss = 0.408811 (22.452 sec/epoch), lr: 0.000368
Evaluating on dev set...
...........................
source: 	 mrr: 0.035179	 ndcg_5: 0.0245	 ndcg_10: 0.0330	 hit@1:0.011586	 hit@5:0.0369	 hit@10: 0.0637
target: 	 mrr: 0.049765	 ndcg_5: 0.0410	 ndcg_10: 0.0517	 hit@1:0.018118	 hit@5:0.0627	 hit@10: 0.0962
epoch 60: train_loss = 0.408811, source_hit@10 = 0.0637, source_ndcg@10 = 0.0330, target_hit@10 = 0.0962, target_ndcg@10 = 0.0517

2024-07-11 12:29:26.684566: step 3648/21280 (epoch 61/70), loss = 0.400228 (22.452 sec/epoch), lr: 0.000368
Evaluating on dev set...
...........................
source: 	 mrr: 0.031323	 ndcg_5: 0.0215	 ndcg_10: 0.0295	 hit@1:0.007965	 hit@5:0.0355	 hit@10: 0.0608
target: 	 mrr: 0.045755	 ndcg_5: 0.0356	 ndcg_10: 0.0472	 hit@1:0.014634	 hit@5:0.0551	 hit@10: 0.0913
epoch 61: train_loss = 0.400228, source_hit@10 = 0.0608, source_ndcg@10 = 0.0295, target_hit@10 = 0.0913, target_ndcg@10 = 0.0472

2024-07-11 12:29:49.393812: step 3952/21280 (epoch 62/70), loss = 0.394485 (22.441 sec/epoch), lr: 0.000349
Evaluating on dev set...
...........................
source: 	 mrr: 0.029814	 ndcg_5: 0.0194	 ndcg_10: 0.0266	 hit@1:0.005793	 hit@5:0.0333	 hit@10: 0.0558
target: 	 mrr: 0.047554	 ndcg_5: 0.0357	 ndcg_10: 0.0502	 hit@1:0.018815	 hit@5:0.0516	 hit@10: 0.0962
epoch 62: train_loss = 0.394485, source_hit@10 = 0.0558, source_ndcg@10 = 0.0266, target_hit@10 = 0.0962, target_ndcg@10 = 0.0502

2024-07-11 12:30:12.104142: step 4256/21280 (epoch 63/70), loss = 0.385949 (22.445 sec/epoch), lr: 0.000349
Evaluating on dev set...
...........................
source: 	 mrr: 0.025573	 ndcg_5: 0.0150	 ndcg_10: 0.0207	 hit@1:0.005069	 hit@5:0.0261	 hit@10: 0.0434
target: 	 mrr: 0.045698	 ndcg_5: 0.0344	 ndcg_10: 0.0465	 hit@1:0.017422	 hit@5:0.0509	 hit@10: 0.0892
epoch 63: train_loss = 0.385949, source_hit@10 = 0.0434, source_ndcg@10 = 0.0207, target_hit@10 = 0.0892, target_ndcg@10 = 0.0465

2024-07-11 12:30:34.808840: step 4560/21280 (epoch 64/70), loss = 0.379490 (22.441 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.028398	 ndcg_5: 0.0152	 ndcg_10: 0.0267	 hit@1:0.005069	 hit@5:0.0261	 hit@10: 0.0623
target: 	 mrr: 0.045598	 ndcg_5: 0.0359	 ndcg_10: 0.0480	 hit@1:0.016028	 hit@5:0.0557	 hit@10: 0.0941
epoch 64: train_loss = 0.379490, source_hit@10 = 0.0623, source_ndcg@10 = 0.0267, target_hit@10 = 0.0941, target_ndcg@10 = 0.0480

2024-07-11 12:30:57.509619: step 4864/21280 (epoch 65/70), loss = 0.376186 (22.432 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.030307	 ndcg_5: 0.0193	 ndcg_10: 0.0288	 hit@1:0.007241	 hit@5:0.0319	 hit@10: 0.0615
target: 	 mrr: 0.044608	 ndcg_5: 0.0345	 ndcg_10: 0.0453	 hit@1:0.016725	 hit@5:0.0537	 hit@10: 0.0871
epoch 65: train_loss = 0.376186, source_hit@10 = 0.0615, source_ndcg@10 = 0.0288, target_hit@10 = 0.0871, target_ndcg@10 = 0.0453

2024-07-11 12:31:20.202762: step 5168/21280 (epoch 66/70), loss = 0.375581 (22.430 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.028894	 ndcg_5: 0.0170	 ndcg_10: 0.0273	 hit@1:0.005793	 hit@5:0.0290	 hit@10: 0.0608
target: 	 mrr: 0.044142	 ndcg_5: 0.0356	 ndcg_10: 0.0474	 hit@1:0.013240	 hit@5:0.0578	 hit@10: 0.0948
epoch 66: train_loss = 0.375581, source_hit@10 = 0.0608, source_ndcg@10 = 0.0273, target_hit@10 = 0.0948, target_ndcg@10 = 0.0474

2024-07-11 12:31:42.907521: step 5472/21280 (epoch 67/70), loss = 0.365719 (22.442 sec/epoch), lr: 0.000315
Evaluating on dev set...
...........................
source: 	 mrr: 0.028859	 ndcg_5: 0.0178	 ndcg_10: 0.0262	 hit@1:0.005069	 hit@5:0.0311	 hit@10: 0.0572
target: 	 mrr: 0.042514	 ndcg_5: 0.0318	 ndcg_10: 0.0448	 hit@1:0.012544	 hit@5:0.0502	 hit@10: 0.0906
epoch 67: train_loss = 0.365719, source_hit@10 = 0.0572, source_ndcg@10 = 0.0262, target_hit@10 = 0.0906, target_ndcg@10 = 0.0448

2024-07-11 12:32:05.618043: step 5776/21280 (epoch 68/70), loss = 0.353177 (22.446 sec/epoch), lr: 0.000299
Evaluating on dev set...
...........................
source: 	 mrr: 0.034063	 ndcg_5: 0.0228	 ndcg_10: 0.0328	 hit@1:0.008689	 hit@5:0.0369	 hit@10: 0.0681
target: 	 mrr: 0.039971	 ndcg_5: 0.0322	 ndcg_10: 0.0444	 hit@1:0.009059	 hit@5:0.0557	 hit@10: 0.0934
epoch 68: train_loss = 0.353177, source_hit@10 = 0.0681, source_ndcg@10 = 0.0328, target_hit@10 = 0.0934, target_ndcg@10 = 0.0444

2024-07-11 12:32:28.318473: step 6080/21280 (epoch 69/70), loss = 0.355583 (22.431 sec/epoch), lr: 0.000299
Evaluating on dev set...
...........................
source: 	 mrr: 0.028722	 ndcg_5: 0.0188	 ndcg_10: 0.0268	 hit@1:0.006517	 hit@5:0.0319	 hit@10: 0.0572
target: 	 mrr: 0.044293	 ndcg_5: 0.0351	 ndcg_10: 0.0456	 hit@1:0.015331	 hit@5:0.0557	 hit@10: 0.0885
epoch 69: train_loss = 0.355583, source_hit@10 = 0.0572, source_ndcg@10 = 0.0268, target_hit@10 = 0.0885, target_ndcg@10 = 0.0456

2024-07-11 12:32:51.426744: step 6384/21280 (epoch 70/70), loss = 0.348866 (22.845 sec/epoch), lr: 0.000284
Evaluating on dev set...
...........................
source: 	 mrr: 0.026887	 ndcg_5: 0.0148	 ndcg_10: 0.0271	 hit@1:0.003621	 hit@5:0.0261	 hit@10: 0.0644
target: 	 mrr: 0.042210	 ndcg_5: 0.0321	 ndcg_10: 0.0415	 hit@1:0.014634	 hit@5:0.0481	 hit@10: 0.0774
epoch 70: train_loss = 0.348866, source_hit@10 = 0.0644, source_ndcg@10 = 0.0271, target_hit@10 = 0.0774, target_ndcg@10 = 0.0415

