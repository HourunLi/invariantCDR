nohup: ignoring input
using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, batch_size=1024, beta=1.5, conv_layers=3, cuda=True, decay_epoch=5, device=device(type='cuda', index=1), device_id='1', domains='cloth_sport', dropout=0.2, epoch=200, feature_dim=126, hidden_dim=126, keep_prob=0.6, lambda_constra=0.15, lambda_critic=0.35, lambda_ease=50, leakey=0.01, load=True, log='logs.txt', log_epoch=3, lr=0.0005, lr_decay=0.95, lr_transfer=0.0005, mask_rate=0.1, min_epoch=50, mode='train', model_file='checkpoint_epoch_40.pt', model_name='cs', num_latent_factors=3, num_negative=20, optim='adam', patience=50, proj_layers=1, projection=1, residual=0, save=True, save_dir='./saved_models', seed=32, sim_threshold=0.9, tau=0.4, test_sample_number=999, transfer_epoch=40, user_batch_size=256, weight_decay=0.0002)
number_user 41829
number_item 17943
732772292
49873
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:47: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
Original edge number: 187880; Augmentation edge number: 192213; adding 4333 edges
augmentation graph loaded!
number_user 27328
number_item 12655
333408046
80379
real graph loaded!
Original edge number: 163291; Augmentation edge number: 175271; adding 11980 edges
augmentation graph loaded!
graph loaded!
Loading data from cloth_sport with batch size 1024...
unseen test: 0
test length: 3156
unseen test: 0
test length: 3085
unseen test: 0
test length: 3589
unseen test: 0
test length: 3546
source_user_num 41829
target_user_num 27328
source_item_num 17943
target_item_num 12655
shared users id: 7857
test users 990, 982
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 187880, target train data: 163291, source test data : 3085, target test data : 3546, source dev data : 1000, target dev data : 1000
Loading model from ./saved_models/cs/checkpoint_epoch_40.pt
2024-07-03 14:53:35.637351: step 343/68600 (epoch 40/200), loss = 1.369499 (198.777 sec/epoch), lr: 0.000500
2024-07-03 14:56:53.794045: step 686/68600 (epoch 41/200), loss = 1.340559 (198.157 sec/epoch), lr: 0.000500
2024-07-03 15:00:11.941781: step 1029/68600 (epoch 42/200), loss = 1.317241 (198.148 sec/epoch), lr: 0.000500
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045284	 ndcg_5: 0.0367	 ndcg_10: 0.0490	 hit@1:0.014259	 hit@5:0.0589	 hit@10: 0.0976
target: 	 mrr: 0.045272	 ndcg_5: 0.0355	 ndcg_10: 0.0484	 hit@1:0.015603	 hit@5:0.0554	 hit@10: 0.0950
source best!
..............................
source: 	 mrr: 0.048480	 ndcg_5: 0.0388	 ndcg_10: 0.0508	 hit@1:0.021070	 hit@5:0.0564	 hit@10: 0.0943
target best!
...................................target: 	 mrr: 0.051788	 ndcg_5: 0.0431	 ndcg_10: 0.0555	 hit@1:0.022561	 hit@5:0.0635	 hit@10: 0.1018
epoch 42: train_loss = 1.317241, source_hit@10 = 0.0943, source_ndcg@10 = 0.0508, target_hit@10 = 0.1018, target_ndcg@10 = 0.0555
new best model saved.

2024-07-03 15:03:31.995963: step 1372/68600 (epoch 43/200), loss = 1.301300 (198.353 sec/epoch), lr: 0.000500
2024-07-03 15:06:50.310380: step 1715/68600 (epoch 44/200), loss = 1.287755 (198.314 sec/epoch), lr: 0.000500
2024-07-03 15:10:08.648959: step 2058/68600 (epoch 45/200), loss = 1.274734 (198.339 sec/epoch), lr: 0.000500
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041710	 ndcg_5: 0.0333	 ndcg_10: 0.0434	 hit@1:0.012991	 hit@5:0.0532	 hit@10: 0.0846
target: 	 mrr: 0.042470	 ndcg_5: 0.0329	 ndcg_10: 0.0436	 hit@1:0.015882	 hit@5:0.0496	 hit@10: 0.0830
epoch 45: train_loss = 1.274734, source_hit@10 = 0.0846, source_ndcg@10 = 0.0434, target_hit@10 = 0.0830, target_ndcg@10 = 0.0436

2024-07-03 15:13:28.037996: step 2401/68600 (epoch 46/200), loss = 1.259089 (198.472 sec/epoch), lr: 0.000475
2024-07-03 15:16:46.429644: step 2744/68600 (epoch 47/200), loss = 1.251156 (198.392 sec/epoch), lr: 0.000475
2024-07-03 15:20:04.740545: step 3087/68600 (epoch 48/200), loss = 1.245140 (198.311 sec/epoch), lr: 0.000475
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.048705	 ndcg_5: 0.0390	 ndcg_10: 0.0518	 hit@1:0.017427	 hit@5:0.0612	 hit@10: 0.1008
target: 	 mrr: 0.038230	 ndcg_5: 0.0298	 ndcg_10: 0.0407	 hit@1:0.012260	 hit@5:0.0468	 hit@10: 0.0808
source best!
..............................
source: 	 mrr: 0.052090	 ndcg_5: 0.0445	 ndcg_10: 0.0553	 hit@1:0.021718	 hit@5:0.0674	 hit@10: 0.1011
epoch 48: train_loss = 1.245140, source_hit@10 = 0.1011, source_ndcg@10 = 0.0553, target_hit@10 = 0.0808, target_ndcg@10 = 0.0407

2024-07-03 15:23:24.444176: step 3430/68600 (epoch 49/200), loss = 1.236211 (198.478 sec/epoch), lr: 0.000475
2024-07-03 15:26:42.897981: step 3773/68600 (epoch 50/200), loss = 1.229161 (198.454 sec/epoch), lr: 0.000475
2024-07-03 15:30:01.473890: step 4116/68600 (epoch 51/200), loss = 1.228085 (198.576 sec/epoch), lr: 0.000475
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039271	 ndcg_5: 0.0287	 ndcg_10: 0.0397	 hit@1:0.012991	 hit@5:0.0444	 hit@10: 0.0783
target: 	 mrr: 0.042785	 ndcg_5: 0.0334	 ndcg_10: 0.0449	 hit@1:0.014489	 hit@5:0.0521	 hit@10: 0.0880
epoch 51: train_loss = 1.228085, source_hit@10 = 0.0783, source_ndcg@10 = 0.0397, target_hit@10 = 0.0880, target_ndcg@10 = 0.0449

2024-07-03 15:33:20.994779: step 4459/68600 (epoch 52/200), loss = 1.224318 (198.608 sec/epoch), lr: 0.000451
2024-07-03 15:36:39.508037: step 4802/68600 (epoch 53/200), loss = 1.214528 (198.513 sec/epoch), lr: 0.000451
2024-07-03 15:39:58.101912: step 5145/68600 (epoch 54/200), loss = 1.214698 (198.594 sec/epoch), lr: 0.000451
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.046759	 ndcg_5: 0.0368	 ndcg_10: 0.0483	 hit@1:0.017744	 hit@5:0.0567	 hit@10: 0.0925
target: 	 mrr: 0.046511	 ndcg_5: 0.0380	 ndcg_10: 0.0488	 hit@1:0.017275	 hit@5:0.0571	 hit@10: 0.0906
target best!
...................................target: 	 mrr: 0.045115	 ndcg_5: 0.0379	 ndcg_10: 0.0491	 hit@1:0.014946	 hit@5:0.0606	 hit@10: 0.0956
epoch 54: train_loss = 1.214698, source_hit@10 = 0.0925, source_ndcg@10 = 0.0483, target_hit@10 = 0.0956, target_ndcg@10 = 0.0491

2024-07-03 15:43:18.120616: step 5488/68600 (epoch 55/200), loss = 1.210028 (198.760 sec/epoch), lr: 0.000451
2024-07-03 15:46:36.796434: step 5831/68600 (epoch 56/200), loss = 1.210499 (198.676 sec/epoch), lr: 0.000451
2024-07-03 15:49:55.862143: step 6174/68600 (epoch 57/200), loss = 1.202330 (199.066 sec/epoch), lr: 0.000451
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040415	 ndcg_5: 0.0299	 ndcg_10: 0.0406	 hit@1:0.015526	 hit@5:0.0447	 hit@10: 0.0776
target: 	 mrr: 0.039380	 ndcg_5: 0.0316	 ndcg_10: 0.0405	 hit@1:0.014489	 hit@5:0.0482	 hit@10: 0.0758
epoch 57: train_loss = 1.202330, source_hit@10 = 0.0776, source_ndcg@10 = 0.0406, target_hit@10 = 0.0758, target_ndcg@10 = 0.0405

