nohup: ignoring input
using gpu:3 to train the model
using gpu:3 to train the model
cuda:3
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, batch_size=1024, beta=1.5, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=3), device_id='3', domains='game_video', dropout=0.8, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_constra=0.3, lambda_critic=0.5, leakey=0.01, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='gv', momentum=0.98, num_latent_factors=3, num_negative=100, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/disk2/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 19457
number_item 8751
real graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
2024-07-31 06:04:15.361201: step 304/24320 (epoch 1/80), loss = 1.228931 (133.284 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.017108	 ndcg_5: 0.0096	 ndcg_10: 0.0166	 hit@1:0.004345	 hit@5:0.0159	 hit@10: 0.0377
target: 	 mrr: 0.034045	 ndcg_5: 0.0261	 ndcg_10: 0.0338	 hit@1:0.011847	 hit@5:0.0404	 hit@10: 0.0648
source best!
.............
source: 	 mrr: 0.023639	 ndcg_5: 0.0170	 ndcg_10: 0.0224	 hit@1:0.011503	 hit@5:0.0230	 hit@10: 0.0399
target best!
..............target: 	 mrr: 0.037236	 ndcg_5: 0.0294	 ndcg_10: 0.0367	 hit@1:0.014403	 hit@5:0.0432	 hit@10: 0.0658
epoch 1: train_loss = 1.228931, source_hit@10 = 0.0399, source_ndcg@10 = 0.0224, target_hit@10 = 0.0658, target_ndcg@10 = 0.0367

2024-07-31 06:06:25.823309: step 608/24320 (epoch 2/80), loss = 1.045930 (128.921 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.019743	 ndcg_5: 0.0099	 ndcg_10: 0.0190	 hit@1:0.002896	 hit@5:0.0181	 hit@10: 0.0463
target: 	 mrr: 0.018403	 ndcg_5: 0.0118	 ndcg_10: 0.0162	 hit@1:0.004878	 hit@5:0.0195	 hit@10: 0.0328
source best!
.............
source: 	 mrr: 0.025545	 ndcg_5: 0.0171	 ndcg_10: 0.0226	 hit@1:0.008436	 hit@5:0.0261	 hit@10: 0.0437
epoch 2: train_loss = 1.045930, source_hit@10 = 0.0437, source_ndcg@10 = 0.0226, target_hit@10 = 0.0328, target_ndcg@10 = 0.0162

2024-07-31 06:08:37.148595: step 912/24320 (epoch 3/80), loss = 1.024986 (130.128 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.030937	 ndcg_5: 0.0192	 ndcg_10: 0.0271	 hit@1:0.008689	 hit@5:0.0290	 hit@10: 0.0536
target: 	 mrr: 0.031702	 ndcg_5: 0.0245	 ndcg_10: 0.0312	 hit@1:0.008362	 hit@5:0.0411	 hit@10: 0.0620
source best!
.............
source: 	 mrr: 0.031921	 ndcg_5: 0.0221	 ndcg_10: 0.0318	 hit@1:0.007669	 hit@5:0.0376	 hit@10: 0.0683
epoch 3: train_loss = 1.024986, source_hit@10 = 0.0683, source_ndcg@10 = 0.0318, target_hit@10 = 0.0620, target_ndcg@10 = 0.0312
new best model saved.

2024-07-31 06:10:46.460008: step 1216/24320 (epoch 4/80), loss = 0.999700 (127.829 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032396	 ndcg_5: 0.0228	 ndcg_10: 0.0335	 hit@1:0.005793	 hit@5:0.0420	 hit@10: 0.0753
target: 	 mrr: 0.037543	 ndcg_5: 0.0289	 ndcg_10: 0.0377	 hit@1:0.013240	 hit@5:0.0446	 hit@10: 0.0725
source best!
.............
source: 	 mrr: 0.031558	 ndcg_5: 0.0232	 ndcg_10: 0.0317	 hit@1:0.006902	 hit@5:0.0399	 hit@10: 0.0667
target best!
..............target: 	 mrr: 0.031619	 ndcg_5: 0.0210	 ndcg_10: 0.0337	 hit@1:0.007545	 hit@5:0.0343	 hit@10: 0.0741
epoch 4: train_loss = 0.999700, source_hit@10 = 0.0667, source_ndcg@10 = 0.0317, target_hit@10 = 0.0741, target_ndcg@10 = 0.0337
new best model saved.

2024-07-31 06:12:55.497216: step 1520/24320 (epoch 5/80), loss = 0.991252 (127.303 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.033799	 ndcg_5: 0.0228	 ndcg_10: 0.0316	 hit@1:0.007241	 hit@5:0.0369	 hit@10: 0.0644
target: 	 mrr: 0.032064	 ndcg_5: 0.0226	 ndcg_10: 0.0311	 hit@1:0.009756	 hit@5:0.0348	 hit@10: 0.0620
source best!
.............
source: 	 mrr: 0.033512	 ndcg_5: 0.0219	 ndcg_10: 0.0333	 hit@1:0.008436	 hit@5:0.0360	 hit@10: 0.0721
epoch 5: train_loss = 0.991252, source_hit@10 = 0.0721, source_ndcg@10 = 0.0333, target_hit@10 = 0.0620, target_ndcg@10 = 0.0311

2024-07-31 06:15:14.267717: step 1824/24320 (epoch 6/80), loss = 0.987131 (137.524 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.036265	 ndcg_5: 0.0258	 ndcg_10: 0.0368	 hit@1:0.010862	 hit@5:0.0434	 hit@10: 0.0775
target: 	 mrr: 0.028916	 ndcg_5: 0.0196	 ndcg_10: 0.0292	 hit@1:0.004181	 hit@5:0.0355	 hit@10: 0.0648
source best!
.............
source: 	 mrr: 0.031292	 ndcg_5: 0.0199	 ndcg_10: 0.0310	 hit@1:0.006902	 hit@5:0.0345	 hit@10: 0.0690
epoch 6: train_loss = 0.987131, source_hit@10 = 0.0690, source_ndcg@10 = 0.0310, target_hit@10 = 0.0648, target_ndcg@10 = 0.0292

2024-07-31 06:17:22.650107: step 2128/24320 (epoch 7/80), loss = 0.985434 (127.163 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.031132	 ndcg_5: 0.0207	 ndcg_10: 0.0290	 hit@1:0.006517	 hit@5:0.0348	 hit@10: 0.0608
target: 	 mrr: 0.020737	 ndcg_5: 0.0122	 ndcg_10: 0.0196	 hit@1:0.002787	 hit@5:0.0216	 hit@10: 0.0446
epoch 7: train_loss = 0.985434, source_hit@10 = 0.0608, source_ndcg@10 = 0.0290, target_hit@10 = 0.0446, target_ndcg@10 = 0.0196

2024-07-31 06:19:29.609316: step 2432/24320 (epoch 8/80), loss = 0.984208 (126.097 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.028251	 ndcg_5: 0.0176	 ndcg_10: 0.0283	 hit@1:0.003621	 hit@5:0.0319	 hit@10: 0.0652
target: 	 mrr: 0.030243	 ndcg_5: 0.0210	 ndcg_10: 0.0299	 hit@1:0.008362	 hit@5:0.0341	 hit@10: 0.0613
epoch 8: train_loss = 0.984208, source_hit@10 = 0.0652, source_ndcg@10 = 0.0283, target_hit@10 = 0.0613, target_ndcg@10 = 0.0299

2024-07-31 06:21:34.955361: step 2736/24320 (epoch 9/80), loss = 0.983880 (124.467 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.030951	 ndcg_5: 0.0192	 ndcg_10: 0.0293	 hit@1:0.007965	 hit@5:0.0304	 hit@10: 0.0615
target: 	 mrr: 0.034309	 ndcg_5: 0.0271	 ndcg_10: 0.0368	 hit@1:0.010453	 hit@5:0.0446	 hit@10: 0.0753
epoch 9: train_loss = 0.983880, source_hit@10 = 0.0615, source_ndcg@10 = 0.0293, target_hit@10 = 0.0753, target_ndcg@10 = 0.0368

2024-07-31 06:23:39.483255: step 3040/24320 (epoch 10/80), loss = 0.981905 (123.651 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032714	 ndcg_5: 0.0213	 ndcg_10: 0.0330	 hit@1:0.006517	 hit@5:0.0362	 hit@10: 0.0724
target: 	 mrr: 0.028728	 ndcg_5: 0.0219	 ndcg_10: 0.0298	 hit@1:0.009756	 hit@5:0.0341	 hit@10: 0.0585
epoch 10: train_loss = 0.981905, source_hit@10 = 0.0724, source_ndcg@10 = 0.0330, target_hit@10 = 0.0585, target_ndcg@10 = 0.0298

2024-07-31 06:25:58.597762: step 3344/24320 (epoch 11/80), loss = 0.982210 (138.266 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.033375	 ndcg_5: 0.0235	 ndcg_10: 0.0344	 hit@1:0.006517	 hit@5:0.0420	 hit@10: 0.0760
target: 	 mrr: 0.020533	 ndcg_5: 0.0126	 ndcg_10: 0.0201	 hit@1:0.003484	 hit@5:0.0223	 hit@10: 0.0460
epoch 11: train_loss = 0.982210, source_hit@10 = 0.0760, source_ndcg@10 = 0.0344, target_hit@10 = 0.0460, target_ndcg@10 = 0.0201

2024-07-31 06:28:09.111783: step 3648/24320 (epoch 12/80), loss = 0.979401 (129.610 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.035193	 ndcg_5: 0.0260	 ndcg_10: 0.0354	 hit@1:0.007241	 hit@5:0.0449	 hit@10: 0.0739
target: 	 mrr: 0.035102	 ndcg_5: 0.0257	 ndcg_10: 0.0339	 hit@1:0.014634	 hit@5:0.0362	 hit@10: 0.0620
epoch 12: train_loss = 0.979401, source_hit@10 = 0.0739, source_ndcg@10 = 0.0354, target_hit@10 = 0.0620, target_ndcg@10 = 0.0339

2024-07-31 06:30:27.860392: step 3952/24320 (epoch 13/80), loss = 0.978050 (137.709 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.035122	 ndcg_5: 0.0271	 ndcg_10: 0.0356	 hit@1:0.007965	 hit@5:0.0471	 hit@10: 0.0739
target: 	 mrr: 0.033647	 ndcg_5: 0.0267	 ndcg_10: 0.0346	 hit@1:0.009756	 hit@5:0.0432	 hit@10: 0.0676
epoch 13: train_loss = 0.978050, source_hit@10 = 0.0739, source_ndcg@10 = 0.0356, target_hit@10 = 0.0676, target_ndcg@10 = 0.0346

