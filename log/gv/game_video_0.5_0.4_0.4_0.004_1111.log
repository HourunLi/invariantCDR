nohup: ignoring input
using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=1), device_id='1', domains='game_video', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.01, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='gv', momentum=0.98, num_latent_factors=3, num_negative=100, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=1111, similarity_tau=0.1, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 19457
number_item 8751
real graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
2024-08-01 11:15:51.785861: step 304/24320 (epoch 1/80), loss = 1.379552 (38.760 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.019231	 ndcg_5: 0.0134	 ndcg_10: 0.0178	 hit@1:0.004345	 hit@5:0.0224	 hit@10: 0.0362
target: 	 mrr: 0.028118	 ndcg_5: 0.0201	 ndcg_10: 0.0283	 hit@1:0.006272	 hit@5:0.0341	 hit@10: 0.0599
source best!
.............
source: 	 mrr: 0.022034	 ndcg_5: 0.0159	 ndcg_10: 0.0209	 hit@1:0.006135	 hit@5:0.0253	 hit@10: 0.0406
target best!
..............target: 	 mrr: 0.029575	 ndcg_5: 0.0203	 ndcg_10: 0.0294	 hit@1:0.008916	 hit@5:0.0316	 hit@10: 0.0604
epoch 1: train_loss = 1.379552, source_hit@10 = 0.0406, source_ndcg@10 = 0.0209, target_hit@10 = 0.0604, target_ndcg@10 = 0.0294

2024-08-01 11:16:30.984170: step 608/24320 (epoch 2/80), loss = 1.225619 (38.569 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.031173	 ndcg_5: 0.0199	 ndcg_10: 0.0270	 hit@1:0.007241	 hit@5:0.0326	 hit@10: 0.0543
target: 	 mrr: 0.035882	 ndcg_5: 0.0280	 ndcg_10: 0.0355	 hit@1:0.014634	 hit@5:0.0439	 hit@10: 0.0676
source best!
.............
source: 	 mrr: 0.023494	 ndcg_5: 0.0118	 ndcg_10: 0.0187	 hit@1:0.003834	 hit@5:0.0207	 hit@10: 0.0422
target best!
..............target: 	 mrr: 0.035501	 ndcg_5: 0.0264	 ndcg_10: 0.0363	 hit@1:0.013032	 hit@5:0.0405	 hit@10: 0.0713
epoch 2: train_loss = 1.225619, source_hit@10 = 0.0422, source_ndcg@10 = 0.0187, target_hit@10 = 0.0713, target_ndcg@10 = 0.0363
new best model saved.

2024-08-01 11:17:10.557865: step 912/24320 (epoch 3/80), loss = 1.184511 (38.812 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.035924	 ndcg_5: 0.0257	 ndcg_10: 0.0371	 hit@1:0.007241	 hit@5:0.0442	 hit@10: 0.0789
target: 	 mrr: 0.043056	 ndcg_5: 0.0346	 ndcg_10: 0.0474	 hit@1:0.009756	 hit@5:0.0592	 hit@10: 0.0990
source best!
.............
source: 	 mrr: 0.033741	 ndcg_5: 0.0242	 ndcg_10: 0.0301	 hit@1:0.010736	 hit@5:0.0383	 hit@10: 0.0567
target best!
..............target: 	 mrr: 0.044167	 ndcg_5: 0.0361	 ndcg_10: 0.0485	 hit@1:0.013032	 hit@5:0.0610	 hit@10: 0.0988
epoch 3: train_loss = 1.184511, source_hit@10 = 0.0567, source_ndcg@10 = 0.0301, target_hit@10 = 0.0988, target_ndcg@10 = 0.0485
new best model saved.

2024-08-01 11:17:49.877442: step 1216/24320 (epoch 4/80), loss = 1.166995 (38.542 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.033545	 ndcg_5: 0.0251	 ndcg_10: 0.0341	 hit@1:0.007241	 hit@5:0.0449	 hit@10: 0.0724
target: 	 mrr: 0.040148	 ndcg_5: 0.0300	 ndcg_10: 0.0432	 hit@1:0.012544	 hit@5:0.0474	 hit@10: 0.0892
epoch 4: train_loss = 1.166995, source_hit@10 = 0.0724, source_ndcg@10 = 0.0341, target_hit@10 = 0.0892, target_ndcg@10 = 0.0432

2024-08-01 11:18:29.140206: step 1520/24320 (epoch 5/80), loss = 1.159338 (38.897 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.035630	 ndcg_5: 0.0242	 ndcg_10: 0.0345	 hit@1:0.009413	 hit@5:0.0398	 hit@10: 0.0724
target: 	 mrr: 0.033745	 ndcg_5: 0.0260	 ndcg_10: 0.0359	 hit@1:0.009059	 hit@5:0.0432	 hit@10: 0.0746
epoch 5: train_loss = 1.159338, source_hit@10 = 0.0724, source_ndcg@10 = 0.0345, target_hit@10 = 0.0746, target_ndcg@10 = 0.0359

2024-08-01 11:19:08.484388: step 1824/24320 (epoch 6/80), loss = 1.151611 (39.002 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.029788	 ndcg_5: 0.0198	 ndcg_10: 0.0272	 hit@1:0.008689	 hit@5:0.0326	 hit@10: 0.0558
target: 	 mrr: 0.042824	 ndcg_5: 0.0323	 ndcg_10: 0.0454	 hit@1:0.016028	 hit@5:0.0495	 hit@10: 0.0906
epoch 6: train_loss = 1.151611, source_hit@10 = 0.0558, source_ndcg@10 = 0.0272, target_hit@10 = 0.0906, target_ndcg@10 = 0.0454

2024-08-01 11:19:47.428215: step 2128/24320 (epoch 7/80), loss = 1.147796 (38.603 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.028758	 ndcg_5: 0.0182	 ndcg_10: 0.0238	 hit@1:0.007965	 hit@5:0.0275	 hit@10: 0.0449
target: 	 mrr: 0.040425	 ndcg_5: 0.0316	 ndcg_10: 0.0429	 hit@1:0.011150	 hit@5:0.0544	 hit@10: 0.0899
epoch 7: train_loss = 1.147796, source_hit@10 = 0.0449, source_ndcg@10 = 0.0238, target_hit@10 = 0.0899, target_ndcg@10 = 0.0429

2024-08-01 11:20:26.170095: step 2432/24320 (epoch 8/80), loss = 1.132105 (38.396 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.022689	 ndcg_5: 0.0132	 ndcg_10: 0.0188	 hit@1:0.003621	 hit@5:0.0224	 hit@10: 0.0398
target: 	 mrr: 0.040856	 ndcg_5: 0.0299	 ndcg_10: 0.0464	 hit@1:0.010453	 hit@5:0.0509	 hit@10: 0.1024
epoch 8: train_loss = 1.132105, source_hit@10 = 0.0398, source_ndcg@10 = 0.0188, target_hit@10 = 0.1024, target_ndcg@10 = 0.0464

2024-08-01 11:21:04.612913: step 2736/24320 (epoch 9/80), loss = 1.111935 (38.105 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.031046	 ndcg_5: 0.0218	 ndcg_10: 0.0287	 hit@1:0.005793	 hit@5:0.0369	 hit@10: 0.0587
target: 	 mrr: 0.035200	 ndcg_5: 0.0259	 ndcg_10: 0.0358	 hit@1:0.009756	 hit@5:0.0425	 hit@10: 0.0732
epoch 9: train_loss = 1.111935, source_hit@10 = 0.0587, source_ndcg@10 = 0.0287, target_hit@10 = 0.0732, target_ndcg@10 = 0.0358

2024-08-01 11:21:44.086838: step 3040/24320 (epoch 10/80), loss = 1.103996 (39.135 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032426	 ndcg_5: 0.0204	 ndcg_10: 0.0314	 hit@1:0.007241	 hit@5:0.0340	 hit@10: 0.0681
target: 	 mrr: 0.032833	 ndcg_5: 0.0237	 ndcg_10: 0.0345	 hit@1:0.005575	 hit@5:0.0432	 hit@10: 0.0767
epoch 10: train_loss = 1.103996, source_hit@10 = 0.0681, source_ndcg@10 = 0.0314, target_hit@10 = 0.0767, target_ndcg@10 = 0.0345

2024-08-01 11:22:23.096847: step 3344/24320 (epoch 11/80), loss = 1.102207 (38.669 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.010377	 ndcg_5: 0.0016	 ndcg_10: 0.0053	 hit@1:0.000724	 hit@5:0.0029	 hit@10: 0.0145
target: 	 mrr: 0.044059	 ndcg_5: 0.0351	 ndcg_10: 0.0462	 hit@1:0.013937	 hit@5:0.0571	 hit@10: 0.0920
target best!
..............target: 	 mrr: 0.049816	 ndcg_5: 0.0410	 ndcg_10: 0.0528	 hit@1:0.018519	 hit@5:0.0631	 hit@10: 0.1001
epoch 11: train_loss = 1.102207, source_hit@10 = 0.0145, source_ndcg@10 = 0.0053, target_hit@10 = 0.1001, target_ndcg@10 = 0.0528

2024-08-01 11:23:02.790711: step 3648/24320 (epoch 12/80), loss = 1.097590 (39.187 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.021178	 ndcg_5: 0.0135	 ndcg_10: 0.0188	 hit@1:0.006517	 hit@5:0.0210	 hit@10: 0.0377
target: 	 mrr: 0.045266	 ndcg_5: 0.0376	 ndcg_10: 0.0518	 hit@1:0.012544	 hit@5:0.0648	 hit@10: 0.1094
target best!
..............target: 	 mrr: 0.049868	 ndcg_5: 0.0390	 ndcg_10: 0.0565	 hit@1:0.017147	 hit@5:0.0624	 hit@10: 0.1166
epoch 12: train_loss = 1.097590, source_hit@10 = 0.0377, source_ndcg@10 = 0.0188, target_hit@10 = 0.1166, target_ndcg@10 = 0.0565

2024-08-01 11:23:41.850460: step 3952/24320 (epoch 13/80), loss = 1.096422 (38.531 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.027871	 ndcg_5: 0.0177	 ndcg_10: 0.0257	 hit@1:0.003621	 hit@5:0.0319	 hit@10: 0.0572
target: 	 mrr: 0.047479	 ndcg_5: 0.0385	 ndcg_10: 0.0526	 hit@1:0.016725	 hit@5:0.0627	 hit@10: 0.1066
target best!
..............target: 	 mrr: 0.053437	 ndcg_5: 0.0469	 ndcg_10: 0.0617	 hit@1:0.018519	 hit@5:0.0761	 hit@10: 0.1221
epoch 13: train_loss = 1.096422, source_hit@10 = 0.0572, source_ndcg@10 = 0.0257, target_hit@10 = 0.1221, target_ndcg@10 = 0.0617

2024-08-01 11:24:20.301302: step 4256/24320 (epoch 14/80), loss = 1.093995 (37.947 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.040466	 ndcg_5: 0.0310	 ndcg_10: 0.0403	 hit@1:0.012310	 hit@5:0.0500	 hit@10: 0.0789
target: 	 mrr: 0.039688	 ndcg_5: 0.0298	 ndcg_10: 0.0417	 hit@1:0.011847	 hit@5:0.0474	 hit@10: 0.0843
source best!
.............
source: 	 mrr: 0.038593	 ndcg_5: 0.0271	 ndcg_10: 0.0383	 hit@1:0.012270	 hit@5:0.0422	 hit@10: 0.0767
epoch 14: train_loss = 1.093995, source_hit@10 = 0.0767, source_ndcg@10 = 0.0383, target_hit@10 = 0.0843, target_ndcg@10 = 0.0417

2024-08-01 11:25:00.122935: step 4560/24320 (epoch 15/80), loss = 1.091179 (39.352 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.026728	 ndcg_5: 0.0187	 ndcg_10: 0.0252	 hit@1:0.005793	 hit@5:0.0319	 hit@10: 0.0529
target: 	 mrr: 0.045136	 ndcg_5: 0.0358	 ndcg_10: 0.0482	 hit@1:0.016028	 hit@5:0.0564	 hit@10: 0.0955
epoch 15: train_loss = 1.091179, source_hit@10 = 0.0529, source_ndcg@10 = 0.0252, target_hit@10 = 0.0955, target_ndcg@10 = 0.0482

2024-08-01 11:25:38.715447: step 4864/24320 (epoch 16/80), loss = 1.082433 (38.253 sec/epoch), lr: 0.003610
Evaluating on dev set...
...........................
source: 	 mrr: 0.032178	 ndcg_5: 0.0210	 ndcg_10: 0.0309	 hit@1:0.004345	 hit@5:0.0391	 hit@10: 0.0702
target: 	 mrr: 0.038665	 ndcg_5: 0.0294	 ndcg_10: 0.0389	 hit@1:0.009756	 hit@5:0.0474	 hit@10: 0.0767
epoch 16: train_loss = 1.082433, source_hit@10 = 0.0702, source_ndcg@10 = 0.0309, target_hit@10 = 0.0767, target_ndcg@10 = 0.0389

2024-08-01 11:26:18.021317: step 5168/24320 (epoch 17/80), loss = 1.071280 (38.928 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.034436	 ndcg_5: 0.0233	 ndcg_10: 0.0343	 hit@1:0.009413	 hit@5:0.0377	 hit@10: 0.0724
target: 	 mrr: 0.040668	 ndcg_5: 0.0330	 ndcg_10: 0.0441	 hit@1:0.010453	 hit@5:0.0544	 hit@10: 0.0885
epoch 17: train_loss = 1.071280, source_hit@10 = 0.0724, source_ndcg@10 = 0.0343, target_hit@10 = 0.0885, target_ndcg@10 = 0.0441

2024-08-01 11:26:57.166862: step 5472/24320 (epoch 18/80), loss = 1.065306 (38.808 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.037788	 ndcg_5: 0.0272	 ndcg_10: 0.0379	 hit@1:0.010862	 hit@5:0.0442	 hit@10: 0.0775
target: 	 mrr: 0.041653	 ndcg_5: 0.0316	 ndcg_10: 0.0459	 hit@1:0.011150	 hit@5:0.0530	 hit@10: 0.0976
epoch 18: train_loss = 1.065306, source_hit@10 = 0.0775, source_ndcg@10 = 0.0379, target_hit@10 = 0.0976, target_ndcg@10 = 0.0459

2024-08-01 11:27:36.217683: step 5776/24320 (epoch 19/80), loss = 1.061913 (38.716 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.023328	 ndcg_5: 0.0170	 ndcg_10: 0.0221	 hit@1:0.007965	 hit@5:0.0253	 hit@10: 0.0413
target: 	 mrr: 0.051212	 ndcg_5: 0.0413	 ndcg_10: 0.0564	 hit@1:0.018118	 hit@5:0.0634	 hit@10: 0.1101
target best!
..............target: 	 mrr: 0.055979	 ndcg_5: 0.0486	 ndcg_10: 0.0612	 hit@1:0.020576	 hit@5:0.0761	 hit@10: 0.1159
epoch 19: train_loss = 1.061913, source_hit@10 = 0.0413, source_ndcg@10 = 0.0221, target_hit@10 = 0.1159, target_ndcg@10 = 0.0612

2024-08-01 11:28:15.191772: step 6080/24320 (epoch 20/80), loss = 1.056323 (38.455 sec/epoch), lr: 0.003258
Evaluating on dev set...
...........................
source: 	 mrr: 0.034839	 ndcg_5: 0.0217	 ndcg_10: 0.0356	 hit@1:0.005069	 hit@5:0.0384	 hit@10: 0.0825
target: 	 mrr: 0.047617	 ndcg_5: 0.0389	 ndcg_10: 0.0507	 hit@1:0.020209	 hit@5:0.0571	 hit@10: 0.0941
epoch 20: train_loss = 1.056323, source_hit@10 = 0.0825, source_ndcg@10 = 0.0356, target_hit@10 = 0.0941, target_ndcg@10 = 0.0507

2024-08-01 11:28:54.598202: step 6384/24320 (epoch 21/80), loss = 1.056223 (39.070 sec/epoch), lr: 0.003258
Evaluating on dev set...
...........................
source: 	 mrr: 0.035772	 ndcg_5: 0.0237	 ndcg_10: 0.0355	 hit@1:0.008689	 hit@5:0.0377	 hit@10: 0.0746
target: 	 mrr: 0.044361	 ndcg_5: 0.0380	 ndcg_10: 0.0457	 hit@1:0.016028	 hit@5:0.0606	 hit@10: 0.0850
epoch 21: train_loss = 1.056223, source_hit@10 = 0.0746, source_ndcg@10 = 0.0355, target_hit@10 = 0.0850, target_ndcg@10 = 0.0457

2024-08-01 11:29:33.593056: step 6688/24320 (epoch 22/80), loss = 1.051626 (38.660 sec/epoch), lr: 0.003095
Evaluating on dev set...
...........................
source: 	 mrr: 0.038008	 ndcg_5: 0.0246	 ndcg_10: 0.0378	 hit@1:0.010862	 hit@5:0.0384	 hit@10: 0.0789
target: 	 mrr: 0.044067	 ndcg_5: 0.0342	 ndcg_10: 0.0501	 hit@1:0.013240	 hit@5:0.0557	 hit@10: 0.1059
epoch 22: train_loss = 1.051626, source_hit@10 = 0.0789, source_ndcg@10 = 0.0378, target_hit@10 = 0.1059, target_ndcg@10 = 0.0501

2024-08-01 11:30:13.190205: step 6992/24320 (epoch 23/80), loss = 1.051012 (39.264 sec/epoch), lr: 0.003095
Evaluating on dev set...
...........................
source: 	 mrr: 0.022779	 ndcg_5: 0.0117	 ndcg_10: 0.0197	 hit@1:0.003621	 hit@5:0.0203	 hit@10: 0.0449
target: 	 mrr: 0.040825	 ndcg_5: 0.0307	 ndcg_10: 0.0456	 hit@1:0.011150	 hit@5:0.0481	 hit@10: 0.0948
epoch 23: train_loss = 1.051012, source_hit@10 = 0.0449, source_ndcg@10 = 0.0197, target_hit@10 = 0.0948, target_ndcg@10 = 0.0456

2024-08-01 11:30:52.430282: step 7296/24320 (epoch 24/80), loss = 1.049231 (38.905 sec/epoch), lr: 0.002940
Evaluating on dev set...
...........................
source: 	 mrr: 0.037411	 ndcg_5: 0.0272	 ndcg_10: 0.0385	 hit@1:0.007241	 hit@5:0.0478	 hit@10: 0.0833
target: 	 mrr: 0.050454	 ndcg_5: 0.0422	 ndcg_10: 0.0549	 hit@1:0.015331	 hit@5:0.0683	 hit@10: 0.1080
epoch 24: train_loss = 1.049231, source_hit@10 = 0.0833, source_ndcg@10 = 0.0385, target_hit@10 = 0.1080, target_ndcg@10 = 0.0549

2024-08-01 11:31:30.651372: step 7600/24320 (epoch 25/80), loss = 1.047496 (37.864 sec/epoch), lr: 0.002940
Evaluating on dev set...
...........................
source: 	 mrr: 0.030074	 ndcg_5: 0.0215	 ndcg_10: 0.0296	 hit@1:0.007965	 hit@5:0.0348	 hit@10: 0.0601
target: 	 mrr: 0.048534	 ndcg_5: 0.0399	 ndcg_10: 0.0531	 hit@1:0.017422	 hit@5:0.0627	 hit@10: 0.1045
epoch 25: train_loss = 1.047496, source_hit@10 = 0.0601, source_ndcg@10 = 0.0296, target_hit@10 = 0.1045, target_ndcg@10 = 0.0531

2024-08-01 11:32:09.202080: step 7904/24320 (epoch 26/80), loss = 1.044991 (38.191 sec/epoch), lr: 0.002793
Evaluating on dev set...
...........................
source: 	 mrr: 0.030680	 ndcg_5: 0.0208	 ndcg_10: 0.0303	 hit@1:0.003621	 hit@5:0.0391	 hit@10: 0.0688
target: 	 mrr: 0.050063	 ndcg_5: 0.0427	 ndcg_10: 0.0560	 hit@1:0.014634	 hit@5:0.0690	 hit@10: 0.1108
epoch 26: train_loss = 1.044991, source_hit@10 = 0.0688, source_ndcg@10 = 0.0303, target_hit@10 = 0.1108, target_ndcg@10 = 0.0560

2024-08-01 11:32:47.815275: step 8208/24320 (epoch 27/80), loss = 1.045257 (38.276 sec/epoch), lr: 0.002793
Evaluating on dev set...
...........................
source: 	 mrr: 0.038878	 ndcg_5: 0.0268	 ndcg_10: 0.0398	 hit@1:0.009413	 hit@5:0.0456	 hit@10: 0.0862
target: 	 mrr: 0.041052	 ndcg_5: 0.0327	 ndcg_10: 0.0446	 hit@1:0.010453	 hit@5:0.0557	 hit@10: 0.0920
epoch 27: train_loss = 1.045257, source_hit@10 = 0.0862, source_ndcg@10 = 0.0398, target_hit@10 = 0.0920, target_ndcg@10 = 0.0446

2024-08-01 11:33:26.822771: step 8512/24320 (epoch 28/80), loss = 1.041053 (38.671 sec/epoch), lr: 0.002654
Evaluating on dev set...
...........................
source: 	 mrr: 0.032342	 ndcg_5: 0.0203	 ndcg_10: 0.0319	 hit@1:0.007241	 hit@5:0.0348	 hit@10: 0.0710
target: 	 mrr: 0.051945	 ndcg_5: 0.0445	 ndcg_10: 0.0590	 hit@1:0.017422	 hit@5:0.0711	 hit@10: 0.1157
target best!
..............target: 	 mrr: 0.057110	 ndcg_5: 0.0486	 ndcg_10: 0.0623	 hit@1:0.024691	 hit@5:0.0713	 hit@10: 0.1139
epoch 28: train_loss = 1.041053, source_hit@10 = 0.0710, source_ndcg@10 = 0.0319, target_hit@10 = 0.1139, target_ndcg@10 = 0.0623

2024-08-01 11:34:05.944005: step 8816/24320 (epoch 29/80), loss = 1.039909 (38.617 sec/epoch), lr: 0.002654
Evaluating on dev set...
...........................
source: 	 mrr: 0.036054	 ndcg_5: 0.0244	 ndcg_10: 0.0375	 hit@1:0.006517	 hit@5:0.0413	 hit@10: 0.0825
target: 	 mrr: 0.044235	 ndcg_5: 0.0383	 ndcg_10: 0.0474	 hit@1:0.012544	 hit@5:0.0634	 hit@10: 0.0913
epoch 29: train_loss = 1.039909, source_hit@10 = 0.0825, source_ndcg@10 = 0.0375, target_hit@10 = 0.0913, target_ndcg@10 = 0.0474

2024-08-01 11:34:44.283355: step 9120/24320 (epoch 30/80), loss = 1.038971 (37.999 sec/epoch), lr: 0.002521
Evaluating on dev set...
...........................
source: 	 mrr: 0.031989	 ndcg_5: 0.0186	 ndcg_10: 0.0310	 hit@1:0.006517	 hit@5:0.0311	 hit@10: 0.0695
target: 	 mrr: 0.046405	 ndcg_5: 0.0372	 ndcg_10: 0.0491	 hit@1:0.016725	 hit@5:0.0564	 hit@10: 0.0934
epoch 30: train_loss = 1.038971, source_hit@10 = 0.0695, source_ndcg@10 = 0.0310, target_hit@10 = 0.0934, target_ndcg@10 = 0.0491

2024-08-01 11:35:23.557710: step 9424/24320 (epoch 31/80), loss = 1.035920 (38.935 sec/epoch), lr: 0.002395
Evaluating on dev set...
...........................
source: 	 mrr: 0.034485	 ndcg_5: 0.0212	 ndcg_10: 0.0316	 hit@1:0.006517	 hit@5:0.0362	 hit@10: 0.0688
target: 	 mrr: 0.053518	 ndcg_5: 0.0449	 ndcg_10: 0.0602	 hit@1:0.020209	 hit@5:0.0697	 hit@10: 0.1171
target best!
..............target: 	 mrr: 0.055188	 ndcg_5: 0.0468	 ndcg_10: 0.0593	 hit@1:0.021948	 hit@5:0.0734	 hit@10: 0.1125
epoch 31: train_loss = 1.035920, source_hit@10 = 0.0688, source_ndcg@10 = 0.0316, target_hit@10 = 0.1125, target_ndcg@10 = 0.0593

2024-08-01 11:36:02.352522: step 9728/24320 (epoch 32/80), loss = 1.036539 (38.300 sec/epoch), lr: 0.002395
Evaluating on dev set...
...........................
source: 	 mrr: 0.031187	 ndcg_5: 0.0208	 ndcg_10: 0.0299	 hit@1:0.006517	 hit@5:0.0355	 hit@10: 0.0637
target: 	 mrr: 0.042664	 ndcg_5: 0.0320	 ndcg_10: 0.0438	 hit@1:0.014634	 hit@5:0.0495	 hit@10: 0.0864
epoch 32: train_loss = 1.036539, source_hit@10 = 0.0637, source_ndcg@10 = 0.0299, target_hit@10 = 0.0864, target_ndcg@10 = 0.0438

2024-08-01 11:36:41.276831: step 10032/24320 (epoch 33/80), loss = 1.033148 (38.591 sec/epoch), lr: 0.002275
Evaluating on dev set...
...........................
source: 	 mrr: 0.037377	 ndcg_5: 0.0267	 ndcg_10: 0.0362	 hit@1:0.011586	 hit@5:0.0434	 hit@10: 0.0739
target: 	 mrr: 0.047932	 ndcg_5: 0.0389	 ndcg_10: 0.0552	 hit@1:0.015331	 hit@5:0.0627	 hit@10: 0.1136
epoch 33: train_loss = 1.033148, source_hit@10 = 0.0739, source_ndcg@10 = 0.0362, target_hit@10 = 0.1136, target_ndcg@10 = 0.0552

2024-08-01 11:37:19.704508: step 10336/24320 (epoch 34/80), loss = 1.033499 (38.094 sec/epoch), lr: 0.002275
Evaluating on dev set...
...........................
source: 	 mrr: 0.032404	 ndcg_5: 0.0214	 ndcg_10: 0.0337	 hit@1:0.006517	 hit@5:0.0369	 hit@10: 0.0753
target: 	 mrr: 0.042673	 ndcg_5: 0.0340	 ndcg_10: 0.0451	 hit@1:0.013240	 hit@5:0.0557	 hit@10: 0.0906
epoch 34: train_loss = 1.033499, source_hit@10 = 0.0753, source_ndcg@10 = 0.0337, target_hit@10 = 0.0906, target_ndcg@10 = 0.0451

2024-08-01 11:37:59.439020: step 10640/24320 (epoch 35/80), loss = 1.029894 (39.380 sec/epoch), lr: 0.002161
Evaluating on dev set...
...........................
source: 	 mrr: 0.034913	 ndcg_5: 0.0207	 ndcg_10: 0.0333	 hit@1:0.010138	 hit@5:0.0304	 hit@10: 0.0702
target: 	 mrr: 0.046201	 ndcg_5: 0.0379	 ndcg_10: 0.0526	 hit@1:0.012544	 hit@5:0.0634	 hit@10: 0.1094
epoch 35: train_loss = 1.029894, source_hit@10 = 0.0702, source_ndcg@10 = 0.0333, target_hit@10 = 0.1094, target_ndcg@10 = 0.0526

2024-08-01 11:38:38.589057: step 10944/24320 (epoch 36/80), loss = 1.028474 (38.814 sec/epoch), lr: 0.002161
Evaluating on dev set...
...........................
source: 	 mrr: 0.034376	 ndcg_5: 0.0231	 ndcg_10: 0.0326	 hit@1:0.007241	 hit@5:0.0406	 hit@10: 0.0695
target: 	 mrr: 0.052201	 ndcg_5: 0.0450	 ndcg_10: 0.0568	 hit@1:0.018815	 hit@5:0.0711	 hit@10: 0.1073
epoch 36: train_loss = 1.028474, source_hit@10 = 0.0695, source_ndcg@10 = 0.0326, target_hit@10 = 0.1073, target_ndcg@10 = 0.0568

2024-08-01 11:39:17.660403: step 11248/24320 (epoch 37/80), loss = 1.027077 (38.735 sec/epoch), lr: 0.002161
Evaluating on dev set...
...........................
source: 	 mrr: 0.038850	 ndcg_5: 0.0293	 ndcg_10: 0.0396	 hit@1:0.007965	 hit@5:0.0507	 hit@10: 0.0833
target: 	 mrr: 0.047089	 ndcg_5: 0.0374	 ndcg_10: 0.0513	 hit@1:0.014634	 hit@5:0.0606	 hit@10: 0.1038
epoch 37: train_loss = 1.027077, source_hit@10 = 0.0833, source_ndcg@10 = 0.0396, target_hit@10 = 0.1038, target_ndcg@10 = 0.0513

2024-08-01 11:39:56.879967: step 11552/24320 (epoch 38/80), loss = 1.025582 (38.855 sec/epoch), lr: 0.002053
Evaluating on dev set...
...........................
source: 	 mrr: 0.035169	 ndcg_5: 0.0221	 ndcg_10: 0.0344	 hit@1:0.008689	 hit@5:0.0348	 hit@10: 0.0739
target: 	 mrr: 0.052080	 ndcg_5: 0.0450	 ndcg_10: 0.0583	 hit@1:0.016725	 hit@5:0.0725	 hit@10: 0.1136
epoch 38: train_loss = 1.025582, source_hit@10 = 0.0739, source_ndcg@10 = 0.0344, target_hit@10 = 0.1136, target_ndcg@10 = 0.0583

2024-08-01 11:40:34.797076: step 11856/24320 (epoch 39/80), loss = 1.027142 (37.580 sec/epoch), lr: 0.002053
Evaluating on dev set...
...........................
source: 	 mrr: 0.038853	 ndcg_5: 0.0281	 ndcg_10: 0.0392	 hit@1:0.008689	 hit@5:0.0463	 hit@10: 0.0811
target: 	 mrr: 0.046332	 ndcg_5: 0.0360	 ndcg_10: 0.0468	 hit@1:0.016028	 hit@5:0.0544	 hit@10: 0.0878
epoch 39: train_loss = 1.027142, source_hit@10 = 0.0811, source_ndcg@10 = 0.0392, target_hit@10 = 0.0878, target_ndcg@10 = 0.0468

2024-08-01 11:41:12.929700: step 12160/24320 (epoch 40/80), loss = 1.022096 (37.777 sec/epoch), lr: 0.001951
Evaluating on dev set...
...........................
source: 	 mrr: 0.033567	 ndcg_5: 0.0216	 ndcg_10: 0.0328	 hit@1:0.007965	 hit@5:0.0369	 hit@10: 0.0710
target: 	 mrr: 0.046699	 ndcg_5: 0.0382	 ndcg_10: 0.0514	 hit@1:0.014634	 hit@5:0.0613	 hit@10: 0.1031
epoch 40: train_loss = 1.022096, source_hit@10 = 0.0710, source_ndcg@10 = 0.0328, target_hit@10 = 0.1031, target_ndcg@10 = 0.0514

2024-08-01 11:41:51.674198: step 12464/24320 (epoch 41/80), loss = 1.020019 (38.406 sec/epoch), lr: 0.001853
Evaluating on dev set...
...........................
source: 	 mrr: 0.034634	 ndcg_5: 0.0195	 ndcg_10: 0.0349	 hit@1:0.007241	 hit@5:0.0311	 hit@10: 0.0789
target: 	 mrr: 0.049185	 ndcg_5: 0.0403	 ndcg_10: 0.0548	 hit@1:0.016028	 hit@5:0.0648	 hit@10: 0.1094
epoch 41: train_loss = 1.020019, source_hit@10 = 0.0789, source_ndcg@10 = 0.0349, target_hit@10 = 0.1094, target_ndcg@10 = 0.0548

2024-08-01 11:42:31.059940: step 12768/24320 (epoch 42/80), loss = 1.019032 (39.046 sec/epoch), lr: 0.001853
Evaluating on dev set...
...........................
source: 	 mrr: 0.033685	 ndcg_5: 0.0216	 ndcg_10: 0.0337	 hit@1:0.007241	 hit@5:0.0377	 hit@10: 0.0760
target: 	 mrr: 0.051044	 ndcg_5: 0.0421	 ndcg_10: 0.0534	 hit@1:0.020209	 hit@5:0.0641	 hit@10: 0.0997
epoch 42: train_loss = 1.019032, source_hit@10 = 0.0760, source_ndcg@10 = 0.0337, target_hit@10 = 0.0997, target_ndcg@10 = 0.0534

2024-08-01 11:43:10.182915: step 13072/24320 (epoch 43/80), loss = 1.018080 (38.784 sec/epoch), lr: 0.001853
Evaluating on dev set...
...........................
source: 	 mrr: 0.037018	 ndcg_5: 0.0253	 ndcg_10: 0.0368	 hit@1:0.010138	 hit@5:0.0420	 hit@10: 0.0782
target: 	 mrr: 0.056241	 ndcg_5: 0.0489	 ndcg_10: 0.0621	 hit@1:0.019512	 hit@5:0.0780	 hit@10: 0.1192
target best!
..............target: 	 mrr: 0.057337	 ndcg_5: 0.0479	 ndcg_10: 0.0631	 hit@1:0.019890	 hit@5:0.0748	 hit@10: 0.1214
epoch 43: train_loss = 1.018080, source_hit@10 = 0.0782, source_ndcg@10 = 0.0368, target_hit@10 = 0.1214, target_ndcg@10 = 0.0631

2024-08-01 11:43:48.819470: step 13376/24320 (epoch 44/80), loss = 1.017610 (38.152 sec/epoch), lr: 0.001853
Evaluating on dev set...
...........................
source: 	 mrr: 0.033682	 ndcg_5: 0.0191	 ndcg_10: 0.0317	 hit@1:0.006517	 hit@5:0.0319	 hit@10: 0.0710
target: 	 mrr: 0.050147	 ndcg_5: 0.0395	 ndcg_10: 0.0528	 hit@1:0.019512	 hit@5:0.0578	 hit@10: 0.0990
epoch 44: train_loss = 1.017610, source_hit@10 = 0.0710, source_ndcg@10 = 0.0317, target_hit@10 = 0.0990, target_ndcg@10 = 0.0528

2024-08-01 11:44:27.598408: step 13680/24320 (epoch 45/80), loss = 1.018326 (38.443 sec/epoch), lr: 0.001761
Evaluating on dev set...
...........................
source: 	 mrr: 0.031730	 ndcg_5: 0.0194	 ndcg_10: 0.0310	 hit@1:0.006517	 hit@5:0.0348	 hit@10: 0.0710
target: 	 mrr: 0.046090	 ndcg_5: 0.0392	 ndcg_10: 0.0521	 hit@1:0.011150	 hit@5:0.0669	 hit@10: 0.1066
epoch 45: train_loss = 1.018326, source_hit@10 = 0.0710, source_ndcg@10 = 0.0310, target_hit@10 = 0.1066, target_ndcg@10 = 0.0521

2024-08-01 11:45:06.128926: step 13984/24320 (epoch 46/80), loss = 1.014587 (38.191 sec/epoch), lr: 0.001672
Evaluating on dev set...
...........................
source: 	 mrr: 0.035259	 ndcg_5: 0.0222	 ndcg_10: 0.0340	 hit@1:0.008689	 hit@5:0.0369	 hit@10: 0.0739
target: 	 mrr: 0.050010	 ndcg_5: 0.0431	 ndcg_10: 0.0544	 hit@1:0.019512	 hit@5:0.0697	 hit@10: 0.1045
epoch 46: train_loss = 1.014587, source_hit@10 = 0.0739, source_ndcg@10 = 0.0340, target_hit@10 = 0.1045, target_ndcg@10 = 0.0544

2024-08-01 11:45:44.923465: step 14288/24320 (epoch 47/80), loss = 1.013681 (38.452 sec/epoch), lr: 0.001672
Evaluating on dev set...
...........................
source: 	 mrr: 0.038202	 ndcg_5: 0.0272	 ndcg_10: 0.0374	 hit@1:0.010138	 hit@5:0.0442	 hit@10: 0.0760
target: 	 mrr: 0.050000	 ndcg_5: 0.0434	 ndcg_10: 0.0549	 hit@1:0.016725	 hit@5:0.0711	 hit@10: 0.1066
epoch 47: train_loss = 1.013681, source_hit@10 = 0.0760, source_ndcg@10 = 0.0374, target_hit@10 = 0.1066, target_ndcg@10 = 0.0549

2024-08-01 11:46:24.204557: step 14592/24320 (epoch 48/80), loss = 1.012001 (38.902 sec/epoch), lr: 0.001672
Evaluating on dev set...
...........................
source: 	 mrr: 0.025422	 ndcg_5: 0.0168	 ndcg_10: 0.0227	 hit@1:0.004345	 hit@5:0.0290	 hit@10: 0.0471
target: 	 mrr: 0.050458	 ndcg_5: 0.0421	 ndcg_10: 0.0546	 hit@1:0.016725	 hit@5:0.0676	 hit@10: 0.1066
epoch 48: train_loss = 1.012001, source_hit@10 = 0.0471, source_ndcg@10 = 0.0227, target_hit@10 = 0.1066, target_ndcg@10 = 0.0546

2024-08-01 11:47:03.220149: step 14896/24320 (epoch 49/80), loss = 1.011675 (38.680 sec/epoch), lr: 0.001589
Evaluating on dev set...
...........................
source: 	 mrr: 0.039489	 ndcg_5: 0.0263	 ndcg_10: 0.0407	 hit@1:0.012310	 hit@5:0.0413	 hit@10: 0.0862
target: 	 mrr: 0.052867	 ndcg_5: 0.0449	 ndcg_10: 0.0576	 hit@1:0.020209	 hit@5:0.0697	 hit@10: 0.1094
epoch 49: train_loss = 1.011675, source_hit@10 = 0.0862, source_ndcg@10 = 0.0407, target_hit@10 = 0.1094, target_ndcg@10 = 0.0576

2024-08-01 11:47:42.266473: step 15200/24320 (epoch 50/80), loss = 1.011058 (38.684 sec/epoch), lr: 0.001589
Evaluating on dev set...
...........................
source: 	 mrr: 0.039197	 ndcg_5: 0.0286	 ndcg_10: 0.0399	 hit@1:0.008689	 hit@5:0.0478	 hit@10: 0.0833
target: 	 mrr: 0.053995	 ndcg_5: 0.0445	 ndcg_10: 0.0579	 hit@1:0.019512	 hit@5:0.0683	 hit@10: 0.1101
epoch 50: train_loss = 1.011058, source_hit@10 = 0.0833, source_ndcg@10 = 0.0399, target_hit@10 = 0.1101, target_ndcg@10 = 0.0579
shift to transfer learning mode

2024-08-01 11:48:22.351755: step 15504/24320 (epoch 51/80), loss = 1.008648 (39.716 sec/epoch), lr: 0.001589
Evaluating on dev set...
...........................
source: 	 mrr: 0.031128	 ndcg_5: 0.0188	 ndcg_10: 0.0273	 hit@1:0.007241	 hit@5:0.0319	 hit@10: 0.0587
target: 	 mrr: 0.052106	 ndcg_5: 0.0416	 ndcg_10: 0.0574	 hit@1:0.019512	 hit@5:0.0641	 hit@10: 0.1129
epoch 51: train_loss = 1.008648, source_hit@10 = 0.0587, source_ndcg@10 = 0.0273, target_hit@10 = 0.1129, target_ndcg@10 = 0.0574

2024-08-01 11:49:02.362175: step 15808/24320 (epoch 52/80), loss = 1.008474 (39.675 sec/epoch), lr: 0.001509
Evaluating on dev set...
...........................
source: 	 mrr: 0.035860	 ndcg_5: 0.0253	 ndcg_10: 0.0341	 hit@1:0.007965	 hit@5:0.0420	 hit@10: 0.0695
target: 	 mrr: 0.050499	 ndcg_5: 0.0445	 ndcg_10: 0.0556	 hit@1:0.017422	 hit@5:0.0732	 hit@10: 0.1080
epoch 52: train_loss = 1.008474, source_hit@10 = 0.0695, source_ndcg@10 = 0.0341, target_hit@10 = 0.1080, target_ndcg@10 = 0.0556

2024-08-01 11:49:41.796713: step 16112/24320 (epoch 53/80), loss = 1.007357 (39.089 sec/epoch), lr: 0.001509
Evaluating on dev set...
...........................
source: 	 mrr: 0.039627	 ndcg_5: 0.0298	 ndcg_10: 0.0409	 hit@1:0.008689	 hit@5:0.0507	 hit@10: 0.0862
target: 	 mrr: 0.051943	 ndcg_5: 0.0430	 ndcg_10: 0.0560	 hit@1:0.020209	 hit@5:0.0662	 hit@10: 0.1066
epoch 53: train_loss = 1.007357, source_hit@10 = 0.0862, source_ndcg@10 = 0.0409, target_hit@10 = 0.1066, target_ndcg@10 = 0.0560

2024-08-01 11:50:18.804745: step 16416/24320 (epoch 54/80), loss = 1.006507 (36.671 sec/epoch), lr: 0.001509
Evaluating on dev set...
...........................
source: 	 mrr: 0.035764	 ndcg_5: 0.0257	 ndcg_10: 0.0356	 hit@1:0.010862	 hit@5:0.0413	 hit@10: 0.0724
target: 	 mrr: 0.057967	 ndcg_5: 0.0502	 ndcg_10: 0.0640	 hit@1:0.024390	 hit@5:0.0753	 hit@10: 0.1185
target best!
..............target: 	 mrr: 0.057255	 ndcg_5: 0.0503	 ndcg_10: 0.0631	 hit@1:0.021948	 hit@5:0.0802	 hit@10: 0.1200
epoch 54: train_loss = 1.006507, source_hit@10 = 0.0724, source_ndcg@10 = 0.0356, target_hit@10 = 0.1200, target_ndcg@10 = 0.0631
early termination of training
