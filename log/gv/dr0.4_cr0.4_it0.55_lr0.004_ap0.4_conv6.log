nohup: ignoring input
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:54: UserWarning: An issue occurred while importing 'pyg-lib'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'pyg-lib'. "
/home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/torch_geometric/typing.py:110: UserWarning: An issue occurred while importing 'torch-sparse'. Disabling its usage. Stacktrace: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home1/lhr/anaconda3/envs/torch/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'torch-sparse'. "
using gpu:7 to train the model
using gpu:7 to train the model
cuda:7
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.4, batch_size=1024, beta_inter=0.55, conv_layers=6, cuda=True, decay_epoch=10, device=device(type='cuda', index=7), device_id='7', domains='game_video', dropout=0.4, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='gv', momentum=0.98, num_latent_factors=3, num_negative=100, optim='adam', patience=20, proj_layers=1, projection=1, rectify_epoch=30, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
/home1/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:72: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /opt/conda/conda-bld/pytorch_1711403590347/work/torch/csrc/utils/tensor_new.cpp:618.)
  return torch.sparse.FloatTensor(indices, values, shape)
real graph loaded!
number_user 19457
number_item 8751
real graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
2024-08-07 16:14:47.701759: step 304/24320 (epoch 1/80), loss = 1.372610 (116.000 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.029166	 ndcg_5: 0.0172	 ndcg_10: 0.0276	 hit@1:0.007241	 hit@5:0.0282	 hit@10: 0.0608
target: 	 mrr: 0.031044	 ndcg_5: 0.0219	 ndcg_10: 0.0311	 hit@1:0.011150	 hit@5:0.0334	 hit@10: 0.0620
source best!
.............
source: 	 mrr: 0.033407	 ndcg_5: 0.0221	 ndcg_10: 0.0331	 hit@1:0.008436	 hit@5:0.0360	 hit@10: 0.0698
target best!
..............target: 	 mrr: 0.029428	 ndcg_5: 0.0219	 ndcg_10: 0.0295	 hit@1:0.006859	 hit@5:0.0364	 hit@10: 0.0604
epoch 1: train_loss = 1.372610, source_hit@10 = 0.0698, source_ndcg@10 = 0.0331, target_hit@10 = 0.0604, target_ndcg@10 = 0.0295

2024-08-07 16:16:42.919133: step 608/24320 (epoch 2/80), loss = 1.199851 (113.205 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.031559	 ndcg_5: 0.0207	 ndcg_10: 0.0314	 hit@1:0.005793	 hit@5:0.0348	 hit@10: 0.0688
target: 	 mrr: 0.022923	 ndcg_5: 0.0145	 ndcg_10: 0.0205	 hit@1:0.006969	 hit@5:0.0223	 hit@10: 0.0411
source best!
.............
source: 	 mrr: 0.032439	 ndcg_5: 0.0225	 ndcg_10: 0.0310	 hit@1:0.007669	 hit@5:0.0383	 hit@10: 0.0644
epoch 2: train_loss = 1.199851, source_hit@10 = 0.0644, source_ndcg@10 = 0.0310, target_hit@10 = 0.0411, target_ndcg@10 = 0.0205
new best model saved.

2024-08-07 16:18:37.701549: step 912/24320 (epoch 3/80), loss = 1.179053 (113.615 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.027956	 ndcg_5: 0.0205	 ndcg_10: 0.0254	 hit@1:0.005793	 hit@5:0.0340	 hit@10: 0.0492
target: 	 mrr: 0.027509	 ndcg_5: 0.0176	 ndcg_10: 0.0252	 hit@1:0.006969	 hit@5:0.0293	 hit@10: 0.0530
epoch 3: train_loss = 1.179053, source_hit@10 = 0.0492, source_ndcg@10 = 0.0254, target_hit@10 = 0.0530, target_ndcg@10 = 0.0252

2024-08-07 16:20:32.991092: step 1216/24320 (epoch 4/80), loss = 1.165986 (114.462 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.035232	 ndcg_5: 0.0265	 ndcg_10: 0.0360	 hit@1:0.007241	 hit@5:0.0463	 hit@10: 0.0760
target: 	 mrr: 0.031478	 ndcg_5: 0.0223	 ndcg_10: 0.0301	 hit@1:0.011847	 hit@5:0.0334	 hit@10: 0.0578
source best!
.............
source: 	 mrr: 0.034606	 ndcg_5: 0.0255	 ndcg_10: 0.0330	 hit@1:0.010736	 hit@5:0.0406	 hit@10: 0.0644
target best!
..............target: 	 mrr: 0.027688	 ndcg_5: 0.0178	 ndcg_10: 0.0260	 hit@1:0.007545	 hit@5:0.0288	 hit@10: 0.0549
epoch 4: train_loss = 1.165986, source_hit@10 = 0.0644, source_ndcg@10 = 0.0330, target_hit@10 = 0.0549, target_ndcg@10 = 0.0260
new best model saved.

2024-08-07 16:22:27.797483: step 1520/24320 (epoch 5/80), loss = 1.148465 (113.281 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.033957	 ndcg_5: 0.0213	 ndcg_10: 0.0317	 hit@1:0.009413	 hit@5:0.0326	 hit@10: 0.0652
target: 	 mrr: 0.033159	 ndcg_5: 0.0254	 ndcg_10: 0.0327	 hit@1:0.009059	 hit@5:0.0404	 hit@10: 0.0634
target best!
..............target: 	 mrr: 0.036833	 ndcg_5: 0.0292	 ndcg_10: 0.0378	 hit@1:0.014403	 hit@5:0.0446	 hit@10: 0.0713
epoch 5: train_loss = 1.148465, source_hit@10 = 0.0652, source_ndcg@10 = 0.0317, target_hit@10 = 0.0713, target_ndcg@10 = 0.0378
new best model saved.

2024-08-07 16:24:21.638362: step 1824/24320 (epoch 6/80), loss = 1.135685 (112.661 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.024514	 ndcg_5: 0.0142	 ndcg_10: 0.0249	 hit@1:0.002172	 hit@5:0.0261	 hit@10: 0.0594
target: 	 mrr: 0.033120	 ndcg_5: 0.0251	 ndcg_10: 0.0333	 hit@1:0.011150	 hit@5:0.0404	 hit@10: 0.0655
epoch 6: train_loss = 1.135685, source_hit@10 = 0.0594, source_ndcg@10 = 0.0249, target_hit@10 = 0.0655, target_ndcg@10 = 0.0333

2024-08-07 16:26:15.875249: step 2128/24320 (epoch 7/80), loss = 1.119651 (113.493 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.020058	 ndcg_5: 0.0122	 ndcg_10: 0.0171	 hit@1:0.005793	 hit@5:0.0196	 hit@10: 0.0348
target: 	 mrr: 0.036720	 ndcg_5: 0.0267	 ndcg_10: 0.0386	 hit@1:0.010453	 hit@5:0.0439	 hit@10: 0.0808
target best!
..............target: 	 mrr: 0.041343	 ndcg_5: 0.0320	 ndcg_10: 0.0446	 hit@1:0.013032	 hit@5:0.0508	 hit@10: 0.0898
epoch 7: train_loss = 1.119651, source_hit@10 = 0.0348, source_ndcg@10 = 0.0171, target_hit@10 = 0.0898, target_ndcg@10 = 0.0446
new best model saved.

2024-08-07 16:28:09.871123: step 2432/24320 (epoch 8/80), loss = 1.109959 (112.823 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032613	 ndcg_5: 0.0195	 ndcg_10: 0.0311	 hit@1:0.007965	 hit@5:0.0304	 hit@10: 0.0673
target: 	 mrr: 0.037719	 ndcg_5: 0.0279	 ndcg_10: 0.0406	 hit@1:0.009059	 hit@5:0.0474	 hit@10: 0.0878
target best!
..............target: 	 mrr: 0.038245	 ndcg_5: 0.0264	 ndcg_10: 0.0398	 hit@1:0.011660	 hit@5:0.0418	 hit@10: 0.0830
epoch 8: train_loss = 1.109959, source_hit@10 = 0.0673, source_ndcg@10 = 0.0311, target_hit@10 = 0.0830, target_ndcg@10 = 0.0398
new best model saved.

2024-08-07 16:30:06.479255: step 2736/24320 (epoch 9/80), loss = 1.104790 (115.342 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.028158	 ndcg_5: 0.0167	 ndcg_10: 0.0254	 hit@1:0.005793	 hit@5:0.0268	 hit@10: 0.0543
target: 	 mrr: 0.043821	 ndcg_5: 0.0346	 ndcg_10: 0.0452	 hit@1:0.016028	 hit@5:0.0523	 hit@10: 0.0857
target best!
..............target: 	 mrr: 0.042500	 ndcg_5: 0.0330	 ndcg_10: 0.0441	 hit@1:0.013717	 hit@5:0.0535	 hit@10: 0.0885
epoch 9: train_loss = 1.104790, source_hit@10 = 0.0543, source_ndcg@10 = 0.0254, target_hit@10 = 0.0885, target_ndcg@10 = 0.0441
new best model saved.

2024-08-07 16:31:59.546885: step 3040/24320 (epoch 10/80), loss = 1.100000 (111.867 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.039718	 ndcg_5: 0.0306	 ndcg_10: 0.0410	 hit@1:0.010138	 hit@5:0.0514	 hit@10: 0.0840
target: 	 mrr: 0.038139	 ndcg_5: 0.0301	 ndcg_10: 0.0404	 hit@1:0.009756	 hit@5:0.0502	 hit@10: 0.0829
source best!
.............
source: 	 mrr: 0.035858	 ndcg_5: 0.0251	 ndcg_10: 0.0349	 hit@1:0.007669	 hit@5:0.0429	 hit@10: 0.0736
epoch 10: train_loss = 1.100000, source_hit@10 = 0.0736, source_ndcg@10 = 0.0349, target_hit@10 = 0.0829, target_ndcg@10 = 0.0404
new best model saved.

2024-08-07 16:33:53.375294: step 3344/24320 (epoch 11/80), loss = 1.100098 (112.462 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032432	 ndcg_5: 0.0211	 ndcg_10: 0.0333	 hit@1:0.008689	 hit@5:0.0348	 hit@10: 0.0731
target: 	 mrr: 0.038142	 ndcg_5: 0.0286	 ndcg_10: 0.0402	 hit@1:0.013240	 hit@5:0.0446	 hit@10: 0.0808
epoch 11: train_loss = 1.100098, source_hit@10 = 0.0731, source_ndcg@10 = 0.0333, target_hit@10 = 0.0808, target_ndcg@10 = 0.0402

2024-08-07 16:35:46.967888: step 3648/24320 (epoch 12/80), loss = 1.095331 (112.874 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.037631	 ndcg_5: 0.0277	 ndcg_10: 0.0400	 hit@1:0.009413	 hit@5:0.0478	 hit@10: 0.0862
target: 	 mrr: 0.042459	 ndcg_5: 0.0342	 ndcg_10: 0.0445	 hit@1:0.015331	 hit@5:0.0523	 hit@10: 0.0850
epoch 12: train_loss = 1.095331, source_hit@10 = 0.0862, source_ndcg@10 = 0.0400, target_hit@10 = 0.0850, target_ndcg@10 = 0.0445

2024-08-07 16:37:42.484817: step 3952/24320 (epoch 13/80), loss = 1.094979 (114.736 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.034427	 ndcg_5: 0.0236	 ndcg_10: 0.0321	 hit@1:0.007965	 hit@5:0.0391	 hit@10: 0.0659
target: 	 mrr: 0.042222	 ndcg_5: 0.0330	 ndcg_10: 0.0438	 hit@1:0.016028	 hit@5:0.0509	 hit@10: 0.0836
epoch 13: train_loss = 1.094979, source_hit@10 = 0.0659, source_ndcg@10 = 0.0321, target_hit@10 = 0.0836, target_ndcg@10 = 0.0438

2024-08-07 16:39:36.795281: step 4256/24320 (epoch 14/80), loss = 1.091319 (113.627 sec/epoch), lr: 0.003610
Evaluating on dev set...
...........................
source: 	 mrr: 0.018832	 ndcg_5: 0.0063	 ndcg_10: 0.0134	 hit@1:0.002896	 hit@5:0.0101	 hit@10: 0.0326
target: 	 mrr: 0.018325	 ndcg_5: 0.0101	 ndcg_10: 0.0143	 hit@1:0.002787	 hit@5:0.0174	 hit@10: 0.0300
epoch 14: train_loss = 1.091319, source_hit@10 = 0.0326, source_ndcg@10 = 0.0134, target_hit@10 = 0.0300, target_ndcg@10 = 0.0143

2024-08-07 16:41:36.546715: step 4560/24320 (epoch 15/80), loss = 1.089043 (118.934 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.035635	 ndcg_5: 0.0250	 ndcg_10: 0.0366	 hit@1:0.007965	 hit@5:0.0420	 hit@10: 0.0782
target: 	 mrr: 0.049019	 ndcg_5: 0.0399	 ndcg_10: 0.0516	 hit@1:0.020906	 hit@5:0.0613	 hit@10: 0.0976
target best!
..............target: 	 mrr: 0.053840	 ndcg_5: 0.0442	 ndcg_10: 0.0552	 hit@1:0.025377	 hit@5:0.0638	 hit@10: 0.0981
epoch 15: train_loss = 1.089043, source_hit@10 = 0.0782, source_ndcg@10 = 0.0366, target_hit@10 = 0.0981, target_ndcg@10 = 0.0552
new best model saved.

2024-08-07 16:43:37.644616: step 4864/24320 (epoch 16/80), loss = 1.088282 (119.814 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.034951	 ndcg_5: 0.0234	 ndcg_10: 0.0346	 hit@1:0.006517	 hit@5:0.0398	 hit@10: 0.0746
target: 	 mrr: 0.032465	 ndcg_5: 0.0231	 ndcg_10: 0.0323	 hit@1:0.011847	 hit@5:0.0355	 hit@10: 0.0641
epoch 16: train_loss = 1.088282, source_hit@10 = 0.0746, source_ndcg@10 = 0.0346, target_hit@10 = 0.0641, target_ndcg@10 = 0.0323

2024-08-07 16:45:35.905884: step 5168/24320 (epoch 17/80), loss = 1.084268 (117.357 sec/epoch), lr: 0.003258
Evaluating on dev set...
...........................
source: 	 mrr: 0.033643	 ndcg_5: 0.0208	 ndcg_10: 0.0343	 hit@1:0.007241	 hit@5:0.0348	 hit@10: 0.0775
target: 	 mrr: 0.031896	 ndcg_5: 0.0243	 ndcg_10: 0.0353	 hit@1:0.009756	 hit@5:0.0404	 hit@10: 0.0753
epoch 17: train_loss = 1.084268, source_hit@10 = 0.0775, source_ndcg@10 = 0.0343, target_hit@10 = 0.0753, target_ndcg@10 = 0.0353

2024-08-07 16:47:32.883357: step 5472/24320 (epoch 18/80), loss = 1.082350 (116.261 sec/epoch), lr: 0.003095
Evaluating on dev set...
...........................
source: 	 mrr: 0.039078	 ndcg_5: 0.0256	 ndcg_10: 0.0391	 hit@1:0.008689	 hit@5:0.0420	 hit@10: 0.0847
target: 	 mrr: 0.040616	 ndcg_5: 0.0304	 ndcg_10: 0.0444	 hit@1:0.012544	 hit@5:0.0495	 hit@10: 0.0927
epoch 18: train_loss = 1.082350, source_hit@10 = 0.0847, source_ndcg@10 = 0.0391, target_hit@10 = 0.0927, target_ndcg@10 = 0.0444

2024-08-07 16:49:27.678433: step 5776/24320 (epoch 19/80), loss = 1.081201 (113.950 sec/epoch), lr: 0.003095
Evaluating on dev set...
...........................
source: 	 mrr: 0.039832	 ndcg_5: 0.0275	 ndcg_10: 0.0379	 hit@1:0.013034	 hit@5:0.0406	 hit@10: 0.0731
target: 	 mrr: 0.048144	 ndcg_5: 0.0402	 ndcg_10: 0.0522	 hit@1:0.017422	 hit@5:0.0627	 hit@10: 0.1003
source best!
.............
source: 	 mrr: 0.034709	 ndcg_5: 0.0228	 ndcg_10: 0.0342	 hit@1:0.009202	 hit@5:0.0376	 hit@10: 0.0729
epoch 19: train_loss = 1.081201, source_hit@10 = 0.0729, source_ndcg@10 = 0.0342, target_hit@10 = 0.1003, target_ndcg@10 = 0.0522
new best model saved.

2024-08-07 16:51:27.643040: step 6080/24320 (epoch 20/80), loss = 1.080848 (118.747 sec/epoch), lr: 0.003095
Evaluating on dev set...
...........................
source: 	 mrr: 0.027668	 ndcg_5: 0.0161	 ndcg_10: 0.0241	 hit@1:0.007241	 hit@5:0.0246	 hit@10: 0.0492
target: 	 mrr: 0.057569	 ndcg_5: 0.0477	 ndcg_10: 0.0623	 hit@1:0.027178	 hit@5:0.0683	 hit@10: 0.1143
target best!
..............target: 	 mrr: 0.050503	 ndcg_5: 0.0394	 ndcg_10: 0.0530	 hit@1:0.018519	 hit@5:0.0597	 hit@10: 0.1022
epoch 20: train_loss = 1.080848, source_hit@10 = 0.0492, source_ndcg@10 = 0.0241, target_hit@10 = 0.1022, target_ndcg@10 = 0.0530
new best model saved.

2024-08-07 16:53:29.554018: step 6384/24320 (epoch 21/80), loss = 1.076863 (120.751 sec/epoch), lr: 0.002940
Evaluating on dev set...
...........................
source: 	 mrr: 0.022200	 ndcg_5: 0.0120	 ndcg_10: 0.0204	 hit@1:0.005069	 hit@5:0.0188	 hit@10: 0.0449
target: 	 mrr: 0.055181	 ndcg_5: 0.0472	 ndcg_10: 0.0602	 hit@1:0.022300	 hit@5:0.0718	 hit@10: 0.1122
epoch 21: train_loss = 1.076863, source_hit@10 = 0.0449, source_ndcg@10 = 0.0204, target_hit@10 = 0.1122, target_ndcg@10 = 0.0602

2024-08-07 16:55:31.269348: step 6688/24320 (epoch 22/80), loss = 1.074695 (120.968 sec/epoch), lr: 0.002793
Evaluating on dev set...
...........................
source: 	 mrr: 0.034414	 ndcg_5: 0.0243	 ndcg_10: 0.0353	 hit@1:0.005793	 hit@5:0.0442	 hit@10: 0.0789
target: 	 mrr: 0.046697	 ndcg_5: 0.0379	 ndcg_10: 0.0496	 hit@1:0.014634	 hit@5:0.0599	 hit@10: 0.0962
epoch 22: train_loss = 1.074695, source_hit@10 = 0.0789, source_ndcg@10 = 0.0353, target_hit@10 = 0.0962, target_ndcg@10 = 0.0496

2024-08-07 16:57:33.057224: step 6992/24320 (epoch 23/80), loss = 1.073086 (121.024 sec/epoch), lr: 0.002793
Evaluating on dev set...
...........................
source: 	 mrr: 0.020250	 ndcg_5: 0.0107	 ndcg_10: 0.0163	 hit@1:0.002172	 hit@5:0.0203	 hit@10: 0.0384
target: 	 mrr: 0.039269	 ndcg_5: 0.0282	 ndcg_10: 0.0399	 hit@1:0.013240	 hit@5:0.0425	 hit@10: 0.0787
epoch 23: train_loss = 1.073086, source_hit@10 = 0.0384, source_ndcg@10 = 0.0163, target_hit@10 = 0.0787, target_ndcg@10 = 0.0399

2024-08-07 16:59:34.816841: step 7296/24320 (epoch 24/80), loss = 1.070617 (120.961 sec/epoch), lr: 0.002654
Evaluating on dev set...
...........................
source: 	 mrr: 0.035674	 ndcg_5: 0.0236	 ndcg_10: 0.0357	 hit@1:0.007965	 hit@5:0.0406	 hit@10: 0.0789
target: 	 mrr: 0.047252	 ndcg_5: 0.0405	 ndcg_10: 0.0518	 hit@1:0.016028	 hit@5:0.0662	 hit@10: 0.1010
epoch 24: train_loss = 1.070617, source_hit@10 = 0.0789, source_ndcg@10 = 0.0357, target_hit@10 = 0.1010, target_ndcg@10 = 0.0518

2024-08-07 17:01:39.964034: step 7600/24320 (epoch 25/80), loss = 1.069616 (124.315 sec/epoch), lr: 0.002654
Evaluating on dev set...
...........................
source: 	 mrr: 0.040205	 ndcg_5: 0.0316	 ndcg_10: 0.0410	 hit@1:0.009413	 hit@5:0.0536	 hit@10: 0.0825
target: 	 mrr: 0.045434	 ndcg_5: 0.0366	 ndcg_10: 0.0489	 hit@1:0.015331	 hit@5:0.0592	 hit@10: 0.0976
source best!
.............
source: 	 mrr: 0.035142	 ndcg_5: 0.0228	 ndcg_10: 0.0330	 hit@1:0.009969	 hit@5:0.0353	 hit@10: 0.0667
epoch 25: train_loss = 1.069616, source_hit@10 = 0.0667, source_ndcg@10 = 0.0330, target_hit@10 = 0.0976, target_ndcg@10 = 0.0489
new best model saved.

2024-08-07 17:03:43.715552: step 7904/24320 (epoch 26/80), loss = 1.066821 (122.397 sec/epoch), lr: 0.002654
Evaluating on dev set...
...........................
source: 	 mrr: 0.044967	 ndcg_5: 0.0348	 ndcg_10: 0.0470	 hit@1:0.013758	 hit@5:0.0565	 hit@10: 0.0949
target: 	 mrr: 0.053910	 ndcg_5: 0.0465	 ndcg_10: 0.0576	 hit@1:0.018815	 hit@5:0.0739	 hit@10: 0.1080
source best!
.............
source: 	 mrr: 0.044926	 ndcg_5: 0.0339	 ndcg_10: 0.0461	 hit@1:0.014571	 hit@5:0.0521	 hit@10: 0.0897
epoch 26: train_loss = 1.066821, source_hit@10 = 0.0897, source_ndcg@10 = 0.0461, target_hit@10 = 0.1080, target_ndcg@10 = 0.0576
new best model saved.

2024-08-07 17:05:52.812382: step 8208/24320 (epoch 27/80), loss = 1.071216 (127.943 sec/epoch), lr: 0.002654
Evaluating on dev set...
...........................
source: 	 mrr: 0.037005	 ndcg_5: 0.0275	 ndcg_10: 0.0382	 hit@1:0.011586	 hit@5:0.0427	 hit@10: 0.0768
target: 	 mrr: 0.040456	 ndcg_5: 0.0314	 ndcg_10: 0.0414	 hit@1:0.013937	 hit@5:0.0495	 hit@10: 0.0815
epoch 27: train_loss = 1.071216, source_hit@10 = 0.0768, source_ndcg@10 = 0.0382, target_hit@10 = 0.0815, target_ndcg@10 = 0.0414

2024-08-07 17:07:53.510019: step 8512/24320 (epoch 28/80), loss = 1.065210 (119.903 sec/epoch), lr: 0.002521
Evaluating on dev set...
...........................
source: 	 mrr: 0.034551	 ndcg_5: 0.0225	 ndcg_10: 0.0335	 hit@1:0.009413	 hit@5:0.0362	 hit@10: 0.0710
target: 	 mrr: 0.058447	 ndcg_5: 0.0497	 ndcg_10: 0.0645	 hit@1:0.023693	 hit@5:0.0746	 hit@10: 0.1206
target best!
..............target: 	 mrr: 0.057238	 ndcg_5: 0.0520	 ndcg_10: 0.0620	 hit@1:0.020576	 hit@5:0.0830	 hit@10: 0.1145
epoch 28: train_loss = 1.065210, source_hit@10 = 0.0710, source_ndcg@10 = 0.0335, target_hit@10 = 0.1145, target_ndcg@10 = 0.0620
new best model saved.

2024-08-07 17:09:48.408327: step 8816/24320 (epoch 29/80), loss = 1.066222 (113.594 sec/epoch), lr: 0.002521
Evaluating on dev set...
...........................
source: 	 mrr: 0.038097	 ndcg_5: 0.0298	 ndcg_10: 0.0379	 hit@1:0.010138	 hit@5:0.0507	 hit@10: 0.0760
target: 	 mrr: 0.035313	 ndcg_5: 0.0269	 ndcg_10: 0.0354	 hit@1:0.011150	 hit@5:0.0425	 hit@10: 0.0690
epoch 29: train_loss = 1.066222, source_hit@10 = 0.0760, source_ndcg@10 = 0.0379, target_hit@10 = 0.0690, target_ndcg@10 = 0.0354

2024-08-07 17:11:43.604708: step 9120/24320 (epoch 30/80), loss = 1.064605 (114.276 sec/epoch), lr: 0.002395
Evaluating on dev set...
...........................
source: 	 mrr: 0.039635	 ndcg_5: 0.0305	 ndcg_10: 0.0388	 hit@1:0.010862	 hit@5:0.0492	 hit@10: 0.0753
target: 	 mrr: 0.040540	 ndcg_5: 0.0287	 ndcg_10: 0.0421	 hit@1:0.013937	 hit@5:0.0439	 hit@10: 0.0857
epoch 30: train_loss = 1.064605, source_hit@10 = 0.0753, source_ndcg@10 = 0.0388, target_hit@10 = 0.0857, target_ndcg@10 = 0.0421
shift to transfer learning mode

2024-08-07 17:13:52.770798: step 9424/24320 (epoch 31/80), loss = 1.063627 (128.348 sec/epoch), lr: 0.002395
Evaluating on dev set...
...........................
source: 	 mrr: 0.035831	 ndcg_5: 0.0247	 ndcg_10: 0.0359	 hit@1:0.008689	 hit@5:0.0420	 hit@10: 0.0768
target: 	 mrr: 0.041971	 ndcg_5: 0.0328	 ndcg_10: 0.0443	 hit@1:0.013240	 hit@5:0.0544	 hit@10: 0.0899
epoch 31: train_loss = 1.063627, source_hit@10 = 0.0768, source_ndcg@10 = 0.0359, target_hit@10 = 0.0899, target_ndcg@10 = 0.0443

2024-08-07 17:16:00.236982: step 9728/24320 (epoch 32/80), loss = 1.062311 (126.727 sec/epoch), lr: 0.002275
Evaluating on dev set...
...........................
source: 	 mrr: 0.039773	 ndcg_5: 0.0275	 ndcg_10: 0.0396	 hit@1:0.010138	 hit@5:0.0456	 hit@10: 0.0833
target: 	 mrr: 0.034032	 ndcg_5: 0.0226	 ndcg_10: 0.0335	 hit@1:0.013240	 hit@5:0.0328	 hit@10: 0.0669
epoch 32: train_loss = 1.062311, source_hit@10 = 0.0833, source_ndcg@10 = 0.0396, target_hit@10 = 0.0669, target_ndcg@10 = 0.0335

2024-08-07 17:18:11.688242: step 10032/24320 (epoch 33/80), loss = 1.058407 (130.714 sec/epoch), lr: 0.002161
Evaluating on dev set...
...........................
source: 	 mrr: 0.025657	 ndcg_5: 0.0168	 ndcg_10: 0.0236	 hit@1:0.006517	 hit@5:0.0275	 hit@10: 0.0485
target: 	 mrr: 0.045138	 ndcg_5: 0.0376	 ndcg_10: 0.0499	 hit@1:0.013240	 hit@5:0.0606	 hit@10: 0.0990
epoch 33: train_loss = 1.058407, source_hit@10 = 0.0485, source_ndcg@10 = 0.0236, target_hit@10 = 0.0990, target_ndcg@10 = 0.0499

2024-08-07 17:20:20.043976: step 10336/24320 (epoch 34/80), loss = 1.054183 (127.499 sec/epoch), lr: 0.002053
Evaluating on dev set...
...........................
source: 	 mrr: 0.037905	 ndcg_5: 0.0273	 ndcg_10: 0.0388	 hit@1:0.010138	 hit@5:0.0449	 hit@10: 0.0811
target: 	 mrr: 0.046413	 ndcg_5: 0.0382	 ndcg_10: 0.0508	 hit@1:0.014634	 hit@5:0.0634	 hit@10: 0.1024
epoch 34: train_loss = 1.054183, source_hit@10 = 0.0811, source_ndcg@10 = 0.0388, target_hit@10 = 0.1024, target_ndcg@10 = 0.0508

2024-08-07 17:22:31.337208: step 10640/24320 (epoch 35/80), loss = 1.052039 (130.563 sec/epoch), lr: 0.002053
Evaluating on dev set...
...........................
source: 	 mrr: 0.020079	 ndcg_5: 0.0112	 ndcg_10: 0.0192	 hit@1:0.002896	 hit@5:0.0203	 hit@10: 0.0449
target: 	 mrr: 0.044391	 ndcg_5: 0.0345	 ndcg_10: 0.0495	 hit@1:0.012544	 hit@5:0.0571	 hit@10: 0.1038
epoch 35: train_loss = 1.052039, source_hit@10 = 0.0449, source_ndcg@10 = 0.0192, target_hit@10 = 0.1038, target_ndcg@10 = 0.0495

2024-08-07 17:24:32.527004: step 10944/24320 (epoch 36/80), loss = 1.050269 (120.305 sec/epoch), lr: 0.001951
Evaluating on dev set...
...........................
source: 	 mrr: 0.036649	 ndcg_5: 0.0293	 ndcg_10: 0.0367	 hit@1:0.012310	 hit@5:0.0471	 hit@10: 0.0710
target: 	 mrr: 0.056149	 ndcg_5: 0.0487	 ndcg_10: 0.0617	 hit@1:0.023693	 hit@5:0.0746	 hit@10: 0.1150
epoch 36: train_loss = 1.050269, source_hit@10 = 0.0710, source_ndcg@10 = 0.0367, target_hit@10 = 0.1150, target_ndcg@10 = 0.0617

2024-08-07 17:26:35.438049: step 11248/24320 (epoch 37/80), loss = 1.049525 (122.109 sec/epoch), lr: 0.001951
Evaluating on dev set...
...........................
source: 	 mrr: 0.045969	 ndcg_5: 0.0348	 ndcg_10: 0.0487	 hit@1:0.013758	 hit@5:0.0558	 hit@10: 0.0992
target: 	 mrr: 0.059610	 ndcg_5: 0.0508	 ndcg_10: 0.0643	 hit@1:0.025784	 hit@5:0.0746	 hit@10: 0.1164
source best!
.............
source: 	 mrr: 0.052165	 ndcg_5: 0.0414	 ndcg_10: 0.0548	 hit@1:0.020706	 hit@5:0.0613	 hit@10: 0.1035
target best!
..............target: 	 mrr: 0.056220	 ndcg_5: 0.0477	 ndcg_10: 0.0632	 hit@1:0.020576	 hit@5:0.0748	 hit@10: 0.1228
epoch 37: train_loss = 1.049525, source_hit@10 = 0.1035, source_ndcg@10 = 0.0548, target_hit@10 = 0.1228, target_ndcg@10 = 0.0632
new best model saved.

2024-08-07 17:28:35.270713: step 11552/24320 (epoch 38/80), loss = 1.047987 (118.119 sec/epoch), lr: 0.001951
Evaluating on dev set...
...........................
source: 	 mrr: 0.027584	 ndcg_5: 0.0173	 ndcg_10: 0.0249	 hit@1:0.004345	 hit@5:0.0311	 hit@10: 0.0550
target: 	 mrr: 0.050906	 ndcg_5: 0.0428	 ndcg_10: 0.0565	 hit@1:0.018815	 hit@5:0.0676	 hit@10: 0.1101
epoch 38: train_loss = 1.047987, source_hit@10 = 0.0550, source_ndcg@10 = 0.0249, target_hit@10 = 0.1101, target_ndcg@10 = 0.0565

2024-08-07 17:30:39.015212: step 11856/24320 (epoch 39/80), loss = 1.045195 (123.027 sec/epoch), lr: 0.001853
Evaluating on dev set...
...........................
source: 	 mrr: 0.039793	 ndcg_5: 0.0274	 ndcg_10: 0.0409	 hit@1:0.009413	 hit@5:0.0478	 hit@10: 0.0898
target: 	 mrr: 0.052146	 ndcg_5: 0.0463	 ndcg_10: 0.0557	 hit@1:0.022300	 hit@5:0.0704	 hit@10: 0.0997
epoch 39: train_loss = 1.045195, source_hit@10 = 0.0898, source_ndcg@10 = 0.0409, target_hit@10 = 0.0997, target_ndcg@10 = 0.0557

2024-08-07 17:32:42.508449: step 12160/24320 (epoch 40/80), loss = 1.046005 (122.677 sec/epoch), lr: 0.001853
Evaluating on dev set...
...........................
source: 	 mrr: 0.040447	 ndcg_5: 0.0301	 ndcg_10: 0.0402	 hit@1:0.011586	 hit@5:0.0500	 hit@10: 0.0811
target: 	 mrr: 0.051996	 ndcg_5: 0.0445	 ndcg_10: 0.0583	 hit@1:0.018815	 hit@5:0.0697	 hit@10: 0.1129
epoch 40: train_loss = 1.046005, source_hit@10 = 0.0811, source_ndcg@10 = 0.0402, target_hit@10 = 0.1129, target_ndcg@10 = 0.0583

2024-08-07 17:34:39.044805: step 12464/24320 (epoch 41/80), loss = 1.043526 (115.831 sec/epoch), lr: 0.001853
Evaluating on dev set...
...........................
source: 	 mrr: 0.043040	 ndcg_5: 0.0319	 ndcg_10: 0.0414	 hit@1:0.014482	 hit@5:0.0500	 hit@10: 0.0789
target: 	 mrr: 0.043947	 ndcg_5: 0.0321	 ndcg_10: 0.0472	 hit@1:0.015331	 hit@5:0.0474	 hit@10: 0.0948
epoch 41: train_loss = 1.043526, source_hit@10 = 0.0789, source_ndcg@10 = 0.0414, target_hit@10 = 0.0948, target_ndcg@10 = 0.0472

2024-08-07 17:36:41.132589: step 12768/24320 (epoch 42/80), loss = 1.043207 (121.224 sec/epoch), lr: 0.001761
Evaluating on dev set...
...........................
source: 	 mrr: 0.045776	 ndcg_5: 0.0336	 ndcg_10: 0.0461	 hit@1:0.014482	 hit@5:0.0529	 hit@10: 0.0920
target: 	 mrr: 0.052670	 ndcg_5: 0.0447	 ndcg_10: 0.0542	 hit@1:0.022300	 hit@5:0.0641	 hit@10: 0.0934
epoch 42: train_loss = 1.043207, source_hit@10 = 0.0920, source_ndcg@10 = 0.0461, target_hit@10 = 0.0934, target_ndcg@10 = 0.0542

2024-08-07 17:38:39.537521: step 13072/24320 (epoch 43/80), loss = 1.040043 (117.621 sec/epoch), lr: 0.001761
Evaluating on dev set...
...........................
source: 	 mrr: 0.039323	 ndcg_5: 0.0292	 ndcg_10: 0.0408	 hit@1:0.007241	 hit@5:0.0514	 hit@10: 0.0876
target: 	 mrr: 0.048173	 ndcg_5: 0.0390	 ndcg_10: 0.0518	 hit@1:0.018118	 hit@5:0.0620	 hit@10: 0.1017
epoch 43: train_loss = 1.040043, source_hit@10 = 0.0876, source_ndcg@10 = 0.0408, target_hit@10 = 0.1017, target_ndcg@10 = 0.0518

2024-08-07 17:40:34.258084: step 13376/24320 (epoch 44/80), loss = 1.037601 (113.954 sec/epoch), lr: 0.001672
Evaluating on dev set...
...........................
source: 	 mrr: 0.028607	 ndcg_5: 0.0172	 ndcg_10: 0.0239	 hit@1:0.009413	 hit@5:0.0253	 hit@10: 0.0463
target: 	 mrr: 0.048464	 ndcg_5: 0.0398	 ndcg_10: 0.0516	 hit@1:0.020209	 hit@5:0.0606	 hit@10: 0.0976
epoch 44: train_loss = 1.037601, source_hit@10 = 0.0463, source_ndcg@10 = 0.0239, target_hit@10 = 0.0976, target_ndcg@10 = 0.0516

2024-08-07 17:42:26.241137: step 13680/24320 (epoch 45/80), loss = 1.035946 (111.215 sec/epoch), lr: 0.001589
Evaluating on dev set...
...........................
source: 	 mrr: 0.038436	 ndcg_5: 0.0262	 ndcg_10: 0.0392	 hit@1:0.010862	 hit@5:0.0427	 hit@10: 0.0825
target: 	 mrr: 0.052289	 ndcg_5: 0.0450	 ndcg_10: 0.0555	 hit@1:0.021603	 hit@5:0.0676	 hit@10: 0.1003
epoch 45: train_loss = 1.035946, source_hit@10 = 0.0825, source_ndcg@10 = 0.0392, target_hit@10 = 0.1003, target_ndcg@10 = 0.0555

2024-08-07 17:44:19.065897: step 13984/24320 (epoch 46/80), loss = 1.034165 (112.079 sec/epoch), lr: 0.001589
Evaluating on dev set...
...........................
source: 	 mrr: 0.037539	 ndcg_5: 0.0281	 ndcg_10: 0.0360	 hit@1:0.010862	 hit@5:0.0449	 hit@10: 0.0702
target: 	 mrr: 0.045720	 ndcg_5: 0.0379	 ndcg_10: 0.0488	 hit@1:0.018815	 hit@5:0.0585	 hit@10: 0.0934
epoch 46: train_loss = 1.034165, source_hit@10 = 0.0702, source_ndcg@10 = 0.0360, target_hit@10 = 0.0934, target_ndcg@10 = 0.0488

2024-08-07 17:46:10.541039: step 14288/24320 (epoch 47/80), loss = 1.032909 (110.740 sec/epoch), lr: 0.001509
Evaluating on dev set...
...........................
source: 	 mrr: 0.042504	 ndcg_5: 0.0295	 ndcg_10: 0.0446	 hit@1:0.011586	 hit@5:0.0471	 hit@10: 0.0949
target: 	 mrr: 0.042374	 ndcg_5: 0.0330	 ndcg_10: 0.0465	 hit@1:0.011847	 hit@5:0.0557	 hit@10: 0.0976
epoch 47: train_loss = 1.032909, source_hit@10 = 0.0949, source_ndcg@10 = 0.0446, target_hit@10 = 0.0976, target_ndcg@10 = 0.0465

