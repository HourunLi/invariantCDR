nohup: ignoring input
using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, beta_inter=0.4, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=1), device_id='1', domains='game_video', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_critic=0.4, leakey=0.01, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='gv', momentum=0.98, num_latent_factors=3, num_negative=100, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 19457
number_item 8751
real graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
2024-08-02 10:59:02.788838: step 304/24320 (epoch 1/80), loss = 1.395777 (38.336 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.026847	 ndcg_5: 0.0171	 ndcg_10: 0.0250	 hit@1:0.005793	 hit@5:0.0319	 hit@10: 0.0572
target: 	 mrr: 0.034847	 ndcg_5: 0.0255	 ndcg_10: 0.0355	 hit@1:0.011847	 hit@5:0.0397	 hit@10: 0.0711
source best!
.............
source: 	 mrr: 0.032580	 ndcg_5: 0.0214	 ndcg_10: 0.0325	 hit@1:0.009969	 hit@5:0.0337	 hit@10: 0.0683
target best!
..............target: 	 mrr: 0.036274	 ndcg_5: 0.0292	 ndcg_10: 0.0367	 hit@1:0.010974	 hit@5:0.0466	 hit@10: 0.0700
epoch 1: train_loss = 1.395777, source_hit@10 = 0.0683, source_ndcg@10 = 0.0325, target_hit@10 = 0.0700, target_ndcg@10 = 0.0367

2024-08-02 10:59:42.472807: step 608/24320 (epoch 2/80), loss = 1.234216 (39.064 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032340	 ndcg_5: 0.0226	 ndcg_10: 0.0315	 hit@1:0.007241	 hit@5:0.0369	 hit@10: 0.0652
target: 	 mrr: 0.026957	 ndcg_5: 0.0166	 ndcg_10: 0.0236	 hit@1:0.011150	 hit@5:0.0223	 hit@10: 0.0439
source best!
.............
source: 	 mrr: 0.034584	 ndcg_5: 0.0234	 ndcg_10: 0.0352	 hit@1:0.009202	 hit@5:0.0376	 hit@10: 0.0744
epoch 2: train_loss = 1.234216, source_hit@10 = 0.0744, source_ndcg@10 = 0.0352, target_hit@10 = 0.0439, target_ndcg@10 = 0.0236

2024-08-02 11:00:21.606072: step 912/24320 (epoch 3/80), loss = 1.187069 (38.669 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.027573	 ndcg_5: 0.0158	 ndcg_10: 0.0256	 hit@1:0.003621	 hit@5:0.0290	 hit@10: 0.0601
target: 	 mrr: 0.029988	 ndcg_5: 0.0223	 ndcg_10: 0.0309	 hit@1:0.008362	 hit@5:0.0348	 hit@10: 0.0627
epoch 3: train_loss = 1.187069, source_hit@10 = 0.0601, source_ndcg@10 = 0.0256, target_hit@10 = 0.0627, target_ndcg@10 = 0.0309

2024-08-02 11:01:00.909719: step 1216/24320 (epoch 4/80), loss = 1.169398 (38.950 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032463	 ndcg_5: 0.0237	 ndcg_10: 0.0311	 hit@1:0.007241	 hit@5:0.0406	 hit@10: 0.0637
target: 	 mrr: 0.033325	 ndcg_5: 0.0222	 ndcg_10: 0.0338	 hit@1:0.009059	 hit@5:0.0369	 hit@10: 0.0739
source best!
.............
source: 	 mrr: 0.035331	 ndcg_5: 0.0270	 ndcg_10: 0.0365	 hit@1:0.009202	 hit@5:0.0445	 hit@10: 0.0744
epoch 4: train_loss = 1.169398, source_hit@10 = 0.0744, source_ndcg@10 = 0.0365, target_hit@10 = 0.0739, target_ndcg@10 = 0.0338

2024-08-02 11:01:39.844159: step 1520/24320 (epoch 5/80), loss = 1.157890 (38.464 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032147	 ndcg_5: 0.0219	 ndcg_10: 0.0304	 hit@1:0.008689	 hit@5:0.0362	 hit@10: 0.0630
target: 	 mrr: 0.034998	 ndcg_5: 0.0226	 ndcg_10: 0.0329	 hit@1:0.013240	 hit@5:0.0328	 hit@10: 0.0648
target best!
..............target: 	 mrr: 0.042929	 ndcg_5: 0.0338	 ndcg_10: 0.0436	 hit@1:0.017833	 hit@5:0.0501	 hit@10: 0.0809
epoch 5: train_loss = 1.157890, source_hit@10 = 0.0630, source_ndcg@10 = 0.0304, target_hit@10 = 0.0809, target_ndcg@10 = 0.0436

2024-08-02 11:02:17.860949: step 1824/24320 (epoch 6/80), loss = 1.138428 (37.538 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.035862	 ndcg_5: 0.0246	 ndcg_10: 0.0328	 hit@1:0.011586	 hit@5:0.0369	 hit@10: 0.0630
target: 	 mrr: 0.044769	 ndcg_5: 0.0359	 ndcg_10: 0.0459	 hit@1:0.017422	 hit@5:0.0544	 hit@10: 0.0850
source best!
.............
source: 	 mrr: 0.035245	 ndcg_5: 0.0247	 ndcg_10: 0.0346	 hit@1:0.010736	 hit@5:0.0399	 hit@10: 0.0713
target best!
..............target: 	 mrr: 0.040603	 ndcg_5: 0.0303	 ndcg_10: 0.0430	 hit@1:0.014403	 hit@5:0.0466	 hit@10: 0.0864
epoch 6: train_loss = 1.138428, source_hit@10 = 0.0713, source_ndcg@10 = 0.0346, target_hit@10 = 0.0864, target_ndcg@10 = 0.0430
new best model saved.

2024-08-02 11:02:54.580300: step 2128/24320 (epoch 7/80), loss = 1.123706 (35.958 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.035959	 ndcg_5: 0.0262	 ndcg_10: 0.0374	 hit@1:0.010138	 hit@5:0.0434	 hit@10: 0.0789
target: 	 mrr: 0.040642	 ndcg_5: 0.0306	 ndcg_10: 0.0412	 hit@1:0.013240	 hit@5:0.0474	 hit@10: 0.0801
source best!
.............
source: 	 mrr: 0.035883	 ndcg_5: 0.0261	 ndcg_10: 0.0364	 hit@1:0.010736	 hit@5:0.0429	 hit@10: 0.0752
epoch 7: train_loss = 1.123706, source_hit@10 = 0.0752, source_ndcg@10 = 0.0364, target_hit@10 = 0.0801, target_ndcg@10 = 0.0412

2024-08-02 11:03:32.600210: step 2432/24320 (epoch 8/80), loss = 1.115577 (37.563 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.030547	 ndcg_5: 0.0237	 ndcg_10: 0.0312	 hit@1:0.007965	 hit@5:0.0398	 hit@10: 0.0637
target: 	 mrr: 0.048384	 ndcg_5: 0.0394	 ndcg_10: 0.0518	 hit@1:0.016725	 hit@5:0.0606	 hit@10: 0.0990
target best!
..............target: 	 mrr: 0.044364	 ndcg_5: 0.0344	 ndcg_10: 0.0482	 hit@1:0.011660	 hit@5:0.0556	 hit@10: 0.0981
epoch 8: train_loss = 1.115577, source_hit@10 = 0.0637, source_ndcg@10 = 0.0312, target_hit@10 = 0.0981, target_ndcg@10 = 0.0482

2024-08-02 11:04:10.048998: step 2736/24320 (epoch 9/80), loss = 1.110920 (36.965 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.034006	 ndcg_5: 0.0262	 ndcg_10: 0.0349	 hit@1:0.008689	 hit@5:0.0434	 hit@10: 0.0702
target: 	 mrr: 0.052686	 ndcg_5: 0.0446	 ndcg_10: 0.0581	 hit@1:0.018118	 hit@5:0.0697	 hit@10: 0.1115
target best!
..............target: 	 mrr: 0.053524	 ndcg_5: 0.0454	 ndcg_10: 0.0598	 hit@1:0.019890	 hit@5:0.0713	 hit@10: 0.1159
epoch 9: train_loss = 1.110920, source_hit@10 = 0.0702, source_ndcg@10 = 0.0349, target_hit@10 = 0.1159, target_ndcg@10 = 0.0598
new best model saved.

2024-08-02 11:04:48.192973: step 3040/24320 (epoch 10/80), loss = 1.106442 (37.514 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032713	 ndcg_5: 0.0214	 ndcg_10: 0.0318	 hit@1:0.007965	 hit@5:0.0355	 hit@10: 0.0681
target: 	 mrr: 0.044829	 ndcg_5: 0.0349	 ndcg_10: 0.0479	 hit@1:0.013937	 hit@5:0.0564	 hit@10: 0.0969
epoch 10: train_loss = 1.106442, source_hit@10 = 0.0681, source_ndcg@10 = 0.0318, target_hit@10 = 0.0969, target_ndcg@10 = 0.0479

2024-08-02 11:05:25.201489: step 3344/24320 (epoch 11/80), loss = 1.104732 (36.680 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.034156	 ndcg_5: 0.0243	 ndcg_10: 0.0322	 hit@1:0.011586	 hit@5:0.0391	 hit@10: 0.0637
target: 	 mrr: 0.044653	 ndcg_5: 0.0345	 ndcg_10: 0.0471	 hit@1:0.014634	 hit@5:0.0544	 hit@10: 0.0934
epoch 11: train_loss = 1.104732, source_hit@10 = 0.0637, source_ndcg@10 = 0.0322, target_hit@10 = 0.0934, target_ndcg@10 = 0.0471

2024-08-02 11:06:02.555691: step 3648/24320 (epoch 12/80), loss = 1.102476 (37.026 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.030248	 ndcg_5: 0.0205	 ndcg_10: 0.0299	 hit@1:0.007241	 hit@5:0.0340	 hit@10: 0.0630
target: 	 mrr: 0.038493	 ndcg_5: 0.0284	 ndcg_10: 0.0381	 hit@1:0.011847	 hit@5:0.0453	 hit@10: 0.0753
epoch 12: train_loss = 1.102476, source_hit@10 = 0.0630, source_ndcg@10 = 0.0299, target_hit@10 = 0.0753, target_ndcg@10 = 0.0381

2024-08-02 11:06:40.122339: step 3952/24320 (epoch 13/80), loss = 1.099809 (37.235 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.033542	 ndcg_5: 0.0241	 ndcg_10: 0.0337	 hit@1:0.007241	 hit@5:0.0406	 hit@10: 0.0702
target: 	 mrr: 0.039941	 ndcg_5: 0.0291	 ndcg_10: 0.0436	 hit@1:0.009059	 hit@5:0.0481	 hit@10: 0.0934
epoch 13: train_loss = 1.099809, source_hit@10 = 0.0702, source_ndcg@10 = 0.0337, target_hit@10 = 0.0934, target_ndcg@10 = 0.0436

2024-08-02 11:07:15.986167: step 4256/24320 (epoch 14/80), loss = 1.098587 (35.532 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.031710	 ndcg_5: 0.0219	 ndcg_10: 0.0312	 hit@1:0.007965	 hit@5:0.0377	 hit@10: 0.0666
target: 	 mrr: 0.059444	 ndcg_5: 0.0510	 ndcg_10: 0.0616	 hit@1:0.026481	 hit@5:0.0746	 hit@10: 0.1073
target best!
..............target: 	 mrr: 0.054808	 ndcg_5: 0.0463	 ndcg_10: 0.0593	 hit@1:0.019890	 hit@5:0.0741	 hit@10: 0.1139
epoch 14: train_loss = 1.098587, source_hit@10 = 0.0666, source_ndcg@10 = 0.0312, target_hit@10 = 0.1139, target_ndcg@10 = 0.0593
new best model saved.

2024-08-02 11:07:52.873615: step 4560/24320 (epoch 15/80), loss = 1.095547 (36.263 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.028507	 ndcg_5: 0.0208	 ndcg_10: 0.0283	 hit@1:0.006517	 hit@5:0.0369	 hit@10: 0.0608
target: 	 mrr: 0.044412	 ndcg_5: 0.0377	 ndcg_10: 0.0513	 hit@1:0.009756	 hit@5:0.0662	 hit@10: 0.1087
epoch 15: train_loss = 1.095547, source_hit@10 = 0.0608, source_ndcg@10 = 0.0283, target_hit@10 = 0.1087, target_ndcg@10 = 0.0513

2024-08-02 11:08:28.777816: step 4864/24320 (epoch 16/80), loss = 1.092058 (35.575 sec/epoch), lr: 0.003610
Evaluating on dev set...
...........................
source: 	 mrr: 0.034139	 ndcg_5: 0.0246	 ndcg_10: 0.0351	 hit@1:0.007965	 hit@5:0.0427	 hit@10: 0.0760
target: 	 mrr: 0.053615	 ndcg_5: 0.0445	 ndcg_10: 0.0573	 hit@1:0.022300	 hit@5:0.0683	 hit@10: 0.1080
epoch 16: train_loss = 1.092058, source_hit@10 = 0.0760, source_ndcg@10 = 0.0351, target_hit@10 = 0.1080, target_ndcg@10 = 0.0573

2024-08-02 11:09:04.653876: step 5168/24320 (epoch 17/80), loss = 1.087792 (35.546 sec/epoch), lr: 0.003610
Evaluating on dev set...
...........................
source: 	 mrr: 0.030849	 ndcg_5: 0.0203	 ndcg_10: 0.0315	 hit@1:0.004345	 hit@5:0.0355	 hit@10: 0.0702
target: 	 mrr: 0.049658	 ndcg_5: 0.0418	 ndcg_10: 0.0564	 hit@1:0.015331	 hit@5:0.0676	 hit@10: 0.1136
epoch 17: train_loss = 1.087792, source_hit@10 = 0.0702, source_ndcg@10 = 0.0315, target_hit@10 = 0.1136, target_ndcg@10 = 0.0564

2024-08-02 11:09:40.450252: step 5472/24320 (epoch 18/80), loss = 1.083446 (35.461 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.033190	 ndcg_5: 0.0223	 ndcg_10: 0.0314	 hit@1:0.007241	 hit@5:0.0369	 hit@10: 0.0659
target: 	 mrr: 0.056533	 ndcg_5: 0.0520	 ndcg_10: 0.0609	 hit@1:0.020906	 hit@5:0.0836	 hit@10: 0.1115
epoch 18: train_loss = 1.083446, source_hit@10 = 0.0659, source_ndcg@10 = 0.0314, target_hit@10 = 0.1115, target_ndcg@10 = 0.0609

2024-08-02 11:10:16.620179: step 5776/24320 (epoch 19/80), loss = 1.081602 (35.840 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.033886	 ndcg_5: 0.0246	 ndcg_10: 0.0315	 hit@1:0.008689	 hit@5:0.0398	 hit@10: 0.0615
target: 	 mrr: 0.052842	 ndcg_5: 0.0457	 ndcg_10: 0.0549	 hit@1:0.020906	 hit@5:0.0704	 hit@10: 0.0990
epoch 19: train_loss = 1.081602, source_hit@10 = 0.0615, source_ndcg@10 = 0.0315, target_hit@10 = 0.0990, target_ndcg@10 = 0.0549

2024-08-02 11:10:54.128643: step 6080/24320 (epoch 20/80), loss = 1.077395 (37.175 sec/epoch), lr: 0.003258
Evaluating on dev set...
...........................
source: 	 mrr: 0.031106	 ndcg_5: 0.0207	 ndcg_10: 0.0300	 hit@1:0.010862	 hit@5:0.0311	 hit@10: 0.0601
target: 	 mrr: 0.057009	 ndcg_5: 0.0488	 ndcg_10: 0.0610	 hit@1:0.023693	 hit@5:0.0725	 hit@10: 0.1101
epoch 20: train_loss = 1.077395, source_hit@10 = 0.0601, source_ndcg@10 = 0.0300, target_hit@10 = 0.1101, target_ndcg@10 = 0.0610

