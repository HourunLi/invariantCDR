nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, alpha=0.5, batch_size=1024, batch_tau=0.2, beta_inter=0.55, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=0), device_id='0', domains='game_video', dropout=0.4, epoch=80, feature_dim=126, hidden_dim=126, k_tau=0.4, lambda_critic=0.4, leakey=0.05, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='gv', momentum=0.98, num_latent_factors=3, num_negative=100, optim='adam', patience=20, proj_layers=1, projection=1, rectify_epoch=30, residual=1, save=False, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 19457
number_item 8751
real graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
2024-08-09 12:59:09.624057: step 304/24320 (epoch 1/80), loss = 2.527237 (33.907 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.014174	 ndcg_5: 0.0077	 ndcg_10: 0.0127	 hit@1:0.002172	 hit@5:0.0138	 hit@10: 0.0290
target: 	 mrr: 0.032353	 ndcg_5: 0.0267	 ndcg_10: 0.0319	 hit@1:0.009756	 hit@5:0.0425	 hit@10: 0.0585
source best!
.............
source: 	 mrr: 0.014807	 ndcg_5: 0.0093	 ndcg_10: 0.0132	 hit@1:0.001534	 hit@5:0.0176	 hit@10: 0.0299
target best!
..............target: 	 mrr: 0.028707	 ndcg_5: 0.0190	 ndcg_10: 0.0279	 hit@1:0.010288	 hit@5:0.0281	 hit@10: 0.0556
epoch 1: train_loss = 2.527237, source_hit@10 = 0.0299, source_ndcg@10 = 0.0132, target_hit@10 = 0.0556, target_ndcg@10 = 0.0279

2024-08-09 12:59:43.484943: step 608/24320 (epoch 2/80), loss = 1.901109 (33.334 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.015841	 ndcg_5: 0.0081	 ndcg_10: 0.0111	 hit@1:0.003621	 hit@5:0.0123	 hit@10: 0.0217
target: 	 mrr: 0.025193	 ndcg_5: 0.0162	 ndcg_10: 0.0256	 hit@1:0.006969	 hit@5:0.0258	 hit@10: 0.0551
source best!
.............
source: 	 mrr: 0.017024	 ndcg_5: 0.0082	 ndcg_10: 0.0122	 hit@1:0.003067	 hit@5:0.0130	 hit@10: 0.0253
epoch 2: train_loss = 1.901109, source_hit@10 = 0.0253, source_ndcg@10 = 0.0122, target_hit@10 = 0.0551, target_ndcg@10 = 0.0256
new best model saved.

2024-08-09 13:00:18.350397: step 912/24320 (epoch 3/80), loss = 1.769697 (34.354 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.015398	 ndcg_5: 0.0086	 ndcg_10: 0.0117	 hit@1:0.002172	 hit@5:0.0152	 hit@10: 0.0246
target: 	 mrr: 0.027073	 ndcg_5: 0.0201	 ndcg_10: 0.0264	 hit@1:0.007666	 hit@5:0.0328	 hit@10: 0.0523
epoch 3: train_loss = 1.769697, source_hit@10 = 0.0246, source_ndcg@10 = 0.0117, target_hit@10 = 0.0523, target_ndcg@10 = 0.0264

2024-08-09 13:00:52.130899: step 1216/24320 (epoch 4/80), loss = 1.700506 (33.485 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.034391	 ndcg_5: 0.0259	 ndcg_10: 0.0328	 hit@1:0.007965	 hit@5:0.0442	 hit@10: 0.0659
target: 	 mrr: 0.037800	 ndcg_5: 0.0306	 ndcg_10: 0.0383	 hit@1:0.013240	 hit@5:0.0467	 hit@10: 0.0711
source best!
.............
source: 	 mrr: 0.031230	 ndcg_5: 0.0209	 ndcg_10: 0.0295	 hit@1:0.006135	 hit@5:0.0353	 hit@10: 0.0621
target best!
..............target: 	 mrr: 0.038590	 ndcg_5: 0.0322	 ndcg_10: 0.0399	 hit@1:0.011660	 hit@5:0.0508	 hit@10: 0.0748
epoch 4: train_loss = 1.700506, source_hit@10 = 0.0621, source_ndcg@10 = 0.0295, target_hit@10 = 0.0748, target_ndcg@10 = 0.0399
new best model saved.

2024-08-09 13:01:26.678348: step 1520/24320 (epoch 5/80), loss = 1.648872 (33.927 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.025710	 ndcg_5: 0.0159	 ndcg_10: 0.0249	 hit@1:0.003621	 hit@5:0.0290	 hit@10: 0.0572
target: 	 mrr: 0.027537	 ndcg_5: 0.0190	 ndcg_10: 0.0261	 hit@1:0.009059	 hit@5:0.0293	 hit@10: 0.0516
epoch 5: train_loss = 1.648872, source_hit@10 = 0.0572, source_ndcg@10 = 0.0249, target_hit@10 = 0.0516, target_ndcg@10 = 0.0261

2024-08-09 13:02:00.947747: step 1824/24320 (epoch 6/80), loss = 1.607302 (33.984 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.019923	 ndcg_5: 0.0113	 ndcg_10: 0.0152	 hit@1:0.004345	 hit@5:0.0188	 hit@10: 0.0311
target: 	 mrr: 0.044906	 ndcg_5: 0.0354	 ndcg_10: 0.0474	 hit@1:0.016725	 hit@5:0.0537	 hit@10: 0.0913
target best!
..............target: 	 mrr: 0.046628	 ndcg_5: 0.0375	 ndcg_10: 0.0494	 hit@1:0.018519	 hit@5:0.0569	 hit@10: 0.0940
epoch 6: train_loss = 1.607302, source_hit@10 = 0.0311, source_ndcg@10 = 0.0152, target_hit@10 = 0.0940, target_ndcg@10 = 0.0494
new best model saved.

2024-08-09 13:02:35.207617: step 2128/24320 (epoch 7/80), loss = 1.576320 (33.749 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.024155	 ndcg_5: 0.0135	 ndcg_10: 0.0221	 hit@1:0.005793	 hit@5:0.0224	 hit@10: 0.0500
target: 	 mrr: 0.030237	 ndcg_5: 0.0228	 ndcg_10: 0.0303	 hit@1:0.009059	 hit@5:0.0362	 hit@10: 0.0592
epoch 7: train_loss = 1.576320, source_hit@10 = 0.0500, source_ndcg@10 = 0.0221, target_hit@10 = 0.0592, target_ndcg@10 = 0.0303

2024-08-09 13:03:09.030023: step 2432/24320 (epoch 8/80), loss = 1.553779 (33.524 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.024168	 ndcg_5: 0.0147	 ndcg_10: 0.0203	 hit@1:0.002896	 hit@5:0.0268	 hit@10: 0.0442
target: 	 mrr: 0.034985	 ndcg_5: 0.0282	 ndcg_10: 0.0358	 hit@1:0.011847	 hit@5:0.0460	 hit@10: 0.0697
epoch 8: train_loss = 1.553779, source_hit@10 = 0.0442, source_ndcg@10 = 0.0203, target_hit@10 = 0.0697, target_ndcg@10 = 0.0358

2024-08-09 13:03:42.655587: step 2736/24320 (epoch 9/80), loss = 1.533554 (33.338 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.027274	 ndcg_5: 0.0176	 ndcg_10: 0.0238	 hit@1:0.007965	 hit@5:0.0282	 hit@10: 0.0478
target: 	 mrr: 0.029674	 ndcg_5: 0.0228	 ndcg_10: 0.0289	 hit@1:0.011150	 hit@5:0.0362	 hit@10: 0.0551
epoch 9: train_loss = 1.533554, source_hit@10 = 0.0478, source_ndcg@10 = 0.0238, target_hit@10 = 0.0551, target_ndcg@10 = 0.0289

2024-08-09 13:04:17.322921: step 3040/24320 (epoch 10/80), loss = 1.516713 (34.379 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.018140	 ndcg_5: 0.0095	 ndcg_10: 0.0154	 hit@1:0.004345	 hit@5:0.0145	 hit@10: 0.0326
target: 	 mrr: 0.044562	 ndcg_5: 0.0346	 ndcg_10: 0.0470	 hit@1:0.016028	 hit@5:0.0530	 hit@10: 0.0920
epoch 10: train_loss = 1.516713, source_hit@10 = 0.0326, source_ndcg@10 = 0.0154, target_hit@10 = 0.0920, target_ndcg@10 = 0.0470

2024-08-09 13:04:52.091594: step 3344/24320 (epoch 11/80), loss = 1.503070 (34.475 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.008303	 ndcg_5: 0.0030	 ndcg_10: 0.0051	 hit@1:0.000724	 hit@5:0.0051	 hit@10: 0.0116
target: 	 mrr: 0.038364	 ndcg_5: 0.0296	 ndcg_10: 0.0387	 hit@1:0.011847	 hit@5:0.0460	 hit@10: 0.0739
epoch 11: train_loss = 1.503070, source_hit@10 = 0.0116, source_ndcg@10 = 0.0051, target_hit@10 = 0.0739, target_ndcg@10 = 0.0387

2024-08-09 13:05:25.907360: step 3648/24320 (epoch 12/80), loss = 1.485526 (33.526 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.029130	 ndcg_5: 0.0208	 ndcg_10: 0.0284	 hit@1:0.005793	 hit@5:0.0362	 hit@10: 0.0594
target: 	 mrr: 0.037329	 ndcg_5: 0.0279	 ndcg_10: 0.0384	 hit@1:0.015331	 hit@5:0.0404	 hit@10: 0.0732
epoch 12: train_loss = 1.485526, source_hit@10 = 0.0594, source_ndcg@10 = 0.0284, target_hit@10 = 0.0732, target_ndcg@10 = 0.0384

2024-08-09 13:06:00.065050: step 3952/24320 (epoch 13/80), loss = 1.472287 (33.868 sec/epoch), lr: 0.003800
Evaluating on dev set...
...........................
source: 	 mrr: 0.024918	 ndcg_5: 0.0144	 ndcg_10: 0.0235	 hit@1:0.003621	 hit@5:0.0261	 hit@10: 0.0543
target: 	 mrr: 0.038891	 ndcg_5: 0.0298	 ndcg_10: 0.0407	 hit@1:0.012544	 hit@5:0.0481	 hit@10: 0.0815
epoch 13: train_loss = 1.472287, source_hit@10 = 0.0543, source_ndcg@10 = 0.0235, target_hit@10 = 0.0815, target_ndcg@10 = 0.0407

2024-08-09 13:06:33.538486: step 4256/24320 (epoch 14/80), loss = 1.460311 (33.185 sec/epoch), lr: 0.003610
Evaluating on dev set...
...........................
source: 	 mrr: 0.029423	 ndcg_5: 0.0206	 ndcg_10: 0.0278	 hit@1:0.008689	 hit@5:0.0333	 hit@10: 0.0565
target: 	 mrr: 0.038601	 ndcg_5: 0.0300	 ndcg_10: 0.0423	 hit@1:0.010453	 hit@5:0.0509	 hit@10: 0.0892
epoch 14: train_loss = 1.460311, source_hit@10 = 0.0565, source_ndcg@10 = 0.0278, target_hit@10 = 0.0892, target_ndcg@10 = 0.0423

2024-08-09 13:07:08.000167: step 4560/24320 (epoch 15/80), loss = 1.452156 (34.172 sec/epoch), lr: 0.003610
Evaluating on dev set...
...........................
source: 	 mrr: 0.033273	 ndcg_5: 0.0267	 ndcg_10: 0.0327	 hit@1:0.009413	 hit@5:0.0442	 hit@10: 0.0630
target: 	 mrr: 0.039026	 ndcg_5: 0.0301	 ndcg_10: 0.0397	 hit@1:0.012544	 hit@5:0.0481	 hit@10: 0.0780
epoch 15: train_loss = 1.452156, source_hit@10 = 0.0630, source_ndcg@10 = 0.0327, target_hit@10 = 0.0780, target_ndcg@10 = 0.0397

2024-08-09 13:07:41.797591: step 4864/24320 (epoch 16/80), loss = 1.445327 (33.507 sec/epoch), lr: 0.003610
Evaluating on dev set...
...........................
source: 	 mrr: 0.013879	 ndcg_5: 0.0089	 ndcg_10: 0.0110	 hit@1:0.002896	 hit@5:0.0145	 hit@10: 0.0210
target: 	 mrr: 0.027895	 ndcg_5: 0.0211	 ndcg_10: 0.0276	 hit@1:0.009756	 hit@5:0.0341	 hit@10: 0.0544
epoch 16: train_loss = 1.445327, source_hit@10 = 0.0210, source_ndcg@10 = 0.0110, target_hit@10 = 0.0544, target_ndcg@10 = 0.0276

2024-08-09 13:08:16.144684: step 5168/24320 (epoch 17/80), loss = 1.431623 (34.057 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.014602	 ndcg_5: 0.0077	 ndcg_10: 0.0101	 hit@1:0.000724	 hit@5:0.0145	 hit@10: 0.0217
target: 	 mrr: 0.045035	 ndcg_5: 0.0389	 ndcg_10: 0.0485	 hit@1:0.017422	 hit@5:0.0620	 hit@10: 0.0920
target best!
..............target: 	 mrr: 0.046477	 ndcg_5: 0.0373	 ndcg_10: 0.0495	 hit@1:0.018519	 hit@5:0.0556	 hit@10: 0.0933
epoch 17: train_loss = 1.431623, source_hit@10 = 0.0217, source_ndcg@10 = 0.0101, target_hit@10 = 0.0933, target_ndcg@10 = 0.0495
new best model saved.

2024-08-09 13:08:50.601976: step 5472/24320 (epoch 18/80), loss = 1.424744 (33.944 sec/epoch), lr: 0.003429
Evaluating on dev set...
...........................
source: 	 mrr: 0.013446	 ndcg_5: 0.0068	 ndcg_10: 0.0093	 hit@1:0.005069	 hit@5:0.0087	 hit@10: 0.0167
target: 	 mrr: 0.038727	 ndcg_5: 0.0305	 ndcg_10: 0.0405	 hit@1:0.013937	 hit@5:0.0467	 hit@10: 0.0780
epoch 18: train_loss = 1.424744, source_hit@10 = 0.0167, source_ndcg@10 = 0.0093, target_hit@10 = 0.0780, target_ndcg@10 = 0.0405

2024-08-09 13:09:24.285900: step 5776/24320 (epoch 19/80), loss = 1.411506 (33.393 sec/epoch), lr: 0.003258
Evaluating on dev set...
...........................
source: 	 mrr: 0.032201	 ndcg_5: 0.0223	 ndcg_10: 0.0309	 hit@1:0.009413	 hit@5:0.0355	 hit@10: 0.0623
target: 	 mrr: 0.045605	 ndcg_5: 0.0373	 ndcg_10: 0.0471	 hit@1:0.018118	 hit@5:0.0564	 hit@10: 0.0871
target best!
..............target: 	 mrr: 0.047609	 ndcg_5: 0.0375	 ndcg_10: 0.0478	 hit@1:0.019890	 hit@5:0.0549	 hit@10: 0.0864
epoch 19: train_loss = 1.411506, source_hit@10 = 0.0623, source_ndcg@10 = 0.0309, target_hit@10 = 0.0864, target_ndcg@10 = 0.0478
new best model saved.

2024-08-09 13:09:58.778693: step 6080/24320 (epoch 20/80), loss = 1.407198 (33.977 sec/epoch), lr: 0.003258
Evaluating on dev set...
...........................
source: 	 mrr: 0.031342	 ndcg_5: 0.0221	 ndcg_10: 0.0297	 hit@1:0.009413	 hit@5:0.0340	 hit@10: 0.0579
target: 	 mrr: 0.033413	 ndcg_5: 0.0267	 ndcg_10: 0.0339	 hit@1:0.011150	 hit@5:0.0425	 hit@10: 0.0648
epoch 20: train_loss = 1.407198, source_hit@10 = 0.0579, source_ndcg@10 = 0.0297, target_hit@10 = 0.0648, target_ndcg@10 = 0.0339

