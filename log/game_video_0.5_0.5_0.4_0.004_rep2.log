nohup: ignoring input
using gpu:4 to train the model
using gpu:4 to train the model
cuda:4
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, batch_size=1024, beta=1.5, conv_layers=4, cuda=True, decay_epoch=10, device=device(type='cuda', index=4), device_id='4', domains='game_video', dropout=0.5, epoch=80, feature_dim=126, hidden_dim=126, inter_tau=0.2, intra_tau=1, lambda_constra=0.3, lambda_critic=0.5, leakey=0.01, load=False, log='logs.txt', log_epoch=1, lr=0.004, lr_decay=0.95, min_epoch=50, mode='train', model_file=None, model_name='gv', momentum=0.98, num_latent_factors=3, num_negative=100, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=32, similarity_tau=0.1, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/disk2/lhr/invariantCDR/invariantCDR/utils/GraphMaker.py:45: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
number_user 19457
number_item 8751
real graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
2024-07-31 06:05:21.452965: step 304/24320 (epoch 1/80), loss = 1.170567 (132.011 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.023863	 ndcg_5: 0.0163	 ndcg_10: 0.0226	 hit@1:0.005793	 hit@5:0.0275	 hit@10: 0.0471
target: 	 mrr: 0.032351	 ndcg_5: 0.0236	 ndcg_10: 0.0323	 hit@1:0.009756	 hit@5:0.0376	 hit@10: 0.0662
source best!
.............
source: 	 mrr: 0.025135	 ndcg_5: 0.0176	 ndcg_10: 0.0232	 hit@1:0.006902	 hit@5:0.0291	 hit@10: 0.0468
target best!
..............target: 	 mrr: 0.034095	 ndcg_5: 0.0237	 ndcg_10: 0.0323	 hit@1:0.013717	 hit@5:0.0350	 hit@10: 0.0617
epoch 1: train_loss = 1.170567, source_hit@10 = 0.0468, source_ndcg@10 = 0.0232, target_hit@10 = 0.0617, target_ndcg@10 = 0.0323

2024-07-31 06:07:34.039648: step 608/24320 (epoch 2/80), loss = 1.034866 (130.973 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.023683	 ndcg_5: 0.0122	 ndcg_10: 0.0206	 hit@1:0.001448	 hit@5:0.0224	 hit@10: 0.0485
target: 	 mrr: 0.027689	 ndcg_5: 0.0177	 ndcg_10: 0.0252	 hit@1:0.010453	 hit@5:0.0244	 hit@10: 0.0481
epoch 2: train_loss = 1.034866, source_hit@10 = 0.0485, source_ndcg@10 = 0.0206, target_hit@10 = 0.0481, target_ndcg@10 = 0.0252

2024-07-31 06:09:46.721126: step 912/24320 (epoch 3/80), loss = 1.013704 (131.794 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.031784	 ndcg_5: 0.0209	 ndcg_10: 0.0304	 hit@1:0.007241	 hit@5:0.0348	 hit@10: 0.0652
target: 	 mrr: 0.028430	 ndcg_5: 0.0196	 ndcg_10: 0.0294	 hit@1:0.007666	 hit@5:0.0321	 hit@10: 0.0620
source best!
.............
source: 	 mrr: 0.031520	 ndcg_5: 0.0198	 ndcg_10: 0.0308	 hit@1:0.007669	 hit@5:0.0322	 hit@10: 0.0667
epoch 3: train_loss = 1.013704, source_hit@10 = 0.0667, source_ndcg@10 = 0.0308, target_hit@10 = 0.0620, target_ndcg@10 = 0.0294
new best model saved.

2024-07-31 06:12:00.358940: step 1216/24320 (epoch 4/80), loss = 0.995549 (132.164 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.030530	 ndcg_5: 0.0181	 ndcg_10: 0.0301	 hit@1:0.004345	 hit@5:0.0326	 hit@10: 0.0702
target: 	 mrr: 0.019543	 ndcg_5: 0.0106	 ndcg_10: 0.0166	 hit@1:0.004181	 hit@5:0.0174	 hit@10: 0.0362
epoch 4: train_loss = 0.995549, source_hit@10 = 0.0702, source_ndcg@10 = 0.0301, target_hit@10 = 0.0362, target_ndcg@10 = 0.0166

2024-07-31 06:14:12.713074: step 1520/24320 (epoch 5/80), loss = 0.991417 (131.403 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.033768	 ndcg_5: 0.0223	 ndcg_10: 0.0322	 hit@1:0.010138	 hit@5:0.0348	 hit@10: 0.0659
target: 	 mrr: 0.023497	 ndcg_5: 0.0133	 ndcg_10: 0.0201	 hit@1:0.006969	 hit@5:0.0195	 hit@10: 0.0411
source best!
.............
source: 	 mrr: 0.034178	 ndcg_5: 0.0247	 ndcg_10: 0.0334	 hit@1:0.007669	 hit@5:0.0429	 hit@10: 0.0706
epoch 5: train_loss = 0.991417, source_hit@10 = 0.0706, source_ndcg@10 = 0.0334, target_hit@10 = 0.0411, target_ndcg@10 = 0.0201

2024-07-31 06:16:23.460451: step 1824/24320 (epoch 6/80), loss = 0.986324 (129.500 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.036916	 ndcg_5: 0.0273	 ndcg_10: 0.0369	 hit@1:0.009413	 hit@5:0.0449	 hit@10: 0.0746
target: 	 mrr: 0.030362	 ndcg_5: 0.0200	 ndcg_10: 0.0295	 hit@1:0.009059	 hit@5:0.0314	 hit@10: 0.0613
source best!
.............
source: 	 mrr: 0.032309	 ndcg_5: 0.0205	 ndcg_10: 0.0310	 hit@1:0.006135	 hit@5:0.0353	 hit@10: 0.0675
epoch 6: train_loss = 0.986324, source_hit@10 = 0.0675, source_ndcg@10 = 0.0310, target_hit@10 = 0.0613, target_ndcg@10 = 0.0295
new best model saved.

2024-07-31 06:18:35.181521: step 2128/24320 (epoch 7/80), loss = 0.985446 (130.345 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.037965	 ndcg_5: 0.0271	 ndcg_10: 0.0351	 hit@1:0.010862	 hit@5:0.0420	 hit@10: 0.0673
target: 	 mrr: 0.033855	 ndcg_5: 0.0249	 ndcg_10: 0.0346	 hit@1:0.011150	 hit@5:0.0390	 hit@10: 0.0690
source best!
.............
source: 	 mrr: 0.036979	 ndcg_5: 0.0255	 ndcg_10: 0.0351	 hit@1:0.011503	 hit@5:0.0391	 hit@10: 0.0690
target best!
..............target: 	 mrr: 0.038879	 ndcg_5: 0.0322	 ndcg_10: 0.0386	 hit@1:0.015775	 hit@5:0.0494	 hit@10: 0.0693
epoch 7: train_loss = 0.985446, source_hit@10 = 0.0690, source_ndcg@10 = 0.0351, target_hit@10 = 0.0693, target_ndcg@10 = 0.0386
new best model saved.

2024-07-31 06:20:47.373890: step 2432/24320 (epoch 8/80), loss = 0.984273 (130.416 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.033666	 ndcg_5: 0.0210	 ndcg_10: 0.0335	 hit@1:0.007241	 hit@5:0.0348	 hit@10: 0.0739
target: 	 mrr: 0.038130	 ndcg_5: 0.0299	 ndcg_10: 0.0384	 hit@1:0.012544	 hit@5:0.0474	 hit@10: 0.0739
target best!
..............target: 	 mrr: 0.039725	 ndcg_5: 0.0318	 ndcg_10: 0.0419	 hit@1:0.011660	 hit@5:0.0521	 hit@10: 0.0837
epoch 8: train_loss = 0.984273, source_hit@10 = 0.0739, source_ndcg@10 = 0.0335, target_hit@10 = 0.0837, target_ndcg@10 = 0.0419

2024-07-31 06:22:58.114431: step 2736/24320 (epoch 9/80), loss = 0.982328 (129.393 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.032869	 ndcg_5: 0.0219	 ndcg_10: 0.0320	 hit@1:0.007241	 hit@5:0.0369	 hit@10: 0.0681
target: 	 mrr: 0.039481	 ndcg_5: 0.0303	 ndcg_10: 0.0402	 hit@1:0.013240	 hit@5:0.0488	 hit@10: 0.0794
target best!
..............target: 	 mrr: 0.039040	 ndcg_5: 0.0291	 ndcg_10: 0.0390	 hit@1:0.012346	 hit@5:0.0473	 hit@10: 0.0782
epoch 9: train_loss = 0.982328, source_hit@10 = 0.0681, source_ndcg@10 = 0.0320, target_hit@10 = 0.0782, target_ndcg@10 = 0.0390

2024-07-31 06:25:08.822628: step 3040/24320 (epoch 10/80), loss = 0.978445 (129.392 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.036394	 ndcg_5: 0.0256	 ndcg_10: 0.0365	 hit@1:0.010138	 hit@5:0.0442	 hit@10: 0.0782
target: 	 mrr: 0.036527	 ndcg_5: 0.0255	 ndcg_10: 0.0356	 hit@1:0.013937	 hit@5:0.0376	 hit@10: 0.0690
epoch 10: train_loss = 0.978445, source_hit@10 = 0.0782, source_ndcg@10 = 0.0365, target_hit@10 = 0.0690, target_ndcg@10 = 0.0356

2024-07-31 06:27:22.165231: step 3344/24320 (epoch 11/80), loss = 0.979270 (132.399 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.038645	 ndcg_5: 0.0249	 ndcg_10: 0.0386	 hit@1:0.013758	 hit@5:0.0369	 hit@10: 0.0797
target: 	 mrr: 0.039291	 ndcg_5: 0.0310	 ndcg_10: 0.0415	 hit@1:0.011847	 hit@5:0.0502	 hit@10: 0.0836
source best!
.............
source: 	 mrr: 0.036942	 ndcg_5: 0.0230	 ndcg_10: 0.0381	 hit@1:0.010736	 hit@5:0.0353	 hit@10: 0.0828
epoch 11: train_loss = 0.979270, source_hit@10 = 0.0828, source_ndcg@10 = 0.0381, target_hit@10 = 0.0836, target_ndcg@10 = 0.0415
new best model saved.

2024-07-31 06:29:33.552366: step 3648/24320 (epoch 12/80), loss = 0.975300 (129.946 sec/epoch), lr: 0.004000
Evaluating on dev set...
...........................
source: 	 mrr: 0.040756	 ndcg_5: 0.0309	 ndcg_10: 0.0403	 hit@1:0.013758	 hit@5:0.0463	 hit@10: 0.0760
target: 	 mrr: 0.044527	 ndcg_5: 0.0350	 ndcg_10: 0.0477	 hit@1:0.015331	 hit@5:0.0551	 hit@10: 0.0948
source best!
.............
source: 	 mrr: 0.034374	 ndcg_5: 0.0219	 ndcg_10: 0.0348	 hit@1:0.007669	 hit@5:0.0368	 hit@10: 0.0775
target best!
..............target: 	 mrr: 0.045113	 ndcg_5: 0.0378	 ndcg_10: 0.0491	 hit@1:0.013032	 hit@5:0.0645	 hit@10: 0.0995
epoch 12: train_loss = 0.975300, source_hit@10 = 0.0775, source_ndcg@10 = 0.0348, target_hit@10 = 0.0995, target_ndcg@10 = 0.0491
new best model saved.

