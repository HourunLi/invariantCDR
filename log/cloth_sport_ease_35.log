nohup: ignoring input
using gpu:1 to train the model
using gpu:1 to train the model
cuda:1
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, batch_size=1024, beta=1.5, conv_layers=3, cuda=True, decay_epoch=5, device=device(type='cuda', index=1), device_id='1', domains='cloth_sport', dropout=0.2, epoch=200, feature_dim=126, hidden_dim=126, keep_prob=0.6, lambda_constra=0.15, lambda_critic=0.35, lambda_ease=50, leakey=0.01, load=True, log='logs.txt', log_epoch=1, lr=0.0005, lr_decay=0.95, lr_transfer=0.0005, mask_rate=0.1, min_epoch=50, mode='train', model_file='checkpoint_epoch_35.pt', model_name='cs', num_latent_factors=3, num_negative=10, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=32, sim_threshold=0.9, tau=0.4, test_sample_number=999, transfer_epoch=35, user_batch_size=256, weight_decay=0.0002)
number_user 41829
number_item 17943
732772292
49873
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:46: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
Original edge number: 187880; Augmentation edge number: 192213; adding 4333 edges
augmentation graph loaded!
number_user 27328
number_item 12655
333408046
80379
real graph loaded!
Original edge number: 163291; Augmentation edge number: 175271; adding 11980 edges
augmentation graph loaded!
graph loaded!
Loading data from cloth_sport with batch size 1024...
unseen test: 0
test length: 3156
unseen test: 0
test length: 3085
unseen test: 0
test length: 3589
unseen test: 0
test length: 3546
source_user_num 41829
target_user_num 27328
source_item_num 17943
target_item_num 12655
shared users id: 7857
test users 990, 982
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 187880, target train data: 163291, source test data : 3085, target test data : 3546, source dev data : 1000, target dev data : 1000
Loading model from ./saved_models/cs/checkpoint_epoch_35.pt
2024-07-04 17:57:25.690051: step 343/68600 (epoch 35/200), loss = 1.460801 (199.983 sec/epoch), lr: 0.000500
Evaluating on dev set...
....................
source: 	 mrr: 0.079708	 ndcg_5: 0.0642	 ndcg_10: 0.0874	 hit@1:0.028000	 hit@5:0.1010	 hit@10: 0.1730
target: 	 mrr: 0.112590	 ndcg_5: 0.0996	 ndcg_10: 0.1312	 hit@1:0.047000	 hit@5:0.1540	 hit@10: 0.2530
new best model saved.

2024-07-04 18:00:45.175080: step 686/68600 (epoch 36/200), loss = 1.393087 (198.855 sec/epoch), lr: 0.000500
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.056129	 ndcg_5: 0.0465	 ndcg_10: 0.0612	 hit@1:0.022180	 hit@5:0.0719	 hit@10: 0.1172
target: 	 mrr: 0.049157	 ndcg_5: 0.0403	 ndcg_10: 0.0525	 hit@1:0.018111	 hit@5:0.0616	 hit@10: 0.0995
epoch 36: train_loss = 1.393087, source_hit@10 = 0.1172, source_ndcg@10 = 0.0612, target_hit@10 = 0.0995, target_ndcg@10 = 0.0525

2024-07-04 18:04:05.075414: step 1029/68600 (epoch 37/200), loss = 1.354130 (198.973 sec/epoch), lr: 0.000475
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.055729	 ndcg_5: 0.0457	 ndcg_10: 0.0597	 hit@1:0.022180	 hit@5:0.0672	 hit@10: 0.1112
target: 	 mrr: 0.048922	 ndcg_5: 0.0409	 ndcg_10: 0.0540	 hit@1:0.018668	 hit@5:0.0627	 hit@10: 0.1034
epoch 37: train_loss = 1.354130, source_hit@10 = 0.1112, source_ndcg@10 = 0.0597, target_hit@10 = 0.1034, target_ndcg@10 = 0.0540

2024-07-04 18:07:25.057239: step 1372/68600 (epoch 38/200), loss = 1.330606 (199.053 sec/epoch), lr: 0.000451
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049798	 ndcg_5: 0.0404	 ndcg_10: 0.0530	 hit@1:0.019645	 hit@5:0.0612	 hit@10: 0.1008
target: 	 mrr: 0.045845	 ndcg_5: 0.0369	 ndcg_10: 0.0477	 hit@1:0.018947	 hit@5:0.0549	 hit@10: 0.0886
epoch 38: train_loss = 1.330606, source_hit@10 = 0.1008, source_ndcg@10 = 0.0530, target_hit@10 = 0.0886, target_ndcg@10 = 0.0477

2024-07-04 18:10:44.918308: step 1715/68600 (epoch 39/200), loss = 1.305903 (198.940 sec/epoch), lr: 0.000429
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036711	 ndcg_5: 0.0296	 ndcg_10: 0.0388	 hit@1:0.011407	 hit@5:0.0475	 hit@10: 0.0760
target: 	 mrr: 0.045516	 ndcg_5: 0.0374	 ndcg_10: 0.0489	 hit@1:0.015603	 hit@5:0.0593	 hit@10: 0.0950
epoch 39: train_loss = 1.305903, source_hit@10 = 0.0760, source_ndcg@10 = 0.0388, target_hit@10 = 0.0950, target_ndcg@10 = 0.0489

2024-07-04 18:14:04.851094: step 2058/68600 (epoch 40/200), loss = 1.289198 (199.018 sec/epoch), lr: 0.000407
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040604	 ndcg_5: 0.0315	 ndcg_10: 0.0424	 hit@1:0.013625	 hit@5:0.0494	 hit@10: 0.0833
target: 	 mrr: 0.048406	 ndcg_5: 0.0404	 ndcg_10: 0.0535	 hit@1:0.016439	 hit@5:0.0652	 hit@10: 0.1059
epoch 40: train_loss = 1.289198, source_hit@10 = 0.0833, source_ndcg@10 = 0.0424, target_hit@10 = 0.1059, target_ndcg@10 = 0.0535

2024-07-04 18:17:24.692504: step 2401/68600 (epoch 41/200), loss = 1.273140 (198.914 sec/epoch), lr: 0.000407
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041950	 ndcg_5: 0.0317	 ndcg_10: 0.0445	 hit@1:0.014259	 hit@5:0.0491	 hit@10: 0.0890
target: 	 mrr: 0.042768	 ndcg_5: 0.0348	 ndcg_10: 0.0461	 hit@1:0.016160	 hit@5:0.0532	 hit@10: 0.0883
epoch 41: train_loss = 1.273140, source_hit@10 = 0.0890, source_ndcg@10 = 0.0445, target_hit@10 = 0.0883, target_ndcg@10 = 0.0461

2024-07-04 18:20:44.515583: step 2744/68600 (epoch 42/200), loss = 1.261455 (198.909 sec/epoch), lr: 0.000387
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049132	 ndcg_5: 0.0399	 ndcg_10: 0.0514	 hit@1:0.018378	 hit@5:0.0615	 hit@10: 0.0973
target: 	 mrr: 0.048625	 ndcg_5: 0.0400	 ndcg_10: 0.0523	 hit@1:0.018947	 hit@5:0.0619	 hit@10: 0.1006
epoch 42: train_loss = 1.261455, source_hit@10 = 0.0973, source_ndcg@10 = 0.0514, target_hit@10 = 0.1006, target_ndcg@10 = 0.0523

2024-07-04 18:24:04.345153: step 3087/68600 (epoch 43/200), loss = 1.252069 (198.909 sec/epoch), lr: 0.000387
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.037206	 ndcg_5: 0.0288	 ndcg_10: 0.0380	 hit@1:0.012357	 hit@5:0.0469	 hit@10: 0.0754
target: 	 mrr: 0.046044	 ndcg_5: 0.0372	 ndcg_10: 0.0493	 hit@1:0.016996	 hit@5:0.0577	 hit@10: 0.0953
epoch 43: train_loss = 1.252069, source_hit@10 = 0.0754, source_ndcg@10 = 0.0380, target_hit@10 = 0.0953, target_ndcg@10 = 0.0493

2024-07-04 18:27:24.187925: step 3430/68600 (epoch 44/200), loss = 1.237806 (198.928 sec/epoch), lr: 0.000368
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039479	 ndcg_5: 0.0297	 ndcg_10: 0.0408	 hit@1:0.014259	 hit@5:0.0466	 hit@10: 0.0811
target: 	 mrr: 0.042598	 ndcg_5: 0.0342	 ndcg_10: 0.0443	 hit@1:0.016439	 hit@5:0.0524	 hit@10: 0.0836
epoch 44: train_loss = 1.237806, source_hit@10 = 0.0811, source_ndcg@10 = 0.0408, target_hit@10 = 0.0836, target_ndcg@10 = 0.0443

2024-07-04 18:30:44.180920: step 3773/68600 (epoch 45/200), loss = 1.228061 (199.078 sec/epoch), lr: 0.000349
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049806	 ndcg_5: 0.0416	 ndcg_10: 0.0541	 hit@1:0.016477	 hit@5:0.0665	 hit@10: 0.1058
target: 	 mrr: 0.042520	 ndcg_5: 0.0340	 ndcg_10: 0.0434	 hit@1:0.016160	 hit@5:0.0513	 hit@10: 0.0808
epoch 45: train_loss = 1.228061, source_hit@10 = 0.1058, source_ndcg@10 = 0.0541, target_hit@10 = 0.0808, target_ndcg@10 = 0.0434

2024-07-04 18:34:04.235136: step 4116/68600 (epoch 46/200), loss = 1.219458 (199.136 sec/epoch), lr: 0.000349
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.049264	 ndcg_5: 0.0396	 ndcg_10: 0.0506	 hit@1:0.019645	 hit@5:0.0593	 hit@10: 0.0935
target: 	 mrr: 0.044852	 ndcg_5: 0.0367	 ndcg_10: 0.0482	 hit@1:0.015325	 hit@5:0.0574	 hit@10: 0.0931
epoch 46: train_loss = 1.219458, source_hit@10 = 0.0935, source_ndcg@10 = 0.0506, target_hit@10 = 0.0931, target_ndcg@10 = 0.0482

2024-07-04 18:37:24.164226: step 4459/68600 (epoch 47/200), loss = 1.211668 (199.009 sec/epoch), lr: 0.000349
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036086	 ndcg_5: 0.0270	 ndcg_10: 0.0366	 hit@1:0.011090	 hit@5:0.0440	 hit@10: 0.0741
target: 	 mrr: 0.041707	 ndcg_5: 0.0320	 ndcg_10: 0.0439	 hit@1:0.014489	 hit@5:0.0490	 hit@10: 0.0867
epoch 47: train_loss = 1.211668, source_hit@10 = 0.0741, source_ndcg@10 = 0.0366, target_hit@10 = 0.0867, target_ndcg@10 = 0.0439

2024-07-04 18:40:44.065038: step 4802/68600 (epoch 48/200), loss = 1.203469 (198.980 sec/epoch), lr: 0.000332
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.036325	 ndcg_5: 0.0260	 ndcg_10: 0.0367	 hit@1:0.011724	 hit@5:0.0406	 hit@10: 0.0745
target: 	 mrr: 0.035371	 ndcg_5: 0.0278	 ndcg_10: 0.0360	 hit@1:0.012260	 hit@5:0.0435	 hit@10: 0.0691
epoch 48: train_loss = 1.203469, source_hit@10 = 0.0745, source_ndcg@10 = 0.0367, target_hit@10 = 0.0691, target_ndcg@10 = 0.0360

2024-07-04 18:44:03.946383: step 5145/68600 (epoch 49/200), loss = 1.196935 (198.962 sec/epoch), lr: 0.000315
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.032863	 ndcg_5: 0.0232	 ndcg_10: 0.0329	 hit@1:0.008872	 hit@5:0.0383	 hit@10: 0.0688
target: 	 mrr: 0.039716	 ndcg_5: 0.0322	 ndcg_10: 0.0425	 hit@1:0.012817	 hit@5:0.0532	 hit@10: 0.0855
epoch 49: train_loss = 1.196935, source_hit@10 = 0.0688, source_ndcg@10 = 0.0329, target_hit@10 = 0.0855, target_ndcg@10 = 0.0425

2024-07-04 18:47:24.012557: step 5488/68600 (epoch 50/200), loss = 1.191778 (199.144 sec/epoch), lr: 0.000315
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.029742	 ndcg_5: 0.0210	 ndcg_10: 0.0291	 hit@1:0.007288	 hit@5:0.0358	 hit@10: 0.0612
target: 	 mrr: 0.033743	 ndcg_5: 0.0252	 ndcg_10: 0.0350	 hit@1:0.011145	 hit@5:0.0404	 hit@10: 0.0708
epoch 50: train_loss = 1.191778, source_hit@10 = 0.0612, source_ndcg@10 = 0.0291, target_hit@10 = 0.0708, target_ndcg@10 = 0.0350

2024-07-04 18:50:43.948059: step 5831/68600 (epoch 51/200), loss = 1.183435 (199.019 sec/epoch), lr: 0.000299
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.034297	 ndcg_5: 0.0244	 ndcg_10: 0.0343	 hit@1:0.008872	 hit@5:0.0396	 hit@10: 0.0707
target: 	 mrr: 0.035911	 ndcg_5: 0.0272	 ndcg_10: 0.0366	 hit@1:0.011981	 hit@5:0.0426	 hit@10: 0.0719
epoch 51: train_loss = 1.183435, source_hit@10 = 0.0707, source_ndcg@10 = 0.0343, target_hit@10 = 0.0719, target_ndcg@10 = 0.0366

2024-07-04 18:54:03.941155: step 6174/68600 (epoch 52/200), loss = 1.177204 (199.073 sec/epoch), lr: 0.000299
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.028395	 ndcg_5: 0.0194	 ndcg_10: 0.0280	 hit@1:0.006020	 hit@5:0.0330	 hit@10: 0.0599
target: 	 mrr: 0.038685	 ndcg_5: 0.0304	 ndcg_10: 0.0391	 hit@1:0.013374	 hit@5:0.0476	 hit@10: 0.0752
epoch 52: train_loss = 1.177204, source_hit@10 = 0.0599, source_ndcg@10 = 0.0280, target_hit@10 = 0.0752, target_ndcg@10 = 0.0391

2024-07-04 18:57:23.922718: step 6517/68600 (epoch 53/200), loss = 1.171849 (199.034 sec/epoch), lr: 0.000284
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.041819	 ndcg_5: 0.0321	 ndcg_10: 0.0419	 hit@1:0.015209	 hit@5:0.0501	 hit@10: 0.0805
target: 	 mrr: 0.043066	 ndcg_5: 0.0346	 ndcg_10: 0.0450	 hit@1:0.016160	 hit@5:0.0538	 hit@10: 0.0864
epoch 53: train_loss = 1.171849, source_hit@10 = 0.0805, source_ndcg@10 = 0.0419, target_hit@10 = 0.0864, target_ndcg@10 = 0.0450

2024-07-04 19:00:43.885552: step 6860/68600 (epoch 54/200), loss = 1.166915 (199.042 sec/epoch), lr: 0.000284
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.037943	 ndcg_5: 0.0287	 ndcg_10: 0.0384	 hit@1:0.012357	 hit@5:0.0459	 hit@10: 0.0757
target: 	 mrr: 0.043409	 ndcg_5: 0.0348	 ndcg_10: 0.0455	 hit@1:0.015325	 hit@5:0.0543	 hit@10: 0.0875
epoch 54: train_loss = 1.166915, source_hit@10 = 0.0757, source_ndcg@10 = 0.0384, target_hit@10 = 0.0875, target_ndcg@10 = 0.0455

2024-07-04 19:04:03.786423: step 7203/68600 (epoch 55/200), loss = 1.160484 (198.980 sec/epoch), lr: 0.000270
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045679	 ndcg_5: 0.0355	 ndcg_10: 0.0495	 hit@1:0.014892	 hit@5:0.0570	 hit@10: 0.1001
target: 	 mrr: 0.044420	 ndcg_5: 0.0361	 ndcg_10: 0.0476	 hit@1:0.016160	 hit@5:0.0563	 hit@10: 0.0922
epoch 55: train_loss = 1.160484, source_hit@10 = 0.1001, source_ndcg@10 = 0.0495, target_hit@10 = 0.0922, target_ndcg@10 = 0.0476

2024-07-04 19:07:23.776601: step 7546/68600 (epoch 56/200), loss = 1.157127 (199.068 sec/epoch), lr: 0.000270
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.045001	 ndcg_5: 0.0356	 ndcg_10: 0.0460	 hit@1:0.014575	 hit@5:0.0561	 hit@10: 0.0878
target: 	 mrr: 0.041686	 ndcg_5: 0.0329	 ndcg_10: 0.0438	 hit@1:0.014767	 hit@5:0.0502	 hit@10: 0.0844
epoch 56: train_loss = 1.157127, source_hit@10 = 0.0878, source_ndcg@10 = 0.0460, target_hit@10 = 0.0844, target_ndcg@10 = 0.0438

2024-07-04 19:10:43.782161: step 7889/68600 (epoch 57/200), loss = 1.150084 (199.074 sec/epoch), lr: 0.000257
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.042786	 ndcg_5: 0.0333	 ndcg_10: 0.0439	 hit@1:0.014259	 hit@5:0.0529	 hit@10: 0.0856
target: 	 mrr: 0.044405	 ndcg_5: 0.0358	 ndcg_10: 0.0457	 hit@1:0.018390	 hit@5:0.0532	 hit@10: 0.0839
epoch 57: train_loss = 1.150084, source_hit@10 = 0.0856, source_ndcg@10 = 0.0439, target_hit@10 = 0.0839, target_ndcg@10 = 0.0457

2024-07-04 19:14:03.897048: step 8232/68600 (epoch 58/200), loss = 1.144846 (199.196 sec/epoch), lr: 0.000257
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.039939	 ndcg_5: 0.0314	 ndcg_10: 0.0424	 hit@1:0.011407	 hit@5:0.0510	 hit@10: 0.0852
target: 	 mrr: 0.040935	 ndcg_5: 0.0330	 ndcg_10: 0.0418	 hit@1:0.014210	 hit@5:0.0510	 hit@10: 0.0786
epoch 58: train_loss = 1.144846, source_hit@10 = 0.0852, source_ndcg@10 = 0.0424, target_hit@10 = 0.0786, target_ndcg@10 = 0.0418

2024-07-04 19:17:23.950719: step 8575/68600 (epoch 59/200), loss = 1.141661 (199.134 sec/epoch), lr: 0.000244
Evaluating on dev set...
..................................................................
source: 	 mrr: 0.040678	 ndcg_5: 0.0326	 ndcg_10: 0.0415	 hit@1:0.013625	 hit@5:0.0529	 hit@10: 0.0811
target: 	 mrr: 0.044023	 ndcg_5: 0.0354	 ndcg_10: 0.0458	 hit@1:0.016439	 hit@5:0.0535	 hit@10: 0.0864
epoch 59: train_loss = 1.141661, source_hit@10 = 0.0811, source_ndcg@10 = 0.0415, target_hit@10 = 0.0864, target_ndcg@10 = 0.0458

