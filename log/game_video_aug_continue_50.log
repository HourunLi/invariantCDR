nohup: ignoring input
using gpu:0 to train the model
using gpu:0 to train the model
cuda:0
Namespace(A_split=False, JK='sum', a_fold=100, aggregate=False, batch_size=1024, beta=1.5, conv_layers=3, cuda=True, decay_epoch=5, device=device(type='cuda', index=0), device_id='0', domains='game_video', dropout=0.2, epoch=70, feature_dim=126, hidden_dim=126, keep_prob=0.6, lambda_constra=0.3, lambda_critic=0.3, lambda_ease=50, leakey=0.01, load=True, log='logs.txt', log_epoch=1, lr=0.0005, lr_decay=0.95, lr_transfer=0.0005, min_epoch=50, mode='train', model_file='single_50.pt', model_name='gv', num_latent_factors=3, num_negative=10, optim='adam', patience=50, proj_layers=1, projection=1, residual=1, save=True, save_dir='./saved_models', seed=32, sim_threshold=0.9, tau=0.4, test_sample_number=999, transfer_epoch=50, user_batch_size=256, weight_decay=0.0002)
number_user 25025
number_item 12319
/home/hourun/invariantCDR_v2/invariantCDR/utils/GraphMaker.py:47: RuntimeWarning: divide by zero encountered in power
  r_inv = np.power(rowsum, -1).flatten()
real graph loaded!
augmented graph loaded!
number_user 19457
number_item 8751
real graph loaded!
augmented graph loaded!
graph loaded!
Loading data from game_video with batch size 1024...
unseen test: 0
test length: 1381
unseen test: 0
test length: 1304
unseen test: 0
test length: 1435
unseen test: 0
test length: 1458
source_user_num 25025
target_user_num 19457
source_item_num 12319
target_item_num 8751
shared users id: 1737
test users 226, 217
unseen test: 0
dev length: 1000
unseen test: 0
dev length: 1000
source train data : 155036, target train data: 156091, source test data : 1304, target test data : 1458, source dev data : 1000, target dev data : 1000
Loading model from ./saved_models/gv/single_50.pt
2024-07-11 10:26:42.730595: step 304/21280 (epoch 50/70), loss = 0.545775 (19.038 sec/epoch), lr: 0.000500
Evaluating on dev set...
....................
source: 	 mrr: 0.251677	 ndcg_5: 0.2535	 ndcg_10: 0.2941	 hit@1:0.133000	 hit@5:0.3660	 hit@10: 0.4920
target: 	 mrr: 0.258471	 ndcg_5: 0.2567	 ndcg_10: 0.3073	 hit@1:0.132000	 hit@5:0.3760	 hit@10: 0.5330
new best model saved.

2024-07-11 10:27:01.564511: step 608/21280 (epoch 51/70), loss = 0.501208 (18.554 sec/epoch), lr: 0.000500
Evaluating on dev set...
...........................
source: 	 mrr: 0.041918	 ndcg_5: 0.0313	 ndcg_10: 0.0411	 hit@1:0.012310	 hit@5:0.0514	 hit@10: 0.0818
target: 	 mrr: 0.048475	 ndcg_5: 0.0383	 ndcg_10: 0.0516	 hit@1:0.018815	 hit@5:0.0578	 hit@10: 0.0990
epoch 51: train_loss = 0.501208, source_hit@10 = 0.0818, source_ndcg@10 = 0.0411, target_hit@10 = 0.0990, target_ndcg@10 = 0.0516

2024-07-11 10:27:20.340991: step 912/21280 (epoch 52/70), loss = 0.474287 (18.512 sec/epoch), lr: 0.000475
Evaluating on dev set...
...........................
source: 	 mrr: 0.035156	 ndcg_5: 0.0237	 ndcg_10: 0.0337	 hit@1:0.007965	 hit@5:0.0398	 hit@10: 0.0710
target: 	 mrr: 0.045822	 ndcg_5: 0.0378	 ndcg_10: 0.0484	 hit@1:0.016725	 hit@5:0.0592	 hit@10: 0.0920
epoch 52: train_loss = 0.474287, source_hit@10 = 0.0710, source_ndcg@10 = 0.0337, target_hit@10 = 0.0920, target_ndcg@10 = 0.0484

2024-07-11 10:27:39.089574: step 1216/21280 (epoch 53/70), loss = 0.455559 (18.482 sec/epoch), lr: 0.000451
Evaluating on dev set...
...........................
source: 	 mrr: 0.041149	 ndcg_5: 0.0298	 ndcg_10: 0.0401	 hit@1:0.013034	 hit@5:0.0478	 hit@10: 0.0797
target: 	 mrr: 0.049270	 ndcg_5: 0.0410	 ndcg_10: 0.0531	 hit@1:0.016028	 hit@5:0.0641	 hit@10: 0.1017
epoch 53: train_loss = 0.455559, source_hit@10 = 0.0797, source_ndcg@10 = 0.0401, target_hit@10 = 0.1017, target_ndcg@10 = 0.0531

2024-07-11 10:27:57.894782: step 1520/21280 (epoch 54/70), loss = 0.439204 (18.542 sec/epoch), lr: 0.000451
Evaluating on dev set...
...........................
source: 	 mrr: 0.036221	 ndcg_5: 0.0263	 ndcg_10: 0.0330	 hit@1:0.007965	 hit@5:0.0456	 hit@10: 0.0666
target: 	 mrr: 0.049447	 ndcg_5: 0.0409	 ndcg_10: 0.0532	 hit@1:0.020209	 hit@5:0.0613	 hit@10: 0.1003
epoch 54: train_loss = 0.439204, source_hit@10 = 0.0666, source_ndcg@10 = 0.0330, target_hit@10 = 0.1003, target_ndcg@10 = 0.0532

2024-07-11 10:28:16.764816: step 1824/21280 (epoch 55/70), loss = 0.422750 (18.600 sec/epoch), lr: 0.000429
Evaluating on dev set...
...........................
source: 	 mrr: 0.037096	 ndcg_5: 0.0242	 ndcg_10: 0.0360	 hit@1:0.010862	 hit@5:0.0377	 hit@10: 0.0746
target: 	 mrr: 0.048489	 ndcg_5: 0.0426	 ndcg_10: 0.0553	 hit@1:0.015331	 hit@5:0.0704	 hit@10: 0.1094
epoch 55: train_loss = 0.422750, source_hit@10 = 0.0746, source_ndcg@10 = 0.0360, target_hit@10 = 0.1094, target_ndcg@10 = 0.0553

2024-07-11 10:28:35.603034: step 2128/21280 (epoch 56/70), loss = 0.407633 (18.575 sec/epoch), lr: 0.000407
Evaluating on dev set...
...........................
source: 	 mrr: 0.039081	 ndcg_5: 0.0278	 ndcg_10: 0.0393	 hit@1:0.010138	 hit@5:0.0471	 hit@10: 0.0833
target: 	 mrr: 0.037578	 ndcg_5: 0.0294	 ndcg_10: 0.0383	 hit@1:0.011150	 hit@5:0.0474	 hit@10: 0.0753
epoch 56: train_loss = 0.407633, source_hit@10 = 0.0833, source_ndcg@10 = 0.0393, target_hit@10 = 0.0753, target_ndcg@10 = 0.0383

2024-07-11 10:28:54.464995: step 2432/21280 (epoch 57/70), loss = 0.397880 (18.591 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.037275	 ndcg_5: 0.0252	 ndcg_10: 0.0373	 hit@1:0.007241	 hit@5:0.0427	 hit@10: 0.0811
target: 	 mrr: 0.042380	 ndcg_5: 0.0348	 ndcg_10: 0.0445	 hit@1:0.014634	 hit@5:0.0551	 hit@10: 0.0850
epoch 57: train_loss = 0.397880, source_hit@10 = 0.0811, source_ndcg@10 = 0.0373, target_hit@10 = 0.0850, target_ndcg@10 = 0.0445

2024-07-11 10:29:13.331985: step 2736/21280 (epoch 58/70), loss = 0.392055 (18.597 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.036955	 ndcg_5: 0.0240	 ndcg_10: 0.0341	 hit@1:0.008689	 hit@5:0.0369	 hit@10: 0.0688
target: 	 mrr: 0.044025	 ndcg_5: 0.0357	 ndcg_10: 0.0481	 hit@1:0.012544	 hit@5:0.0578	 hit@10: 0.0955
epoch 58: train_loss = 0.392055, source_hit@10 = 0.0688, source_ndcg@10 = 0.0341, target_hit@10 = 0.0955, target_ndcg@10 = 0.0481

2024-07-11 10:29:32.185009: step 3040/21280 (epoch 59/70), loss = 0.387093 (18.585 sec/epoch), lr: 0.000387
Evaluating on dev set...
...........................
source: 	 mrr: 0.036056	 ndcg_5: 0.0229	 ndcg_10: 0.0358	 hit@1:0.008689	 hit@5:0.0362	 hit@10: 0.0775
target: 	 mrr: 0.044065	 ndcg_5: 0.0363	 ndcg_10: 0.0470	 hit@1:0.013240	 hit@5:0.0592	 hit@10: 0.0934
epoch 59: train_loss = 0.387093, source_hit@10 = 0.0775, source_ndcg@10 = 0.0358, target_hit@10 = 0.0934, target_ndcg@10 = 0.0470

2024-07-11 10:29:51.044254: step 3344/21280 (epoch 60/70), loss = 0.379374 (18.589 sec/epoch), lr: 0.000368
Evaluating on dev set...
...........................
source: 	 mrr: 0.037650	 ndcg_5: 0.0249	 ndcg_10: 0.0375	 hit@1:0.009413	 hit@5:0.0406	 hit@10: 0.0797
target: 	 mrr: 0.045277	 ndcg_5: 0.0378	 ndcg_10: 0.0473	 hit@1:0.016725	 hit@5:0.0599	 hit@10: 0.0892
epoch 60: train_loss = 0.379374, source_hit@10 = 0.0797, source_ndcg@10 = 0.0375, target_hit@10 = 0.0892, target_ndcg@10 = 0.0473

2024-07-11 10:30:09.893907: step 3648/21280 (epoch 61/70), loss = 0.373855 (18.579 sec/epoch), lr: 0.000368
Evaluating on dev set...
...........................
source: 	 mrr: 0.037256	 ndcg_5: 0.0245	 ndcg_10: 0.0368	 hit@1:0.007241	 hit@5:0.0406	 hit@10: 0.0789
target: 	 mrr: 0.045103	 ndcg_5: 0.0367	 ndcg_10: 0.0482	 hit@1:0.014634	 hit@5:0.0592	 hit@10: 0.0948
epoch 61: train_loss = 0.373855, source_hit@10 = 0.0789, source_ndcg@10 = 0.0368, target_hit@10 = 0.0948, target_ndcg@10 = 0.0482

2024-07-11 10:30:28.742152: step 3952/21280 (epoch 62/70), loss = 0.363645 (18.578 sec/epoch), lr: 0.000349
Evaluating on dev set...
...........................
source: 	 mrr: 0.038607	 ndcg_5: 0.0268	 ndcg_10: 0.0386	 hit@1:0.010138	 hit@5:0.0434	 hit@10: 0.0797
target: 	 mrr: 0.039415	 ndcg_5: 0.0309	 ndcg_10: 0.0399	 hit@1:0.013937	 hit@5:0.0488	 hit@10: 0.0774
epoch 62: train_loss = 0.363645, source_hit@10 = 0.0797, source_ndcg@10 = 0.0386, target_hit@10 = 0.0774, target_ndcg@10 = 0.0399

2024-07-11 10:30:47.664154: step 4256/21280 (epoch 63/70), loss = 0.355636 (18.650 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.040774	 ndcg_5: 0.0303	 ndcg_10: 0.0429	 hit@1:0.009413	 hit@5:0.0507	 hit@10: 0.0905
target: 	 mrr: 0.039693	 ndcg_5: 0.0315	 ndcg_10: 0.0416	 hit@1:0.012544	 hit@5:0.0509	 hit@10: 0.0822
epoch 63: train_loss = 0.355636, source_hit@10 = 0.0905, source_ndcg@10 = 0.0429, target_hit@10 = 0.0822, target_ndcg@10 = 0.0416

2024-07-11 10:31:06.507710: step 4560/21280 (epoch 64/70), loss = 0.351823 (18.574 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.040324	 ndcg_5: 0.0297	 ndcg_10: 0.0384	 hit@1:0.012310	 hit@5:0.0471	 hit@10: 0.0746
target: 	 mrr: 0.042825	 ndcg_5: 0.0339	 ndcg_10: 0.0446	 hit@1:0.013240	 hit@5:0.0551	 hit@10: 0.0878
epoch 64: train_loss = 0.351823, source_hit@10 = 0.0746, source_ndcg@10 = 0.0384, target_hit@10 = 0.0878, target_ndcg@10 = 0.0446

2024-07-11 10:31:25.337993: step 4864/21280 (epoch 65/70), loss = 0.347716 (18.566 sec/epoch), lr: 0.000332
Evaluating on dev set...
...........................
source: 	 mrr: 0.040660	 ndcg_5: 0.0302	 ndcg_10: 0.0418	 hit@1:0.010138	 hit@5:0.0500	 hit@10: 0.0862
target: 	 mrr: 0.042245	 ndcg_5: 0.0320	 ndcg_10: 0.0444	 hit@1:0.015331	 hit@5:0.0488	 hit@10: 0.0871
epoch 65: train_loss = 0.347716, source_hit@10 = 0.0862, source_ndcg@10 = 0.0418, target_hit@10 = 0.0871, target_ndcg@10 = 0.0444

2024-07-11 10:31:44.208240: step 5168/21280 (epoch 66/70), loss = 0.343074 (18.605 sec/epoch), lr: 0.000315
Evaluating on dev set...
...........................
source: 	 mrr: 0.040198	 ndcg_5: 0.0298	 ndcg_10: 0.0409	 hit@1:0.010138	 hit@5:0.0492	 hit@10: 0.0840
target: 	 mrr: 0.040084	 ndcg_5: 0.0315	 ndcg_10: 0.0398	 hit@1:0.012544	 hit@5:0.0488	 hit@10: 0.0753
epoch 66: train_loss = 0.343074, source_hit@10 = 0.0840, source_ndcg@10 = 0.0409, target_hit@10 = 0.0753, target_ndcg@10 = 0.0398

2024-07-11 10:32:03.189271: step 5472/21280 (epoch 67/70), loss = 0.333591 (18.713 sec/epoch), lr: 0.000299
Evaluating on dev set...
...........................
source: 	 mrr: 0.043278	 ndcg_5: 0.0329	 ndcg_10: 0.0425	 hit@1:0.015206	 hit@5:0.0521	 hit@10: 0.0818
target: 	 mrr: 0.042834	 ndcg_5: 0.0356	 ndcg_10: 0.0466	 hit@1:0.013937	 hit@5:0.0564	 hit@10: 0.0913
epoch 67: train_loss = 0.333591, source_hit@10 = 0.0818, source_ndcg@10 = 0.0425, target_hit@10 = 0.0913, target_ndcg@10 = 0.0466

2024-07-11 10:32:22.041334: step 5776/21280 (epoch 68/70), loss = 0.326493 (18.584 sec/epoch), lr: 0.000299
Evaluating on dev set...
...........................
source: 	 mrr: 0.044504	 ndcg_5: 0.0351	 ndcg_10: 0.0464	 hit@1:0.014482	 hit@5:0.0565	 hit@10: 0.0920
target: 	 mrr: 0.037131	 ndcg_5: 0.0309	 ndcg_10: 0.0408	 hit@1:0.009756	 hit@5:0.0544	 hit@10: 0.0857
epoch 68: train_loss = 0.326493, source_hit@10 = 0.0920, source_ndcg@10 = 0.0464, target_hit@10 = 0.0857, target_ndcg@10 = 0.0408

2024-07-11 10:32:40.908879: step 6080/21280 (epoch 69/70), loss = 0.324718 (18.598 sec/epoch), lr: 0.000284
Evaluating on dev set...
...........................
source: 	 mrr: 0.043329	 ndcg_5: 0.0333	 ndcg_10: 0.0433	 hit@1:0.013758	 hit@5:0.0536	 hit@10: 0.0847
target: 	 mrr: 0.037073	 ndcg_5: 0.0266	 ndcg_10: 0.0379	 hit@1:0.013240	 hit@5:0.0397	 hit@10: 0.0746
epoch 69: train_loss = 0.324718, source_hit@10 = 0.0847, source_ndcg@10 = 0.0433, target_hit@10 = 0.0746, target_ndcg@10 = 0.0379

2024-07-11 10:32:59.760674: step 6384/21280 (epoch 70/70), loss = 0.315541 (18.583 sec/epoch), lr: 0.000270
Evaluating on dev set...
...........................
source: 	 mrr: 0.042203	 ndcg_5: 0.0334	 ndcg_10: 0.0430	 hit@1:0.011586	 hit@5:0.0558	 hit@10: 0.0862
target: 	 mrr: 0.040383	 ndcg_5: 0.0342	 ndcg_10: 0.0436	 hit@1:0.011847	 hit@5:0.0571	 hit@10: 0.0857
epoch 70: train_loss = 0.315541, source_hit@10 = 0.0862, source_ndcg@10 = 0.0430, target_hit@10 = 0.0857, target_ndcg@10 = 0.0436

